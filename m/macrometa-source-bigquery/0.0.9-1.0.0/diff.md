# Comparing `tmp/macrometa-source-bigquery-0.0.9.tar.gz` & `tmp/macrometa-source-bigquery-1.0.0.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "macrometa-source-bigquery-0.0.9.tar", last modified: Tue Apr 11 12:02:57 2023, max compression
+gzip compressed data, was "macrometa-source-bigquery-1.0.0.tar", last modified: Tue Aug  1 08:48:43 2023, max compression
```

## Comparing `macrometa-source-bigquery-0.0.9.tar` & `macrometa-source-bigquery-1.0.0.tar`

 * *Command `'html2text {}'` failed with exit code 1. (No output)*

```diff
@@ -26,16 +26,16 @@
 00000190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00000200: 3238 206d 7469 6d65 3d31 3638 3132 3134  28 mtime=1681214
-00000210: 3537 372e 3030 3936 3130 320a 0000 0000  577.0096102.....
+00000200: 3238 206d 7469 6d65 3d31 3639 3038 3739  28 mtime=1690879
+00000210: 3732 332e 3233 3437 3930 330a 0000 0000  723.2347903.....
 00000220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -59,23 +59,23 @@
 000003a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000003b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000003c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000003d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000003e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000003f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000400: 6d61 6372 6f6d 6574 612d 736f 7572 6365  macrometa-source
-00000410: 2d62 6967 7175 6572 792d 302e 302e 392f  -bigquery-0.0.9/
+00000410: 2d62 6967 7175 6572 792d 312e 302e 302f  -bigquery-1.0.0/
 00000420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000460: 0000 0000 3030 3030 3735 3500 3030 3031  ....0000755.0001
 00000470: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
-00000480: 3030 3030 3030 3000 3134 3431 3532 3436  0000000.14415246
-00000490: 3136 3100 3031 3632 3230 0020 3500 0000  161.016220. 5...
+00000480: 3030 3030 3030 3000 3134 3436 3231 3433  0000000.14462143
+00000490: 3335 3300 3031 3632 3131 0020 3500 0000  353.016211. 5...
 000004a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000004b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000004c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000004d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000004e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000004f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000500: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
@@ -122,16 +122,16 @@
 00000790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000007a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000007b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000007c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000007d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000007e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000007f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00000800: 3232 206d 7469 6d65 3d31 3638 3132 3134  22 mtime=1681214
-00000810: 3536 312e 300a 0000 0000 0000 0000 0000  561.0...........
+00000800: 3232 206d 7469 6d65 3d31 3639 3038 3739  22 mtime=1690879
+00000810: 3730 362e 300a 0000 0000 0000 0000 0000  706.0...........
 00000820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -155,23 +155,23 @@
 000009a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000009b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000009c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000009d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000009e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000009f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000a00: 6d61 6372 6f6d 6574 612d 736f 7572 6365  macrometa-source
-00000a10: 2d62 6967 7175 6572 792d 302e 302e 392f  -bigquery-0.0.9/
+00000a10: 2d62 6967 7175 6572 792d 312e 302e 302f  -bigquery-1.0.0/
 00000a20: 4c49 4345 4e53 4500 0000 0000 0000 0000  LICENSE.........
 00000a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000a60: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
 00000a70: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
-00000a80: 3030 3236 3133 3500 3134 3431 3532 3436  0026135.14415246
-00000a90: 3134 3100 3031 3732 3332 0020 3000 0000  141.017232. 0...
+00000a80: 3030 3236 3133 3500 3134 3436 3231 3433  0026135.14462143
+00000a90: 3333 3200 3031 3732 3232 0020 3000 0000  332.017222. 0...
 00000aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000b00: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
@@ -954,16 +954,16 @@
 00003b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003c00: 3238 206d 7469 6d65 3d31 3638 3132 3134  28 mtime=1681214
-00003c10: 3537 372e 3030 3936 3130 320a 0000 0000  577.0096102.....
+00003c00: 3238 206d 7469 6d65 3d31 3639 3038 3739  28 mtime=1690879
+00003c10: 3732 332e 3233 3437 3930 330a 0000 0000  723.2347903.....
 00003c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003c60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003c80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -987,23 +987,23 @@
 00003da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003e00: 6d61 6372 6f6d 6574 612d 736f 7572 6365  macrometa-source
-00003e10: 2d62 6967 7175 6572 792d 302e 302e 392f  -bigquery-0.0.9/
+00003e10: 2d62 6967 7175 6572 792d 312e 302e 302f  -bigquery-1.0.0/
 00003e20: 504b 472d 494e 464f 0000 0000 0000 0000  PKG-INFO........
 00003e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003e60: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
 00003e70: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
-00003e80: 3030 3136 3536 3400 3134 3431 3532 3436  0016564.14415246
-00003e90: 3136 3100 3031 3733 3331 0020 3000 0000  161.017331. 0...
+00003e80: 3030 3136 3536 3400 3134 3436 3231 3433  0016564.14462143
+00003e90: 3335 3300 3031 3733 3232 0020 3000 0000  353.017322. 0...
 00003ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003f00: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
@@ -1021,16 +1021,16 @@
 00003fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004000: 4d65 7461 6461 7461 2d56 6572 7369 6f6e  Metadata-Version
 00004010: 3a20 322e 310a 4e61 6d65 3a20 6d61 6372  : 2.1.Name: macr
 00004020: 6f6d 6574 612d 736f 7572 6365 2d62 6967  ometa-source-big
-00004030: 7175 6572 790a 5665 7273 696f 6e3a 2030  query.Version: 0
-00004040: 2e30 2e39 0a53 756d 6d61 7279 3a20 4d61  .0.9.Summary: Ma
+00004030: 7175 6572 790a 5665 7273 696f 6e3a 2031  query.Version: 1
+00004040: 2e30 2e30 0a53 756d 6d61 7279 3a20 4d61  .0.0.Summary: Ma
 00004050: 6372 6f6d 6574 6120 736f 7572 6365 2062  crometa source b
 00004060: 6967 7175 6572 7920 636f 6e6e 6563 746f  igquery connecto
 00004070: 7220 666f 7220 6578 7472 6163 7469 6e67  r for extracting
 00004080: 2064 6174 6120 6672 6f6d 2042 6967 5175   data from BigQu
 00004090: 6572 790a 486f 6d65 2d70 6167 653a 2068  ery.Home-page: h
 000040a0: 7474 7073 3a2f 2f67 6974 6875 622e 636f  ttps://github.co
 000040b0: 6d2f 4d61 6372 6f6d 6574 6163 6f72 702f  m/Macrometacorp/
@@ -1530,16 +1530,16 @@
 00005f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00005fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00005fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00005fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00005fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00005fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00005ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006000: 3232 206d 7469 6d65 3d31 3638 3132 3134  22 mtime=1681214
-00006010: 3536 312e 300a 0000 0000 0000 0000 0000  561.0...........
+00006000: 3232 206d 7469 6d65 3d31 3639 3038 3739  22 mtime=1690879
+00006010: 3730 362e 300a 0000 0000 0000 0000 0000  706.0...........
 00006020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00006030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00006040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00006050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00006060: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00006070: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00006080: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -1563,23 +1563,23 @@
 000061a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000061b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000061c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000061d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000061e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000061f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00006200: 6d61 6372 6f6d 6574 612d 736f 7572 6365  macrometa-source
-00006210: 2d62 6967 7175 6572 792d 302e 302e 392f  -bigquery-0.0.9/
+00006210: 2d62 6967 7175 6572 792d 312e 302e 302f  -bigquery-1.0.0/
 00006220: 5245 4144 4d45 2e6d 6400 0000 0000 0000  README.md.......
 00006230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00006240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00006250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00006260: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
 00006270: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
-00006280: 3030 3135 3732 3200 3134 3431 3532 3436  0015722.14415246
-00006290: 3134 3100 3031 3735 3034 0020 3000 0000  141.017504. 0...
+00006280: 3030 3135 3732 3200 3134 3436 3231 3433  0015722.14462143
+00006290: 3333 3200 3031 3734 3734 0020 3000 0000  332.017474. 0...
 000062a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000062b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000062c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000062d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000062e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000062f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00006300: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
@@ -2074,16 +2074,16 @@
 00008190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000081a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000081b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000081c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000081d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000081e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000081f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008200: 3238 206d 7469 6d65 3d31 3638 3132 3134  28 mtime=1681214
-00008210: 3537 372e 3030 3936 3130 320a 0000 0000  577.0096102.....
+00008200: 3238 206d 7469 6d65 3d31 3639 3038 3739  28 mtime=1690879
+00008210: 3732 332e 3233 3437 3930 330a 0000 0000  723.2347903.....
 00008220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -2107,23 +2107,23 @@
 000083a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000083b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000083c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000083d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000083e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000083f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008400: 6d61 6372 6f6d 6574 612d 736f 7572 6365  macrometa-source
-00008410: 2d62 6967 7175 6572 792d 302e 302e 392f  -bigquery-0.0.9/
+00008410: 2d62 6967 7175 6572 792d 312e 302e 302f  -bigquery-1.0.0/
 00008420: 6d61 6372 6f6d 6574 615f 736f 7572 6365  macrometa_source
 00008430: 5f62 6967 7175 6572 792f 0000 0000 0000  _bigquery/......
 00008440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008460: 0000 0000 3030 3030 3735 3500 3030 3031  ....0000755.0001
 00008470: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
-00008480: 3030 3030 3030 3000 3134 3431 3532 3436  0000000.14415246
-00008490: 3136 3100 3032 3334 3537 0020 3500 0000  161.023457. 5...
+00008480: 3030 3030 3030 3000 3134 3436 3231 3433  0000000.14462143
+00008490: 3335 3300 3032 3334 3530 0020 3500 0000  353.023450. 5...
 000084a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000084b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000084c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000084d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000084e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000084f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008500: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
@@ -2170,16 +2170,16 @@
 00008790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000087a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000087b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000087c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000087d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000087e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000087f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008800: 3232 206d 7469 6d65 3d31 3638 3132 3134  22 mtime=1681214
-00008810: 3536 312e 300a 0000 0000 0000 0000 0000  561.0...........
+00008800: 3232 206d 7469 6d65 3d31 3639 3038 3739  22 mtime=1690879
+00008810: 3730 362e 300a 0000 0000 0000 0000 0000  706.0...........
 00008820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -2203,23 +2203,23 @@
 000089a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000089b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000089c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000089d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000089e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000089f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008a00: 6d61 6372 6f6d 6574 612d 736f 7572 6365  macrometa-source
-00008a10: 2d62 6967 7175 6572 792d 302e 302e 392f  -bigquery-0.0.9/
+00008a10: 2d62 6967 7175 6572 792d 312e 302e 302f  -bigquery-1.0.0/
 00008a20: 6d61 6372 6f6d 6574 615f 736f 7572 6365  macrometa_source
 00008a30: 5f62 6967 7175 6572 792f 5f5f 696e 6974  _bigquery/__init
 00008a40: 5f5f 2e70 7900 0000 0000 0000 0000 0000  __.py...........
 00008a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008a60: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
 00008a70: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
-00008a80: 3030 3433 3234 3400 3134 3431 3532 3436  0043244.14415246
-00008a90: 3134 3100 3032 3535 3735 0020 3000 0000  141.025575. 0...
+00008a80: 3030 3432 3630 3500 3134 3436 3231 3433  0042605.14462143
+00008a90: 3333 3200 3032 3535 3635 0020 3000 0000  332.025565. 0...
 00008aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008b00: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
@@ -2248,1137 +2248,1137 @@
 00008c70: 6563 746f 7220 696d 706f 7274 2028 0a20  ector import (. 
 00008c80: 2020 2043 3843 6f6e 6e65 6374 6f72 2c20     C8Connector, 
 00008c90: 436f 6e66 6967 5072 6f70 6572 7479 2c20  ConfigProperty, 
 00008ca0: 5361 6d70 6c65 2c20 5363 6865 6d61 2c0a  Sample, Schema,.
 00008cb0: 2020 2020 436f 6e66 6967 4174 7472 6962      ConfigAttrib
 00008cc0: 7574 6554 7970 652c 2053 6368 656d 6141  uteType, SchemaA
 00008cd0: 7474 7269 6275 7465 5479 7065 2c20 5363  ttributeType, Sc
-00008ce0: 6865 6d61 4174 7472 6962 7574 6529 0a69  hemaAttribute).i
-00008cf0: 6d70 6f72 7420 7369 6e67 6572 0a66 726f  mport singer.fro
-00008d00: 6d20 7369 6e67 6572 2069 6d70 6f72 7420  m singer import 
-00008d10: 7574 696c 7320 6173 2073 696e 6765 725f  utils as singer_
-00008d20: 7574 696c 730a 6672 6f6d 2073 696e 6765  utils.from singe
-00008d30: 7220 696d 706f 7274 206d 6574 6164 6174  r import metadat
-00008d40: 610a 6672 6f6d 2073 696e 6765 722e 6361  a.from singer.ca
-00008d50: 7461 6c6f 6720 696d 706f 7274 2043 6174  talog import Cat
-00008d60: 616c 6f67 0a0a 6672 6f6d 206d 6163 726f  alog..from macro
-00008d70: 6d65 7461 5f73 6f75 7263 655f 6269 6771  meta_source_bigq
-00008d80: 7565 7279 2e73 616d 706c 655f 6461 7461  uery.sample_data
-00008d90: 2069 6d70 6f72 7420 6665 7463 685f 7361   import fetch_sa
-00008da0: 6d70 6c65 732c 206d 6f64 6966 795f 7265  mples, modify_re
-00008db0: 7365 7276 6564 5f6b 6579 730a 6672 6f6d  served_keys.from
-00008dc0: 206d 6163 726f 6d65 7461 5f73 6f75 7263   macrometa_sourc
-00008dd0: 655f 6269 6771 7565 7279 2069 6d70 6f72  e_bigquery impor
-00008de0: 7420 7379 6e63 5f62 6967 7175 6572 7920  t sync_bigquery 
-00008df0: 6173 2073 6f75 7263 650a 0a0a 5245 5155  as source...REQU
-00008e00: 4952 4544 5f43 4f4e 4649 475f 4b45 5953  IRED_CONFIG_KEYS
-00008e10: 203d 205b 2274 6162 6c65 222c 2022 6372   = ["table", "cr
-00008e20: 6564 656e 7469 616c 735f 6669 6c65 222c  edentials_file",
-00008e30: 2022 7072 6f6a 6563 7422 5d0a 0a4c 4f47   "project"]..LOG
-00008e40: 4745 5220 3d20 7369 6e67 6572 2e67 6574  GER = singer.get
-00008e50: 5f6c 6f67 6765 7228 226d 6163 726f 6d65  _logger("macrome
-00008e60: 7461 5f73 6f75 7263 655f 6269 6771 7565  ta_source_bigque
-00008e70: 7279 2229 0a0a 0a64 6566 2067 6574 5f61  ry")...def get_a
-00008e80: 6273 5f70 6174 6828 7061 7468 293a 0a20  bs_path(path):. 
-00008e90: 2020 2072 6574 7572 6e20 6f73 2e70 6174     return os.pat
-00008ea0: 682e 6a6f 696e 286f 732e 7061 7468 2e64  h.join(os.path.d
-00008eb0: 6972 6e61 6d65 286f 732e 7061 7468 2e72  irname(os.path.r
-00008ec0: 6561 6c70 6174 6828 5f5f 6669 6c65 5f5f  ealpath(__file__
-00008ed0: 2929 2c20 7061 7468 290a 0a0a 2320 4c6f  )), path)...# Lo
-00008ee0: 6164 2073 6368 656d 6173 2066 726f 6d20  ad schemas from 
-00008ef0: 7363 6865 6d61 7320 666f 6c64 6572 0a64  schemas folder.d
-00008f00: 6566 206c 6f61 645f 7363 6865 6d61 7328  ef load_schemas(
-00008f10: 293a 0a20 2020 2073 6368 656d 6173 203d  ):.    schemas =
-00008f20: 207b 7d0a 0a20 2020 2066 6f72 2066 696c   {}..    for fil
-00008f30: 656e 616d 6520 696e 206f 732e 6c69 7374  ename in os.list
-00008f40: 6469 7228 6765 745f 6162 735f 7061 7468  dir(get_abs_path
-00008f50: 2827 7363 6865 6d61 7327 2929 3a0a 2020  ('schemas')):.  
-00008f60: 2020 2020 2020 7061 7468 203d 2067 6574        path = get
-00008f70: 5f61 6273 5f70 6174 6828 2773 6368 656d  _abs_path('schem
-00008f80: 6173 2729 202b 2027 2f27 202b 2066 696c  as') + '/' + fil
-00008f90: 656e 616d 650a 2020 2020 2020 2020 6669  ename.        fi
-00008fa0: 6c65 5f72 6177 203d 2066 696c 656e 616d  le_raw = filenam
-00008fb0: 652e 7265 706c 6163 6528 272e 6a73 6f6e  e.replace('.json
-00008fc0: 272c 2027 2729 0a20 2020 2020 2020 2077  ', '').        w
-00008fd0: 6974 6820 6f70 656e 2870 6174 6829 2061  ith open(path) a
-00008fe0: 7320 6669 6c65 3a0a 2020 2020 2020 2020  s file:.        
-00008ff0: 2020 2020 7363 6865 6d61 735b 6669 6c65      schemas[file
-00009000: 5f72 6177 5d20 3d20 6a73 6f6e 2e6c 6f61  _raw] = json.loa
-00009010: 6428 6669 6c65 290a 0a20 2020 2072 6574  d(file)..    ret
-00009020: 7572 6e20 7363 6865 6d61 730a 0a0a 6465  urn schemas...de
-00009030: 6620 6469 7363 6f76 6572 2863 6f6e 6669  f discover(confi
-00009040: 6729 3a0a 2020 2020 7374 7265 616d 7320  g):.    streams 
-00009050: 3d20 5b5d 0a0a 2020 2020 2320 5265 7374  = []..    # Rest
-00009060: 7275 6374 7572 696e 6720 7374 7265 616d  ructuring stream
-00009070: 730a 2020 2020 636f 6e66 6967 7320 3d20  s.    configs = 
-00009080: 5b0a 2020 2020 2020 2020 7b0a 2020 2020  [.        {.    
-00009090: 2020 2020 2020 2020 226e 616d 6522 3a20          "name": 
-000090a0: 636f 6e66 6967 5b27 7461 626c 6527 5d2c  config['table'],
-000090b0: 0a20 2020 2020 2020 2020 2020 2022 7461  .            "ta
-000090c0: 626c 6522 3a20 636f 6e66 6967 5b27 7461  ble": config['ta
-000090d0: 626c 6527 5d0a 2020 2020 2020 2020 7d0a  ble'].        }.
-000090e0: 2020 2020 5d0a 0a20 2020 2069 6620 636f      ]..    if co
-000090f0: 6e66 6967 2e67 6574 2827 6461 7465 7469  nfig.get('dateti
-00009100: 6d65 5f6b 6579 2729 3a0a 2020 2020 2020  me_key'):.      
-00009110: 2020 636f 6e66 6967 735b 305d 5b27 6461    configs[0]['da
-00009120: 7465 7469 6d65 5f6b 6579 275d 203d 2063  tetime_key'] = c
-00009130: 6f6e 6669 675b 2764 6174 6574 696d 655f  onfig['datetime_
-00009140: 6b65 7927 5d0a 2020 2020 6966 2063 6f6e  key'].    if con
-00009150: 6669 672e 6765 7428 2766 696c 7465 7273  fig.get('filters
-00009160: 2729 3a0a 2020 2020 2020 2020 6669 6c74  '):.        filt
-00009170: 6572 7320 3d20 636f 6e66 6967 5b27 6669  ers = config['fi
-00009180: 6c74 6572 7327 5d2e 7370 6c69 7428 272c  lters'].split(',
-00009190: 2729 0a20 2020 2020 2020 2066 6f72 2069  ').        for i
-000091a0: 7465 6d20 696e 2066 696c 7465 7273 3a0a  tem in filters:.
-000091b0: 2020 2020 2020 2020 2020 2020 6974 656d              item
-000091c0: 2e73 7472 6970 2829 0a20 2020 2020 2020  .strip().       
-000091d0: 2063 6f6e 6669 6773 5b30 5d5b 2766 696c   configs[0]['fil
-000091e0: 7465 7273 275d 203d 2066 696c 7465 7273  ters'] = filters
-000091f0: 0a20 2020 2069 6620 636f 6e66 6967 2e67  .    if config.g
-00009200: 6574 2827 636f 6c75 6d6e 7327 2c20 272a  et('columns', '*
-00009210: 2729 3a0a 2020 2020 2020 2020 636f 6c75  '):.        colu
-00009220: 6d6e 7320 3d20 636f 6e66 6967 5b27 636f  mns = config['co
-00009230: 6c75 6d6e 7327 5d2e 7370 6c69 7428 272c  lumns'].split(',
-00009240: 2729 0a20 2020 2020 2020 2066 6f72 2069  ').        for i
-00009250: 7465 6d20 696e 2063 6f6c 756d 6e73 3a0a  tem in columns:.
-00009260: 2020 2020 2020 2020 2020 2020 6974 656d              item
-00009270: 2e73 7472 6970 2829 0a20 2020 2020 2020  .strip().       
-00009280: 2063 6f6e 6669 6773 5b30 5d5b 2763 6f6c   configs[0]['col
-00009290: 756d 6e73 275d 203d 2063 6f6c 756d 6e73  umns'] = columns
-000092a0: 0a0a 2020 2020 6164 645f 7469 6d65 7374  ..    add_timest
-000092b0: 616d 7020 3d20 636f 6e66 6967 2e67 6574  amp = config.get
-000092c0: 2827 6164 645f 6578 7472 6163 7465 645f  ('add_extracted_
-000092d0: 7469 6d65 7374 616d 7027 2c20 4661 6c73  timestamp', Fals
-000092e0: 6529 0a20 2020 2066 6f72 2073 7472 6561  e).    for strea
-000092f0: 6d20 696e 2063 6f6e 6669 6773 3a0a 2020  m in configs:.  
-00009300: 2020 2020 2020 7374 7265 616d 5f6d 6574        stream_met
-00009310: 6164 6174 612c 2073 7472 6561 6d5f 6b65  adata, stream_ke
-00009320: 795f 7072 6f70 6572 7469 6573 2c20 7363  y_properties, sc
-00009330: 6865 6d61 203d 2073 6f75 7263 652e 646f  hema = source.do
-00009340: 5f64 6973 636f 7665 7228 0a20 2020 2020  _discover(.     
-00009350: 2020 2020 2020 2063 6f6e 6669 672c 0a20         config,. 
-00009360: 2020 2020 2020 2020 2020 2073 7472 6561             strea
-00009370: 6d2c 0a20 2020 2020 2020 2020 2020 2061  m,.            a
-00009380: 6464 5f74 696d 6573 7461 6d70 290a 0a20  dd_timestamp).. 
-00009390: 2020 2020 2020 2023 2063 7265 6174 6520         # create 
-000093a0: 616e 6420 6164 6420 6361 7461 6c6f 6720  and add catalog 
-000093b0: 656e 7472 790a 2020 2020 2020 2020 6361  entry.        ca
-000093c0: 7461 6c6f 675f 656e 7472 7920 3d20 7b0a  talog_entry = {.
-000093d0: 2020 2020 2020 2020 2020 2020 2773 7472              'str
-000093e0: 6561 6d27 3a20 7374 7265 616d 5b22 6e61  eam': stream["na
-000093f0: 6d65 225d 2c0a 2020 2020 2020 2020 2020  me"],.          
-00009400: 2020 2774 6170 5f73 7472 6561 6d5f 6964    'tap_stream_id
-00009410: 273a 2073 7472 6561 6d5b 226e 616d 6522  ': stream["name"
-00009420: 5d2c 0a20 2020 2020 2020 2020 2020 2027  ],.            '
-00009430: 7363 6865 6d61 273a 2073 6368 656d 612c  schema': schema,
-00009440: 0a20 2020 2020 2020 2020 2020 2027 6d65  .            'me
-00009450: 7461 6461 7461 273a 2073 7472 6561 6d5f  tadata': stream_
-00009460: 6d65 7461 6461 7461 2c0a 2020 2020 2020  metadata,.      
-00009470: 2020 2020 2020 276b 6579 5f70 726f 7065        'key_prope
-00009480: 7274 6965 7327 3a20 7374 7265 616d 5f6b  rties': stream_k
-00009490: 6579 5f70 726f 7065 7274 6965 730a 2020  ey_properties.  
-000094a0: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
-000094b0: 7374 7265 616d 732e 6170 7065 6e64 2863  streams.append(c
-000094c0: 6174 616c 6f67 5f65 6e74 7279 290a 0a20  atalog_entry).. 
-000094d0: 2020 2072 6574 7572 6e20 7b27 7374 7265     return {'stre
-000094e0: 616d 7327 3a20 7374 7265 616d 737d 0a0a  ams': streams}..
-000094f0: 0a64 6566 205f 6765 745f 7365 6c65 6374  .def _get_select
-00009500: 6564 5f73 7472 6561 6d73 2863 6174 616c  ed_streams(catal
-00009510: 6f67 293a 0a20 2020 2027 2727 0a20 2020  og):.    '''.   
-00009520: 2047 6574 7320 7365 6c65 6374 6564 2073   Gets selected s
-00009530: 7472 6561 6d73 2e20 2043 6865 636b 7320  treams.  Checks 
-00009540: 7363 6865 6d61 2773 2027 7365 6c65 6374  schema's 'select
-00009550: 6564 2720 6669 7273 7420 286c 6567 6163  ed' first (legac
-00009560: 7929 0a20 2020 2061 6e64 2074 6865 6e20  y).    and then 
-00009570: 6368 6563 6b73 206d 6574 6164 6174 6120  checks metadata 
-00009580: 2863 7572 7265 6e74 292c 206c 6f6f 6b69  (current), looki
-00009590: 6e67 2066 6f72 2061 6e20 656d 7074 7920  ng for an empty 
-000095a0: 6272 6561 6463 7275 6d62 0a20 2020 2061  breadcrumb.    a
-000095b0: 6e64 206d 6461 7461 2077 6974 6820 6120  nd mdata with a 
-000095c0: 2773 656c 6563 7465 6427 2065 6e74 7279  'selected' entry
-000095d0: 0a20 2020 2027 2727 0a20 2020 2073 656c  .    '''.    sel
-000095e0: 6563 7465 645f 7374 7265 616d 7320 3d20  ected_streams = 
-000095f0: 5b5d 0a20 2020 2066 6f72 2073 7472 6561  [].    for strea
-00009600: 6d20 696e 2063 6174 616c 6f67 2e73 7472  m in catalog.str
-00009610: 6561 6d73 3a0a 2020 2020 2020 2020 7374  eams:.        st
-00009620: 7265 616d 5f6d 6574 6164 6174 6120 3d20  ream_metadata = 
-00009630: 6d65 7461 6461 7461 2e74 6f5f 6d61 7028  metadata.to_map(
-00009640: 7374 7265 616d 2e6d 6574 6164 6174 6129  stream.metadata)
-00009650: 0a20 2020 2020 2020 2023 2073 7472 6561  .        # strea
-00009660: 6d20 6d65 7461 6461 7461 2077 696c 6c20  m metadata will 
-00009670: 6861 7665 2061 6e20 656d 7074 7920 6272  have an empty br
-00009680: 6561 6463 7275 6d62 0a20 2020 2020 2020  eadcrumb.       
-00009690: 2069 6620 6d65 7461 6461 7461 2e67 6574   if metadata.get
-000096a0: 2873 7472 6561 6d5f 6d65 7461 6461 7461  (stream_metadata
-000096b0: 2c20 2829 2c20 2273 656c 6563 7465 6422  , (), "selected"
-000096c0: 293a 0a20 2020 2020 2020 2020 2020 2073  ):.            s
-000096d0: 656c 6563 7465 645f 7374 7265 616d 732e  elected_streams.
-000096e0: 6170 7065 6e64 2873 7472 6561 6d2e 7461  append(stream.ta
-000096f0: 705f 7374 7265 616d 5f69 6429 0a0a 2020  p_stream_id)..  
-00009700: 2020 7265 7475 726e 2073 656c 6563 7465    return selecte
-00009710: 645f 7374 7265 616d 730a 0a0a 6465 6620  d_streams...def 
-00009720: 7379 6e63 2863 6f6e 6669 672c 2073 7461  sync(config, sta
-00009730: 7465 2c20 6361 7461 6c6f 6729 3a0a 2020  te, catalog):.  
-00009740: 2020 7365 6c65 6374 6564 5f73 7472 6561    selected_strea
-00009750: 6d5f 6964 7320 3d20 5f67 6574 5f73 656c  m_ids = _get_sel
-00009760: 6563 7465 645f 7374 7265 616d 7328 6361  ected_streams(ca
-00009770: 7461 6c6f 6729 0a20 2020 2023 204c 6f6f  talog).    # Loo
-00009780: 7020 6f76 6572 2073 7472 6561 6d73 2069  p over streams i
-00009790: 6e20 6361 7461 6c6f 670a 2020 2020 666f  n catalog.    fo
-000097a0: 7220 7374 7265 616d 2069 6e20 6361 7461  r stream in cata
-000097b0: 6c6f 672e 7374 7265 616d 733a 0a20 2020  log.streams:.   
-000097c0: 2020 2020 2073 7472 6561 6d5f 6964 203d       stream_id =
-000097d0: 2073 7472 6561 6d2e 7461 705f 7374 7265   stream.tap_stre
-000097e0: 616d 5f69 640a 2020 2020 2020 2020 7374  am_id.        st
-000097f0: 7265 616d 5f73 6368 656d 6120 3d20 7374  ream_schema = st
-00009800: 7265 616d 2e73 6368 656d 610a 2020 2020  ream.schema.    
-00009810: 2020 2020 6966 2073 7472 6561 6d5f 6964      if stream_id
-00009820: 2069 6e20 7365 6c65 6374 6564 5f73 7472   in selected_str
-00009830: 6561 6d5f 6964 733a 0a20 2020 2020 2020  eam_ids:.       
-00009840: 2020 2020 2073 6f75 7263 652e 646f 5f73       source.do_s
-00009850: 796e 6328 636f 6e66 6967 2c20 7374 6174  ync(config, stat
-00009860: 652c 2073 7472 6561 6d29 0a20 2020 2020  e, stream).     
-00009870: 2020 2020 2020 204c 4f47 4745 522e 696e         LOGGER.in
-00009880: 666f 2827 5379 6e63 696e 6720 7374 7265  fo('Syncing stre
-00009890: 616d 3a27 202b 2073 7472 6561 6d5f 6964  am:' + stream_id
-000098a0: 290a 2020 2020 7265 7475 726e 0a0a 0a64  ).    return...d
-000098b0: 6566 2070 6172 7365 5f61 7267 7328 293a  ef parse_args():
-000098c0: 0a20 2020 2027 2727 2054 6869 7320 6973  .    ''' This is
-000098d0: 2074 6f20 7265 706c 6163 6520 7369 6e67   to replace sing
-000098e0: 6572 2773 2064 6566 6175 6c74 2073 696e  er's default sin
-000098f0: 6765 725f 7574 696c 732e 7061 7273 655f  ger_utils.parse_
-00009900: 6172 6773 2829 0a20 2020 2068 7474 7073  args().    https
-00009910: 3a2f 2f67 6974 6875 622e 636f 6d2f 7369  ://github.com/si
-00009920: 6e67 6572 2d69 6f2f 7369 6e67 6572 2d70  nger-io/singer-p
-00009930: 7974 686f 6e2f 626c 6f62 2f6d 6173 7465  ython/blob/maste
-00009940: 722f 7369 6e67 6572 2f75 7469 6c73 2e70  r/singer/utils.p
-00009950: 790a 0a20 2020 2050 6172 7365 2073 7461  y..    Parse sta
-00009960: 6e64 6172 6420 636f 6d6d 616e 642d 6c69  ndard command-li
-00009970: 6e65 2061 7267 732e 0a20 2020 2050 6172  ne args..    Par
-00009980: 7365 7320 7468 6520 636f 6d6d 616e 642d  ses the command-
-00009990: 6c69 6e65 2061 7267 756d 656e 7473 206d  line arguments m
-000099a0: 656e 7469 6f6e 6564 2069 6e20 7468 6520  entioned in the 
-000099b0: 5350 4543 2061 6e64 2074 6865 0a20 2020  SPEC and the.   
-000099c0: 2042 4553 545f 5052 4143 5449 4345 5320   BEST_PRACTICES 
-000099d0: 646f 6375 6d65 6e74 733a 0a20 2020 202d  documents:.    -
-000099e0: 632c 2d2d 636f 6e66 6967 2020 2020 2043  c,--config     C
-000099f0: 6f6e 6669 6720 6669 6c65 0a20 2020 202d  onfig file.    -
-00009a00: 732c 2d2d 7374 6174 6520 2020 2020 2053  s,--state      S
-00009a10: 7461 7465 2066 696c 650a 2020 2020 2d64  tate file.    -d
-00009a20: 2c2d 2d64 6973 636f 7665 7220 2020 5275  ,--discover   Ru
-00009a30: 6e20 696e 2064 6973 636f 7665 7220 6d6f  n in discover mo
-00009a40: 6465 0a20 2020 202d 2d63 6174 616c 6f67  de.    --catalog
-00009a50: 2020 2020 2020 2043 6174 616c 6f67 2066         Catalog f
-00009a60: 696c 650a 2020 2020 5265 7475 726e 7320  ile.    Returns 
-00009a70: 7468 6520 7061 7273 6564 2061 7267 7320  the parsed args 
-00009a80: 6f62 6a65 6374 2066 726f 6d20 6172 6770  object from argp
-00009a90: 6172 7365 2e20 466f 7220 6561 6368 2061  arse. For each a
-00009aa0: 7267 756d 656e 7420 7468 6174 0a20 2020  rgument that.   
-00009ab0: 2070 6f69 6e74 2074 6f20 4a53 4f4e 2066   point to JSON f
-00009ac0: 696c 6573 2028 636f 6e66 6967 2c20 7374  iles (config, st
-00009ad0: 6174 652c 2070 726f 7065 7274 6965 7329  ate, properties)
-00009ae0: 2c20 7765 2077 696c 6c20 6175 746f 6d61  , we will automa
-00009af0: 7469 6361 6c6c 790a 2020 2020 6c6f 6164  tically.    load
-00009b00: 2061 6e64 2070 6172 7365 2074 6865 204a   and parse the J
-00009b10: 534f 4e20 6669 6c65 2e0a 2020 2020 2727  SON file..    ''
-00009b20: 270a 2020 2020 7061 7273 6572 203d 2061  '.    parser = a
-00009b30: 7267 7061 7273 652e 4172 6775 6d65 6e74  rgparse.Argument
-00009b40: 5061 7273 6572 2829 0a0a 2020 2020 7061  Parser()..    pa
-00009b50: 7273 6572 2e61 6464 5f61 7267 756d 656e  rser.add_argumen
-00009b60: 7428 0a20 2020 2020 2020 2027 2d63 272c  t(.        '-c',
-00009b70: 2027 2d2d 636f 6e66 6967 272c 0a20 2020   '--config',.   
-00009b80: 2020 2020 2068 656c 703d 2743 6f6e 6669       help='Confi
-00009b90: 6720 6669 6c65 272c 0a20 2020 2020 2020  g file',.       
-00009ba0: 2072 6571 7569 7265 643d 5472 7565 290a   required=True).
-00009bb0: 0a20 2020 2070 6172 7365 722e 6164 645f  .    parser.add_
-00009bc0: 6172 6775 6d65 6e74 280a 2020 2020 2020  argument(.      
-00009bd0: 2020 272d 7327 2c20 272d 2d73 7461 7465    '-s', '--state
-00009be0: 272c 0a20 2020 2020 2020 2068 656c 703d  ',.        help=
-00009bf0: 2753 7461 7465 2066 696c 6527 290a 0a20  'State file').. 
-00009c00: 2020 2070 6172 7365 722e 6164 645f 6172     parser.add_ar
-00009c10: 6775 6d65 6e74 280a 2020 2020 2020 2020  gument(.        
-00009c20: 272d 7027 2c20 272d 2d70 726f 7065 7274  '-p', '--propert
-00009c30: 6965 7327 2c0a 2020 2020 2020 2020 6865  ies',.        he
-00009c40: 6c70 3d27 5072 6f70 6572 7479 2073 656c  lp='Property sel
-00009c50: 6563 7469 6f6e 733a 2044 4550 5245 4341  ections: DEPRECA
-00009c60: 5445 442c 2050 6c65 6173 6520 7573 6520  TED, Please use 
-00009c70: 2d2d 6361 7461 6c6f 6720 696e 7374 6561  --catalog instea
-00009c80: 6427 290a 0a20 2020 2070 6172 7365 722e  d')..    parser.
-00009c90: 6164 645f 6172 6775 6d65 6e74 280a 2020  add_argument(.  
-00009ca0: 2020 2020 2020 272d 2d63 6174 616c 6f67        '--catalog
-00009cb0: 272c 0a20 2020 2020 2020 2068 656c 703d  ',.        help=
-00009cc0: 2743 6174 616c 6f67 2066 696c 6527 290a  'Catalog file').
-00009cd0: 0a20 2020 2070 6172 7365 722e 6164 645f  .    parser.add_
-00009ce0: 6172 6775 6d65 6e74 280a 2020 2020 2020  argument(.      
-00009cf0: 2020 272d 6427 2c20 272d 2d64 6973 636f    '-d', '--disco
-00009d00: 7665 7227 2c0a 2020 2020 2020 2020 6163  ver',.        ac
-00009d10: 7469 6f6e 3d27 7374 6f72 655f 7472 7565  tion='store_true
-00009d20: 272c 0a20 2020 2020 2020 2068 656c 703d  ',.        help=
-00009d30: 2744 6f20 7363 6865 6d61 2064 6973 636f  'Do schema disco
-00009d40: 7665 7279 2729 0a0a 2020 2020 2320 4361  very')..    # Ca
-00009d50: 7074 7572 6520 6164 6469 7469 6f6e 616c  pture additional
-00009d60: 2061 7267 730a 2020 2020 7061 7273 6572   args.    parser
-00009d70: 2e61 6464 5f61 7267 756d 656e 7428 0a20  .add_argument(. 
-00009d80: 2020 2020 2020 2022 2d2d 7374 6172 745f         "--start_
-00009d90: 6461 7465 7469 6d65 222c 2074 7970 653d  datetime", type=
-00009da0: 7374 722c 0a20 2020 2020 2020 2068 656c  str,.        hel
-00009db0: 703d 2249 6e63 6c75 7369 7665 2073 7461  p="Inclusive sta
-00009dc0: 7274 2064 6174 6520 7469 6d65 2069 6e20  rt date time in 
-00009dd0: 4953 4f38 3630 312d 4461 7465 2d53 7472  ISO8601-Date-Str
-00009de0: 696e 6720 666f 726d 6174 3a20 3230 3139  ing format: 2019
-00009df0: 2d30 342d 3131 5430 303a 3030 3a30 305a  -04-11T00:00:00Z
-00009e00: 2229 0a20 2020 2070 6172 7365 722e 6164  ").    parser.ad
-00009e10: 645f 6172 6775 6d65 6e74 280a 2020 2020  d_argument(.    
-00009e20: 2020 2020 222d 2d65 6e64 5f64 6174 6574      "--end_datet
-00009e30: 696d 6522 2c20 7479 7065 3d73 7472 2c0a  ime", type=str,.
-00009e40: 2020 2020 2020 2020 6865 6c70 3d22 4578          help="Ex
-00009e50: 636c 7573 6976 6520 656e 6420 6461 7465  clusive end date
-00009e60: 2074 696d 6520 696e 2049 534f 3836 3031   time in ISO8601
-00009e70: 2d44 6174 652d 5374 7269 6e67 2066 6f72  -Date-String for
-00009e80: 6d61 743a 2032 3031 392d 3034 2d31 3254  mat: 2019-04-12T
-00009e90: 3030 3a30 303a 3030 5a22 290a 0a20 2020  00:00:00Z")..   
-00009ea0: 2061 7267 7320 3d20 7061 7273 6572 2e70   args = parser.p
-00009eb0: 6172 7365 5f61 7267 7328 290a 2020 2020  arse_args().    
-00009ec0: 6966 2061 7267 732e 636f 6e66 6967 3a0a  if args.config:.
-00009ed0: 2020 2020 2020 2020 6172 6773 2e63 6f6e          args.con
-00009ee0: 6669 6720 3d20 7369 6e67 6572 5f75 7469  fig = singer_uti
-00009ef0: 6c73 2e6c 6f61 645f 6a73 6f6e 2861 7267  ls.load_json(arg
-00009f00: 732e 636f 6e66 6967 290a 2020 2020 6966  s.config).    if
-00009f10: 2061 7267 732e 7374 6174 653a 0a20 2020   args.state:.   
-00009f20: 2020 2020 2061 7267 732e 7374 6174 6520       args.state 
-00009f30: 3d20 7369 6e67 6572 5f75 7469 6c73 2e6c  = singer_utils.l
-00009f40: 6f61 645f 6a73 6f6e 2861 7267 732e 7374  oad_json(args.st
-00009f50: 6174 6529 0a20 2020 2065 6c73 653a 0a20  ate).    else:. 
-00009f60: 2020 2020 2020 2061 7267 732e 7374 6174         args.stat
-00009f70: 6520 3d20 7b7d 0a20 2020 2069 6620 6172  e = {}.    if ar
-00009f80: 6773 2e70 726f 7065 7274 6965 733a 0a20  gs.properties:. 
-00009f90: 2020 2020 2020 2061 7267 732e 7072 6f70         args.prop
-00009fa0: 6572 7469 6573 203d 2073 696e 6765 725f  erties = singer_
-00009fb0: 7574 696c 732e 6c6f 6164 5f6a 736f 6e28  utils.load_json(
-00009fc0: 6172 6773 2e70 726f 7065 7274 6965 7329  args.properties)
-00009fd0: 0a20 2020 2069 6620 6172 6773 2e63 6174  .    if args.cat
-00009fe0: 616c 6f67 3a0a 2020 2020 2020 2020 6172  alog:.        ar
-00009ff0: 6773 2e63 6174 616c 6f67 203d 2043 6174  gs.catalog = Cat
-0000a000: 616c 6f67 2e6c 6f61 6428 6172 6773 2e63  alog.load(args.c
-0000a010: 6174 616c 6f67 290a 0a20 2020 2072 6574  atalog)..    ret
-0000a020: 7572 6e20 6172 6773 0a0a 0a64 6566 206d  urn args...def m
-0000a030: 6169 6e5f 696d 706c 2829 3a0a 2020 2020  ain_impl():.    
-0000a040: 6172 6773 203d 2073 696e 6765 725f 7574  args = singer_ut
-0000a050: 696c 732e 7061 7273 655f 6172 6773 2852  ils.parse_args(R
-0000a060: 4551 5549 5245 445f 434f 4e46 4947 5f4b  EQUIRED_CONFIG_K
-0000a070: 4559 5329 0a20 2020 2063 6f6e 6e5f 636f  EYS).    conn_co
-0000a080: 6e66 6967 203d 207b 7d0a 2020 2020 636f  nfig = {}.    co
-0000a090: 6e6e 5f63 6f6e 6669 672e 7570 6461 7465  nn_config.update
-0000a0a0: 2861 7267 732e 636f 6e66 6967 290a 0a20  (args.config).. 
-0000a0b0: 2020 2023 204f 7665 7277 7269 7465 2063     # Overwrite c
-0000a0c0: 6f6e 6669 6720 7370 6563 7320 7769 7468  onfig specs with
-0000a0d0: 2063 6f6d 6d61 6e64 6c69 6e65 2061 7267   commandline arg
-0000a0e0: 730a 2020 2020 6172 6773 5f64 6963 7420  s.    args_dict 
-0000a0f0: 3d20 6172 6773 2e5f 5f64 6963 745f 5f0a  = args.__dict__.
-0000a100: 2020 2020 666f 7220 6172 6720 696e 2061      for arg in a
-0000a110: 7267 735f 6469 6374 2e6b 6579 7328 293a  rgs_dict.keys():
-0000a120: 0a20 2020 2020 2020 2069 6620 6172 6720  .        if arg 
-0000a130: 696e 2063 6f6e 6e5f 636f 6e66 6967 2e6b  in conn_config.k
-0000a140: 6579 7328 2920 616e 6420 6172 6773 5f64  eys() and args_d
-0000a150: 6963 745b 6172 675d 2069 7320 4e6f 6e65  ict[arg] is None
-0000a160: 3a0a 2020 2020 2020 2020 2020 2020 636f  :.            co
-0000a170: 6e74 696e 7565 0a20 2020 2020 2020 2063  ntinue.        c
-0000a180: 6f6e 6e5f 636f 6e66 6967 5b61 7267 5d20  onn_config[arg] 
-0000a190: 3d20 6172 6773 5f64 6963 745b 6172 675d  = args_dict[arg]
-0000a1a0: 0a0a 2020 2020 6966 206e 6f74 2063 6f6e  ..    if not con
-0000a1b0: 6e5f 636f 6e66 6967 2e67 6574 2822 656e  n_config.get("en
-0000a1c0: 645f 6461 7465 7469 6d65 2229 3a0a 2020  d_datetime"):.  
-0000a1d0: 2020 2020 2020 636f 6e6e 5f63 6f6e 6669        conn_confi
-0000a1e0: 675b 2265 6e64 5f64 6174 6574 696d 6522  g["end_datetime"
-0000a1f0: 5d20 3d20 6461 7465 7469 6d65 2e64 6174  ] = datetime.dat
-0000a200: 6574 696d 652e 7574 636e 6f77 2829 2e69  etime.utcnow().i
-0000a210: 736f 666f 726d 6174 2829 0a0a 2020 2020  soformat()..    
-0000a220: 7472 793a 0a20 2020 2020 2020 2063 6f6e  try:.        con
-0000a230: 6e5f 636f 6e66 6967 203d 2073 6f75 7263  n_config = sourc
-0000a240: 652e 6372 6561 7465 5f63 7265 6465 6e74  e.create_credent
-0000a250: 6961 6c73 5f66 696c 6528 636f 6e6e 5f63  ials_file(conn_c
-0000a260: 6f6e 6669 6729 0a20 2020 2020 2020 2023  onfig).        #
-0000a270: 2069 6620 6e6f 7420 636f 6e6e 5f63 6f6e   if not conn_con
-0000a280: 6669 672e 6765 7428 2273 7461 7274 5f64  fig.get("start_d
-0000a290: 6174 6574 696d 6522 2920 616e 6420 6e6f  atetime") and no
-0000a2a0: 7420 636f 6e6e 5f63 6f6e 6669 672e 6765  t conn_config.ge
-0000a2b0: 7428 2273 7461 7465 2229 3a0a 2020 2020  t("state"):.    
-0000a2c0: 2020 2020 2320 2020 2020 4c4f 4747 4552      #     LOGGER
-0000a2d0: 2e65 7272 6f72 2822 7374 6174 6520 6f72  .error("state or
-0000a2e0: 2073 7461 7274 5f64 6174 6574 696d 6520   start_datetime 
-0000a2f0: 6d75 7374 2062 6520 7370 6563 6966 6965  must be specifie
-0000a300: 6422 290a 2020 2020 2020 2020 2320 2020  d").        #   
-0000a310: 2020 7265 7475 726e 0a0a 2020 2020 2020    return..      
-0000a320: 2020 2320 4966 2064 6973 636f 7665 7220    # If discover 
-0000a330: 666c 6167 2077 6173 2070 6173 7365 642c  flag was passed,
-0000a340: 2072 756e 2064 6973 636f 7665 7279 206d   run discovery m
-0000a350: 6f64 6520 616e 6420 6475 6d70 206f 7574  ode and dump out
-0000a360: 7075 7420 746f 2073 7464 6f75 740a 2020  put to stdout.  
-0000a370: 2020 2020 2020 6966 2061 7267 732e 6469        if args.di
-0000a380: 7363 6f76 6572 3a0a 2020 2020 2020 2020  scover:.        
-0000a390: 2020 2020 6361 7461 6c6f 6720 3d20 6469      catalog = di
-0000a3a0: 7363 6f76 6572 2863 6f6e 6e5f 636f 6e66  scover(conn_conf
-0000a3b0: 6967 290a 2020 2020 2020 2020 2020 2020  ig).            
-0000a3c0: 7072 696e 7428 6a73 6f6e 2e64 756d 7073  print(json.dumps
-0000a3d0: 2863 6174 616c 6f67 2c20 696e 6465 6e74  (catalog, indent
-0000a3e0: 3d32 2929 0a20 2020 2020 2020 2023 204f  =2)).        # O
-0000a3f0: 7468 6572 7769 7365 2072 756e 2069 6e20  therwise run in 
-0000a400: 7379 6e63 206d 6f64 650a 2020 2020 2020  sync mode.      
-0000a410: 2020 656c 6966 2061 7267 732e 6361 7461    elif args.cata
-0000a420: 6c6f 673a 0a20 2020 2020 2020 2020 2020  log:.           
-0000a430: 2063 6174 616c 6f67 203d 2061 7267 732e   catalog = args.
-0000a440: 6361 7461 6c6f 670a 2020 2020 2020 2020  catalog.        
-0000a450: 2020 2020 7379 6e63 2863 6f6e 6e5f 636f      sync(conn_co
-0000a460: 6e66 6967 2c20 6172 6773 2e73 7461 7465  nfig, args.state
-0000a470: 2c20 6361 7461 6c6f 6729 0a20 2020 2020  , catalog).     
-0000a480: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0000a490: 2020 2020 204c 4f47 4745 522e 6372 6974       LOGGER.crit
-0000a4a0: 6963 616c 2822 4361 7461 6c6f 6720 6669  ical("Catalog fi
-0000a4b0: 6c65 206e 6f74 2073 7065 6369 6669 6564  le not specified
-0000a4c0: 2229 0a20 2020 2065 7863 6570 7420 4578  ").    except Ex
-0000a4d0: 6365 7074 696f 6e20 6173 2065 3a0a 2020  ception as e:.  
-0000a4e0: 2020 2020 2020 4c4f 4747 4552 2e77 6172        LOGGER.war
-0000a4f0: 6e28 2245 7863 6570 7469 6f6e 2072 6169  n("Exception rai
-0000a500: 7365 643a 2025 7322 2c20 6529 0a20 2020  sed: %s", e).   
-0000a510: 2020 2020 2073 6f75 7263 652e 6465 6c65       source.dele
-0000a520: 7465 5f63 7265 6465 6e74 6961 6c73 5f66  te_credentials_f
-0000a530: 696c 6528 636f 6e6e 5f63 6f6e 6669 6729  ile(conn_config)
-0000a540: 0a20 2020 2020 2020 2072 6169 7365 2065  .        raise e
-0000a550: 0a20 2020 2073 6f75 7263 652e 6465 6c65  .    source.dele
-0000a560: 7465 5f63 7265 6465 6e74 6961 6c73 5f66  te_credentials_f
-0000a570: 696c 6528 636f 6e6e 5f63 6f6e 6669 6729  ile(conn_config)
-0000a580: 0a20 2020 2072 6574 7572 6e0a 0a0a 636c  .    return...cl
-0000a590: 6173 7320 4269 6751 7565 7279 536f 7572  ass BigQuerySour
-0000a5a0: 6365 436f 6e6e 6563 746f 7228 4338 436f  ceConnector(C8Co
-0000a5b0: 6e6e 6563 746f 7229 3a0a 2020 2020 2222  nnector):.    ""
-0000a5c0: 2242 6967 5175 6572 7953 6f75 7263 6543  "BigQuerySourceC
-0000a5d0: 6f6e 6e65 6374 6f72 2773 2043 3843 6f6e  onnector's C8Con
-0000a5e0: 6e65 6374 6f72 2069 6d70 6c2e 2222 220a  nector impl.""".
-0000a5f0: 0a20 2020 2064 6566 206e 616d 6528 7365  .    def name(se
-0000a600: 6c66 2920 2d3e 2073 7472 3a0a 2020 2020  lf) -> str:.    
-0000a610: 2020 2020 2222 2252 6574 7572 6e73 2074      """Returns t
-0000a620: 6865 206e 616d 6520 6f66 2074 6865 2063  he name of the c
-0000a630: 6f6e 6e65 6374 6f72 2e22 2222 0a20 2020  onnector.""".   
-0000a640: 2020 2020 2072 6574 7572 6e20 2242 6967       return "Big
-0000a650: 5175 6572 7922 0a0a 2020 2020 6465 6620  Query"..    def 
-0000a660: 7061 636b 6167 655f 6e61 6d65 2873 656c  package_name(sel
-0000a670: 6629 202d 3e20 7374 723a 0a20 2020 2020  f) -> str:.     
-0000a680: 2020 2022 2222 5265 7475 726e 7320 7468     """Returns th
-0000a690: 6520 7061 636b 6167 6520 6e61 6d65 206f  e package name o
-0000a6a0: 6620 7468 6520 636f 6e6e 6563 746f 7220  f the connector 
-0000a6b0: 2869 2e65 2e20 5079 5069 2070 6163 6b61  (i.e. PyPi packa
-0000a6c0: 6765 206e 616d 6529 2e22 2222 0a20 2020  ge name).""".   
-0000a6d0: 2020 2020 2072 6574 7572 6e20 226d 6163       return "mac
-0000a6e0: 726f 6d65 7461 2d73 6f75 7263 652d 6269  rometa-source-bi
-0000a6f0: 6771 7565 7279 220a 0a20 2020 2064 6566  gquery"..    def
-0000a700: 2076 6572 7369 6f6e 2873 656c 6629 202d   version(self) -
-0000a710: 3e20 7374 723a 0a20 2020 2020 2020 2022  > str:.        "
-0000a720: 2222 5265 7475 726e 7320 7468 6520 7665  ""Returns the ve
-0000a730: 7273 696f 6e20 6f66 2074 6865 2063 6f6e  rsion of the con
-0000a740: 6e65 6374 6f72 2e22 2222 0a20 2020 2020  nector.""".     
-0000a750: 2020 2072 6574 7572 6e20 706b 675f 7265     return pkg_re
-0000a760: 736f 7572 6365 732e 6765 745f 6469 7374  sources.get_dist
-0000a770: 7269 6275 7469 6f6e 2827 6d61 6372 6f6d  ribution('macrom
-0000a780: 6574 615f 736f 7572 6365 5f62 6967 7175  eta_source_bigqu
-0000a790: 6572 7927 292e 7665 7273 696f 6e0a 0a20  ery').version.. 
-0000a7a0: 2020 2064 6566 2074 7970 6528 7365 6c66     def type(self
-0000a7b0: 2920 2d3e 2073 7472 3a0a 2020 2020 2020  ) -> str:.      
-0000a7c0: 2020 2222 2252 6574 7572 6e73 2074 6865    """Returns the
-0000a7d0: 2074 7970 6520 6f66 2074 6865 2063 6f6e   type of the con
-0000a7e0: 6e65 6374 6f72 2e22 2222 0a20 2020 2020  nector.""".     
-0000a7f0: 2020 2072 6574 7572 6e20 2273 6f75 7263     return "sourc
-0000a800: 6522 0a0a 2020 2020 6465 6620 6465 7363  e"..    def desc
-0000a810: 7269 7074 696f 6e28 7365 6c66 2920 2d3e  ription(self) ->
-0000a820: 2073 7472 3a0a 2020 2020 2020 2020 2222   str:.        ""
-0000a830: 2252 6574 7572 6e73 2074 6865 2064 6573  "Returns the des
-0000a840: 6372 6970 7469 6f6e 206f 6620 7468 6520  cription of the 
-0000a850: 636f 6e6e 6563 746f 722e 2222 220a 2020  connector.""".  
-0000a860: 2020 2020 2020 7265 7475 726e 2022 536f        return "So
-0000a870: 7572 6365 2064 6174 6120 6672 6f6d 2061  urce data from a
-0000a880: 2042 6967 5175 6572 7920 7461 626c 652e   BigQuery table.
-0000a890: 220a 0a20 2020 2064 6566 206c 6f67 6f28  "..    def logo(
-0000a8a0: 7365 6c66 2920 2d3e 2073 7472 3a0a 2020  self) -> str:.  
-0000a8b0: 2020 2020 2020 2222 2252 6574 7572 6e73        """Returns
-0000a8c0: 2074 6865 206c 6f67 6f20 696d 6167 6520   the logo image 
-0000a8d0: 666f 7220 7468 6520 636f 6e6e 6563 746f  for the connecto
-0000a8e0: 722e 2222 220a 2020 2020 2020 2020 7265  r.""".        re
-0000a8f0: 7475 726e 2022 220a 0a20 2020 2064 6566  turn ""..    def
-0000a900: 2076 616c 6964 6174 6528 7365 6c66 2c20   validate(self, 
-0000a910: 696e 7465 6772 6174 696f 6e3a 2064 6963  integration: dic
-0000a920: 7429 202d 3e20 4e6f 6e65 3a0a 2020 2020  t) -> None:.    
-0000a930: 2020 2020 2222 2256 616c 6964 6174 6520      """Validate 
-0000a940: 6769 7665 6e20 636f 6e66 6967 7572 6174  given configurat
-0000a950: 696f 6e73 2061 6761 696e 7374 2074 6865  ions against the
-0000a960: 2063 6f6e 6e65 6374 6f72 2e0a 2020 2020   connector..    
-0000a970: 2020 2020 4966 2069 6e76 616c 6964 2c20      If invalid, 
-0000a980: 7468 726f 7720 616e 2065 7863 6570 7469  throw an excepti
-0000a990: 6f6e 2077 6974 6820 7468 6520 6361 7573  on with the caus
-0000a9a0: 652e 0a20 2020 2020 2020 2022 2222 0a20  e..        """. 
-0000a9b0: 2020 2020 2020 2063 6f6e 6669 6720 3d20         config = 
-0000a9c0: 7365 6c66 2e67 6574 5f63 6f6e 6669 6728  self.get_config(
-0000a9d0: 696e 7465 6772 6174 696f 6e29 0a20 2020  integration).   
-0000a9e0: 2020 2020 2074 7279 3a0a 2020 2020 2020       try:.      
-0000a9f0: 2020 2020 2020 636f 6e66 6967 203d 2073        config = s
-0000aa00: 6f75 7263 652e 6372 6561 7465 5f63 7265  ource.create_cre
-0000aa10: 6465 6e74 6961 6c73 5f66 696c 6528 636f  dentials_file(co
-0000aa20: 6e66 6967 290a 2020 2020 2020 2020 2020  nfig).          
-0000aa30: 2020 6469 7363 6f76 6572 2863 6f6e 6669    discover(confi
-0000aa40: 6729 0a20 2020 2020 2020 2065 7863 6570  g).        excep
-0000aa50: 7420 4578 6365 7074 696f 6e20 6173 2065  t Exception as e
-0000aa60: 3a0a 2020 2020 2020 2020 2020 2020 4c4f  :.            LO
-0000aa70: 4747 4552 2e77 6172 6e28 2245 7863 6570  GGER.warn("Excep
-0000aa80: 7469 6f6e 2072 6169 7365 643a 2025 7322  tion raised: %s"
-0000aa90: 2c20 6529 0a20 2020 2020 2020 2020 2020  , e).           
-0000aaa0: 2073 6f75 7263 652e 6465 6c65 7465 5f63   source.delete_c
-0000aab0: 7265 6465 6e74 6961 6c73 5f66 696c 6528  redentials_file(
-0000aac0: 636f 6e66 6967 290a 2020 2020 2020 2020  config).        
-0000aad0: 2020 2020 7261 6973 6520 650a 2020 2020      raise e.    
-0000aae0: 2020 2020 736f 7572 6365 2e64 656c 6574      source.delet
-0000aaf0: 655f 6372 6564 656e 7469 616c 735f 6669  e_credentials_fi
-0000ab00: 6c65 2863 6f6e 6669 6729 0a0a 2020 2020  le(config)..    
-0000ab10: 6465 6620 7361 6d70 6c65 7328 7365 6c66  def samples(self
-0000ab20: 2c20 696e 7465 6772 6174 696f 6e3a 2064  , integration: d
-0000ab30: 6963 7429 202d 3e20 6c69 7374 5b53 616d  ict) -> list[Sam
-0000ab40: 706c 655d 3a0a 2020 2020 2020 2020 2222  ple]:.        ""
-0000ab50: 2246 6574 6368 2073 616d 706c 6520 6461  "Fetch sample da
-0000ab60: 7461 2075 7369 6e67 2074 6865 2070 726f  ta using the pro
-0000ab70: 7669 6465 6420 636f 6e66 6967 7572 6174  vided configurat
-0000ab80: 696f 6e73 2e22 2222 0a20 2020 2020 2020  ions.""".       
-0000ab90: 2063 6f6e 6669 6720 3d20 7365 6c66 2e67   config = self.g
-0000aba0: 6574 5f63 6f6e 6669 6728 696e 7465 6772  et_config(integr
-0000abb0: 6174 696f 6e29 0a20 2020 2020 2020 2074  ation).        t
-0000abc0: 7279 3a0a 2020 2020 2020 2020 2020 2020  ry:.            
-0000abd0: 636f 6e66 6967 203d 2073 6f75 7263 652e  config = source.
-0000abe0: 6372 6561 7465 5f63 7265 6465 6e74 6961  create_credentia
-0000abf0: 6c73 5f66 696c 6528 636f 6e66 6967 290a  ls_file(config).
-0000ac00: 2020 2020 2020 2020 2020 2020 7374 7265              stre
-0000ac10: 616d 7320 3d20 6469 7363 6f76 6572 2863  ams = discover(c
-0000ac20: 6f6e 6669 6729 5b27 7374 7265 616d 7327  onfig)['streams'
-0000ac30: 5d0a 2020 2020 2020 2020 2020 2020 7265  ].            re
-0000ac40: 7375 6c74 7320 3d20 5b5d 0a20 2020 2020  sults = [].     
-0000ac50: 2020 2020 2020 2066 6f72 2073 7472 6561         for strea
-0000ac60: 6d20 696e 2073 7472 6561 6d73 3a0a 2020  m in streams:.  
-0000ac70: 2020 2020 2020 2020 2020 2020 2020 735f                s_
-0000ac80: 6174 7472 6962 7320 3d20 5b5d 0a20 2020  attribs = [].   
-0000ac90: 2020 2020 2020 2020 2020 2020 2073 5f73               s_s
-0000aca0: 6368 656d 6120 3d20 7374 7265 616d 5b27  chema = stream['
-0000acb0: 7363 6865 6d61 275d 0a0a 2020 2020 2020  schema']..      
-0000acc0: 2020 2020 2020 2020 2020 6461 7461 203d            data =
-0000acd0: 2066 6574 6368 5f73 616d 706c 6573 2863   fetch_samples(c
-0000ace0: 6f6e 6669 672c 2073 7472 6561 6d29 5b3a  onfig, stream)[:
-0000acf0: 3130 5d0a 2020 2020 2020 2020 2020 2020  10].            
-0000ad00: 2020 2020 2320 4170 7065 6e64 696e 6720      # Appending 
-0000ad10: 5f20 746f 206b 6579 7320 666f 7220 7072  _ to keys for pr
-0000ad20: 6573 6572 7669 6e67 2076 616c 7565 7320  eserving values 
-0000ad30: 6f66 2072 6573 6572 7665 6420 6b65 7973  of reserved keys
-0000ad40: 2069 6e20 736f 7572 6365 2064 6174 610a   in source data.
-0000ad50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ad60: 7265 7365 7276 6564 5f6b 6579 7320 3d20  reserved_keys = 
-0000ad70: 5b27 5f6b 6579 272c 2027 5f69 6427 2c20  ['_key', '_id', 
-0000ad80: 275f 7265 7627 5d0a 2020 2020 2020 2020  '_rev'].        
-0000ad90: 2020 2020 2020 2020 6966 2073 7472 6561          if strea
-0000ada0: 6d5b 276d 6574 6164 6174 6127 5d5b 305d  m['metadata'][0]
-0000adb0: 5b27 6d65 7461 6461 7461 275d 2e67 6574  ['metadata'].get
-0000adc0: 2827 7461 626c 652d 6b65 792d 7072 6f70  ('table-key-prop
-0000add0: 6572 7469 6573 2729 3a0a 2020 2020 2020  erties'):.      
-0000ade0: 2020 2020 2020 2020 2020 2020 2020 6b65                ke
-0000adf0: 795f 7072 6f70 6572 7469 6573 203d 2073  y_properties = s
-0000ae00: 7472 6561 6d5b 276d 6574 6164 6174 6127  tream['metadata'
-0000ae10: 5d5b 305d 5b27 6d65 7461 6461 7461 275d  ][0]['metadata']
-0000ae20: 2e67 6574 2827 7461 626c 652d 6b65 792d  .get('table-key-
-0000ae30: 7072 6f70 6572 7469 6573 2729 0a20 2020  properties').   
-0000ae40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ae50: 2069 6620 6b65 795f 7072 6f70 6572 7469   if key_properti
-0000ae60: 6573 5b30 5d20 3d3d 2027 5f6b 6579 273a  es[0] == '_key':
-0000ae70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000ae80: 2020 2020 2020 2020 2072 6573 6572 7665           reserve
-0000ae90: 645f 6b65 7973 2e72 656d 6f76 6528 275f  d_keys.remove('_
-0000aea0: 6b65 7927 290a 2020 2020 2020 2020 2020  key').          
-0000aeb0: 2020 2020 2020 735f 7363 6865 6d61 5b27        s_schema['
-0000aec0: 7072 6f70 6572 7469 6573 275d 203d 206d  properties'] = m
-0000aed0: 6f64 6966 795f 7265 7365 7276 6564 5f6b  odify_reserved_k
-0000aee0: 6579 7328 735f 7363 6865 6d61 5b27 7072  eys(s_schema['pr
-0000aef0: 6f70 6572 7469 6573 275d 2c20 7265 7365  operties'], rese
-0000af00: 7276 6564 5f6b 6579 7329 0a0a 2020 2020  rved_keys)..    
-0000af10: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-0000af20: 6b2c 2076 2069 6e20 735f 7363 6865 6d61  k, v in s_schema
-0000af30: 5b27 7072 6f70 6572 7469 6573 275d 2e69  ['properties'].i
-0000af40: 7465 6d73 2829 3a0a 2020 2020 2020 2020  tems():.        
-0000af50: 2020 2020 2020 2020 2020 2020 7420 3d20              t = 
-0000af60: 765b 2774 7970 6527 5d5b 2d31 5d0a 2020  v['type'][-1].  
-0000af70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000af80: 2020 735f 6174 7472 6962 732e 6170 7065    s_attribs.appe
-0000af90: 6e64 2853 6368 656d 6141 7474 7269 6275  nd(SchemaAttribu
-0000afa0: 7465 286b 2c20 7365 6c66 2e67 6574 5f61  te(k, self.get_a
-0000afb0: 7474 7269 6275 7465 5f74 7970 6528 7429  ttribute_type(t)
-0000afc0: 2929 0a20 2020 2020 2020 2020 2020 2020  )).             
-0000afd0: 2020 2073 6368 656d 6120 3d20 5363 6865     schema = Sche
-0000afe0: 6d61 2873 7472 6561 6d5b 2773 7472 6561  ma(stream['strea
-0000aff0: 6d27 5d2c 2073 5f61 7474 7269 6273 290a  m'], s_attribs).
-0000b000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b010: 7265 7375 6c74 732e 6170 7065 6e64 2853  results.append(S
-0000b020: 616d 706c 6528 0a20 2020 2020 2020 2020  ample(.         
-0000b030: 2020 2020 2020 2020 2020 2073 6368 656d             schem
-0000b040: 613d 7363 6865 6d61 2c0a 2020 2020 2020  a=schema,.      
-0000b050: 2020 2020 2020 2020 2020 2020 2020 6461                da
-0000b060: 7461 3d64 6174 6129 0a20 2020 2020 2020  ta=data).       
-0000b070: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-0000b080: 2020 2065 7863 6570 7420 4578 6365 7074     except Except
-0000b090: 696f 6e20 6173 2065 3a0a 2020 2020 2020  ion as e:.      
-0000b0a0: 2020 2020 2020 4c4f 4747 4552 2e77 6172        LOGGER.war
-0000b0b0: 6e28 2245 7863 6570 7469 6f6e 2072 6169  n("Exception rai
-0000b0c0: 7365 643a 2025 7322 2c20 6529 0a20 2020  sed: %s", e).   
-0000b0d0: 2020 2020 2020 2020 2073 6f75 7263 652e           source.
-0000b0e0: 6465 6c65 7465 5f63 7265 6465 6e74 6961  delete_credentia
-0000b0f0: 6c73 5f66 696c 6528 636f 6e66 6967 290a  ls_file(config).
-0000b100: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-0000b110: 6520 650a 2020 2020 2020 2020 736f 7572  e e.        sour
-0000b120: 6365 2e64 656c 6574 655f 6372 6564 656e  ce.delete_creden
-0000b130: 7469 616c 735f 6669 6c65 2863 6f6e 6669  tials_file(confi
-0000b140: 6729 0a20 2020 2020 2020 2072 6574 7572  g).        retur
-0000b150: 6e20 7265 7375 6c74 730a 0a20 2020 2064  n results..    d
-0000b160: 6566 2073 6368 656d 6173 2873 656c 662c  ef schemas(self,
-0000b170: 2069 6e74 6567 7261 7469 6f6e 3a20 6469   integration: di
-0000b180: 6374 2920 2d3e 206c 6973 745b 5363 6865  ct) -> list[Sche
-0000b190: 6d61 5d3a 0a20 2020 2020 2020 2022 2222  ma]:.        """
-0000b1a0: 4765 7420 7375 7070 6f72 7465 6420 7363  Get supported sc
-0000b1b0: 6865 6d61 7320 7573 696e 6720 7468 6520  hemas using the 
-0000b1c0: 6769 7665 6e20 636f 6e66 6967 7572 6174  given configurat
-0000b1d0: 696f 6e73 2e22 2222 0a20 2020 2020 2020  ions.""".       
-0000b1e0: 2063 6f6e 6669 6720 3d20 7365 6c66 2e67   config = self.g
-0000b1f0: 6574 5f63 6f6e 6669 6728 696e 7465 6772  et_config(integr
-0000b200: 6174 696f 6e29 0a20 2020 2020 2020 2074  ation).        t
-0000b210: 7279 3a0a 2020 2020 2020 2020 2020 2020  ry:.            
-0000b220: 636f 6e66 6967 203d 2073 6f75 7263 652e  config = source.
-0000b230: 6372 6561 7465 5f63 7265 6465 6e74 6961  create_credentia
-0000b240: 6c73 5f66 696c 6528 636f 6e66 6967 290a  ls_file(config).
-0000b250: 2020 2020 2020 2020 2020 2020 7374 7265              stre
-0000b260: 616d 7320 3d20 6469 7363 6f76 6572 2863  ams = discover(c
-0000b270: 6f6e 6669 6729 5b27 7374 7265 616d 7327  onfig)['streams'
-0000b280: 5d0a 2020 2020 2020 2020 2020 2020 7265  ].            re
-0000b290: 7375 6c74 7320 3d20 5b5d 0a20 2020 2020  sults = [].     
-0000b2a0: 2020 2020 2020 2066 6f72 2073 7472 6561         for strea
-0000b2b0: 6d20 696e 2073 7472 6561 6d73 3a0a 2020  m in streams:.  
-0000b2c0: 2020 2020 2020 2020 2020 2020 2020 735f                s_
-0000b2d0: 6174 7472 6962 7320 3d20 5b5d 0a20 2020  attribs = [].   
-0000b2e0: 2020 2020 2020 2020 2020 2020 2073 5f73               s_s
-0000b2f0: 6368 656d 6120 3d20 7374 7265 616d 5b27  chema = stream['
-0000b300: 7363 6865 6d61 275d 0a0a 2020 2020 2020  schema']..      
-0000b310: 2020 2020 2020 2020 2020 2320 4170 7065            # Appe
-0000b320: 6e64 696e 6720 5f20 746f 206b 6579 7320  nding _ to keys 
-0000b330: 666f 7220 7072 6573 6572 7669 6e67 2076  for preserving v
-0000b340: 616c 7565 7320 6f66 2072 6573 6572 7665  alues of reserve
-0000b350: 6420 6b65 7973 2069 6e20 736f 7572 6365  d keys in source
-0000b360: 2064 6174 610a 2020 2020 2020 2020 2020   data.          
-0000b370: 2020 2020 2020 7265 7365 7276 6564 5f6b        reserved_k
-0000b380: 6579 7320 3d20 5b27 5f6b 6579 272c 2027  eys = ['_key', '
-0000b390: 5f69 6427 2c20 275f 7265 7627 5d0a 2020  _id', '_rev'].  
-0000b3a0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0000b3b0: 2073 7472 6561 6d5b 276d 6574 6164 6174   stream['metadat
-0000b3c0: 6127 5d5b 305d 5b27 6d65 7461 6461 7461  a'][0]['metadata
-0000b3d0: 275d 2e67 6574 2827 7461 626c 652d 6b65  '].get('table-ke
-0000b3e0: 792d 7072 6f70 6572 7469 6573 2729 3a0a  y-properties'):.
-0000b3f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b400: 2020 2020 6b65 795f 7072 6f70 6572 7469      key_properti
-0000b410: 6573 203d 2073 7472 6561 6d5b 276d 6574  es = stream['met
-0000b420: 6164 6174 6127 5d5b 305d 5b27 6d65 7461  adata'][0]['meta
-0000b430: 6461 7461 275d 2e67 6574 2827 7461 626c  data'].get('tabl
-0000b440: 652d 6b65 792d 7072 6f70 6572 7469 6573  e-key-properties
-0000b450: 2729 0a20 2020 2020 2020 2020 2020 2020  ').             
-0000b460: 2020 2020 2020 2069 6620 6b65 795f 7072         if key_pr
-0000b470: 6f70 6572 7469 6573 5b30 5d20 3d3d 2027  operties[0] == '
-0000b480: 5f6b 6579 273a 0a20 2020 2020 2020 2020  _key':.         
-0000b490: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0000b4a0: 6573 6572 7665 645f 6b65 7973 2e72 656d  eserved_keys.rem
-0000b4b0: 6f76 6528 275f 6b65 7927 290a 2020 2020  ove('_key').    
-0000b4c0: 2020 2020 2020 2020 2020 2020 735f 7363              s_sc
-0000b4d0: 6865 6d61 5b27 7072 6f70 6572 7469 6573  hema['properties
-0000b4e0: 275d 203d 206d 6f64 6966 795f 7265 7365  '] = modify_rese
-0000b4f0: 7276 6564 5f6b 6579 7328 735f 7363 6865  rved_keys(s_sche
-0000b500: 6d61 5b27 7072 6f70 6572 7469 6573 275d  ma['properties']
-0000b510: 2c20 7265 7365 7276 6564 5f6b 6579 7329  , reserved_keys)
-0000b520: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000b530: 2020 666f 7220 6b2c 2076 2069 6e20 735f    for k, v in s_
-0000b540: 7363 6865 6d61 5b27 7072 6f70 6572 7469  schema['properti
-0000b550: 6573 275d 2e69 7465 6d73 2829 3a0a 2020  es'].items():.  
-0000b560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b570: 2020 7420 3d20 765b 2774 7970 6527 5d5b    t = v['type'][
-0000b580: 2d31 5d0a 2020 2020 2020 2020 2020 2020  -1].            
-0000b590: 2020 2020 2020 2020 735f 6174 7472 6962          s_attrib
-0000b5a0: 732e 6170 7065 6e64 2853 6368 656d 6141  s.append(SchemaA
-0000b5b0: 7474 7269 6275 7465 286b 2c20 7365 6c66  ttribute(k, self
-0000b5c0: 2e67 6574 5f61 7474 7269 6275 7465 5f74  .get_attribute_t
-0000b5d0: 7970 6528 7429 2929 0a20 2020 2020 2020  ype(t))).       
-0000b5e0: 2020 2020 2020 2020 2072 6573 756c 7473           results
-0000b5f0: 2e61 7070 656e 6428 5363 6865 6d61 2873  .append(Schema(s
-0000b600: 7472 6561 6d5b 2773 7472 6561 6d27 5d2c  tream['stream'],
-0000b610: 2073 5f61 7474 7269 6273 2929 0a20 2020   s_attribs)).   
-0000b620: 2020 2020 2065 7863 6570 7420 4578 6365       except Exce
-0000b630: 7074 696f 6e20 6173 2065 3a0a 2020 2020  ption as e:.    
-0000b640: 2020 2020 2020 2020 4c4f 4747 4552 2e77          LOGGER.w
-0000b650: 6172 6e28 2245 7863 6570 7469 6f6e 2072  arn("Exception r
-0000b660: 6169 7365 643a 2025 7322 2c20 6529 0a20  aised: %s", e). 
-0000b670: 2020 2020 2020 2020 2020 2073 6f75 7263             sourc
-0000b680: 652e 6465 6c65 7465 5f63 7265 6465 6e74  e.delete_credent
-0000b690: 6961 6c73 5f66 696c 6528 636f 6e66 6967  ials_file(config
-0000b6a0: 290a 2020 2020 2020 2020 2020 2020 7261  ).            ra
-0000b6b0: 6973 6520 650a 2020 2020 2020 2020 736f  ise e.        so
-0000b6c0: 7572 6365 2e64 656c 6574 655f 6372 6564  urce.delete_cred
-0000b6d0: 656e 7469 616c 735f 6669 6c65 2863 6f6e  entials_file(con
-0000b6e0: 6669 6729 0a20 2020 2020 2020 2072 6574  fig).        ret
-0000b6f0: 7572 6e20 7265 7375 6c74 730a 0a20 2020  urn results..   
-0000b700: 2064 6566 2072 6573 6572 7665 645f 6b65   def reserved_ke
-0000b710: 7973 2873 656c 6629 202d 3e20 6c69 7374  ys(self) -> list
-0000b720: 5b73 7472 5d3a 0a20 2020 2020 2020 2022  [str]:.        "
-0000b730: 2222 4c69 7374 206f 6620 7265 7365 7276  ""List of reserv
-0000b740: 6564 206b 6579 7320 666f 7220 7468 6520  ed keys for the 
-0000b750: 636f 6e6e 6563 746f 722e 2222 220a 2020  connector.""".  
-0000b760: 2020 2020 2020 7265 7475 726e 205b 5d0a        return [].
-0000b770: 0a20 2020 2040 7374 6174 6963 6d65 7468  .    @staticmeth
-0000b780: 6f64 0a20 2020 2064 6566 2067 6574 5f61  od.    def get_a
-0000b790: 7474 7269 6275 7465 5f74 7970 6528 736f  ttribute_type(so
-0000b7a0: 7572 6365 5f74 7970 653a 2073 7472 2920  urce_type: str) 
-0000b7b0: 2d3e 2053 6368 656d 6141 7474 7269 6275  -> SchemaAttribu
-0000b7c0: 7465 5479 7065 3a0a 2020 2020 2020 2020  teType:.        
-0000b7d0: 6966 2073 6f75 7263 655f 7479 7065 203d  if source_type =
-0000b7e0: 3d20 2773 7472 696e 6727 3a0a 2020 2020  = 'string':.    
-0000b7f0: 2020 2020 2020 2020 7265 7475 726e 2053          return S
-0000b800: 6368 656d 6141 7474 7269 6275 7465 5479  chemaAttributeTy
-0000b810: 7065 2e53 5452 494e 470a 2020 2020 2020  pe.STRING.      
-0000b820: 2020 656c 6966 2073 6f75 7263 655f 7479    elif source_ty
-0000b830: 7065 203d 3d20 2769 6e74 6567 6572 273a  pe == 'integer':
-0000b840: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-0000b850: 7572 6e20 5363 6865 6d61 4174 7472 6962  urn SchemaAttrib
-0000b860: 7574 6554 7970 652e 4c4f 4e47 0a20 2020  uteType.LONG.   
-0000b870: 2020 2020 2065 6c69 6620 736f 7572 6365       elif source
-0000b880: 5f74 7970 6520 3d3d 2027 626f 6f6c 6561  _type == 'boolea
-0000b890: 6e27 3a0a 2020 2020 2020 2020 2020 2020  n':.            
-0000b8a0: 7265 7475 726e 2053 6368 656d 6141 7474  return SchemaAtt
-0000b8b0: 7269 6275 7465 5479 7065 2e42 4f4f 4c45  ributeType.BOOLE
-0000b8c0: 414e 0a20 2020 2020 2020 2065 6c69 6620  AN.        elif 
-0000b8d0: 736f 7572 6365 5f74 7970 6520 3d3d 2027  source_type == '
-0000b8e0: 6e75 6d62 6572 273a 0a20 2020 2020 2020  number':.       
-0000b8f0: 2020 2020 2072 6574 7572 6e20 5363 6865       return Sche
-0000b900: 6d61 4174 7472 6962 7574 6554 7970 652e  maAttributeType.
-0000b910: 444f 5542 4c45 0a20 2020 2020 2020 2065  DOUBLE.        e
-0000b920: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0000b930: 2072 6574 7572 6e20 5363 6865 6d61 4174   return SchemaAt
-0000b940: 7472 6962 7574 6554 7970 652e 4f42 4a45  tributeType.OBJE
-0000b950: 4354 0a0a 2020 2020 6465 6620 636f 6e66  CT..    def conf
-0000b960: 6967 2873 656c 6629 202d 3e20 6c69 7374  ig(self) -> list
-0000b970: 5b43 6f6e 6669 6750 726f 7065 7274 795d  [ConfigProperty]
-0000b980: 3a0a 2020 2020 2020 2020 2222 2247 6574  :.        """Get
-0000b990: 2063 6f6e 6669 6775 7261 7469 6f6e 2070   configuration p
-0000b9a0: 6172 616d 6574 6572 7320 666f 7220 7468  arameters for th
-0000b9b0: 6520 636f 6e6e 6563 746f 722e 2222 220a  e connector.""".
-0000b9c0: 2020 2020 2020 2020 7265 7475 726e 205b          return [
-0000b9d0: 0a20 2020 2020 2020 2020 2020 2043 6f6e  .            Con
-0000b9e0: 6669 6750 726f 7065 7274 7928 2770 726f  figProperty('pro
-0000b9f0: 6a65 6374 272c 2027 5072 6f6a 6563 7420  ject', 'Project 
-0000ba00: 4944 272c 2043 6f6e 6669 6741 7474 7269  ID', ConfigAttri
-0000ba10: 6275 7465 5479 7065 2e53 5452 494e 472c  buteType.STRING,
-0000ba20: 2054 7275 652c 2046 616c 7365 2c0a 2020   True, False,.  
-0000ba30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ba40: 2020 2020 2020 2020 2064 6573 6372 6970           descrip
-0000ba50: 7469 6f6e 3d27 596f 7572 2042 6967 5175  tion='Your BigQu
-0000ba60: 6572 7920 7072 6f6a 6563 7420 4944 2e27  ery project ID.'
-0000ba70: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000ba80: 2020 2020 2020 2020 2020 2020 2070 6c61               pla
-0000ba90: 6365 686f 6c64 6572 5f76 616c 7565 3d27  ceholder_value='
-0000baa0: 6d79 5f70 726f 6a65 6374 5f69 6427 292c  my_project_id'),
-0000bab0: 0a20 2020 2020 2020 2020 2020 2043 6f6e  .            Con
-0000bac0: 6669 6750 726f 7065 7274 7928 2774 6162  figProperty('tab
-0000bad0: 6c65 272c 2027 5461 626c 6527 2c20 436f  le', 'Table', Co
-0000bae0: 6e66 6967 4174 7472 6962 7574 6554 7970  nfigAttributeTyp
-0000baf0: 652e 5354 5249 4e47 2c20 5472 7565 2c20  e.STRING, True, 
-0000bb00: 4661 6c73 652c 0a20 2020 2020 2020 2020  False,.         
-0000bb10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bb20: 2020 6465 7363 7269 7074 696f 6e3d 2746    description='F
-0000bb30: 756c 6c79 2071 7561 6c69 6669 6564 2074  ully qualified t
-0000bb40: 6162 6c65 206e 616d 6520 696e 2042 6967  able name in Big
-0000bb50: 5175 6572 792c 2077 6974 6820 666f 726d  Query, with form
-0000bb60: 6174 2027 0a20 2020 2020 2020 2020 2020  at '.           
-0000bb70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bb80: 2020 2020 2020 2020 2020 2020 273c 7072              '<pr
-0000bb90: 6f6a 6563 743e 2e3c 6461 7461 7365 743e  oject>.<dataset>
-0000bba0: 2e3c 7461 626c 653e 272c 0a20 2020 2020  .<table>',.     
-0000bbb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bbc0: 2020 2020 2020 706c 6163 6568 6f6c 6465        placeholde
-0000bbd0: 725f 7661 6c75 653d 276d 795f 7072 6f6a  r_value='my_proj
-0000bbe0: 6563 742e 6d79 5f64 6174 6173 6574 2e6d  ect.my_dataset.m
-0000bbf0: 795f 7461 626c 6527 292c 0a20 2020 2020  y_table'),.     
-0000bc00: 2020 2020 2020 2043 6f6e 6669 6750 726f         ConfigPro
-0000bc10: 7065 7274 7928 2763 7265 6465 6e74 6961  perty('credentia
-0000bc20: 6c73 5f66 696c 6527 2c20 2743 7265 6465  ls_file', 'Crede
-0000bc30: 6e74 6961 6c73 204a 534f 4e20 6669 6c65  ntials JSON file
-0000bc40: 272c 2043 6f6e 6669 6741 7474 7269 6275  ', ConfigAttribu
-0000bc50: 7465 5479 7065 2e53 5452 494e 472c 2054  teType.STRING, T
-0000bc60: 7275 652c 2046 616c 7365 2c0a 2020 2020  rue, False,.    
-0000bc70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bc80: 2020 2020 2020 2064 6573 6372 6970 7469         descripti
-0000bc90: 6f6e 3d27 436f 6e74 656e 7420 6f66 2074  on='Content of t
-0000bca0: 6865 2063 7265 6465 6e74 6961 6c73 2e6a  he credentials.j
-0000bcb0: 736f 6e20 6669 6c65 2066 6f72 2079 6f75  son file for you
-0000bcc0: 7220 7365 7276 6963 6520 6163 636f 756e  r service accoun
-0000bcd0: 742e 270a 2020 2020 2020 2020 2020 2020  t.'.            
-0000bce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bcf0: 2020 2020 2020 2020 2020 2027 5365 6520             'See 
-0000bd00: 7468 6520 2241 6374 6976 6174 6520 7468  the "Activate th
-0000bd10: 6520 476f 6f67 6c65 2042 6967 5175 6572  e Google BigQuer
-0000bd20: 7920 4150 4922 2073 6563 7469 6f6e 206f  y API" section o
-0000bd30: 6620 7468 6520 7265 706f 7369 746f 7279  f the repository
-0000bd40: 5c27 7327 0a20 2020 2020 2020 2020 2020  \'s'.           
-0000bd50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bd60: 2020 2020 2020 2020 2020 2020 2752 4541              'REA
-0000bd70: 444d 4520 616e 6420 6874 7470 733a 2f2f  DME and https://
-0000bd80: 636c 6f75 642e 676f 6f67 6c65 2e63 6f6d  cloud.google.com
-0000bd90: 2f64 6f63 732f 6175 7468 656e 7469 6361  /docs/authentica
-0000bda0: 7469 6f6e 2f70 726f 6475 6374 696f 6e2e  tion/production.
-0000bdb0: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
-0000bdc0: 2020 2020 2020 2020 2020 2020 2020 706c                pl
-0000bdd0: 6163 6568 6f6c 6465 725f 7661 6c75 653d  aceholder_value=
-0000bde0: 2763 7265 6465 6e74 6961 6c73 2e6a 736f  'credentials.jso
-0000bdf0: 6e20 636f 6e74 656e 7473 2729 2c0a 2020  n contents'),.  
-0000be00: 2020 2020 2020 2020 2020 436f 6e66 6967            Config
-0000be10: 5072 6f70 6572 7479 2827 636f 6c75 6d6e  Property('column
-0000be20: 7327 2c20 2743 6f6c 756d 6e73 272c 2043  s', 'Columns', C
-0000be30: 6f6e 6669 6741 7474 7269 6275 7465 5479  onfigAttributeTy
-0000be40: 7065 2e53 5452 494e 472c 2046 616c 7365  pe.STRING, False
-0000be50: 2c20 4661 6c73 652c 0a20 2020 2020 2020  , False,.       
-0000be60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000be70: 2020 2020 6465 7363 7269 7074 696f 6e3d      description=
-0000be80: 2743 6f6d 6d61 2d73 6570 6172 6174 6564  'Comma-separated
-0000be90: 206c 6973 7420 6f66 2063 6f6c 756d 6e73   list of columns
-0000bea0: 2074 6f20 6265 2073 656c 6563 7465 642e   to be selected.
-0000beb0: 2055 7365 2022 2a22 2074 6f20 7365 6c65   Use "*" to sele
-0000bec0: 6374 2061 6c6c 2063 6f6c 756d 6e73 272c  ct all columns',
-0000bed0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000bee0: 2020 2020 2020 2020 2020 2020 6465 6661              defa
-0000bef0: 756c 745f 7661 6c75 653d 272a 2729 2c0a  ult_value='*'),.
-0000bf00: 2020 2020 2020 2020 2020 2020 436f 6e66              Conf
-0000bf10: 6967 5072 6f70 6572 7479 2827 7072 696d  igProperty('prim
-0000bf20: 6172 795f 6b65 7927 2c20 2755 6e69 7175  ary_key', 'Uniqu
-0000bf30: 6520 5072 696d 6172 7920 4b65 7920 2874  e Primary Key (t
-0000bf40: 6f20 6265 2075 7365 6420 6173 205f 6b65  o be used as _ke
-0000bf50: 7920 666f 7220 7468 6520 636f 6c6c 6563  y for the collec
-0000bf60: 7469 6f6e 2927 2c0a 2020 2020 2020 2020  tion)',.        
-0000bf70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bf80: 2020 2043 6f6e 6669 6741 7474 7269 6275     ConfigAttribu
-0000bf90: 7465 5479 7065 2e53 5452 494e 472c 2046  teType.STRING, F
-0000bfa0: 616c 7365 2c20 4661 6c73 652c 0a20 2020  alse, False,.   
-0000bfb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bfc0: 2020 2020 2020 2020 6465 7363 7269 7074          descript
-0000bfd0: 696f 6e3d 2741 2075 6e69 7175 6520 7072  ion='A unique pr
-0000bfe0: 696d 6172 7920 6b65 7920 6672 6f6d 2074  imary key from t
-0000bff0: 6865 2062 6967 7175 6572 7920 7461 626c  he bigquery tabl
-0000c000: 6520 7768 6963 6820 6e65 6564 7320 6265  e which needs be
-0000c010: 2075 7365 6420 6173 205f 6b65 7920 666f   used as _key fo
-0000c020: 7220 270a 2020 2020 2020 2020 2020 2020  r '.            
-0000c030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c040: 2020 2020 2020 2020 2020 2027 7468 6520             'the 
-0000c050: 636f 6c6c 6563 7469 6f6e 2e27 0a20 2020  collection.'.   
-0000c060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008ce0: 6865 6d61 4174 7472 6962 7574 652c 2056  hemaAttribute, V
+00008cf0: 616c 6964 6174 696f 6e45 7863 6570 7469  alidationExcepti
+00008d00: 6f6e 290a 696d 706f 7274 2073 696e 6765  on).import singe
+00008d10: 720a 6672 6f6d 2070 726f 6d65 7468 6575  r.from prometheu
+00008d20: 735f 636c 6965 6e74 2069 6d70 6f72 7420  s_client import 
+00008d30: 436f 6c6c 6563 746f 7252 6567 6973 7472  CollectorRegistr
+00008d40: 792c 2073 7461 7274 5f68 7474 705f 7365  y, start_http_se
+00008d50: 7276 6572 2c20 436f 756e 7465 720a 6672  rver, Counter.fr
+00008d60: 6f6d 2073 696e 6765 7220 696d 706f 7274  om singer import
+00008d70: 2075 7469 6c73 2061 7320 7369 6e67 6572   utils as singer
+00008d80: 5f75 7469 6c73 0a66 726f 6d20 7369 6e67  _utils.from sing
+00008d90: 6572 2069 6d70 6f72 7420 6d65 7461 6461  er import metada
+00008da0: 7461 0a66 726f 6d20 7369 6e67 6572 2e63  ta.from singer.c
+00008db0: 6174 616c 6f67 2069 6d70 6f72 7420 4361  atalog import Ca
+00008dc0: 7461 6c6f 670a 0a66 726f 6d20 6d61 6372  talog..from macr
+00008dd0: 6f6d 6574 615f 736f 7572 6365 5f62 6967  ometa_source_big
+00008de0: 7175 6572 792e 7361 6d70 6c65 5f64 6174  query.sample_dat
+00008df0: 6120 696d 706f 7274 2066 6574 6368 5f73  a import fetch_s
+00008e00: 616d 706c 6573 2c20 6d6f 6469 6679 5f72  amples, modify_r
+00008e10: 6573 6572 7665 645f 6b65 7973 0a66 726f  eserved_keys.fro
+00008e20: 6d20 6d61 6372 6f6d 6574 615f 736f 7572  m macrometa_sour
+00008e30: 6365 5f62 6967 7175 6572 7920 696d 706f  ce_bigquery impo
+00008e40: 7274 2073 796e 635f 6269 6771 7565 7279  rt sync_bigquery
+00008e50: 2061 7320 736f 7572 6365 0a0a 0a52 4551   as source...REQ
+00008e60: 5549 5245 445f 434f 4e46 4947 5f4b 4559  UIRED_CONFIG_KEY
+00008e70: 5320 3d20 5b22 7461 626c 6522 2c20 2263  S = ["table", "c
+00008e80: 7265 6465 6e74 6961 6c73 5f66 696c 6522  redentials_file"
+00008e90: 2c20 2270 726f 6a65 6374 225d 0a0a 4c4f  , "project"]..LO
+00008ea0: 4747 4552 203d 2073 696e 6765 722e 6765  GGER = singer.ge
+00008eb0: 745f 6c6f 6767 6572 2822 6d61 6372 6f6d  t_logger("macrom
+00008ec0: 6574 615f 736f 7572 6365 5f62 6967 7175  eta_source_bigqu
+00008ed0: 6572 7922 290a 0a72 6567 696f 6e5f 6c61  ery")..region_la
+00008ee0: 6265 6c20 3d20 6f73 2e67 6574 656e 7628  bel = os.getenv(
+00008ef0: 2247 444e 5f46 4544 4552 4154 494f 4e22  "GDN_FEDERATION"
+00008f00: 2c20 224e 4122 290a 7465 6e61 6e74 5f6c  , "NA").tenant_l
+00008f10: 6162 656c 203d 206f 732e 6765 7465 6e76  abel = os.getenv
+00008f20: 2822 4744 4e5f 5445 4e41 4e54 222c 2022  ("GDN_TENANT", "
+00008f30: 4e41 2229 0a66 6162 7269 635f 6c61 6265  NA").fabric_labe
+00008f40: 6c20 3d20 6f73 2e67 6574 656e 7628 2247  l = os.getenv("G
+00008f50: 444e 5f46 4142 5249 4322 2c20 224e 4122  DN_FABRIC", "NA"
+00008f60: 290a 776f 726b 666c 6f77 5f6c 6162 656c  ).workflow_label
+00008f70: 203d 206f 732e 6765 7465 6e76 2822 574f   = os.getenv("WO
+00008f80: 524b 464c 4f57 5f55 5549 4422 2c20 224e  RKFLOW_UUID", "N
+00008f90: 4122 290a 0a64 6566 2067 6574 5f61 6273  A")..def get_abs
+00008fa0: 5f70 6174 6828 7061 7468 293a 0a20 2020  _path(path):.   
+00008fb0: 2072 6574 7572 6e20 6f73 2e70 6174 682e   return os.path.
+00008fc0: 6a6f 696e 286f 732e 7061 7468 2e64 6972  join(os.path.dir
+00008fd0: 6e61 6d65 286f 732e 7061 7468 2e72 6561  name(os.path.rea
+00008fe0: 6c70 6174 6828 5f5f 6669 6c65 5f5f 2929  lpath(__file__))
+00008ff0: 2c20 7061 7468 290a 0a0a 2320 4c6f 6164  , path)...# Load
+00009000: 2073 6368 656d 6173 2066 726f 6d20 7363   schemas from sc
+00009010: 6865 6d61 7320 666f 6c64 6572 0a64 6566  hemas folder.def
+00009020: 206c 6f61 645f 7363 6865 6d61 7328 293a   load_schemas():
+00009030: 0a20 2020 2073 6368 656d 6173 203d 207b  .    schemas = {
+00009040: 7d0a 0a20 2020 2066 6f72 2066 696c 656e  }..    for filen
+00009050: 616d 6520 696e 206f 732e 6c69 7374 6469  ame in os.listdi
+00009060: 7228 6765 745f 6162 735f 7061 7468 2827  r(get_abs_path('
+00009070: 7363 6865 6d61 7327 2929 3a0a 2020 2020  schemas')):.    
+00009080: 2020 2020 7061 7468 203d 2067 6574 5f61      path = get_a
+00009090: 6273 5f70 6174 6828 2773 6368 656d 6173  bs_path('schemas
+000090a0: 2729 202b 2027 2f27 202b 2066 696c 656e  ') + '/' + filen
+000090b0: 616d 650a 2020 2020 2020 2020 6669 6c65  ame.        file
+000090c0: 5f72 6177 203d 2066 696c 656e 616d 652e  _raw = filename.
+000090d0: 7265 706c 6163 6528 272e 6a73 6f6e 272c  replace('.json',
+000090e0: 2027 2729 0a20 2020 2020 2020 2077 6974   '').        wit
+000090f0: 6820 6f70 656e 2870 6174 6829 2061 7320  h open(path) as 
+00009100: 6669 6c65 3a0a 2020 2020 2020 2020 2020  file:.          
+00009110: 2020 7363 6865 6d61 735b 6669 6c65 5f72    schemas[file_r
+00009120: 6177 5d20 3d20 6a73 6f6e 2e6c 6f61 6428  aw] = json.load(
+00009130: 6669 6c65 290a 0a20 2020 2072 6574 7572  file)..    retur
+00009140: 6e20 7363 6865 6d61 730a 0a0a 6465 6620  n schemas...def 
+00009150: 6469 7363 6f76 6572 2863 6f6e 6669 6729  discover(config)
+00009160: 3a0a 2020 2020 7472 793a 0a20 2020 2020  :.    try:.     
+00009170: 2020 2073 7472 6561 6d73 203d 205b 5d0a     streams = [].
+00009180: 0a20 2020 2020 2020 206c 696d 6974 203d  .        limit =
+00009190: 2063 6f6e 6669 672e 6765 7428 276c 696d   config.get('lim
+000091a0: 6974 2729 0a20 2020 2020 2020 2074 7279  it').        try
+000091b0: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+000091c0: 206c 696d 6974 2061 6e64 2069 6e74 286c   limit and int(l
+000091d0: 696d 6974 2920 3c3d 2030 3a0a 2020 2020  imit) <= 0:.    
+000091e0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+000091f0: 6520 5661 6c75 6545 7272 6f72 0a20 2020  e ValueError.   
+00009200: 2020 2020 2065 7863 6570 7420 4578 6365       except Exce
+00009210: 7074 696f 6e3a 0a20 2020 2020 2020 2020  ption:.         
+00009220: 2020 2072 6169 7365 2045 7863 6570 7469     raise Excepti
+00009230: 6f6e 2827 5468 6520 6c69 6d69 7420 7072  on('The limit pr
+00009240: 6f76 6964 6564 2069 7320 6e6f 7420 7661  ovided is not va
+00009250: 6c69 642e 204f 6e6c 7920 696e 7465 6765  lid. Only intege
+00009260: 7220 7661 6c75 6573 2067 7265 6174 6572  r values greater
+00009270: 2074 6861 6e20 3020 6172 6520 7375 7070   than 0 are supp
+00009280: 6f72 7465 6420 6173 206c 696d 6974 7327  orted as limits'
+00009290: 290a 0a20 2020 2020 2020 2023 2052 6573  )..        # Res
+000092a0: 7472 7563 7475 7269 6e67 2073 7472 6561  tructuring strea
+000092b0: 6d73 0a20 2020 2020 2020 2063 6f6e 6669  ms.        confi
+000092c0: 6773 203d 205b 0a20 2020 2020 2020 2020  gs = [.         
+000092d0: 2020 207b 0a20 2020 2020 2020 2020 2020     {.           
+000092e0: 2020 2020 2022 6e61 6d65 223a 2063 6f6e       "name": con
+000092f0: 6669 675b 2774 6162 6c65 275d 2c0a 2020  fig['table'],.  
+00009300: 2020 2020 2020 2020 2020 2020 2020 2274                "t
+00009310: 6162 6c65 223a 2063 6f6e 6669 675b 2774  able": config['t
+00009320: 6162 6c65 275d 0a20 2020 2020 2020 2020  able'].         
+00009330: 2020 207d 0a20 2020 2020 2020 205d 0a0a     }.        ]..
+00009340: 2020 2020 2020 2020 6966 2063 6f6e 6669          if confi
+00009350: 672e 6765 7428 2764 6174 6574 696d 655f  g.get('datetime_
+00009360: 6b65 7927 293a 0a20 2020 2020 2020 2020  key'):.         
+00009370: 2020 2063 6f6e 6669 6773 5b30 5d5b 2764     configs[0]['d
+00009380: 6174 6574 696d 655f 6b65 7927 5d20 3d20  atetime_key'] = 
+00009390: 636f 6e66 6967 5b27 6461 7465 7469 6d65  config['datetime
+000093a0: 5f6b 6579 275d 0a20 2020 2020 2020 2069  _key'].        i
+000093b0: 6620 636f 6e66 6967 2e67 6574 2827 6669  f config.get('fi
+000093c0: 6c74 6572 7327 293a 0a20 2020 2020 2020  lters'):.       
+000093d0: 2020 2020 2066 696c 7465 7273 203d 2063       filters = c
+000093e0: 6f6e 6669 675b 2766 696c 7465 7273 275d  onfig['filters']
+000093f0: 2e73 706c 6974 2827 2c27 290a 2020 2020  .split(',').    
+00009400: 2020 2020 2020 2020 666f 7220 6974 656d          for item
+00009410: 2069 6e20 6669 6c74 6572 733a 0a20 2020   in filters:.   
+00009420: 2020 2020 2020 2020 2020 2020 2069 7465               ite
+00009430: 6d2e 7374 7269 7028 290a 2020 2020 2020  m.strip().      
+00009440: 2020 2020 2020 636f 6e66 6967 735b 305d        configs[0]
+00009450: 5b27 6669 6c74 6572 7327 5d20 3d20 6669  ['filters'] = fi
+00009460: 6c74 6572 730a 2020 2020 2020 2020 636f  lters.        co
+00009470: 6e66 6967 5f63 6f6c 756d 6e73 203d 2063  nfig_columns = c
+00009480: 6f6e 6669 672e 6765 7428 2763 6f6c 756d  onfig.get('colum
+00009490: 6e73 272c 2027 2a27 290a 2020 2020 2020  ns', '*').      
+000094a0: 2020 6966 2063 6f6e 6669 675f 636f 6c75    if config_colu
+000094b0: 6d6e 733a 0a20 2020 2020 2020 2020 2020  mns:.           
+000094c0: 2063 6f6c 756d 6e73 203d 2063 6f6e 6669   columns = confi
+000094d0: 675f 636f 6c75 6d6e 732e 7370 6c69 7428  g_columns.split(
+000094e0: 272c 2729 0a20 2020 2020 2020 2020 2020  ',').           
+000094f0: 2066 6f72 2069 7465 6d20 696e 2063 6f6c   for item in col
+00009500: 756d 6e73 3a0a 2020 2020 2020 2020 2020  umns:.          
+00009510: 2020 2020 2020 6974 656d 2e73 7472 6970        item.strip
+00009520: 2829 0a20 2020 2020 2020 2020 2020 2063  ().            c
+00009530: 6f6e 6669 6773 5b30 5d5b 2763 6f6c 756d  onfigs[0]['colum
+00009540: 6e73 275d 203d 2063 6f6c 756d 6e73 0a0a  ns'] = columns..
+00009550: 2020 2020 2020 2020 6164 645f 7469 6d65          add_time
+00009560: 7374 616d 7020 3d20 636f 6e66 6967 2e67  stamp = config.g
+00009570: 6574 2827 6164 645f 6578 7472 6163 7465  et('add_extracte
+00009580: 645f 7469 6d65 7374 616d 7027 2c20 4661  d_timestamp', Fa
+00009590: 6c73 6529 0a20 2020 2020 2020 2066 6f72  lse).        for
+000095a0: 2073 7472 6561 6d20 696e 2063 6f6e 6669   stream in confi
+000095b0: 6773 3a0a 2020 2020 2020 2020 2020 2020  gs:.            
+000095c0: 7374 7265 616d 5f6d 6574 6164 6174 612c  stream_metadata,
+000095d0: 2073 7472 6561 6d5f 6b65 795f 7072 6f70   stream_key_prop
+000095e0: 6572 7469 6573 2c20 7363 6865 6d61 203d  erties, schema =
+000095f0: 2073 6f75 7263 652e 646f 5f64 6973 636f   source.do_disco
+00009600: 7665 7228 0a20 2020 2020 2020 2020 2020  ver(.           
+00009610: 2020 2020 2063 6f6e 6669 672c 0a20 2020       config,.   
+00009620: 2020 2020 2020 2020 2020 2020 2073 7472               str
+00009630: 6561 6d2c 0a20 2020 2020 2020 2020 2020  eam,.           
+00009640: 2020 2020 2061 6464 5f74 696d 6573 7461       add_timesta
+00009650: 6d70 3d61 6464 5f74 696d 6573 7461 6d70  mp=add_timestamp
+00009660: 290a 0a20 2020 2020 2020 2020 2020 2023  )..            #
+00009670: 2063 7265 6174 6520 616e 6420 6164 6420   create and add 
+00009680: 6361 7461 6c6f 6720 656e 7472 790a 2020  catalog entry.  
+00009690: 2020 2020 2020 2020 2020 6361 7461 6c6f            catalo
+000096a0: 675f 656e 7472 7920 3d20 7b0a 2020 2020  g_entry = {.    
+000096b0: 2020 2020 2020 2020 2020 2020 2773 7472              'str
+000096c0: 6561 6d27 3a20 7374 7265 616d 5b22 6e61  eam': stream["na
+000096d0: 6d65 225d 2c0a 2020 2020 2020 2020 2020  me"],.          
+000096e0: 2020 2020 2020 2774 6170 5f73 7472 6561        'tap_strea
+000096f0: 6d5f 6964 273a 2073 7472 6561 6d5b 226e  m_id': stream["n
+00009700: 616d 6522 5d2c 0a20 2020 2020 2020 2020  ame"],.         
+00009710: 2020 2020 2020 2027 7363 6865 6d61 273a         'schema':
+00009720: 2073 6368 656d 612c 0a20 2020 2020 2020   schema,.       
+00009730: 2020 2020 2020 2020 2027 6d65 7461 6461           'metada
+00009740: 7461 273a 2073 7472 6561 6d5f 6d65 7461  ta': stream_meta
+00009750: 6461 7461 2c0a 2020 2020 2020 2020 2020  data,.          
+00009760: 2020 2020 2020 276b 6579 5f70 726f 7065        'key_prope
+00009770: 7274 6965 7327 3a20 7374 7265 616d 5f6b  rties': stream_k
+00009780: 6579 5f70 726f 7065 7274 6965 730a 2020  ey_properties.  
+00009790: 2020 2020 2020 2020 2020 7d0a 2020 2020            }.    
+000097a0: 2020 2020 2020 2020 7374 7265 616d 732e          streams.
+000097b0: 6170 7065 6e64 2863 6174 616c 6f67 5f65  append(catalog_e
+000097c0: 6e74 7279 290a 0a20 2020 2020 2020 2072  ntry)..        r
+000097d0: 6574 7572 6e20 7b27 7374 7265 616d 7327  eturn {'streams'
+000097e0: 3a20 7374 7265 616d 737d 0a20 2020 2065  : streams}.    e
+000097f0: 7863 6570 7420 4578 6365 7074 696f 6e20  xcept Exception 
+00009800: 6173 2065 3a0a 2020 2020 2020 2020 7261  as e:.        ra
+00009810: 6973 6520 5661 6c69 6461 7469 6f6e 4578  ise ValidationEx
+00009820: 6365 7074 696f 6e28 6529 0a0a 0a64 6566  ception(e)...def
+00009830: 205f 6765 745f 7365 6c65 6374 6564 5f73   _get_selected_s
+00009840: 7472 6561 6d73 2863 6174 616c 6f67 293a  treams(catalog):
+00009850: 0a20 2020 2027 2727 0a20 2020 2047 6574  .    '''.    Get
+00009860: 7320 7365 6c65 6374 6564 2073 7472 6561  s selected strea
+00009870: 6d73 2e20 2043 6865 636b 7320 7363 6865  ms.  Checks sche
+00009880: 6d61 2773 2027 7365 6c65 6374 6564 2720  ma's 'selected' 
+00009890: 6669 7273 7420 286c 6567 6163 7929 0a20  first (legacy). 
+000098a0: 2020 2061 6e64 2074 6865 6e20 6368 6563     and then chec
+000098b0: 6b73 206d 6574 6164 6174 6120 2863 7572  ks metadata (cur
+000098c0: 7265 6e74 292c 206c 6f6f 6b69 6e67 2066  rent), looking f
+000098d0: 6f72 2061 6e20 656d 7074 7920 6272 6561  or an empty brea
+000098e0: 6463 7275 6d62 0a20 2020 2061 6e64 206d  dcrumb.    and m
+000098f0: 6461 7461 2077 6974 6820 6120 2773 656c  data with a 'sel
+00009900: 6563 7465 6427 2065 6e74 7279 0a20 2020  ected' entry.   
+00009910: 2027 2727 0a20 2020 2073 656c 6563 7465   '''.    selecte
+00009920: 645f 7374 7265 616d 7320 3d20 5b5d 0a20  d_streams = []. 
+00009930: 2020 2066 6f72 2073 7472 6561 6d20 696e     for stream in
+00009940: 2063 6174 616c 6f67 2e73 7472 6561 6d73   catalog.streams
+00009950: 3a0a 2020 2020 2020 2020 7374 7265 616d  :.        stream
+00009960: 5f6d 6574 6164 6174 6120 3d20 6d65 7461  _metadata = meta
+00009970: 6461 7461 2e74 6f5f 6d61 7028 7374 7265  data.to_map(stre
+00009980: 616d 2e6d 6574 6164 6174 6129 0a20 2020  am.metadata).   
+00009990: 2020 2020 2023 2073 7472 6561 6d20 6d65       # stream me
+000099a0: 7461 6461 7461 2077 696c 6c20 6861 7665  tadata will have
+000099b0: 2061 6e20 656d 7074 7920 6272 6561 6463   an empty breadc
+000099c0: 7275 6d62 0a20 2020 2020 2020 2069 6620  rumb.        if 
+000099d0: 6d65 7461 6461 7461 2e67 6574 2873 7472  metadata.get(str
+000099e0: 6561 6d5f 6d65 7461 6461 7461 2c20 2829  eam_metadata, ()
+000099f0: 2c20 2273 656c 6563 7465 6422 293a 0a20  , "selected"):. 
+00009a00: 2020 2020 2020 2020 2020 2073 656c 6563             selec
+00009a10: 7465 645f 7374 7265 616d 732e 6170 7065  ted_streams.appe
+00009a20: 6e64 2873 7472 6561 6d2e 7461 705f 7374  nd(stream.tap_st
+00009a30: 7265 616d 5f69 6429 0a0a 2020 2020 7265  ream_id)..    re
+00009a40: 7475 726e 2073 656c 6563 7465 645f 7374  turn selected_st
+00009a50: 7265 616d 730a 0a0a 6465 6620 7379 6e63  reams...def sync
+00009a60: 2863 6f6e 6669 672c 2073 7461 7465 2c20  (config, state, 
+00009a70: 6361 7461 6c6f 6729 3a0a 2020 2020 7365  catalog):.    se
+00009a80: 6c65 6374 6564 5f73 7472 6561 6d5f 6964  lected_stream_id
+00009a90: 7320 3d20 5f67 6574 5f73 656c 6563 7465  s = _get_selecte
+00009aa0: 645f 7374 7265 616d 7328 6361 7461 6c6f  d_streams(catalo
+00009ab0: 6729 0a20 2020 2023 204c 6f6f 7020 6f76  g).    # Loop ov
+00009ac0: 6572 2073 7472 6561 6d73 2069 6e20 6361  er streams in ca
+00009ad0: 7461 6c6f 670a 2020 2020 666f 7220 7374  talog.    for st
+00009ae0: 7265 616d 2069 6e20 6361 7461 6c6f 672e  ream in catalog.
+00009af0: 7374 7265 616d 733a 0a20 2020 2020 2020  streams:.       
+00009b00: 2073 7472 6561 6d5f 6964 203d 2073 7472   stream_id = str
+00009b10: 6561 6d2e 7461 705f 7374 7265 616d 5f69  eam.tap_stream_i
+00009b20: 640a 2020 2020 2020 2020 7374 7265 616d  d.        stream
+00009b30: 5f73 6368 656d 6120 3d20 7374 7265 616d  _schema = stream
+00009b40: 2e73 6368 656d 610a 2020 2020 2020 2020  .schema.        
+00009b50: 6966 2073 7472 6561 6d5f 6964 2069 6e20  if stream_id in 
+00009b60: 7365 6c65 6374 6564 5f73 7472 6561 6d5f  selected_stream_
+00009b70: 6964 733a 0a20 2020 2020 2020 2020 2020  ids:.           
+00009b80: 2073 6f75 7263 652e 646f 5f73 796e 6328   source.do_sync(
+00009b90: 636f 6e66 6967 2c20 7374 6174 652c 2073  config, state, s
+00009ba0: 7472 6561 6d29 0a20 2020 2020 2020 2020  tream).         
+00009bb0: 2020 204c 4f47 4745 522e 696e 666f 2827     LOGGER.info('
+00009bc0: 5379 6e63 696e 6720 7374 7265 616d 3a27  Syncing stream:'
+00009bd0: 202b 2073 7472 6561 6d5f 6964 290a 2020   + stream_id).  
+00009be0: 2020 7265 7475 726e 0a0a 0a64 6566 2070    return...def p
+00009bf0: 6172 7365 5f61 7267 7328 293a 0a20 2020  arse_args():.   
+00009c00: 2027 2727 2054 6869 7320 6973 2074 6f20   ''' This is to 
+00009c10: 7265 706c 6163 6520 7369 6e67 6572 2773  replace singer's
+00009c20: 2064 6566 6175 6c74 2073 696e 6765 725f   default singer_
+00009c30: 7574 696c 732e 7061 7273 655f 6172 6773  utils.parse_args
+00009c40: 2829 0a20 2020 2068 7474 7073 3a2f 2f67  ().    https://g
+00009c50: 6974 6875 622e 636f 6d2f 7369 6e67 6572  ithub.com/singer
+00009c60: 2d69 6f2f 7369 6e67 6572 2d70 7974 686f  -io/singer-pytho
+00009c70: 6e2f 626c 6f62 2f6d 6173 7465 722f 7369  n/blob/master/si
+00009c80: 6e67 6572 2f75 7469 6c73 2e70 790a 0a20  nger/utils.py.. 
+00009c90: 2020 2050 6172 7365 2073 7461 6e64 6172     Parse standar
+00009ca0: 6420 636f 6d6d 616e 642d 6c69 6e65 2061  d command-line a
+00009cb0: 7267 732e 0a20 2020 2050 6172 7365 7320  rgs..    Parses 
+00009cc0: 7468 6520 636f 6d6d 616e 642d 6c69 6e65  the command-line
+00009cd0: 2061 7267 756d 656e 7473 206d 656e 7469   arguments menti
+00009ce0: 6f6e 6564 2069 6e20 7468 6520 5350 4543  oned in the SPEC
+00009cf0: 2061 6e64 2074 6865 0a20 2020 2042 4553   and the.    BES
+00009d00: 545f 5052 4143 5449 4345 5320 646f 6375  T_PRACTICES docu
+00009d10: 6d65 6e74 733a 0a20 2020 202d 632c 2d2d  ments:.    -c,--
+00009d20: 636f 6e66 6967 2020 2020 2043 6f6e 6669  config     Confi
+00009d30: 6720 6669 6c65 0a20 2020 202d 732c 2d2d  g file.    -s,--
+00009d40: 7374 6174 6520 2020 2020 2053 7461 7465  state      State
+00009d50: 2066 696c 650a 2020 2020 2d64 2c2d 2d64   file.    -d,--d
+00009d60: 6973 636f 7665 7220 2020 5275 6e20 696e  iscover   Run in
+00009d70: 2064 6973 636f 7665 7220 6d6f 6465 0a20   discover mode. 
+00009d80: 2020 202d 2d63 6174 616c 6f67 2020 2020     --catalog    
+00009d90: 2020 2043 6174 616c 6f67 2066 696c 650a     Catalog file.
+00009da0: 2020 2020 5265 7475 726e 7320 7468 6520      Returns the 
+00009db0: 7061 7273 6564 2061 7267 7320 6f62 6a65  parsed args obje
+00009dc0: 6374 2066 726f 6d20 6172 6770 6172 7365  ct from argparse
+00009dd0: 2e20 466f 7220 6561 6368 2061 7267 756d  . For each argum
+00009de0: 656e 7420 7468 6174 0a20 2020 2070 6f69  ent that.    poi
+00009df0: 6e74 2074 6f20 4a53 4f4e 2066 696c 6573  nt to JSON files
+00009e00: 2028 636f 6e66 6967 2c20 7374 6174 652c   (config, state,
+00009e10: 2070 726f 7065 7274 6965 7329 2c20 7765   properties), we
+00009e20: 2077 696c 6c20 6175 746f 6d61 7469 6361   will automatica
+00009e30: 6c6c 790a 2020 2020 6c6f 6164 2061 6e64  lly.    load and
+00009e40: 2070 6172 7365 2074 6865 204a 534f 4e20   parse the JSON 
+00009e50: 6669 6c65 2e0a 2020 2020 2727 270a 2020  file..    '''.  
+00009e60: 2020 7061 7273 6572 203d 2061 7267 7061    parser = argpa
+00009e70: 7273 652e 4172 6775 6d65 6e74 5061 7273  rse.ArgumentPars
+00009e80: 6572 2829 0a0a 2020 2020 7061 7273 6572  er()..    parser
+00009e90: 2e61 6464 5f61 7267 756d 656e 7428 0a20  .add_argument(. 
+00009ea0: 2020 2020 2020 2027 2d63 272c 2027 2d2d         '-c', '--
+00009eb0: 636f 6e66 6967 272c 0a20 2020 2020 2020  config',.       
+00009ec0: 2068 656c 703d 2743 6f6e 6669 6720 6669   help='Config fi
+00009ed0: 6c65 272c 0a20 2020 2020 2020 2072 6571  le',.        req
+00009ee0: 7569 7265 643d 5472 7565 290a 0a20 2020  uired=True)..   
+00009ef0: 2070 6172 7365 722e 6164 645f 6172 6775   parser.add_argu
+00009f00: 6d65 6e74 280a 2020 2020 2020 2020 272d  ment(.        '-
+00009f10: 7327 2c20 272d 2d73 7461 7465 272c 0a20  s', '--state',. 
+00009f20: 2020 2020 2020 2068 656c 703d 2753 7461         help='Sta
+00009f30: 7465 2066 696c 6527 290a 0a20 2020 2070  te file')..    p
+00009f40: 6172 7365 722e 6164 645f 6172 6775 6d65  arser.add_argume
+00009f50: 6e74 280a 2020 2020 2020 2020 272d 7027  nt(.        '-p'
+00009f60: 2c20 272d 2d70 726f 7065 7274 6965 7327  , '--properties'
+00009f70: 2c0a 2020 2020 2020 2020 6865 6c70 3d27  ,.        help='
+00009f80: 5072 6f70 6572 7479 2073 656c 6563 7469  Property selecti
+00009f90: 6f6e 733a 2044 4550 5245 4341 5445 442c  ons: DEPRECATED,
+00009fa0: 2050 6c65 6173 6520 7573 6520 2d2d 6361   Please use --ca
+00009fb0: 7461 6c6f 6720 696e 7374 6561 6427 290a  talog instead').
+00009fc0: 0a20 2020 2070 6172 7365 722e 6164 645f  .    parser.add_
+00009fd0: 6172 6775 6d65 6e74 280a 2020 2020 2020  argument(.      
+00009fe0: 2020 272d 2d63 6174 616c 6f67 272c 0a20    '--catalog',. 
+00009ff0: 2020 2020 2020 2068 656c 703d 2743 6174         help='Cat
+0000a000: 616c 6f67 2066 696c 6527 290a 0a20 2020  alog file')..   
+0000a010: 2070 6172 7365 722e 6164 645f 6172 6775   parser.add_argu
+0000a020: 6d65 6e74 280a 2020 2020 2020 2020 272d  ment(.        '-
+0000a030: 6427 2c20 272d 2d64 6973 636f 7665 7227  d', '--discover'
+0000a040: 2c0a 2020 2020 2020 2020 6163 7469 6f6e  ,.        action
+0000a050: 3d27 7374 6f72 655f 7472 7565 272c 0a20  ='store_true',. 
+0000a060: 2020 2020 2020 2068 656c 703d 2744 6f20         help='Do 
+0000a070: 7363 6865 6d61 2064 6973 636f 7665 7279  schema discovery
+0000a080: 2729 0a0a 2020 2020 2320 4361 7074 7572  ')..    # Captur
+0000a090: 6520 6164 6469 7469 6f6e 616c 2061 7267  e additional arg
+0000a0a0: 730a 2020 2020 7061 7273 6572 2e61 6464  s.    parser.add
+0000a0b0: 5f61 7267 756d 656e 7428 0a20 2020 2020  _argument(.     
+0000a0c0: 2020 2022 2d2d 7374 6172 745f 6461 7465     "--start_date
+0000a0d0: 7469 6d65 222c 2074 7970 653d 7374 722c  time", type=str,
+0000a0e0: 0a20 2020 2020 2020 2068 656c 703d 2249  .        help="I
+0000a0f0: 6e63 6c75 7369 7665 2073 7461 7274 2064  nclusive start d
+0000a100: 6174 6520 7469 6d65 2069 6e20 4953 4f38  ate time in ISO8
+0000a110: 3630 312d 4461 7465 2d53 7472 696e 6720  601-Date-String 
+0000a120: 666f 726d 6174 3a20 3230 3139 2d30 342d  format: 2019-04-
+0000a130: 3131 5430 303a 3030 3a30 305a 2229 0a20  11T00:00:00Z"). 
+0000a140: 2020 2070 6172 7365 722e 6164 645f 6172     parser.add_ar
+0000a150: 6775 6d65 6e74 280a 2020 2020 2020 2020  gument(.        
+0000a160: 222d 2d65 6e64 5f64 6174 6574 696d 6522  "--end_datetime"
+0000a170: 2c20 7479 7065 3d73 7472 2c0a 2020 2020  , type=str,.    
+0000a180: 2020 2020 6865 6c70 3d22 4578 636c 7573      help="Exclus
+0000a190: 6976 6520 656e 6420 6461 7465 2074 696d  ive end date tim
+0000a1a0: 6520 696e 2049 534f 3836 3031 2d44 6174  e in ISO8601-Dat
+0000a1b0: 652d 5374 7269 6e67 2066 6f72 6d61 743a  e-String format:
+0000a1c0: 2032 3031 392d 3034 2d31 3254 3030 3a30   2019-04-12T00:0
+0000a1d0: 303a 3030 5a22 290a 0a20 2020 2061 7267  0:00Z")..    arg
+0000a1e0: 7320 3d20 7061 7273 6572 2e70 6172 7365  s = parser.parse
+0000a1f0: 5f61 7267 7328 290a 2020 2020 6966 2061  _args().    if a
+0000a200: 7267 732e 636f 6e66 6967 3a0a 2020 2020  rgs.config:.    
+0000a210: 2020 2020 6172 6773 2e63 6f6e 6669 6720      args.config 
+0000a220: 3d20 7369 6e67 6572 5f75 7469 6c73 2e6c  = singer_utils.l
+0000a230: 6f61 645f 6a73 6f6e 2861 7267 732e 636f  oad_json(args.co
+0000a240: 6e66 6967 290a 2020 2020 6966 2061 7267  nfig).    if arg
+0000a250: 732e 7374 6174 653a 0a20 2020 2020 2020  s.state:.       
+0000a260: 2061 7267 732e 7374 6174 6520 3d20 7369   args.state = si
+0000a270: 6e67 6572 5f75 7469 6c73 2e6c 6f61 645f  nger_utils.load_
+0000a280: 6a73 6f6e 2861 7267 732e 7374 6174 6529  json(args.state)
+0000a290: 0a20 2020 2065 6c73 653a 0a20 2020 2020  .    else:.     
+0000a2a0: 2020 2061 7267 732e 7374 6174 6520 3d20     args.state = 
+0000a2b0: 7b7d 0a20 2020 2069 6620 6172 6773 2e70  {}.    if args.p
+0000a2c0: 726f 7065 7274 6965 733a 0a20 2020 2020  roperties:.     
+0000a2d0: 2020 2061 7267 732e 7072 6f70 6572 7469     args.properti
+0000a2e0: 6573 203d 2073 696e 6765 725f 7574 696c  es = singer_util
+0000a2f0: 732e 6c6f 6164 5f6a 736f 6e28 6172 6773  s.load_json(args
+0000a300: 2e70 726f 7065 7274 6965 7329 0a20 2020  .properties).   
+0000a310: 2069 6620 6172 6773 2e63 6174 616c 6f67   if args.catalog
+0000a320: 3a0a 2020 2020 2020 2020 6172 6773 2e63  :.        args.c
+0000a330: 6174 616c 6f67 203d 2043 6174 616c 6f67  atalog = Catalog
+0000a340: 2e6c 6f61 6428 6172 6773 2e63 6174 616c  .load(args.catal
+0000a350: 6f67 290a 0a20 2020 2072 6574 7572 6e20  og)..    return 
+0000a360: 6172 6773 0a0a 0a64 6566 206d 6169 6e5f  args...def main_
+0000a370: 696d 706c 2829 3a0a 2020 2020 2320 4372  impl():.    # Cr
+0000a380: 6561 7465 2061 2063 7573 746f 6d20 436f  eate a custom Co
+0000a390: 6c6c 6563 746f 7252 6567 6973 7472 790a  llectorRegistry.
+0000a3a0: 2020 2020 7265 6769 7374 7279 5f70 6163      registry_pac
+0000a3b0: 6b61 6765 203d 2043 6f6c 6c65 6374 6f72  kage = Collector
+0000a3c0: 5265 6769 7374 7279 2829 0a20 2020 2069  Registry().    i
+0000a3d0: 6e67 6573 745f 6572 726f 7273 203d 2043  ngest_errors = C
+0000a3e0: 6f75 6e74 6572 2827 696e 6765 7374 5f65  ounter('ingest_e
+0000a3f0: 7272 6f72 7327 2c20 2754 6f74 616c 206e  rrors', 'Total n
+0000a400: 756d 6265 7220 6f66 2065 7272 6f72 7320  umber of errors 
+0000a410: 6475 7269 6e67 2069 6e67 6573 7469 6f6e  during ingestion
+0000a420: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
+0000a430: 2020 2020 2020 2020 2020 205b 2772 6567             ['reg
+0000a440: 696f 6e27 2c20 2774 656e 616e 7427 2c20  ion', 'tenant', 
+0000a450: 2766 6162 7269 6327 2c20 2777 6f72 6b66  'fabric', 'workf
+0000a460: 6c6f 7727 5d2c 2072 6567 6973 7472 793d  low'], registry=
+0000a470: 7265 6769 7374 7279 5f70 6163 6b61 6765  registry_package
+0000a480: 290a 2020 2020 4c4f 4747 4552 2e69 6e66  ).    LOGGER.inf
+0000a490: 6f28 2242 6967 7175 6572 7920 736f 7572  o("Bigquery sour
+0000a4a0: 6365 2069 7320 7374 6172 7469 6e67 2074  ce is starting t
+0000a4b0: 6865 206d 6574 7269 6373 2073 6572 7665  he metrics serve
+0000a4c0: 722e 2229 0a20 2020 2073 7461 7274 5f68  r.").    start_h
+0000a4d0: 7474 705f 7365 7276 6572 2838 3030 302c  ttp_server(8000,
+0000a4e0: 2072 6567 6973 7472 793d 7265 6769 7374   registry=regist
+0000a4f0: 7279 5f70 6163 6b61 6765 290a 0a20 2020  ry_package)..   
+0000a500: 2061 7267 7320 3d20 7369 6e67 6572 5f75   args = singer_u
+0000a510: 7469 6c73 2e70 6172 7365 5f61 7267 7328  tils.parse_args(
+0000a520: 5245 5155 4952 4544 5f43 4f4e 4649 475f  REQUIRED_CONFIG_
+0000a530: 4b45 5953 290a 2020 2020 636f 6e6e 5f63  KEYS).    conn_c
+0000a540: 6f6e 6669 6720 3d20 7b7d 0a20 2020 2063  onfig = {}.    c
+0000a550: 6f6e 6e5f 636f 6e66 6967 2e75 7064 6174  onn_config.updat
+0000a560: 6528 6172 6773 2e63 6f6e 6669 6729 0a0a  e(args.config)..
+0000a570: 2020 2020 2320 4f76 6572 7772 6974 6520      # Overwrite 
+0000a580: 636f 6e66 6967 2073 7065 6373 2077 6974  config specs wit
+0000a590: 6820 636f 6d6d 616e 646c 696e 6520 6172  h commandline ar
+0000a5a0: 6773 0a20 2020 2061 7267 735f 6469 6374  gs.    args_dict
+0000a5b0: 203d 2061 7267 732e 5f5f 6469 6374 5f5f   = args.__dict__
+0000a5c0: 0a20 2020 2066 6f72 2061 7267 2069 6e20  .    for arg in 
+0000a5d0: 6172 6773 5f64 6963 742e 6b65 7973 2829  args_dict.keys()
+0000a5e0: 3a0a 2020 2020 2020 2020 6966 2061 7267  :.        if arg
+0000a5f0: 2069 6e20 636f 6e6e 5f63 6f6e 6669 672e   in conn_config.
+0000a600: 6b65 7973 2829 2061 6e64 2061 7267 735f  keys() and args_
+0000a610: 6469 6374 5b61 7267 5d20 6973 204e 6f6e  dict[arg] is Non
+0000a620: 653a 0a20 2020 2020 2020 2020 2020 2063  e:.            c
+0000a630: 6f6e 7469 6e75 650a 2020 2020 2020 2020  ontinue.        
+0000a640: 636f 6e6e 5f63 6f6e 6669 675b 6172 675d  conn_config[arg]
+0000a650: 203d 2061 7267 735f 6469 6374 5b61 7267   = args_dict[arg
+0000a660: 5d0a 0a20 2020 2069 6620 6e6f 7420 636f  ]..    if not co
+0000a670: 6e6e 5f63 6f6e 6669 672e 6765 7428 2265  nn_config.get("e
+0000a680: 6e64 5f64 6174 6574 696d 6522 293a 0a20  nd_datetime"):. 
+0000a690: 2020 2020 2020 2063 6f6e 6e5f 636f 6e66         conn_conf
+0000a6a0: 6967 5b22 656e 645f 6461 7465 7469 6d65  ig["end_datetime
+0000a6b0: 225d 203d 2064 6174 6574 696d 652e 6461  "] = datetime.da
+0000a6c0: 7465 7469 6d65 2e75 7463 6e6f 7728 292e  tetime.utcnow().
+0000a6d0: 6973 6f66 6f72 6d61 7428 290a 0a20 2020  isoformat()..   
+0000a6e0: 2074 7279 3a0a 2020 2020 2020 2020 636f   try:.        co
+0000a6f0: 6e6e 5f63 6f6e 6669 6720 3d20 736f 7572  nn_config = sour
+0000a700: 6365 2e63 7265 6174 655f 6372 6564 656e  ce.create_creden
+0000a710: 7469 616c 735f 6669 6c65 2863 6f6e 6e5f  tials_file(conn_
+0000a720: 636f 6e66 6967 290a 2020 2020 2020 2020  config).        
+0000a730: 2320 6966 206e 6f74 2063 6f6e 6e5f 636f  # if not conn_co
+0000a740: 6e66 6967 2e67 6574 2822 7374 6172 745f  nfig.get("start_
+0000a750: 6461 7465 7469 6d65 2229 2061 6e64 206e  datetime") and n
+0000a760: 6f74 2063 6f6e 6e5f 636f 6e66 6967 2e67  ot conn_config.g
+0000a770: 6574 2822 7374 6174 6522 293a 0a20 2020  et("state"):.   
+0000a780: 2020 2020 2023 2020 2020 204c 4f47 4745       #     LOGGE
+0000a790: 522e 6572 726f 7228 2273 7461 7465 206f  R.error("state o
+0000a7a0: 7220 7374 6172 745f 6461 7465 7469 6d65  r start_datetime
+0000a7b0: 206d 7573 7420 6265 2073 7065 6369 6669   must be specifi
+0000a7c0: 6564 2229 0a20 2020 2020 2020 2023 2020  ed").        #  
+0000a7d0: 2020 2072 6574 7572 6e0a 0a20 2020 2020     return..     
+0000a7e0: 2020 2023 2049 6620 6469 7363 6f76 6572     # If discover
+0000a7f0: 2066 6c61 6720 7761 7320 7061 7373 6564   flag was passed
+0000a800: 2c20 7275 6e20 6469 7363 6f76 6572 7920  , run discovery 
+0000a810: 6d6f 6465 2061 6e64 2064 756d 7020 6f75  mode and dump ou
+0000a820: 7470 7574 2074 6f20 7374 646f 7574 0a20  tput to stdout. 
+0000a830: 2020 2020 2020 2069 6620 6172 6773 2e64         if args.d
+0000a840: 6973 636f 7665 723a 0a20 2020 2020 2020  iscover:.       
+0000a850: 2020 2020 2063 6174 616c 6f67 203d 2064       catalog = d
+0000a860: 6973 636f 7665 7228 636f 6e6e 5f63 6f6e  iscover(conn_con
+0000a870: 6669 6729 0a20 2020 2020 2020 2020 2020  fig).           
+0000a880: 2070 7269 6e74 286a 736f 6e2e 6475 6d70   print(json.dump
+0000a890: 7328 6361 7461 6c6f 672c 2069 6e64 656e  s(catalog, inden
+0000a8a0: 743d 3229 290a 2020 2020 2020 2020 2320  t=2)).        # 
+0000a8b0: 4f74 6865 7277 6973 6520 7275 6e20 696e  Otherwise run in
+0000a8c0: 2073 796e 6320 6d6f 6465 0a20 2020 2020   sync mode.     
+0000a8d0: 2020 2065 6c69 6620 6172 6773 2e63 6174     elif args.cat
+0000a8e0: 616c 6f67 3a0a 2020 2020 2020 2020 2020  alog:.          
+0000a8f0: 2020 6361 7461 6c6f 6720 3d20 6172 6773    catalog = args
+0000a900: 2e63 6174 616c 6f67 0a20 2020 2020 2020  .catalog.       
+0000a910: 2020 2020 2073 796e 6328 636f 6e6e 5f63       sync(conn_c
+0000a920: 6f6e 6669 672c 2061 7267 732e 7374 6174  onfig, args.stat
+0000a930: 652c 2063 6174 616c 6f67 290a 2020 2020  e, catalog).    
+0000a940: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0000a950: 2020 2020 2020 4c4f 4747 4552 2e63 7269        LOGGER.cri
+0000a960: 7469 6361 6c28 2243 6174 616c 6f67 2066  tical("Catalog f
+0000a970: 696c 6520 6e6f 7420 7370 6563 6966 6965  ile not specifie
+0000a980: 6422 290a 2020 2020 6578 6365 7074 2045  d").    except E
+0000a990: 7863 6570 7469 6f6e 2061 7320 653a 0a20  xception as e:. 
+0000a9a0: 2020 2020 2020 204c 4f47 4745 522e 7761         LOGGER.wa
+0000a9b0: 726e 2822 4578 6365 7074 696f 6e20 7261  rn("Exception ra
+0000a9c0: 6973 6564 3a20 2573 222c 2065 290a 2020  ised: %s", e).  
+0000a9d0: 2020 2020 2020 696e 6765 7374 5f65 7272        ingest_err
+0000a9e0: 6f72 732e 6c61 6265 6c73 2872 6567 696f  ors.labels(regio
+0000a9f0: 6e5f 6c61 6265 6c2c 2074 656e 616e 745f  n_label, tenant_
+0000aa00: 6c61 6265 6c2c 2066 6162 7269 635f 6c61  label, fabric_la
+0000aa10: 6265 6c2c 2077 6f72 6b66 6c6f 775f 6c61  bel, workflow_la
+0000aa20: 6265 6c29 2e69 6e63 2829 0a20 2020 2020  bel).inc().     
+0000aa30: 2020 2073 6f75 7263 652e 6465 6c65 7465     source.delete
+0000aa40: 5f63 7265 6465 6e74 6961 6c73 5f66 696c  _credentials_fil
+0000aa50: 6528 636f 6e6e 5f63 6f6e 6669 6729 0a20  e(conn_config). 
+0000aa60: 2020 2020 2020 2072 6169 7365 2065 0a20         raise e. 
+0000aa70: 2020 2073 6f75 7263 652e 6465 6c65 7465     source.delete
+0000aa80: 5f63 7265 6465 6e74 6961 6c73 5f66 696c  _credentials_fil
+0000aa90: 6528 636f 6e6e 5f63 6f6e 6669 6729 0a20  e(conn_config). 
+0000aaa0: 2020 2072 6574 7572 6e0a 0a0a 636c 6173     return...clas
+0000aab0: 7320 4269 6751 7565 7279 536f 7572 6365  s BigQuerySource
+0000aac0: 436f 6e6e 6563 746f 7228 4338 436f 6e6e  Connector(C8Conn
+0000aad0: 6563 746f 7229 3a0a 2020 2020 2222 2242  ector):.    """B
+0000aae0: 6967 5175 6572 7953 6f75 7263 6543 6f6e  igQuerySourceCon
+0000aaf0: 6e65 6374 6f72 2773 2043 3843 6f6e 6e65  nector's C8Conne
+0000ab00: 6374 6f72 2069 6d70 6c2e 2222 220a 0a20  ctor impl.""".. 
+0000ab10: 2020 2064 6566 206e 616d 6528 7365 6c66     def name(self
+0000ab20: 2920 2d3e 2073 7472 3a0a 2020 2020 2020  ) -> str:.      
+0000ab30: 2020 2222 2252 6574 7572 6e73 2074 6865    """Returns the
+0000ab40: 206e 616d 6520 6f66 2074 6865 2063 6f6e   name of the con
+0000ab50: 6e65 6374 6f72 2e22 2222 0a20 2020 2020  nector.""".     
+0000ab60: 2020 2072 6574 7572 6e20 2242 6967 5175     return "BigQu
+0000ab70: 6572 7922 0a0a 2020 2020 6465 6620 7061  ery"..    def pa
+0000ab80: 636b 6167 655f 6e61 6d65 2873 656c 6629  ckage_name(self)
+0000ab90: 202d 3e20 7374 723a 0a20 2020 2020 2020   -> str:.       
+0000aba0: 2022 2222 5265 7475 726e 7320 7468 6520   """Returns the 
+0000abb0: 7061 636b 6167 6520 6e61 6d65 206f 6620  package name of 
+0000abc0: 7468 6520 636f 6e6e 6563 746f 7220 2869  the connector (i
+0000abd0: 2e65 2e20 5079 5069 2070 6163 6b61 6765  .e. PyPi package
+0000abe0: 206e 616d 6529 2e22 2222 0a20 2020 2020   name).""".     
+0000abf0: 2020 2072 6574 7572 6e20 226d 6163 726f     return "macro
+0000ac00: 6d65 7461 2d73 6f75 7263 652d 6269 6771  meta-source-bigq
+0000ac10: 7565 7279 220a 0a20 2020 2064 6566 2076  uery"..    def v
+0000ac20: 6572 7369 6f6e 2873 656c 6629 202d 3e20  ersion(self) -> 
+0000ac30: 7374 723a 0a20 2020 2020 2020 2022 2222  str:.        """
+0000ac40: 5265 7475 726e 7320 7468 6520 7665 7273  Returns the vers
+0000ac50: 696f 6e20 6f66 2074 6865 2063 6f6e 6e65  ion of the conne
+0000ac60: 6374 6f72 2e22 2222 0a20 2020 2020 2020  ctor.""".       
+0000ac70: 2072 6574 7572 6e20 706b 675f 7265 736f   return pkg_reso
+0000ac80: 7572 6365 732e 6765 745f 6469 7374 7269  urces.get_distri
+0000ac90: 6275 7469 6f6e 2827 6d61 6372 6f6d 6574  bution('macromet
+0000aca0: 615f 736f 7572 6365 5f62 6967 7175 6572  a_source_bigquer
+0000acb0: 7927 292e 7665 7273 696f 6e0a 0a20 2020  y').version..   
+0000acc0: 2064 6566 2074 7970 6528 7365 6c66 2920   def type(self) 
+0000acd0: 2d3e 2073 7472 3a0a 2020 2020 2020 2020  -> str:.        
+0000ace0: 2222 2252 6574 7572 6e73 2074 6865 2074  """Returns the t
+0000acf0: 7970 6520 6f66 2074 6865 2063 6f6e 6e65  ype of the conne
+0000ad00: 6374 6f72 2e22 2222 0a20 2020 2020 2020  ctor.""".       
+0000ad10: 2072 6574 7572 6e20 2273 6f75 7263 6522   return "source"
+0000ad20: 0a0a 2020 2020 6465 6620 6465 7363 7269  ..    def descri
+0000ad30: 7074 696f 6e28 7365 6c66 2920 2d3e 2073  ption(self) -> s
+0000ad40: 7472 3a0a 2020 2020 2020 2020 2222 2252  tr:.        """R
+0000ad50: 6574 7572 6e73 2074 6865 2064 6573 6372  eturns the descr
+0000ad60: 6970 7469 6f6e 206f 6620 7468 6520 636f  iption of the co
+0000ad70: 6e6e 6563 746f 722e 2222 220a 2020 2020  nnector.""".    
+0000ad80: 2020 2020 7265 7475 726e 2022 536f 7572      return "Sour
+0000ad90: 6365 2064 6174 6120 6672 6f6d 2061 2042  ce data from a B
+0000ada0: 6967 5175 6572 7920 7461 626c 652e 220a  igQuery table.".
+0000adb0: 0a20 2020 2064 6566 206c 6f67 6f28 7365  .    def logo(se
+0000adc0: 6c66 2920 2d3e 2073 7472 3a0a 2020 2020  lf) -> str:.    
+0000add0: 2020 2020 2222 2252 6574 7572 6e73 2074      """Returns t
+0000ade0: 6865 206c 6f67 6f20 696d 6167 6520 666f  he logo image fo
+0000adf0: 7220 7468 6520 636f 6e6e 6563 746f 722e  r the connector.
+0000ae00: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
+0000ae10: 726e 2022 220a 0a20 2020 2064 6566 2076  rn ""..    def v
+0000ae20: 616c 6964 6174 6528 7365 6c66 2c20 696e  alidate(self, in
+0000ae30: 7465 6772 6174 696f 6e3a 2064 6963 7429  tegration: dict)
+0000ae40: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
+0000ae50: 2020 2222 2256 616c 6964 6174 6520 6769    """Validate gi
+0000ae60: 7665 6e20 636f 6e66 6967 7572 6174 696f  ven configuratio
+0000ae70: 6e73 2061 6761 696e 7374 2074 6865 2063  ns against the c
+0000ae80: 6f6e 6e65 6374 6f72 2e0a 2020 2020 2020  onnector..      
+0000ae90: 2020 4966 2069 6e76 616c 6964 2c20 7468    If invalid, th
+0000aea0: 726f 7720 616e 2065 7863 6570 7469 6f6e  row an exception
+0000aeb0: 2077 6974 6820 7468 6520 6361 7573 652e   with the cause.
+0000aec0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0000aed0: 2020 2020 2063 6f6e 6669 6720 3d20 7365       config = se
+0000aee0: 6c66 2e67 6574 5f63 6f6e 6669 6728 696e  lf.get_config(in
+0000aef0: 7465 6772 6174 696f 6e29 0a20 2020 2020  tegration).     
+0000af00: 2020 2074 7279 3a0a 2020 2020 2020 2020     try:.        
+0000af10: 2020 2020 636f 6e66 6967 203d 2073 6f75      config = sou
+0000af20: 7263 652e 6372 6561 7465 5f63 7265 6465  rce.create_crede
+0000af30: 6e74 6961 6c73 5f66 696c 6528 636f 6e66  ntials_file(conf
+0000af40: 6967 290a 2020 2020 2020 2020 2020 2020  ig).            
+0000af50: 6469 7363 6f76 6572 2863 6f6e 6669 6729  discover(config)
+0000af60: 0a20 2020 2020 2020 2065 7863 6570 7420  .        except 
+0000af70: 4578 6365 7074 696f 6e20 6173 2065 3a0a  Exception as e:.
+0000af80: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0000af90: 2e64 656c 6574 655f 6372 6564 656e 7469  .delete_credenti
+0000afa0: 616c 735f 6578 6365 7074 696f 6e28 652c  als_exception(e,
+0000afb0: 2063 6f6e 6669 6729 0a20 2020 2020 2020   config).       
+0000afc0: 2073 6f75 7263 652e 6465 6c65 7465 5f63   source.delete_c
+0000afd0: 7265 6465 6e74 6961 6c73 5f66 696c 6528  redentials_file(
+0000afe0: 636f 6e66 6967 290a 0a20 2020 2064 6566  config)..    def
+0000aff0: 2073 616d 706c 6573 2873 656c 662c 2069   samples(self, i
+0000b000: 6e74 6567 7261 7469 6f6e 3a20 6469 6374  ntegration: dict
+0000b010: 2920 2d3e 206c 6973 745b 5361 6d70 6c65  ) -> list[Sample
+0000b020: 5d3a 0a20 2020 2020 2020 2022 2222 4665  ]:.        """Fe
+0000b030: 7463 6820 7361 6d70 6c65 2064 6174 6120  tch sample data 
+0000b040: 7573 696e 6720 7468 6520 7072 6f76 6964  using the provid
+0000b050: 6564 2063 6f6e 6669 6775 7261 7469 6f6e  ed configuration
+0000b060: 732e 2222 220a 2020 2020 2020 2020 636f  s.""".        co
+0000b070: 6e66 6967 203d 2073 656c 662e 6765 745f  nfig = self.get_
+0000b080: 636f 6e66 6967 2869 6e74 6567 7261 7469  config(integrati
+0000b090: 6f6e 290a 2020 2020 2020 2020 7472 793a  on).        try:
+0000b0a0: 0a20 2020 2020 2020 2020 2020 2063 6f6e  .            con
+0000b0b0: 6669 6720 3d20 736f 7572 6365 2e63 7265  fig = source.cre
+0000b0c0: 6174 655f 6372 6564 656e 7469 616c 735f  ate_credentials_
+0000b0d0: 6669 6c65 2863 6f6e 6669 6729 0a20 2020  file(config).   
+0000b0e0: 2020 2020 2020 2020 2073 7472 6561 6d73           streams
+0000b0f0: 203d 2064 6973 636f 7665 7228 636f 6e66   = discover(conf
+0000b100: 6967 295b 2773 7472 6561 6d73 275d 0a20  ig)['streams']. 
+0000b110: 2020 2020 2020 2020 2020 2072 6573 756c             resul
+0000b120: 7473 203d 205b 5d0a 2020 2020 2020 2020  ts = [].        
+0000b130: 2020 2020 666f 7220 7374 7265 616d 2069      for stream i
+0000b140: 6e20 7374 7265 616d 733a 0a20 2020 2020  n streams:.     
+0000b150: 2020 2020 2020 2020 2020 2073 5f61 7474             s_att
+0000b160: 7269 6273 203d 205b 5d0a 2020 2020 2020  ribs = [].      
+0000b170: 2020 2020 2020 2020 2020 735f 7363 6865            s_sche
+0000b180: 6d61 203d 2073 7472 6561 6d5b 2773 6368  ma = stream['sch
+0000b190: 656d 6127 5d0a 0a20 2020 2020 2020 2020  ema']..         
+0000b1a0: 2020 2020 2020 2064 6174 6120 3d20 6665         data = fe
+0000b1b0: 7463 685f 7361 6d70 6c65 7328 636f 6e66  tch_samples(conf
+0000b1c0: 6967 2c20 7374 7265 616d 295b 3a31 305d  ig, stream)[:10]
+0000b1d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000b1e0: 2023 2041 7070 656e 6469 6e67 205f 2074   # Appending _ t
+0000b1f0: 6f20 6b65 7973 2066 6f72 2070 7265 7365  o keys for prese
+0000b200: 7276 696e 6720 7661 6c75 6573 206f 6620  rving values of 
+0000b210: 7265 7365 7276 6564 206b 6579 7320 696e  reserved keys in
+0000b220: 2073 6f75 7263 6520 6461 7461 0a20 2020   source data.   
+0000b230: 2020 2020 2020 2020 2020 2020 2072 6573               res
+0000b240: 6572 7665 645f 6b65 7973 203d 205b 275f  erved_keys = ['_
+0000b250: 6b65 7927 2c20 275f 6964 272c 2027 5f72  key', '_id', '_r
+0000b260: 6576 275d 0a20 2020 2020 2020 2020 2020  ev'].           
+0000b270: 2020 2020 2069 6620 7374 7265 616d 5b27       if stream['
+0000b280: 6d65 7461 6461 7461 275d 5b30 5d5b 276d  metadata'][0]['m
+0000b290: 6574 6164 6174 6127 5d2e 6765 7428 2774  etadata'].get('t
+0000b2a0: 6162 6c65 2d6b 6579 2d70 726f 7065 7274  able-key-propert
+0000b2b0: 6965 7327 293a 0a20 2020 2020 2020 2020  ies'):.         
+0000b2c0: 2020 2020 2020 2020 2020 206b 6579 5f70             key_p
+0000b2d0: 726f 7065 7274 6965 7320 3d20 7374 7265  roperties = stre
+0000b2e0: 616d 5b27 6d65 7461 6461 7461 275d 5b30  am['metadata'][0
+0000b2f0: 5d5b 276d 6574 6164 6174 6127 5d2e 6765  ]['metadata'].ge
+0000b300: 7428 2774 6162 6c65 2d6b 6579 2d70 726f  t('table-key-pro
+0000b310: 7065 7274 6965 7327 290a 2020 2020 2020  perties').      
+0000b320: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0000b330: 206b 6579 5f70 726f 7065 7274 6965 735b   key_properties[
+0000b340: 305d 203d 3d20 275f 6b65 7927 3a0a 2020  0] == '_key':.  
+0000b350: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b360: 2020 2020 2020 7265 7365 7276 6564 5f6b        reserved_k
+0000b370: 6579 732e 7265 6d6f 7665 2827 5f6b 6579  eys.remove('_key
+0000b380: 2729 0a20 2020 2020 2020 2020 2020 2020  ').             
+0000b390: 2020 2073 5f73 6368 656d 615b 2770 726f     s_schema['pro
+0000b3a0: 7065 7274 6965 7327 5d20 3d20 6d6f 6469  perties'] = modi
+0000b3b0: 6679 5f72 6573 6572 7665 645f 6b65 7973  fy_reserved_keys
+0000b3c0: 2873 5f73 6368 656d 615b 2770 726f 7065  (s_schema['prope
+0000b3d0: 7274 6965 7327 5d2c 2072 6573 6572 7665  rties'], reserve
+0000b3e0: 645f 6b65 7973 290a 0a20 2020 2020 2020  d_keys)..       
+0000b3f0: 2020 2020 2020 2020 2066 6f72 206b 2c20           for k, 
+0000b400: 7620 696e 2073 5f73 6368 656d 615b 2770  v in s_schema['p
+0000b410: 726f 7065 7274 6965 7327 5d2e 6974 656d  roperties'].item
+0000b420: 7328 293a 0a20 2020 2020 2020 2020 2020  s():.           
+0000b430: 2020 2020 2020 2020 2074 203d 2076 5b27           t = v['
+0000b440: 7479 7065 275d 5b2d 315d 0a20 2020 2020  type'][-1].     
+0000b450: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0000b460: 5f61 7474 7269 6273 2e61 7070 656e 6428  _attribs.append(
+0000b470: 5363 6865 6d61 4174 7472 6962 7574 6528  SchemaAttribute(
+0000b480: 6b2c 2073 656c 662e 6765 745f 6174 7472  k, self.get_attr
+0000b490: 6962 7574 655f 7479 7065 2874 2929 290a  ibute_type(t))).
+0000b4a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b4b0: 7363 6865 6d61 203d 2053 6368 656d 6128  schema = Schema(
+0000b4c0: 7374 7265 616d 5b27 7374 7265 616d 275d  stream['stream']
+0000b4d0: 2c20 735f 6174 7472 6962 7329 0a20 2020  , s_attribs).   
+0000b4e0: 2020 2020 2020 2020 2020 2020 2072 6573               res
+0000b4f0: 756c 7473 2e61 7070 656e 6428 5361 6d70  ults.append(Samp
+0000b500: 6c65 280a 2020 2020 2020 2020 2020 2020  le(.            
+0000b510: 2020 2020 2020 2020 7363 6865 6d61 3d73          schema=s
+0000b520: 6368 656d 612c 0a20 2020 2020 2020 2020  chema,.         
+0000b530: 2020 2020 2020 2020 2020 2064 6174 613d             data=
+0000b540: 6461 7461 290a 2020 2020 2020 2020 2020  data).          
+0000b550: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0000b560: 6578 6365 7074 2045 7863 6570 7469 6f6e  except Exception
+0000b570: 2061 7320 653a 0a20 2020 2020 2020 2020   as e:.         
+0000b580: 2020 2073 656c 662e 6465 6c65 7465 5f63     self.delete_c
+0000b590: 7265 6465 6e74 6961 6c73 5f65 7863 6570  redentials_excep
+0000b5a0: 7469 6f6e 2865 2c20 636f 6e66 6967 290a  tion(e, config).
+0000b5b0: 2020 2020 2020 2020 736f 7572 6365 2e64          source.d
+0000b5c0: 656c 6574 655f 6372 6564 656e 7469 616c  elete_credential
+0000b5d0: 735f 6669 6c65 2863 6f6e 6669 6729 0a20  s_file(config). 
+0000b5e0: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
+0000b5f0: 7375 6c74 730a 0a20 2020 2064 6566 2073  sults..    def s
+0000b600: 6368 656d 6173 2873 656c 662c 2069 6e74  chemas(self, int
+0000b610: 6567 7261 7469 6f6e 3a20 6469 6374 2920  egration: dict) 
+0000b620: 2d3e 206c 6973 745b 5363 6865 6d61 5d3a  -> list[Schema]:
+0000b630: 0a20 2020 2020 2020 2022 2222 4765 7420  .        """Get 
+0000b640: 7375 7070 6f72 7465 6420 7363 6865 6d61  supported schema
+0000b650: 7320 7573 696e 6720 7468 6520 6769 7665  s using the give
+0000b660: 6e20 636f 6e66 6967 7572 6174 696f 6e73  n configurations
+0000b670: 2e22 2222 0a20 2020 2020 2020 2063 6f6e  .""".        con
+0000b680: 6669 6720 3d20 7365 6c66 2e67 6574 5f63  fig = self.get_c
+0000b690: 6f6e 6669 6728 696e 7465 6772 6174 696f  onfig(integratio
+0000b6a0: 6e29 0a20 2020 2020 2020 2074 7279 3a0a  n).        try:.
+0000b6b0: 2020 2020 2020 2020 2020 2020 636f 6e66              conf
+0000b6c0: 6967 203d 2073 6f75 7263 652e 6372 6561  ig = source.crea
+0000b6d0: 7465 5f63 7265 6465 6e74 6961 6c73 5f66  te_credentials_f
+0000b6e0: 696c 6528 636f 6e66 6967 290a 2020 2020  ile(config).    
+0000b6f0: 2020 2020 2020 2020 7374 7265 616d 7320          streams 
+0000b700: 3d20 6469 7363 6f76 6572 2863 6f6e 6669  = discover(confi
+0000b710: 6729 5b27 7374 7265 616d 7327 5d0a 2020  g)['streams'].  
+0000b720: 2020 2020 2020 2020 2020 7265 7375 6c74            result
+0000b730: 7320 3d20 5b5d 0a20 2020 2020 2020 2020  s = [].         
+0000b740: 2020 2066 6f72 2073 7472 6561 6d20 696e     for stream in
+0000b750: 2073 7472 6561 6d73 3a0a 2020 2020 2020   streams:.      
+0000b760: 2020 2020 2020 2020 2020 735f 6174 7472            s_attr
+0000b770: 6962 7320 3d20 5b5d 0a20 2020 2020 2020  ibs = [].       
+0000b780: 2020 2020 2020 2020 2073 5f73 6368 656d           s_schem
+0000b790: 6120 3d20 7374 7265 616d 5b27 7363 6865  a = stream['sche
+0000b7a0: 6d61 275d 0a0a 2020 2020 2020 2020 2020  ma']..          
+0000b7b0: 2020 2020 2020 2320 4170 7065 6e64 696e        # Appendin
+0000b7c0: 6720 5f20 746f 206b 6579 7320 666f 7220  g _ to keys for 
+0000b7d0: 7072 6573 6572 7669 6e67 2076 616c 7565  preserving value
+0000b7e0: 7320 6f66 2072 6573 6572 7665 6420 6b65  s of reserved ke
+0000b7f0: 7973 2069 6e20 736f 7572 6365 2064 6174  ys in source dat
+0000b800: 610a 2020 2020 2020 2020 2020 2020 2020  a.              
+0000b810: 2020 7265 7365 7276 6564 5f6b 6579 7320    reserved_keys 
+0000b820: 3d20 5b27 5f6b 6579 272c 2027 5f69 6427  = ['_key', '_id'
+0000b830: 2c20 275f 7265 7627 5d0a 2020 2020 2020  , '_rev'].      
+0000b840: 2020 2020 2020 2020 2020 6966 2073 7472            if str
+0000b850: 6561 6d5b 276d 6574 6164 6174 6127 5d5b  eam['metadata'][
+0000b860: 305d 5b27 6d65 7461 6461 7461 275d 2e67  0]['metadata'].g
+0000b870: 6574 2827 7461 626c 652d 6b65 792d 7072  et('table-key-pr
+0000b880: 6f70 6572 7469 6573 2729 3a0a 2020 2020  operties'):.    
+0000b890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b8a0: 6b65 795f 7072 6f70 6572 7469 6573 203d  key_properties =
+0000b8b0: 2073 7472 6561 6d5b 276d 6574 6164 6174   stream['metadat
+0000b8c0: 6127 5d5b 305d 5b27 6d65 7461 6461 7461  a'][0]['metadata
+0000b8d0: 275d 2e67 6574 2827 7461 626c 652d 6b65  '].get('table-ke
+0000b8e0: 792d 7072 6f70 6572 7469 6573 2729 0a20  y-properties'). 
+0000b8f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b900: 2020 2069 6620 6b65 795f 7072 6f70 6572     if key_proper
+0000b910: 7469 6573 5b30 5d20 3d3d 2027 5f6b 6579  ties[0] == '_key
+0000b920: 273a 0a20 2020 2020 2020 2020 2020 2020  ':.             
+0000b930: 2020 2020 2020 2020 2020 2072 6573 6572             reser
+0000b940: 7665 645f 6b65 7973 2e72 656d 6f76 6528  ved_keys.remove(
+0000b950: 275f 6b65 7927 290a 2020 2020 2020 2020  '_key').        
+0000b960: 2020 2020 2020 2020 735f 7363 6865 6d61          s_schema
+0000b970: 5b27 7072 6f70 6572 7469 6573 275d 203d  ['properties'] =
+0000b980: 206d 6f64 6966 795f 7265 7365 7276 6564   modify_reserved
+0000b990: 5f6b 6579 7328 735f 7363 6865 6d61 5b27  _keys(s_schema['
+0000b9a0: 7072 6f70 6572 7469 6573 275d 2c20 7265  properties'], re
+0000b9b0: 7365 7276 6564 5f6b 6579 7329 0a0a 2020  served_keys)..  
+0000b9c0: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+0000b9d0: 7220 6b2c 2076 2069 6e20 735f 7363 6865  r k, v in s_sche
+0000b9e0: 6d61 5b27 7072 6f70 6572 7469 6573 275d  ma['properties']
+0000b9f0: 2e69 7465 6d73 2829 3a0a 2020 2020 2020  .items():.      
+0000ba00: 2020 2020 2020 2020 2020 2020 2020 7420                t 
+0000ba10: 3d20 765b 2774 7970 6527 5d5b 2d31 5d0a  = v['type'][-1].
+0000ba20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ba30: 2020 2020 735f 6174 7472 6962 732e 6170      s_attribs.ap
+0000ba40: 7065 6e64 2853 6368 656d 6141 7474 7269  pend(SchemaAttri
+0000ba50: 6275 7465 286b 2c20 7365 6c66 2e67 6574  bute(k, self.get
+0000ba60: 5f61 7474 7269 6275 7465 5f74 7970 6528  _attribute_type(
+0000ba70: 7429 2929 0a20 2020 2020 2020 2020 2020  t))).           
+0000ba80: 2020 2020 2072 6573 756c 7473 2e61 7070       results.app
+0000ba90: 656e 6428 5363 6865 6d61 2873 7472 6561  end(Schema(strea
+0000baa0: 6d5b 2773 7472 6561 6d27 5d2c 2073 5f61  m['stream'], s_a
+0000bab0: 7474 7269 6273 2929 0a20 2020 2020 2020  ttribs)).       
+0000bac0: 2065 7863 6570 7420 4578 6365 7074 696f   except Exceptio
+0000bad0: 6e20 6173 2065 3a0a 2020 2020 2020 2020  n as e:.        
+0000bae0: 2020 2020 7365 6c66 2e64 656c 6574 655f      self.delete_
+0000baf0: 6372 6564 656e 7469 616c 735f 6578 6365  credentials_exce
+0000bb00: 7074 696f 6e28 652c 2063 6f6e 6669 6729  ption(e, config)
+0000bb10: 0a20 2020 2020 2020 2073 6f75 7263 652e  .        source.
+0000bb20: 6465 6c65 7465 5f63 7265 6465 6e74 6961  delete_credentia
+0000bb30: 6c73 5f66 696c 6528 636f 6e66 6967 290a  ls_file(config).
+0000bb40: 2020 2020 2020 2020 7265 7475 726e 2072          return r
+0000bb50: 6573 756c 7473 0a0a 2020 2020 4073 7461  esults..    @sta
+0000bb60: 7469 636d 6574 686f 640a 2020 2020 6465  ticmethod.    de
+0000bb70: 6620 6465 6c65 7465 5f63 7265 6465 6e74  f delete_credent
+0000bb80: 6961 6c73 5f65 7863 6570 7469 6f6e 2865  ials_exception(e
+0000bb90: 2c20 636f 6e66 6967 293a 0a20 2020 2020  , config):.     
+0000bba0: 2020 204c 4f47 4745 522e 7761 726e 2822     LOGGER.warn("
+0000bbb0: 4578 6365 7074 696f 6e20 7261 6973 6564  Exception raised
+0000bbc0: 3a20 2573 222c 2065 290a 2020 2020 2020  : %s", e).      
+0000bbd0: 2020 736f 7572 6365 2e64 656c 6574 655f    source.delete_
+0000bbe0: 6372 6564 656e 7469 616c 735f 6669 6c65  credentials_file
+0000bbf0: 2863 6f6e 6669 6729 0a20 2020 2020 2020  (config).       
+0000bc00: 2072 6169 7365 2065 0a0a 2020 2020 6465   raise e..    de
+0000bc10: 6620 7265 7365 7276 6564 5f6b 6579 7328  f reserved_keys(
+0000bc20: 7365 6c66 2920 2d3e 206c 6973 745b 7374  self) -> list[st
+0000bc30: 725d 3a0a 2020 2020 2020 2020 2222 224c  r]:.        """L
+0000bc40: 6973 7420 6f66 2072 6573 6572 7665 6420  ist of reserved 
+0000bc50: 6b65 7973 2066 6f72 2074 6865 2063 6f6e  keys for the con
+0000bc60: 6e65 6374 6f72 2e22 2222 0a20 2020 2020  nector.""".     
+0000bc70: 2020 2072 6574 7572 6e20 5b5d 0a0a 2020     return []..  
+0000bc80: 2020 4073 7461 7469 636d 6574 686f 640a    @staticmethod.
+0000bc90: 2020 2020 6465 6620 6765 745f 6174 7472      def get_attr
+0000bca0: 6962 7574 655f 7479 7065 2873 6f75 7263  ibute_type(sourc
+0000bcb0: 655f 7479 7065 3a20 7374 7229 202d 3e20  e_type: str) -> 
+0000bcc0: 5363 6865 6d61 4174 7472 6962 7574 6554  SchemaAttributeT
+0000bcd0: 7970 653a 0a20 2020 2020 2020 2069 6620  ype:.        if 
+0000bce0: 736f 7572 6365 5f74 7970 6520 3d3d 2027  source_type == '
+0000bcf0: 7374 7269 6e67 273a 0a20 2020 2020 2020  string':.       
+0000bd00: 2020 2020 2072 6574 7572 6e20 5363 6865       return Sche
+0000bd10: 6d61 4174 7472 6962 7574 6554 7970 652e  maAttributeType.
+0000bd20: 5354 5249 4e47 0a20 2020 2020 2020 2065  STRING.        e
+0000bd30: 6c69 6620 736f 7572 6365 5f74 7970 6520  lif source_type 
+0000bd40: 3d3d 2027 696e 7465 6765 7227 3a0a 2020  == 'integer':.  
+0000bd50: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0000bd60: 2053 6368 656d 6141 7474 7269 6275 7465   SchemaAttribute
+0000bd70: 5479 7065 2e4c 4f4e 470a 2020 2020 2020  Type.LONG.      
+0000bd80: 2020 656c 6966 2073 6f75 7263 655f 7479    elif source_ty
+0000bd90: 7065 203d 3d20 2762 6f6f 6c65 616e 273a  pe == 'boolean':
+0000bda0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+0000bdb0: 7572 6e20 5363 6865 6d61 4174 7472 6962  urn SchemaAttrib
+0000bdc0: 7574 6554 7970 652e 424f 4f4c 4541 4e0a  uteType.BOOLEAN.
+0000bdd0: 2020 2020 2020 2020 656c 6966 2073 6f75          elif sou
+0000bde0: 7263 655f 7479 7065 203d 3d20 276e 756d  rce_type == 'num
+0000bdf0: 6265 7227 3a0a 2020 2020 2020 2020 2020  ber':.          
+0000be00: 2020 7265 7475 726e 2053 6368 656d 6141    return SchemaA
+0000be10: 7474 7269 6275 7465 5479 7065 2e44 4f55  ttributeType.DOU
+0000be20: 424c 450a 2020 2020 2020 2020 656c 7365  BLE.        else
+0000be30: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+0000be40: 7475 726e 2053 6368 656d 6141 7474 7269  turn SchemaAttri
+0000be50: 6275 7465 5479 7065 2e4f 424a 4543 540a  buteType.OBJECT.
+0000be60: 0a20 2020 2064 6566 2063 6f6e 6669 6728  .    def config(
+0000be70: 7365 6c66 2920 2d3e 206c 6973 745b 436f  self) -> list[Co
+0000be80: 6e66 6967 5072 6f70 6572 7479 5d3a 0a20  nfigProperty]:. 
+0000be90: 2020 2020 2020 2022 2222 4765 7420 636f         """Get co
+0000bea0: 6e66 6967 7572 6174 696f 6e20 7061 7261  nfiguration para
+0000beb0: 6d65 7465 7273 2066 6f72 2074 6865 2063  meters for the c
+0000bec0: 6f6e 6e65 6374 6f72 2e22 2222 0a20 2020  onnector.""".   
+0000bed0: 2020 2020 2072 6574 7572 6e20 5b0a 2020       return [.  
+0000bee0: 2020 2020 2020 2020 2020 436f 6e66 6967            Config
+0000bef0: 5072 6f70 6572 7479 2827 7072 6f6a 6563  Property('projec
+0000bf00: 7427 2c20 2750 726f 6a65 6374 2049 4427  t', 'Project ID'
+0000bf10: 2c20 436f 6e66 6967 4174 7472 6962 7574  , ConfigAttribut
+0000bf20: 6554 7970 652e 5354 5249 4e47 2c20 5472  eType.STRING, Tr
+0000bf30: 7565 2c20 4661 6c73 652c 0a20 2020 2020  ue, False,.     
+0000bf40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bf50: 2020 2020 2020 6465 7363 7269 7074 696f        descriptio
+0000bf60: 6e3d 2742 6967 5175 6572 7920 7072 6f6a  n='BigQuery proj
+0000bf70: 6563 7420 4944 2e27 2c0a 2020 2020 2020  ect ID.',.      
+0000bf80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bf90: 2020 2020 2070 6c61 6365 686f 6c64 6572       placeholder
+0000bfa0: 5f76 616c 7565 3d27 6d79 5f70 726f 6a65  _value='my_proje
+0000bfb0: 6374 5f69 6427 292c 0a20 2020 2020 2020  ct_id'),.       
+0000bfc0: 2020 2020 2043 6f6e 6669 6750 726f 7065       ConfigPrope
+0000bfd0: 7274 7928 2774 6162 6c65 272c 2027 5461  rty('table', 'Ta
+0000bfe0: 626c 6527 2c20 436f 6e66 6967 4174 7472  ble', ConfigAttr
+0000bff0: 6962 7574 6554 7970 652e 5354 5249 4e47  ibuteType.STRING
+0000c000: 2c20 5472 7565 2c20 5472 7565 2c0a 2020  , True, True,.  
+0000c010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c020: 2020 2020 2020 2020 2064 6573 6372 6970           descrip
+0000c030: 7469 6f6e 3d27 4675 6c6c 7920 7175 616c  tion='Fully qual
+0000c040: 6966 6965 6420 7461 626c 6520 6e61 6d65  ified table name
+0000c050: 2069 6e20 4269 6751 7565 7279 2c20 7769   in BigQuery, wi
+0000c060: 7468 2066 6f72 6d61 7420 270a 2020 2020  th format '.    
 0000c070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c080: 2020 2020 2720 4966 2074 6865 2063 6f6c      ' If the col
-0000c090: 756d 6e73 2064 6f65 7320 6e6f 7420 6861  umns does not ha
-0000c0a0: 7665 2061 6e79 2063 6f6c 756d 6e20 7769  ve any column wi
-0000c0b0: 7468 2075 6e69 7175 6520 7661 6c75 6573  th unique values
-0000c0c0: 2074 6865 6e20 646f 206e 6f74 2027 0a20   then do not '. 
-0000c0d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c0e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c0f0: 2020 2020 2020 2773 7065 6369 6679 2061        'specify a
-0000c100: 6e79 7468 696e 6720 6865 7265 2c27 0a20  nything here,'. 
-0000c110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c130: 2020 2020 2020 2720 5f6b 6579 2066 6f72        ' _key for
-0000c140: 2074 6865 2063 6f6c 6c65 6374 696f 6e20   the collection 
-0000c150: 7769 6c6c 2062 6520 6175 746f 6765 6e65  will be autogene
-0000c160: 7261 7465 6420 696e 2074 6869 7320 6361  rated in this ca
-0000c170: 7365 2e20 5072 696d 6172 7920 6b65 7920  se. Primary key 
-0000c180: 6973 2027 0a20 2020 2020 2020 2020 2020  is '.           
-0000c190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c1a0: 2020 2020 2020 2020 2020 2020 2763 6173              'cas
-0000c1b0: 6520 7365 6e73 6974 6976 652e 272c 0a20  e sensitive.',. 
-0000c1c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c1d0: 2020 2020 2020 2020 2020 706c 6163 6568            placeh
-0000c1e0: 6f6c 6465 725f 7661 6c75 653d 276d 795f  older_value='my_
-0000c1f0: 7072 696d 6172 795f 6b65 7927 292c 0a20  primary_key'),. 
-0000c200: 2020 2020 2020 2020 2020 2043 6f6e 6669             Confi
-0000c210: 6750 726f 7065 7274 7928 2764 6174 6574  gProperty('datet
-0000c220: 696d 655f 6b65 7927 2c20 2744 6174 6574  ime_key', 'Datet
-0000c230: 696d 6520 4b65 7920 2849 6e63 7265 6d65  ime Key (Increme
-0000c240: 6e74 616c 2072 6570 6c69 6361 7469 6f6e  ntal replication
-0000c250: 2927 2c20 436f 6e66 6967 4174 7472 6962  )', ConfigAttrib
-0000c260: 7574 6554 7970 652e 5354 5249 4e47 2c0a  uteType.STRING,.
+0000c080: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c090: 2020 2027 3c70 726f 6a65 6374 3e2e 3c64     '<project>.<d
+0000c0a0: 6174 6173 6574 3e2e 3c74 6162 6c65 3e20  ataset>.<table> 
+0000c0b0: 2843 6173 652d 7365 6e73 6974 6976 6529  (Case-sensitive)
+0000c0c0: 2e27 2c0a 2020 2020 2020 2020 2020 2020  .',.            
+0000c0d0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+0000c0e0: 6c61 6365 686f 6c64 6572 5f76 616c 7565  laceholder_value
+0000c0f0: 3d27 6d79 5f70 726f 6a65 6374 2e6d 795f  ='my_project.my_
+0000c100: 6461 7461 7365 742e 6d79 5f74 6162 6c65  dataset.my_table
+0000c110: 2729 2c0a 2020 2020 2020 2020 2020 2020  '),.            
+0000c120: 436f 6e66 6967 5072 6f70 6572 7479 2827  ConfigProperty('
+0000c130: 6372 6564 656e 7469 616c 735f 6669 6c65  credentials_file
+0000c140: 272c 2027 4372 6564 656e 7469 616c 7320  ', 'Credentials 
+0000c150: 4a53 4f4e 2046 696c 6527 2c20 436f 6e66  JSON File', Conf
+0000c160: 6967 4174 7472 6962 7574 6554 7970 652e  igAttributeType.
+0000c170: 4649 4c45 2c20 5472 7565 2c20 4661 6c73  FILE, True, Fals
+0000c180: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+0000c190: 2020 2020 2020 2020 2020 2020 2020 6465                de
+0000c1a0: 7363 7269 7074 696f 6e3d 2743 6f6e 7465  scription='Conte
+0000c1b0: 6e74 206f 6620 7468 6520 6372 6564 656e  nt of the creden
+0000c1c0: 7469 616c 732e 6a73 6f6e 2066 696c 6520  tials.json file 
+0000c1d0: 666f 7220 796f 7572 2073 6572 7669 6365  for your service
+0000c1e0: 2061 6363 6f75 6e74 2e20 270a 2020 2020   account. '.    
+0000c1f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c210: 2020 2027 5365 6520 7468 6520 2241 6374     'See the "Act
+0000c220: 6976 6174 6520 7468 6520 476f 6f67 6c65  ivate the Google
+0000c230: 2042 6967 5175 6572 7920 4150 4922 2073   BigQuery API" s
+0000c240: 6563 7469 6f6e 206f 6620 7468 6520 7265  ection of the re
+0000c250: 706f 7369 746f 7279 5c27 7327 0a20 2020  pository\'s'.   
+0000c260: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0000c270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c280: 2020 2020 2020 2020 2020 2046 616c 7365             False
-0000c290: 2c20 4661 6c73 652c 0a20 2020 2020 2020  , False,.       
-0000c2a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c2b0: 2020 2020 6465 7363 7269 7074 696f 6e3d      description=
-0000c2c0: 274e 616d 6520 6f66 2064 6174 6574 696d  'Name of datetim
-0000c2d0: 6520 636f 6c75 6d6e 2074 6f20 7573 6520  e column to use 
-0000c2e0: 6173 2072 6570 6c69 6361 7469 6f6e 206b  as replication k
-0000c2f0: 6579 2e27 2c0a 2020 2020 2020 2020 2020  ey.',.          
-0000c300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c310: 2070 6c61 6365 686f 6c64 6572 5f76 616c   placeholder_val
-0000c320: 7565 3d27 6d79 5f64 6174 6574 696d 655f  ue='my_datetime_
-0000c330: 6b65 7927 292c 0a20 2020 2020 2020 2020  key'),.         
-0000c340: 2020 2043 6f6e 6669 6750 726f 7065 7274     ConfigPropert
-0000c350: 7928 2766 696c 7465 7273 272c 2027 4669  y('filters', 'Fi
-0000c360: 6c74 6572 7327 2c20 436f 6e66 6967 4174  lters', ConfigAt
-0000c370: 7472 6962 7574 6554 7970 652e 5354 5249  tributeType.STRI
-0000c380: 4e47 2c20 4661 6c73 652c 2046 616c 7365  NG, False, False
-0000c390: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000c3a0: 2020 2020 2020 2020 2020 2020 2064 6573               des
-0000c3b0: 6372 6970 7469 6f6e 3d27 436f 6d6d 612d  cription='Comma-
-0000c3c0: 7365 7061 7261 7465 6420 6c69 7374 206f  separated list o
-0000c3d0: 6620 5748 4552 4520 636c 6175 7365 7320  f WHERE clauses 
-0000c3e0: 746f 2066 696c 7465 7220 6578 7472 6163  to filter extrac
-0000c3f0: 7465 6420 6461 7461 2c20 270a 2020 2020  ted data, '.    
-0000c400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c420: 2020 2027 652e 672e 2022 636f 6c75 6d6e     'e.g. "column
-0000c430: 3d5c 2776 616c 7565 5c27 222e 272c 0a20  =\'value\'".',. 
-0000c440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c450: 2020 2020 2020 2020 2020 706c 6163 6568            placeh
-0000c460: 6f6c 6465 725f 7661 6c75 653d 276d 795f  older_value='my_
-0000c470: 6669 6c74 6572 7327 292c 0a20 2020 2020  filters'),.     
-0000c480: 2020 2020 2020 2043 6f6e 6669 6750 726f         ConfigPro
-0000c490: 7065 7274 7928 2773 7461 7274 5f64 6174  perty('start_dat
-0000c4a0: 6574 696d 6527 2c20 2753 7461 7274 2044  etime', 'Start D
-0000c4b0: 6174 6574 696d 6527 2c20 436f 6e66 6967  atetime', Config
-0000c4c0: 4174 7472 6962 7574 6554 7970 652e 5354  AttributeType.ST
-0000c4d0: 5249 4e47 2c20 4661 6c73 652c 2046 616c  RING, False, Fal
-0000c4e0: 7365 2c0a 2020 2020 2020 2020 2020 2020  se,.            
-0000c4f0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-0000c500: 6573 6372 6970 7469 6f6e 3d27 4465 7465  escription='Dete
-0000c510: 726d 696e 6573 2068 6f77 206d 7563 6820  rmines how much 
-0000c520: 6869 7374 6f72 6963 616c 2064 6174 6120  historical data 
-0000c530: 7769 6c6c 2062 6520 6578 7472 6163 7465  will be extracte
-0000c540: 642e 2050 6c65 6173 6520 6265 2061 7761  d. Please be awa
-0000c550: 7265 2074 6861 7420 270a 2020 2020 2020  re that '.      
-0000c560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c580: 2027 7468 6520 6c61 7267 6572 2074 6865   'the larger the
-0000c590: 2074 696d 6520 7065 7269 6f64 2061 6e64   time period and
-0000c5a0: 2061 6d6f 756e 7420 6f66 2064 6174 612c   amount of data,
-0000c5b0: 2074 6865 206c 6f6e 6765 7220 7468 6520   the longer the 
-0000c5c0: 696e 6974 6961 6c20 270a 2020 2020 2020  initial '.      
-0000c5d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c5e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c5f0: 2027 6578 7472 6163 7469 6f6e 2063 616e   'extraction can
-0000c600: 2062 6520 6578 7065 6374 6564 2074 6f20   be expected to 
-0000c610: 7461 6b65 2e27 2c0a 2020 2020 2020 2020  take.',.        
-0000c620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c630: 2020 2070 6c61 6365 686f 6c64 6572 5f76     placeholder_v
-0000c640: 616c 7565 3d27 3230 3137 2d30 312d 3031  alue='2017-01-01
-0000c650: 5430 303a 3030 3a30 305a 2729 2c0a 2020  T00:00:00Z'),.  
-0000c660: 2020 2020 2020 2020 2020 436f 6e66 6967            Config
-0000c670: 5072 6f70 6572 7479 2827 656e 645f 6461  Property('end_da
-0000c680: 7465 7469 6d65 272c 2027 456e 6420 4461  tetime', 'End Da
-0000c690: 7465 7469 6d65 272c 0a20 2020 2020 2020  tetime',.       
+0000c280: 2020 2020 2752 4541 444d 4520 616e 6420      'README and 
+0000c290: 6874 7470 733a 2f2f 636c 6f75 642e 676f  https://cloud.go
+0000c2a0: 6f67 6c65 2e63 6f6d 2f64 6f63 732f 6175  ogle.com/docs/au
+0000c2b0: 7468 656e 7469 6361 7469 6f6e 2f70 726f  thentication/pro
+0000c2c0: 6475 6374 696f 6e2e 272c 0a20 2020 2020  duction.',.     
+0000c2d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c2e0: 2020 2020 2020 706c 6163 6568 6f6c 6465        placeholde
+0000c2f0: 725f 7661 6c75 653d 2763 7265 6465 6e74  r_value='credent
+0000c300: 6961 6c73 2e6a 736f 6e20 636f 6e74 656e  ials.json conten
+0000c310: 7473 2729 2c0a 2020 2020 2020 2020 2020  ts'),.          
+0000c320: 2020 436f 6e66 6967 5072 6f70 6572 7479    ConfigProperty
+0000c330: 2827 636f 6c75 6d6e 7327 2c20 2743 6f6c  ('columns', 'Col
+0000c340: 756d 6e73 272c 2043 6f6e 6669 6741 7474  umns', ConfigAtt
+0000c350: 7269 6275 7465 5479 7065 2e53 5452 494e  ributeType.STRIN
+0000c360: 472c 2046 616c 7365 2c20 5472 7565 2c0a  G, False, True,.
+0000c370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c380: 2020 2020 2020 2020 2020 2064 6573 6372             descr
+0000c390: 6970 7469 6f6e 3d27 436f 6d6d 612d 7365  iption='Comma-se
+0000c3a0: 7061 7261 7465 6420 6c69 7374 206f 6620  parated list of 
+0000c3b0: 636f 6c75 6d6e 7320 746f 2062 6520 7365  columns to be se
+0000c3c0: 6c65 6374 6564 2e20 5573 6520 222a 2220  lected. Use "*" 
+0000c3d0: 746f 2073 656c 6563 7420 616c 6c20 636f  to select all co
+0000c3e0: 6c75 6d6e 732e 272c 0a20 2020 2020 2020  lumns.',.       
+0000c3f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c400: 2020 2020 6465 6661 756c 745f 7661 6c75      default_valu
+0000c410: 653d 272a 2729 2c0a 2020 2020 2020 2020  e='*'),.        
+0000c420: 2020 2020 436f 6e66 6967 5072 6f70 6572      ConfigProper
+0000c430: 7479 2827 7072 696d 6172 795f 6b65 7927  ty('primary_key'
+0000c440: 2c20 2755 6e69 7175 6520 5072 696d 6172  , 'Unique Primar
+0000c450: 7920 4b65 7920 2874 6f20 6265 2075 7365  y Key (to be use
+0000c460: 6420 6173 205f 6b65 7920 666f 7220 7468  d as _key for th
+0000c470: 6520 636f 6c6c 6563 7469 6f6e 2927 2c0a  e collection)',.
+0000c480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c490: 2020 2020 2020 2020 2020 2043 6f6e 6669             Confi
+0000c4a0: 6741 7474 7269 6275 7465 5479 7065 2e53  gAttributeType.S
+0000c4b0: 5452 494e 472c 2046 616c 7365 2c20 5472  TRING, False, Tr
+0000c4c0: 7565 2c0a 2020 2020 2020 2020 2020 2020  ue,.            
+0000c4d0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+0000c4e0: 6573 6372 6970 7469 6f6e 3d27 4120 756e  escription='A un
+0000c4f0: 6971 7565 2070 7269 6d61 7279 206b 6579  ique primary key
+0000c500: 2066 726f 6d20 7468 6520 6269 6771 7565   from the bigque
+0000c510: 7279 2074 6162 6c65 2077 6869 6368 206e  ry table which n
+0000c520: 6565 6473 2062 6520 7573 6564 2061 7320  eeds be used as 
+0000c530: 5f6b 6579 2066 6f72 2027 0a20 2020 2020  _key for '.     
+0000c540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c560: 2020 2774 6865 2063 6f6c 6c65 6374 696f    'the collectio
+0000c570: 6e2e 270a 2020 2020 2020 2020 2020 2020  n.'.            
+0000c580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c590: 2020 2020 2020 2020 2020 2027 2049 6620             ' If 
+0000c5a0: 7468 6520 636f 6c75 6d6e 7320 646f 6573  the columns does
+0000c5b0: 206e 6f74 2068 6176 6520 616e 7920 636f   not have any co
+0000c5c0: 6c75 6d6e 2077 6974 6820 756e 6971 7565  lumn with unique
+0000c5d0: 2076 616c 7565 7320 7468 656e 2064 6f20   values then do 
+0000c5e0: 6e6f 7420 270a 2020 2020 2020 2020 2020  not '.          
+0000c5f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c600: 2020 2020 2020 2020 2020 2020 2027 7370               'sp
+0000c610: 6563 6966 7920 616e 7974 6869 6e67 2068  ecify anything h
+0000c620: 6572 652c 270a 2020 2020 2020 2020 2020  ere,'.          
+0000c630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c640: 2020 2020 2020 2020 2020 2020 2027 205f               ' _
+0000c650: 6b65 7920 666f 7220 7468 6520 636f 6c6c  key for the coll
+0000c660: 6563 7469 6f6e 2077 696c 6c20 6265 2061  ection will be a
+0000c670: 7574 6f67 656e 6572 6174 6564 2069 6e20  utogenerated in 
+0000c680: 7468 6973 2063 6173 652e 2050 7269 6d61  this case. Prima
+0000c690: 7279 206b 6579 2069 7320 270a 2020 2020  ry key is '.    
 0000c6a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c6b0: 2020 2020 436f 6e66 6967 4174 7472 6962      ConfigAttrib
-0000c6c0: 7574 6554 7970 652e 5354 5249 4e47 2c20  uteType.STRING, 
-0000c6d0: 4661 6c73 652c 2046 616c 7365 2c0a 2020  False, False,.  
+0000c6b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c6c0: 2020 2027 6361 7365 2073 656e 7369 7469     'case sensiti
+0000c6d0: 7665 2e27 2c0a 2020 2020 2020 2020 2020  ve.',.          
 0000c6e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c6f0: 2020 2020 2020 2020 2064 6573 6372 6970           descrip
-0000c700: 7469 6f6e 3d27 4461 7465 2075 7020 746f  tion='Date up to
-0000c710: 2077 6865 6e20 6869 7374 6f72 6963 616c   when historical
-0000c720: 2064 6174 6120 7769 6c6c 2062 6520 6578   data will be ex
-0000c730: 7472 6163 7465 642e 272c 0a20 2020 2020  tracted.',.     
-0000c740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c750: 2020 2020 2020 706c 6163 6568 6f6c 6465        placeholde
-0000c760: 725f 7661 6c75 653d 2732 3031 372d 3031  r_value='2017-01
-0000c770: 2d30 3154 3030 3a30 303a 3030 5a27 292c  -01T00:00:00Z'),
-0000c780: 0a20 2020 2020 2020 2020 2020 2043 6f6e  .            Con
-0000c790: 6669 6750 726f 7065 7274 7928 2761 6464  figProperty('add
-0000c7a0: 5f65 7874 7261 6374 6564 5f74 696d 6573  _extracted_times
-0000c7b0: 7461 6d70 272c 2027 4164 6420 4578 7472  tamp', 'Add Extr
-0000c7c0: 6163 7465 6420 5469 6d65 7374 616d 7027  acted Timestamp'
-0000c7d0: 2c20 436f 6e66 6967 4174 7472 6962 7574  , ConfigAttribut
-0000c7e0: 6554 7970 652e 424f 4f4c 4541 4e2c 0a20  eType.BOOLEAN,. 
+0000c6f0: 2070 6c61 6365 686f 6c64 6572 5f76 616c   placeholder_val
+0000c700: 7565 3d27 6d79 5f70 7269 6d61 7279 5f6b  ue='my_primary_k
+0000c710: 6579 2729 2c0a 2020 2020 2020 2020 2020  ey'),.          
+0000c720: 2020 436f 6e66 6967 5072 6f70 6572 7479    ConfigProperty
+0000c730: 2827 6669 6c74 6572 7327 2c20 2746 696c  ('filters', 'Fil
+0000c740: 7465 7273 272c 2043 6f6e 6669 6741 7474  ters', ConfigAtt
+0000c750: 7269 6275 7465 5479 7065 2e53 5452 494e  ributeType.STRIN
+0000c760: 472c 2046 616c 7365 2c20 5472 7565 2c0a  G, False, True,.
+0000c770: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c780: 2020 2020 2020 2020 2020 2064 6573 6372             descr
+0000c790: 6970 7469 6f6e 3d27 436f 6d6d 612d 7365  iption='Comma-se
+0000c7a0: 7061 7261 7465 6420 6c69 7374 206f 6620  parated list of 
+0000c7b0: 5748 4552 4520 636c 6175 7365 7320 746f  WHERE clauses to
+0000c7c0: 2066 696c 7465 7220 6578 7472 6163 7465   filter extracte
+0000c7d0: 6420 6461 7461 2c20 270a 2020 2020 2020  d data, '.      
+0000c7e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0000c7f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c800: 2020 2020 2020 2020 2020 4661 6c73 652c            False,
-0000c810: 2046 616c 7365 2c0a 2020 2020 2020 2020   False,.        
+0000c800: 2027 652e 672e 2022 636f 6c75 6d6e 3d5c   'e.g. "column=\
+0000c810: 2776 616c 7565 5c27 222e 272c 0a20 2020  'value\'".',.   
 0000c820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c830: 2020 2064 6573 6372 6970 7469 6f6e 3d27     description='
-0000c840: 4966 2074 7275 6520 6164 6473 206d 6574  If true adds met
-0000c850: 6164 6174 6120 605f 7364 635f 6578 7472  adata `_sdc_extr
-0000c860: 6163 7465 645f 6174 602e 2054 6865 2074  acted_at`. The t
-0000c870: 696d 6573 7461 6d70 206f 6620 7468 6520  imestamp of the 
-0000c880: 7265 636f 7264 270a 2020 2020 2020 2020  record'.        
-0000c890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c8a0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-0000c8b0: 2077 6865 6e20 6974 2077 6173 2065 7874   when it was ext
-0000c8c0: 7261 6374 6564 2066 726f 6d20 7468 6520  racted from the 
-0000c8d0: 736f 7572 6365 2e27 2c0a 2020 2020 2020  source.',.      
-0000c8e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c8f0: 2020 2020 2064 6566 6175 6c74 5f76 616c       default_val
-0000c900: 7565 3d27 6661 6c73 6527 292c 0a20 2020  ue='false'),.   
-0000c910: 2020 2020 2020 2020 2043 6f6e 6669 6750           ConfigP
-0000c920: 726f 7065 7274 7928 276c 696d 6974 272c  roperty('limit',
-0000c930: 2027 4c69 6d69 7427 2c20 436f 6e66 6967   'Limit', Config
-0000c940: 4174 7472 6962 7574 6554 7970 652e 494e  AttributeType.IN
-0000c950: 542c 2046 616c 7365 2c20 4661 6c73 652c  T, False, False,
-0000c960: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000c970: 2020 2020 2020 2020 2020 2020 6465 7363              desc
-0000c980: 7269 7074 696f 6e3d 274c 696d 6974 7320  ription='Limits 
-0000c990: 7468 6520 6e75 6d62 6572 206f 6620 7265  the number of re
-0000c9a0: 636f 7264 7320 7265 7475 726e 6564 2c20  cords returned, 
-0000c9b0: 6170 706c 6965 6420 6173 2061 206c 696d  applied as a lim
-0000c9c0: 6974 2069 6e20 7468 6520 7175 6572 792e  it in the query.
-0000c9d0: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
-0000c9e0: 2020 2020 2020 2020 2020 2020 2020 706c                pl
-0000c9f0: 6163 6568 6f6c 6465 725f 7661 6c75 653d  aceholder_value=
-0000ca00: 2731 3030 3027 292c 0a20 2020 2020 2020  '1000'),.       
-0000ca10: 2020 2020 2043 6f6e 6669 6750 726f 7065       ConfigPrope
-0000ca20: 7274 7928 2773 7461 7274 5f61 6c77 6179  rty('start_alway
-0000ca30: 735f 696e 636c 7573 6976 6527 2c20 2753  s_inclusive', 'S
-0000ca40: 7461 7274 2041 6c77 6179 7320 496e 636c  tart Always Incl
-0000ca50: 7573 6976 6527 2c20 436f 6e66 6967 4174  usive', ConfigAt
-0000ca60: 7472 6962 7574 6554 7970 652e 424f 4f4c  tributeType.BOOL
-0000ca70: 4541 4e2c 0a20 2020 2020 2020 2020 2020  EAN,.           
-0000ca80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ca90: 4661 6c73 652c 2046 616c 7365 2c0a 2020  False, False,.  
-0000caa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cab0: 2020 2020 2020 2020 2064 6573 6372 6970           descrip
-0000cac0: 7469 6f6e 3d27 5768 656e 2072 6570 6c69  tion='When repli
-0000cad0: 6361 7469 6e67 2069 6e63 7265 6d65 6e74  cating increment
-0000cae0: 616c 6c79 2c20 6469 7361 626c 6520 746f  ally, disable to
-0000caf0: 206f 6e6c 7920 7365 6c65 6374 2072 6563   only select rec
-0000cb00: 6f72 6473 2077 686f 7365 2027 0a20 2020  ords whose '.   
-0000cb10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cb20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cb30: 2020 2020 2764 6174 6574 696d 655f 6b65      'datetime_ke
-0000cb40: 7920 6973 2067 7265 6174 6572 2074 6861  y is greater tha
-0000cb50: 6e20 7468 6520 6d61 7869 6d75 6d20 7661  n the maximum va
-0000cb60: 6c75 6520 7265 706c 6963 6174 6564 2069  lue replicated i
-0000cb70: 6e20 7468 6520 6c61 7374 2072 756e 2c20  n the last run, 
-0000cb80: 270a 2020 2020 2020 2020 2020 2020 2020  '.              
-0000cb90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cba0: 2020 2020 2020 2020 2027 6279 2065 7863           'by exc
-0000cbb0: 6c75 6469 6e67 2072 6563 6f72 6473 2077  luding records w
-0000cbc0: 686f 7365 2074 696d 6573 7461 6d70 7320  hose timestamps 
-0000cbd0: 6d61 7463 6820 6578 6163 746c 792e 2054  match exactly. T
-0000cbe0: 6869 7320 636f 756c 6420 6361 7573 6520  his could cause 
-0000cbf0: 7265 636f 7264 7320 270a 2020 2020 2020  records '.      
-0000cc00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cc10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cc20: 2027 746f 2062 6520 6d69 7373 6564 2074   'to be missed t
-0000cc30: 6861 7420 7765 7265 2063 7265 6174 6564  hat were created
-0000cc40: 2061 6674 6572 2074 6865 206c 6173 7420   after the last 
-0000cc50: 7275 6e20 6669 6e69 7368 6564 2c20 6275  run finished, bu
-0000cc60: 7420 6475 7269 6e67 2074 6865 2027 0a20  t during the '. 
-0000cc70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cc80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cc90: 2020 2020 2020 2773 616d 6520 7365 636f        'same seco
-0000cca0: 6e64 2061 6e64 2077 6974 6820 7468 6520  nd and with the 
-0000ccb0: 7361 6d65 2074 696d 6573 7461 6d70 2e27  same timestamp.'
-0000ccc0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000ccd0: 2020 2020 2020 2020 2020 2020 2064 6566               def
-0000cce0: 6175 6c74 5f76 616c 7565 3d27 7472 7565  ault_value='true
-0000ccf0: 2729 0a20 2020 2020 2020 205d 0a0a 2020  ').        ]..  
-0000cd00: 2020 6465 6620 6361 7061 6269 6c69 7469    def capabiliti
-0000cd10: 6573 2873 656c 6629 202d 3e20 6c69 7374  es(self) -> list
-0000cd20: 5b73 7472 5d3a 0a20 2020 2020 2020 2022  [str]:.        "
-0000cd30: 2222 5265 7475 726e 2074 6865 2063 6170  ""Return the cap
-0000cd40: 6162 696c 6974 6965 735b 315d 206f 6620  abilities[1] of 
-0000cd50: 7468 6520 636f 6e6e 6563 746f 722e 0a20  the connector.. 
-0000cd60: 2020 2020 2020 205b 315d 2068 7474 7073         [1] https
-0000cd70: 3a2f 2f64 6f63 732e 6d65 6c74 616e 6f2e  ://docs.meltano.
-0000cd80: 636f 6d2f 636f 6e74 7269 6275 7465 2f70  com/contribute/p
-0000cd90: 6c75 6769 6e73 2368 6f77 2d74 6f2d 7465  lugins#how-to-te
-0000cda0: 7374 2d61 2d74 6170 0a20 2020 2020 2020  st-a-tap.       
-0000cdb0: 2022 2222 0a20 2020 2020 2020 2072 6574   """.        ret
-0000cdc0: 7572 6e20 5b27 6361 7461 6c6f 6727 2c20  urn ['catalog', 
-0000cdd0: 2764 6973 636f 7665 7227 2c20 2773 7461  'discover', 'sta
-0000cde0: 7465 275d 0a0a 2020 2020 4073 7461 7469  te']..    @stati
-0000cdf0: 636d 6574 686f 640a 2020 2020 6465 6620  cmethod.    def 
-0000ce00: 6765 745f 636f 6e66 6967 2869 6e74 6567  get_config(integ
-0000ce10: 7261 7469 6f6e 3a20 6469 6374 2920 2d3e  ration: dict) ->
-0000ce20: 2064 6963 743a 0a20 2020 2020 2020 2074   dict:.        t
-0000ce30: 7279 3a0a 2020 2020 2020 2020 2020 2020  ry:.            
-0000ce40: 7265 7475 726e 207b 0a20 2020 2020 2020  return {.       
-0000ce50: 2020 2020 2020 2020 2023 2052 6571 7569           # Requi
-0000ce60: 7265 6420 636f 6e66 6967 206b 6579 730a  red config keys.
-0000ce70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ce80: 2770 726f 6a65 6374 273a 2069 6e74 6567  'project': integ
-0000ce90: 7261 7469 6f6e 5b27 7072 6f6a 6563 7427  ration['project'
-0000cea0: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
-0000ceb0: 2020 2027 7461 626c 6527 3a20 696e 7465     'table': inte
-0000cec0: 6772 6174 696f 6e5b 2774 6162 6c65 275d  gration['table']
-0000ced0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000cee0: 2020 2763 7265 6465 6e74 6961 6c73 5f66    'credentials_f
-0000cef0: 696c 6527 3a20 696e 7465 6772 6174 696f  ile': integratio
-0000cf00: 6e5b 2763 7265 6465 6e74 6961 6c73 5f66  n['credentials_f
-0000cf10: 696c 6527 5d2c 0a20 2020 2020 2020 2020  ile'],.         
-0000cf20: 2020 2020 2020 2023 204f 7074 696f 6e61         # Optiona
-0000cf30: 6c20 636f 6e66 6967 206b 6579 730a 2020  l config keys.  
-0000cf40: 2020 2020 2020 2020 2020 2020 2020 2763                'c
-0000cf50: 6f6c 756d 6e73 273a 2069 6e74 6567 7261  olumns': integra
-0000cf60: 7469 6f6e 2e67 6574 2827 636f 6c75 6d6e  tion.get('column
-0000cf70: 7327 2c20 272a 2729 2c0a 2020 2020 2020  s', '*'),.      
-0000cf80: 2020 2020 2020 2020 2020 2770 7269 6d61            'prima
-0000cf90: 7279 5f6b 6579 273a 2069 6e74 6567 7261  ry_key': integra
-0000cfa0: 7469 6f6e 2e67 6574 2827 7072 696d 6172  tion.get('primar
-0000cfb0: 795f 6b65 7927 292c 0a20 2020 2020 2020  y_key'),.       
-0000cfc0: 2020 2020 2020 2020 2027 6461 7465 7469           'dateti
-0000cfd0: 6d65 5f6b 6579 273a 2069 6e74 6567 7261  me_key': integra
-0000cfe0: 7469 6f6e 2e67 6574 2827 6461 7465 7469  tion.get('dateti
-0000cff0: 6d65 5f6b 6579 2729 2c0a 2020 2020 2020  me_key'),.      
-0000d000: 2020 2020 2020 2020 2020 2766 696c 7465            'filte
-0000d010: 7273 273a 2069 6e74 6567 7261 7469 6f6e  rs': integration
-0000d020: 2e67 6574 2827 6669 6c74 6572 7327 292c  .get('filters'),
-0000d030: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000d040: 2027 7374 6172 745f 6461 7465 7469 6d65   'start_datetime
-0000d050: 273a 2069 6e74 6567 7261 7469 6f6e 2e67  ': integration.g
-0000d060: 6574 2827 7374 6172 745f 6461 7465 7469  et('start_dateti
-0000d070: 6d65 2729 2c0a 2020 2020 2020 2020 2020  me'),.          
-0000d080: 2020 2020 2020 2765 6e64 5f64 6174 6574        'end_datet
-0000d090: 696d 6527 3a20 696e 7465 6772 6174 696f  ime': integratio
-0000d0a0: 6e2e 6765 7428 2765 6e64 5f64 6174 6574  n.get('end_datet
-0000d0b0: 696d 6527 292c 0a20 2020 2020 2020 2020  ime'),.         
-0000d0c0: 2020 2020 2020 2027 6164 645f 6578 7472         'add_extr
-0000d0d0: 6163 7465 645f 7469 6d65 7374 616d 7027  acted_timestamp'
-0000d0e0: 3a20 696e 7465 6772 6174 696f 6e2e 6765  : integration.ge
-0000d0f0: 7428 2761 6464 5f65 7874 7261 6374 6564  t('add_extracted
-0000d100: 5f74 696d 6573 7461 6d70 272c 2046 616c  _timestamp', Fal
-0000d110: 7365 292c 0a20 2020 2020 2020 2020 2020  se),.           
-0000d120: 2020 2020 2027 6c69 6d69 7427 3a20 696e       'limit': in
-0000d130: 7465 6772 6174 696f 6e2e 6765 7428 276c  tegration.get('l
-0000d140: 696d 6974 2729 2c0a 2020 2020 2020 2020  imit'),.        
-0000d150: 2020 2020 2020 2020 2773 7461 7274 5f61          'start_a
-0000d160: 6c77 6179 735f 696e 636c 7573 6976 6527  lways_inclusive'
-0000d170: 3a20 696e 7465 6772 6174 696f 6e2e 6765  : integration.ge
-0000d180: 7428 2773 7461 7274 5f61 6c77 6179 735f  t('start_always_
-0000d190: 696e 636c 7573 6976 6527 2c20 5472 7565  inclusive', True
-0000d1a0: 292c 0a20 2020 2020 2020 2020 2020 207d  ),.            }
-0000d1b0: 0a20 2020 2020 2020 2065 7863 6570 7420  .        except 
-0000d1c0: 4b65 7945 7272 6f72 2061 7320 653a 0a20  KeyError as e:. 
-0000d1d0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-0000d1e0: 204b 6579 4572 726f 7228 6627 496e 7465   KeyError(f'Inte
-0000d1f0: 6772 6174 696f 6e20 7072 6f70 6572 7479  gration property
-0000d200: 2060 7b65 7d60 206e 6f74 2066 6f75 6e64   `{e}` not found
-0000d210: 2e27 290a 0a0a 6465 6620 6d61 696e 2829  .')...def main()
-0000d220: 3a0a 2020 2020 2222 220a 2020 2020 6d61  :.    """.    ma
-0000d230: 696e 0a20 2020 2022 2222 0a20 2020 2074  in.    """.    t
-0000d240: 7279 3a0a 2020 2020 2020 2020 6d61 696e  ry:.        main
-0000d250: 5f69 6d70 6c28 290a 2020 2020 6578 6365  _impl().    exce
-0000d260: 7074 2045 7863 6570 7469 6f6e 2061 7320  pt Exception as 
-0000d270: 6578 633a 0a20 2020 2020 2020 204c 4f47  exc:.        LOG
-0000d280: 4745 522e 6372 6974 6963 616c 2865 7863  GER.critical(exc
-0000d290: 290a 2020 2020 2020 2020 7261 6973 6520  ).        raise 
-0000d2a0: 6578 630a 0000 0000 0000 0000 0000 0000  exc.............
+0000c830: 2020 2020 2020 2020 706c 6163 6568 6f6c          placehol
+0000c840: 6465 725f 7661 6c75 653d 276d 795f 6669  der_value='my_fi
+0000c850: 6c74 6572 7327 292c 0a20 2020 2020 2020  lters'),.       
+0000c860: 2020 2020 2043 6f6e 6669 6750 726f 7065       ConfigPrope
+0000c870: 7274 7928 2761 6464 5f65 7874 7261 6374  rty('add_extract
+0000c880: 6564 5f74 696d 6573 7461 6d70 272c 2027  ed_timestamp', '
+0000c890: 4164 6420 4578 7472 6163 7465 6420 5469  Add Extracted Ti
+0000c8a0: 6d65 7374 616d 7027 2c20 436f 6e66 6967  mestamp', Config
+0000c8b0: 4174 7472 6962 7574 6554 7970 652e 424f  AttributeType.BO
+0000c8c0: 4f4c 4541 4e2c 0a20 2020 2020 2020 2020  OLEAN,.         
+0000c8d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c8e0: 2020 4661 6c73 652c 2046 616c 7365 2c0a    False, False,.
+0000c8f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c900: 2020 2020 2020 2020 2020 2064 6573 6372             descr
+0000c910: 6970 7469 6f6e 3d27 4966 2074 7275 6520  iption='If true 
+0000c920: 6164 6473 206d 6574 6164 6174 6120 605f  adds metadata `_
+0000c930: 7364 635f 6578 7472 6163 7465 645f 6174  sdc_extracted_at
+0000c940: 602e 2054 6865 2074 696d 6573 7461 6d70  `. The timestamp
+0000c950: 206f 6620 7468 6520 7265 636f 7264 270a   of the record'.
+0000c960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c980: 2020 2020 2020 2027 2077 6865 6e20 6974         ' when it
+0000c990: 2077 6173 2065 7874 7261 6374 6564 2066   was extracted f
+0000c9a0: 726f 6d20 7468 6520 736f 7572 6365 2e27  rom the source.'
+0000c9b0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0000c9c0: 2020 2020 2020 2020 2020 2020 2064 6566               def
+0000c9d0: 6175 6c74 5f76 616c 7565 3d27 6661 6c73  ault_value='fals
+0000c9e0: 6527 292c 0a20 2020 2020 2020 2020 2020  e'),.           
+0000c9f0: 2043 6f6e 6669 6750 726f 7065 7274 7928   ConfigProperty(
+0000ca00: 276c 696d 6974 272c 2027 4c69 6d69 7427  'limit', 'Limit'
+0000ca10: 2c20 436f 6e66 6967 4174 7472 6962 7574  , ConfigAttribut
+0000ca20: 6554 7970 652e 494e 542c 2046 616c 7365  eType.INT, False
+0000ca30: 2c20 4661 6c73 652c 0a20 2020 2020 2020  , False,.       
+0000ca40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ca50: 2020 2020 6465 7363 7269 7074 696f 6e3d      description=
+0000ca60: 2754 6865 206c 696d 6974 2070 6172 616d  'The limit param
+0000ca70: 6574 6572 2069 7320 7573 6564 2074 6f20  eter is used to 
+0000ca80: 636f 6e74 726f 6c20 7468 6520 6e75 6d62  control the numb
+0000ca90: 6572 206f 6620 7265 636f 7264 7320 6578  er of records ex
+0000caa0: 7472 6163 7465 642e 2027 0a20 2020 2020  tracted. '.     
+0000cab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000cac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000cad0: 2020 2754 6f20 7573 6520 7468 6520 6c69    'To use the li
+0000cae0: 6d69 7420 7061 7261 6d65 7465 7220 636f  mit parameter co
+0000caf0: 7272 6563 746c 792c 2070 726f 7669 6465  rrectly, provide
+0000cb00: 2061 6e20 696e 7465 6765 7220 7661 6c75   an integer valu
+0000cb10: 6520 6772 6561 7465 7220 7468 616e 2030  e greater than 0
+0000cb20: 2e27 0a20 2020 2020 2020 2020 2020 2020  .'.             
+0000cb30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000cb40: 2020 2020 2020 2020 2020 2720 4966 206e            ' If n
+0000cb50: 6f20 6c69 6d69 7420 6973 2070 726f 7669  o limit is provi
+0000cb60: 6465 642c 2072 6563 6f72 6473 2077 696c  ded, records wil
+0000cb70: 6c20 6265 2065 7874 7261 6374 6564 2077  l be extracted w
+0000cb80: 6974 686f 7574 2061 6e79 206c 696d 6974  ithout any limit
+0000cb90: 2e27 2c0a 2020 2020 2020 2020 2020 2020  .',.            
+0000cba0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+0000cbb0: 6c61 6365 686f 6c64 6572 5f76 616c 7565  laceholder_value
+0000cbc0: 3d27 3130 3030 2729 0a20 2020 2020 2020  ='1000').       
+0000cbd0: 205d 0a0a 2020 2020 6465 6620 6361 7061   ]..    def capa
+0000cbe0: 6269 6c69 7469 6573 2873 656c 6629 202d  bilities(self) -
+0000cbf0: 3e20 6c69 7374 5b73 7472 5d3a 0a20 2020  > list[str]:.   
+0000cc00: 2020 2020 2022 2222 5265 7475 726e 2074       """Return t
+0000cc10: 6865 2063 6170 6162 696c 6974 6965 735b  he capabilities[
+0000cc20: 315d 206f 6620 7468 6520 636f 6e6e 6563  1] of the connec
+0000cc30: 746f 722e 0a20 2020 2020 2020 205b 315d  tor..        [1]
+0000cc40: 2068 7474 7073 3a2f 2f64 6f63 732e 6d65   https://docs.me
+0000cc50: 6c74 616e 6f2e 636f 6d2f 636f 6e74 7269  ltano.com/contri
+0000cc60: 6275 7465 2f70 6c75 6769 6e73 2368 6f77  bute/plugins#how
+0000cc70: 2d74 6f2d 7465 7374 2d61 2d74 6170 0a20  -to-test-a-tap. 
+0000cc80: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0000cc90: 2020 2072 6574 7572 6e20 5b27 6361 7461     return ['cata
+0000cca0: 6c6f 6727 2c20 2764 6973 636f 7665 7227  log', 'discover'
+0000ccb0: 2c20 2773 7461 7465 275d 0a0a 2020 2020  , 'state']..    
+0000ccc0: 4073 7461 7469 636d 6574 686f 640a 2020  @staticmethod.  
+0000ccd0: 2020 6465 6620 6765 745f 636f 6e66 6967    def get_config
+0000cce0: 2869 6e74 6567 7261 7469 6f6e 3a20 6469  (integration: di
+0000ccf0: 6374 2920 2d3e 2064 6963 743a 0a20 2020  ct) -> dict:.   
+0000cd00: 2020 2020 2074 7279 3a0a 2020 2020 2020       try:.      
+0000cd10: 2020 2020 2020 7265 7475 726e 207b 0a20        return {. 
+0000cd20: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+0000cd30: 2052 6571 7569 7265 6420 636f 6e66 6967   Required config
+0000cd40: 206b 6579 730a 2020 2020 2020 2020 2020   keys.          
+0000cd50: 2020 2020 2020 2770 726f 6a65 6374 273a        'project':
+0000cd60: 2069 6e74 6567 7261 7469 6f6e 5b27 7072   integration['pr
+0000cd70: 6f6a 6563 7427 5d2c 0a20 2020 2020 2020  oject'],.       
+0000cd80: 2020 2020 2020 2020 2027 7461 626c 6527           'table'
+0000cd90: 3a20 696e 7465 6772 6174 696f 6e5b 2774  : integration['t
+0000cda0: 6162 6c65 275d 2c0a 2020 2020 2020 2020  able'],.        
+0000cdb0: 2020 2020 2020 2020 2763 7265 6465 6e74          'credent
+0000cdc0: 6961 6c73 5f66 696c 6527 3a20 696e 7465  ials_file': inte
+0000cdd0: 6772 6174 696f 6e5b 2763 7265 6465 6e74  gration['credent
+0000cde0: 6961 6c73 5f66 696c 6527 5d2c 0a20 2020  ials_file'],.   
+0000cdf0: 2020 2020 2020 2020 2020 2020 2023 204f               # O
+0000ce00: 7074 696f 6e61 6c20 636f 6e66 6967 206b  ptional config k
+0000ce10: 6579 730a 2020 2020 2020 2020 2020 2020  eys.            
+0000ce20: 2020 2020 2763 6f6c 756d 6e73 273a 2069      'columns': i
+0000ce30: 6e74 6567 7261 7469 6f6e 2e67 6574 2827  ntegration.get('
+0000ce40: 636f 6c75 6d6e 7327 2c20 272a 2729 2c0a  columns', '*'),.
+0000ce50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ce60: 2770 7269 6d61 7279 5f6b 6579 273a 2069  'primary_key': i
+0000ce70: 6e74 6567 7261 7469 6f6e 2e67 6574 2827  ntegration.get('
+0000ce80: 7072 696d 6172 795f 6b65 7927 292c 0a20  primary_key'),. 
+0000ce90: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+0000cea0: 6461 7465 7469 6d65 5f6b 6579 273a 2069  datetime_key': i
+0000ceb0: 6e74 6567 7261 7469 6f6e 2e67 6574 2827  ntegration.get('
+0000cec0: 6461 7465 7469 6d65 5f6b 6579 2729 2c0a  datetime_key'),.
+0000ced0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000cee0: 2766 696c 7465 7273 273a 2069 6e74 6567  'filters': integ
+0000cef0: 7261 7469 6f6e 2e67 6574 2827 6669 6c74  ration.get('filt
+0000cf00: 6572 7327 292c 0a20 2020 2020 2020 2020  ers'),.         
+0000cf10: 2020 2020 2020 2027 7374 6172 745f 6461         'start_da
+0000cf20: 7465 7469 6d65 273a 2069 6e74 6567 7261  tetime': integra
+0000cf30: 7469 6f6e 2e67 6574 2827 7374 6172 745f  tion.get('start_
+0000cf40: 6461 7465 7469 6d65 2729 2c0a 2020 2020  datetime'),.    
+0000cf50: 2020 2020 2020 2020 2020 2020 2765 6e64              'end
+0000cf60: 5f64 6174 6574 696d 6527 3a20 696e 7465  _datetime': inte
+0000cf70: 6772 6174 696f 6e2e 6765 7428 2765 6e64  gration.get('end
+0000cf80: 5f64 6174 6574 696d 6527 292c 0a20 2020  _datetime'),.   
+0000cf90: 2020 2020 2020 2020 2020 2020 2027 6164               'ad
+0000cfa0: 645f 6578 7472 6163 7465 645f 7469 6d65  d_extracted_time
+0000cfb0: 7374 616d 7027 3a20 696e 7465 6772 6174  stamp': integrat
+0000cfc0: 696f 6e2e 6765 7428 2761 6464 5f65 7874  ion.get('add_ext
+0000cfd0: 7261 6374 6564 5f74 696d 6573 7461 6d70  racted_timestamp
+0000cfe0: 272c 2046 616c 7365 292c 0a20 2020 2020  ', False),.     
+0000cff0: 2020 2020 2020 2020 2020 2027 6c69 6d69             'limi
+0000d000: 7427 3a20 696e 7465 6772 6174 696f 6e2e  t': integration.
+0000d010: 6765 7428 276c 696d 6974 2729 2c0a 2020  get('limit'),.  
+0000d020: 2020 2020 2020 2020 2020 2020 2020 2773                's
+0000d030: 7461 7274 5f61 6c77 6179 735f 696e 636c  tart_always_incl
+0000d040: 7573 6976 6527 3a20 696e 7465 6772 6174  usive': integrat
+0000d050: 696f 6e2e 6765 7428 2773 7461 7274 5f61  ion.get('start_a
+0000d060: 6c77 6179 735f 696e 636c 7573 6976 6527  lways_inclusive'
+0000d070: 2c20 5472 7565 292c 0a20 2020 2020 2020  , True),.       
+0000d080: 2020 2020 207d 0a20 2020 2020 2020 2065       }.        e
+0000d090: 7863 6570 7420 4b65 7945 7272 6f72 2061  xcept KeyError a
+0000d0a0: 7320 653a 0a20 2020 2020 2020 2020 2020  s e:.           
+0000d0b0: 2072 6169 7365 2056 616c 6964 6174 696f   raise Validatio
+0000d0c0: 6e45 7863 6570 7469 6f6e 2866 2749 6e74  nException(f'Int
+0000d0d0: 6567 7261 7469 6f6e 2070 726f 7065 7274  egration propert
+0000d0e0: 7920 607b 657d 6020 6e6f 7420 666f 756e  y `{e}` not foun
+0000d0f0: 642e 2729 0a0a 0a64 6566 206d 6169 6e28  d.')...def main(
+0000d100: 293a 0a20 2020 2022 2222 0a20 2020 206d  ):.    """.    m
+0000d110: 6169 6e0a 2020 2020 2222 220a 2020 2020  ain.    """.    
+0000d120: 7472 793a 0a20 2020 2020 2020 206d 6169  try:.        mai
+0000d130: 6e5f 696d 706c 2829 0a20 2020 2065 7863  n_impl().    exc
+0000d140: 6570 7420 4578 6365 7074 696f 6e20 6173  ept Exception as
+0000d150: 2065 7863 3a0a 2020 2020 2020 2020 4c4f   exc:.        LO
+0000d160: 4747 4552 2e63 7269 7469 6361 6c28 6578  GGER.critical(ex
+0000d170: 6329 0a20 2020 2020 2020 2072 6169 7365  c).        raise
+0000d180: 2065 7863 0a00 0000 0000 0000 0000 0000   exc............
+0000d190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000d1a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000d1b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000d1c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000d1d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000d1e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000d1f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000d200: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+0000d210: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000d220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000d230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000d240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000d250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000d260: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+0000d270: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+0000d280: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+0000d290: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
+0000d2a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d2b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d2c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d2d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d2e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d2f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000d300: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 0000d310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -3386,31 +3386,31 @@
 0000d390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d3a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d3b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d3c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d3d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d3e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d3f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d400: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-0000d410: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000d400: 3232 206d 7469 6d65 3d31 3639 3038 3739  22 mtime=1690879
+0000d410: 3730 362e 300a 0000 0000 0000 0000 0000  706.0...........
 0000d420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d460: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-0000d470: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-0000d480: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-0000d490: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
+0000d460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000d470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000d480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000d490: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d4a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d4b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d4c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d4d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d4e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d4f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d500: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+0000d500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -3418,287 +3418,287 @@
 0000d590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d5a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d5b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d5c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d5d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d5e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d5f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d600: 3232 206d 7469 6d65 3d31 3638 3132 3134  22 mtime=1681214
-0000d610: 3536 312e 300a 0000 0000 0000 0000 0000  561.0...........
-0000d620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000d600: 6d61 6372 6f6d 6574 612d 736f 7572 6365  macrometa-source
+0000d610: 2d62 6967 7175 6572 792d 312e 302e 302f  -bigquery-1.0.0/
+0000d620: 6d61 6372 6f6d 6574 615f 736f 7572 6365  macrometa_source
+0000d630: 5f62 6967 7175 6572 792f 7361 6d70 6c65  _bigquery/sample
+0000d640: 5f64 6174 612e 7079 0000 0000 0000 0000  _data.py........
 0000d650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d690: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000d660: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
+0000d670: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+0000d680: 3030 3036 3230 3400 3134 3436 3231 3433  0006204.14462143
+0000d690: 3333 3200 3032 3632 3733 0020 3000 0000  332.026273. 0...
 0000d6a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d6b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d6c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d6d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d6e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d6f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d700: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000d700: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
 0000d710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000d720: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
 0000d730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d7a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d7b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d7c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d7d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d7e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d7f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d800: 6d61 6372 6f6d 6574 612d 736f 7572 6365  macrometa-source
-0000d810: 2d62 6967 7175 6572 792d 302e 302e 392f  -bigquery-0.0.9/
-0000d820: 6d61 6372 6f6d 6574 615f 736f 7572 6365  macrometa_source
-0000d830: 5f62 6967 7175 6572 792f 7361 6d70 6c65  _bigquery/sample
-0000d840: 5f64 6174 612e 7079 0000 0000 0000 0000  _data.py........
-0000d850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d860: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
-0000d870: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
-0000d880: 3030 3036 3036 3400 3134 3431 3532 3436  0006064.14415246
-0000d890: 3134 3100 3032 3633 3037 0020 3000 0000  141.026307. 0...
-0000d8a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d8b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d8c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d8d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d8e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d8f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d900: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
-0000d910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d920: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
-0000d930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d9a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d9b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d9c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d9d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d9e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d9f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000da00: 696d 706f 7274 2064 6174 6575 7469 6c2e  import dateutil.
-0000da10: 7061 7273 6572 0a69 6d70 6f72 7420 6461  parser.import da
-0000da20: 7465 7469 6d65 0a69 6d70 6f72 7420 7369  tetime.import si
-0000da30: 6e67 6572 0a0a 6672 6f6d 2067 6f6f 676c  nger..from googl
-0000da40: 652e 6f61 7574 6832 2069 6d70 6f72 7420  e.oauth2 import 
-0000da50: 7365 7276 6963 655f 6163 636f 756e 740a  service_account.
-0000da60: 6672 6f6d 2067 6f6f 676c 652e 636c 6f75  from google.clou
-0000da70: 6420 696d 706f 7274 2062 6967 7175 6572  d import bigquer
-0000da80: 790a 6672 6f6d 2073 696e 6765 7220 696d  y.from singer im
-0000da90: 706f 7274 206d 6574 6164 6174 610a 6672  port metadata.fr
-0000daa0: 6f6d 206d 6163 726f 6d65 7461 5f73 6f75  om macrometa_sou
-0000dab0: 7263 655f 6269 6771 7565 7279 2e73 796e  rce_bigquery.syn
-0000dac0: 635f 6269 6771 7565 7279 2069 6d70 6f72  c_bigquery impor
-0000dad0: 7420 5f62 7569 6c64 5f71 7565 7279 2c20  t _build_query, 
-0000dae0: 726f 775f 746f 5f72 6563 6f72 642c 2073  row_to_record, s
-0000daf0: 686f 756c 645f 7379 6e63 5f63 6f6c 756d  hould_sync_colum
-0000db00: 6e0a 0a0a 6465 6620 6665 7463 685f 7461  n...def fetch_ta
-0000db10: 626c 6528 636f 6e6e 5f69 6e66 6f2c 2073  ble(conn_info, s
-0000db20: 7472 6561 6d29 3a0a 2020 2020 7361 6d70  tream):.    samp
-0000db30: 6c65 7320 3d20 5b5d 0a20 2020 2063 7265  les = [].    cre
-0000db40: 6465 6e74 6961 6c73 203d 2073 6572 7669  dentials = servi
-0000db50: 6365 5f61 6363 6f75 6e74 2e43 7265 6465  ce_account.Crede
-0000db60: 6e74 6961 6c73 2e66 726f 6d5f 7365 7276  ntials.from_serv
-0000db70: 6963 655f 6163 636f 756e 745f 6669 6c65  ice_account_file
-0000db80: 2863 6f6e 6e5f 696e 666f 5b27 6372 6564  (conn_info['cred
-0000db90: 656e 7469 616c 735f 6669 6c65 275d 290a  entials_file']).
-0000dba0: 2020 2020 636c 6965 6e74 203d 2062 6967      client = big
-0000dbb0: 7175 6572 792e 436c 6965 6e74 2870 726f  query.Client(pro
-0000dbc0: 6a65 6374 3d63 6f6e 6e5f 696e 666f 5b27  ject=conn_info['
-0000dbd0: 7072 6f6a 6563 7427 5d2c 2063 7265 6465  project'], crede
-0000dbe0: 6e74 6961 6c73 3d63 7265 6465 6e74 6961  ntials=credentia
-0000dbf0: 6c73 290a 0a20 2020 2073 7461 7274 5f64  ls)..    start_d
-0000dc00: 6174 6574 696d 6520 3d20 4e6f 6e65 0a20  atetime = None. 
-0000dc10: 2020 2069 6620 636f 6e6e 5f69 6e66 6f2e     if conn_info.
-0000dc20: 6765 7428 2273 7461 7274 5f64 6174 6574  get("start_datet
-0000dc30: 696d 6522 293a 0a20 2020 2020 2020 2073  ime"):.        s
-0000dc40: 7461 7274 5f64 6174 6574 696d 6520 3d20  tart_datetime = 
-0000dc50: 6461 7465 7574 696c 2e70 6172 7365 722e  dateutil.parser.
-0000dc60: 7061 7273 6528 0a20 2020 2020 2020 2020  parse(.         
-0000dc70: 2020 2063 6f6e 6e5f 696e 666f 2e67 6574     conn_info.get
-0000dc80: 2822 7374 6172 745f 6461 7465 7469 6d65  ("start_datetime
-0000dc90: 2229 292e 7374 7266 7469 6d65 2822 2559  ")).strftime("%Y
-0000dca0: 2d25 6d2d 2564 2025 483a 254d 3a25 532e  -%m-%d %H:%M:%S.
-0000dcb0: 2566 2229 0a0a 2020 2020 656e 645f 6461  %f")..    end_da
-0000dcc0: 7465 7469 6d65 203d 204e 6f6e 650a 2020  tetime = None.  
-0000dcd0: 2020 6966 2063 6f6e 6e5f 696e 666f 2e67    if conn_info.g
-0000dce0: 6574 2822 656e 645f 6461 7465 7469 6d65  et("end_datetime
-0000dcf0: 2229 3a0a 2020 2020 2020 2020 656e 645f  "):.        end_
-0000dd00: 6461 7465 7469 6d65 203d 2064 6174 6575  datetime = dateu
-0000dd10: 7469 6c2e 7061 7273 6572 2e70 6172 7365  til.parser.parse
-0000dd20: 280a 2020 2020 2020 2020 2020 2020 636f  (.            co
-0000dd30: 6e6e 5f69 6e66 6f2e 6765 7428 2265 6e64  nn_info.get("end
-0000dd40: 5f64 6174 6574 696d 6522 2929 2e73 7472  _datetime")).str
-0000dd50: 6674 696d 6528 2225 592d 256d 2d25 6420  ftime("%Y-%m-%d 
-0000dd60: 2548 3a25 4d3a 2553 2e25 6622 290a 0a20  %H:%M:%S.%f").. 
-0000dd70: 2020 206b 6579 7320 3d20 7b22 7461 626c     keys = {"tabl
-0000dd80: 6522 3a20 636f 6e6e 5f69 6e66 6f5b 2274  e": conn_info["t
-0000dd90: 6162 6c65 225d 2c0a 2020 2020 2020 2020  able"],.        
-0000dda0: 2020 2020 2263 6f6c 756d 6e73 223a 2063      "columns": c
-0000ddb0: 6f6e 6e5f 696e 666f 5b22 636f 6c75 6d6e  onn_info["column
-0000ddc0: 7322 5d2c 0a20 2020 2020 2020 2020 2020  s"],.           
-0000ddd0: 2022 6461 7465 7469 6d65 5f6b 6579 223a   "datetime_key":
-0000dde0: 2063 6f6e 6e5f 696e 666f 2e67 6574 2822   conn_info.get("
-0000ddf0: 6461 7465 7469 6d65 5f6b 6579 2229 2c0a  datetime_key"),.
-0000de00: 2020 2020 2020 2020 2020 2020 2273 7461              "sta
-0000de10: 7274 5f64 6174 6574 696d 6522 3a20 7374  rt_datetime": st
-0000de20: 6172 745f 6461 7465 7469 6d65 2c0a 2020  art_datetime,.  
-0000de30: 2020 2020 2020 2020 2020 2265 6e64 5f64            "end_d
-0000de40: 6174 6574 696d 6522 3a20 656e 645f 6461  atetime": end_da
-0000de50: 7465 7469 6d65 0a20 2020 2020 2020 2020  tetime.         
-0000de60: 2020 207d 0a0a 2020 2020 7175 6572 7920     }..    query 
-0000de70: 3d20 5f62 7569 6c64 5f71 7565 7279 286b  = _build_query(k
-0000de80: 6579 732c 2063 6f6e 6e5f 696e 666f 2e67  eys, conn_info.g
-0000de90: 6574 2822 6669 6c74 6572 7322 2c20 5b5d  et("filters", []
-0000dea0: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-0000deb0: 2020 2020 2020 2020 2020 2020 6c69 6d69              limi
-0000dec0: 743d 3130 290a 2020 2020 7175 6572 795f  t=10).    query_
-0000ded0: 6a6f 6220 3d20 636c 6965 6e74 2e71 7565  job = client.que
-0000dee0: 7279 2871 7565 7279 290a 2020 2020 7072  ry(query).    pr
-0000def0: 6f70 6572 7469 6573 203d 2073 7472 6561  operties = strea
-0000df00: 6d5b 2773 6368 656d 6127 5d5b 2770 726f  m['schema']['pro
-0000df10: 7065 7274 6965 7327 5d0a 2020 2020 6578  perties'].    ex
-0000df20: 7472 6163 745f 7473 7461 6d70 203d 2064  tract_tstamp = d
-0000df30: 6174 6574 696d 652e 6461 7465 7469 6d65  atetime.datetime
-0000df40: 2e75 7463 6e6f 7728 290a 2020 2020 6578  .utcnow().    ex
-0000df50: 7472 6163 745f 7473 7461 6d70 203d 2065  tract_tstamp = e
-0000df60: 7874 7261 6374 5f74 7374 616d 702e 7265  xtract_tstamp.re
-0000df70: 706c 6163 6528 747a 696e 666f 3d64 6174  place(tzinfo=dat
-0000df80: 6574 696d 652e 7469 6d65 7a6f 6e65 2e75  etime.timezone.u
-0000df90: 7463 290a 2020 2020 666f 7220 726f 7720  tc).    for row 
-0000dfa0: 696e 2071 7565 7279 5f6a 6f62 3a0a 2020  in query_job:.  
-0000dfb0: 2020 2020 2020 7265 636f 7264 203d 2072        record = r
-0000dfc0: 6f77 5f74 6f5f 7265 636f 7264 2872 6f77  ow_to_record(row
-0000dfd0: 2c20 7072 6f70 6572 7469 6573 2c20 6578  , properties, ex
-0000dfe0: 7472 6163 745f 7473 7461 6d70 2c20 7573  tract_tstamp, us
-0000dff0: 655f 6469 6374 3d54 7275 6529 0a20 2020  e_dict=True).   
-0000e000: 2020 2020 2072 6563 5f6d 7367 203d 2073       rec_msg = s
-0000e010: 696e 6765 722e 5265 636f 7264 4d65 7373  inger.RecordMess
-0000e020: 6167 6528 0a20 2020 2020 2020 2020 2020  age(.           
-0000e030: 2073 7472 6561 6d3d 7374 7265 616d 5b27   stream=stream['
-0000e040: 7374 7265 616d 275d 2c0a 2020 2020 2020  stream'],.      
-0000e050: 2020 2020 2020 7265 636f 7264 3d72 6563        record=rec
-0000e060: 6f72 642c 0a20 2020 2020 2020 2020 2020  ord,.           
-0000e070: 2076 6572 7369 6f6e 3d4e 6f6e 652c 0a20   version=None,. 
-0000e080: 2020 2020 2020 2020 2020 2074 696d 655f             time_
-0000e090: 6578 7472 6163 7465 643d 4e6f 6e65 290a  extracted=None).
-0000e0a0: 2020 2020 2020 2020 7361 6d70 6c65 732e          samples.
-0000e0b0: 6170 7065 6e64 2872 6563 5f6d 7367 2e72  append(rec_msg.r
-0000e0c0: 6563 6f72 6429 0a20 2020 2072 6574 7572  ecord).    retur
-0000e0d0: 6e20 7361 6d70 6c65 730a 0a0a 6465 6620  n samples...def 
-0000e0e0: 6665 7463 685f 7361 6d70 6c65 7328 636f  fetch_samples(co
-0000e0f0: 6e6e 5f63 6f6e 6669 672c 2073 7472 6561  nn_config, strea
-0000e100: 6d29 3a0a 2020 2020 2222 220a 2020 2020  m):.    """.    
-0000e110: 4665 7463 6820 7361 6d70 6c65 7320 666f  Fetch samples fo
-0000e120: 7220 7468 6520 7374 7265 616d 2e0a 2020  r the stream..  
-0000e130: 2020 2222 220a 2020 2020 6d64 5f6d 6170    """.    md_map
-0000e140: 203d 206d 6574 6164 6174 612e 746f 5f6d   = metadata.to_m
-0000e150: 6170 2873 7472 6561 6d5b 276d 6574 6164  ap(stream['metad
-0000e160: 6174 6127 5d29 0a20 2020 2064 6573 6972  ata']).    desir
-0000e170: 6564 5f63 6f6c 756d 6e73 203d 205b 6320  ed_columns = [c 
-0000e180: 666f 7220 6320 696e 2073 7472 6561 6d5b  for c in stream[
-0000e190: 2773 6368 656d 6127 5d5b 2770 726f 7065  'schema']['prope
-0000e1a0: 7274 6965 7327 5d2e 6b65 7973 2829 2069  rties'].keys() i
-0000e1b0: 6620 7368 6f75 6c64 5f73 796e 635f 636f  f should_sync_co
-0000e1c0: 6c75 6d6e 286d 645f 6d61 702c 2063 295d  lumn(md_map, c)]
-0000e1d0: 0a20 2020 2064 6573 6972 6564 5f63 6f6c  .    desired_col
-0000e1e0: 756d 6e73 2e73 6f72 7428 290a 2020 2020  umns.sort().    
-0000e1f0: 6966 206c 656e 2864 6573 6972 6564 5f63  if len(desired_c
-0000e200: 6f6c 756d 6e73 2920 3d3d 2030 3a0a 2020  olumns) == 0:.  
-0000e210: 2020 2020 2020 2320 5468 6572 6520 6172        # There ar
-0000e220: 6520 6e6f 2063 6f6c 756d 6e73 2073 656c  e no columns sel
-0000e230: 6563 7465 6420 666f 7220 7374 7265 616d  ected for stream
-0000e240: 2e20 536f 2c20 736b 6970 7069 6e67 2069  . So, skipping i
-0000e250: 742e 0a20 2020 2020 2020 2072 6574 7572  t..        retur
-0000e260: 6e20 5b5d 0a20 2020 2073 7461 7465 203d  n [].    state =
-0000e270: 2066 6574 6368 5f74 6162 6c65 2863 6f6e   fetch_table(con
-0000e280: 6e5f 636f 6e66 6967 2c20 7374 7265 616d  n_config, stream
-0000e290: 290a 0a20 2020 2023 2041 7070 656e 6469  )..    # Appendi
-0000e2a0: 6e67 205f 2074 6f20 6b65 7973 2066 6f72  ng _ to keys for
-0000e2b0: 2070 7265 7365 7276 696e 6720 7661 6c75   preserving valu
-0000e2c0: 6573 206f 6620 7265 7365 7276 6564 206b  es of reserved k
-0000e2d0: 6579 7320 696e 2073 6f75 7263 6520 6461  eys in source da
-0000e2e0: 7461 0a20 2020 2072 6573 6572 7665 645f  ta.    reserved_
-0000e2f0: 6b65 7973 203d 205b 275f 6b65 7927 2c20  keys = ['_key', 
-0000e300: 275f 6964 272c 2027 5f72 6576 275d 0a20  '_id', '_rev']. 
-0000e310: 2020 2069 6620 6d64 5f6d 6170 2e67 6574     if md_map.get
-0000e320: 2828 292c 207b 7d29 2e67 6574 2827 7461  ((), {}).get('ta
-0000e330: 626c 652d 6b65 792d 7072 6f70 6572 7469  ble-key-properti
-0000e340: 6573 2729 3a0a 2020 2020 2020 2020 6b65  es'):.        ke
-0000e350: 795f 7072 6f70 6572 7469 6573 203d 206d  y_properties = m
-0000e360: 645f 6d61 702e 6765 7428 2829 2c20 7b7d  d_map.get((), {}
-0000e370: 292e 6765 7428 2774 6162 6c65 2d6b 6579  ).get('table-key
-0000e380: 2d70 726f 7065 7274 6965 7327 290a 2020  -properties').  
-0000e390: 2020 2020 2020 6966 206b 6579 5f70 726f        if key_pro
-0000e3a0: 7065 7274 6965 735b 305d 203d 3d20 275f  perties[0] == '_
-0000e3b0: 6b65 7927 3a0a 2020 2020 2020 2020 2020  key':.          
-0000e3c0: 2020 7265 7365 7276 6564 5f6b 6579 732e    reserved_keys.
-0000e3d0: 7265 6d6f 7665 2827 5f6b 6579 2729 0a20  remove('_key'). 
-0000e3e0: 2020 2063 6f6c 756d 6e73 203d 2073 6574     columns = set
-0000e3f0: 2864 6573 6972 6564 5f63 6f6c 756d 6e73  (desired_columns
-0000e400: 290a 2020 2020 6966 2061 6e79 286b 6579  ).    if any(key
-0000e410: 2069 6e20 636f 6c75 6d6e 7320 666f 7220   in columns for 
-0000e420: 6b65 7920 696e 2072 6573 6572 7665 645f  key in reserved_
-0000e430: 6b65 7973 293a 0a20 2020 2020 2020 2066  keys):.        f
-0000e440: 6f72 2072 6563 6f72 6420 696e 2073 7461  or record in sta
-0000e450: 7465 3a0a 2020 2020 2020 2020 2020 2020  te:.            
-0000e460: 7265 636f 7264 203d 206d 6f64 6966 795f  record = modify_
-0000e470: 7265 7365 7276 6564 5f6b 6579 7328 7265  reserved_keys(re
-0000e480: 636f 7264 2c20 7265 7365 7276 6564 5f6b  cord, reserved_k
-0000e490: 6579 7329 0a0a 2020 2020 7265 7475 726e  eys)..    return
-0000e4a0: 2073 7461 7465 0a0a 0a64 6566 206d 6f64   state...def mod
-0000e4b0: 6966 795f 7265 7365 7276 6564 5f6b 6579  ify_reserved_key
-0000e4c0: 7328 7265 636f 7264 2c20 7265 7365 7276  s(record, reserv
-0000e4d0: 6564 5f6b 6579 7329 3a0a 2020 2020 666f  ed_keys):.    fo
-0000e4e0: 7220 7265 7365 7276 6564 5f6b 6579 2069  r reserved_key i
-0000e4f0: 6e20 7265 7365 7276 6564 5f6b 6579 733a  n reserved_keys:
-0000e500: 0a20 2020 2020 2020 2069 6620 7265 636f  .        if reco
-0000e510: 7264 2e67 6574 2872 6573 6572 7665 645f  rd.get(reserved_
-0000e520: 6b65 7929 3a0a 2020 2020 2020 2020 2020  key):.          
-0000e530: 2020 6e65 775f 6b65 7920 3d20 225f 2220    new_key = "_" 
-0000e540: 2b20 7265 7365 7276 6564 5f6b 6579 0a20  + reserved_key. 
-0000e550: 2020 2020 2020 2020 2020 2077 6869 6c65             while
-0000e560: 2054 7275 653a 0a20 2020 2020 2020 2020   True:.         
-0000e570: 2020 2020 2020 2069 6620 7265 636f 7264         if record
-0000e580: 2e67 6574 286e 6577 5f6b 6579 293a 0a20  .get(new_key):. 
-0000e590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e5a0: 2020 206e 6577 5f6b 6579 203d 2022 5f22     new_key = "_"
-0000e5b0: 202b 206e 6577 5f6b 6579 0a20 2020 2020   + new_key.     
-0000e5c0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-0000e5d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000e5e0: 2020 2020 2062 7265 616b 0a20 2020 2020       break.     
-0000e5f0: 2020 2020 2020 2072 6563 6f72 645b 6e65         record[ne
-0000e600: 775f 6b65 795d 203d 2072 6563 6f72 642e  w_key] = record.
-0000e610: 706f 7028 7265 7365 7276 6564 5f6b 6579  pop(reserved_key
-0000e620: 290a 2020 2020 7265 7475 726e 2072 6563  ).    return rec
-0000e630: 6f72 640a 0000 0000 0000 0000 0000 0000  ord.............
+0000d800: 696d 706f 7274 2064 6174 6575 7469 6c2e  import dateutil.
+0000d810: 7061 7273 6572 0a69 6d70 6f72 7420 6461  parser.import da
+0000d820: 7465 7469 6d65 0a69 6d70 6f72 7420 7369  tetime.import si
+0000d830: 6e67 6572 0a0a 6672 6f6d 2073 696e 6765  nger..from singe
+0000d840: 7220 696d 706f 7274 2075 7469 6c73 0a66  r import utils.f
+0000d850: 726f 6d20 676f 6f67 6c65 2e6f 6175 7468  rom google.oauth
+0000d860: 3220 696d 706f 7274 2073 6572 7669 6365  2 import service
+0000d870: 5f61 6363 6f75 6e74 0a66 726f 6d20 676f  _account.from go
+0000d880: 6f67 6c65 2e63 6c6f 7564 2069 6d70 6f72  ogle.cloud impor
+0000d890: 7420 6269 6771 7565 7279 0a66 726f 6d20  t bigquery.from 
+0000d8a0: 7369 6e67 6572 2069 6d70 6f72 7420 6d65  singer import me
+0000d8b0: 7461 6461 7461 0a66 726f 6d20 6d61 6372  tadata.from macr
+0000d8c0: 6f6d 6574 615f 736f 7572 6365 5f62 6967  ometa_source_big
+0000d8d0: 7175 6572 792e 7379 6e63 5f62 6967 7175  query.sync_bigqu
+0000d8e0: 6572 7920 696d 706f 7274 205f 6275 696c  ery import _buil
+0000d8f0: 645f 7175 6572 792c 2072 6f77 5f74 6f5f  d_query, row_to_
+0000d900: 7265 636f 7264 2c20 7368 6f75 6c64 5f73  record, should_s
+0000d910: 796e 635f 636f 6c75 6d6e 0a0a 0a64 6566  ync_column...def
+0000d920: 2066 6574 6368 5f74 6162 6c65 2863 6f6e   fetch_table(con
+0000d930: 6e5f 696e 666f 2c20 7374 7265 616d 293a  n_info, stream):
+0000d940: 0a20 2020 2073 616d 706c 6573 203d 205b  .    samples = [
+0000d950: 5d0a 2020 2020 6372 6564 656e 7469 616c  ].    credential
+0000d960: 7320 3d20 7365 7276 6963 655f 6163 636f  s = service_acco
+0000d970: 756e 742e 4372 6564 656e 7469 616c 732e  unt.Credentials.
+0000d980: 6672 6f6d 5f73 6572 7669 6365 5f61 6363  from_service_acc
+0000d990: 6f75 6e74 5f66 696c 6528 636f 6e6e 5f69  ount_file(conn_i
+0000d9a0: 6e66 6f5b 2763 7265 6465 6e74 6961 6c73  nfo['credentials
+0000d9b0: 5f66 696c 6527 5d29 0a20 2020 2063 6c69  _file']).    cli
+0000d9c0: 656e 7420 3d20 6269 6771 7565 7279 2e43  ent = bigquery.C
+0000d9d0: 6c69 656e 7428 7072 6f6a 6563 743d 636f  lient(project=co
+0000d9e0: 6e6e 5f69 6e66 6f5b 2770 726f 6a65 6374  nn_info['project
+0000d9f0: 275d 2c20 6372 6564 656e 7469 616c 733d  '], credentials=
+0000da00: 6372 6564 656e 7469 616c 7329 0a0a 2020  credentials)..  
+0000da10: 2020 7374 6172 745f 6461 7465 7469 6d65    start_datetime
+0000da20: 203d 204e 6f6e 650a 2020 2020 6966 2063   = None.    if c
+0000da30: 6f6e 6e5f 696e 666f 2e67 6574 2822 7374  onn_info.get("st
+0000da40: 6172 745f 6461 7465 7469 6d65 2229 3a0a  art_datetime"):.
+0000da50: 2020 2020 2020 2020 7374 6172 745f 6461          start_da
+0000da60: 7465 7469 6d65 203d 2064 6174 6575 7469  tetime = dateuti
+0000da70: 6c2e 7061 7273 6572 2e70 6172 7365 280a  l.parser.parse(.
+0000da80: 2020 2020 2020 2020 2020 2020 636f 6e6e              conn
+0000da90: 5f69 6e66 6f2e 6765 7428 2273 7461 7274  _info.get("start
+0000daa0: 5f64 6174 6574 696d 6522 2929 2e73 7472  _datetime")).str
+0000dab0: 6674 696d 6528 2225 592d 256d 2d25 6420  ftime("%Y-%m-%d 
+0000dac0: 2548 3a25 4d3a 2553 2e25 6622 290a 0a20  %H:%M:%S.%f").. 
+0000dad0: 2020 2065 6e64 5f64 6174 6574 696d 6520     end_datetime 
+0000dae0: 3d20 4e6f 6e65 0a20 2020 2069 6620 636f  = None.    if co
+0000daf0: 6e6e 5f69 6e66 6f2e 6765 7428 2265 6e64  nn_info.get("end
+0000db00: 5f64 6174 6574 696d 6522 293a 0a20 2020  _datetime"):.   
+0000db10: 2020 2020 2065 6e64 5f64 6174 6574 696d       end_datetim
+0000db20: 6520 3d20 6461 7465 7574 696c 2e70 6172  e = dateutil.par
+0000db30: 7365 722e 7061 7273 6528 0a20 2020 2020  ser.parse(.     
+0000db40: 2020 2020 2020 2063 6f6e 6e5f 696e 666f         conn_info
+0000db50: 2e67 6574 2822 656e 645f 6461 7465 7469  .get("end_dateti
+0000db60: 6d65 2229 292e 7374 7266 7469 6d65 2822  me")).strftime("
+0000db70: 2559 2d25 6d2d 2564 2025 483a 254d 3a25  %Y-%m-%d %H:%M:%
+0000db80: 532e 2566 2229 0a0a 2020 2020 6b65 7973  S.%f")..    keys
+0000db90: 203d 207b 2274 6162 6c65 223a 2063 6f6e   = {"table": con
+0000dba0: 6e5f 696e 666f 5b22 7461 626c 6522 5d2c  n_info["table"],
+0000dbb0: 0a20 2020 2020 2020 2020 2020 2022 636f  .            "co
+0000dbc0: 6c75 6d6e 7322 3a20 7374 7265 616d 5b27  lumns": stream['
+0000dbd0: 6d65 7461 6461 7461 275d 5b30 5d5b 276d  metadata'][0]['m
+0000dbe0: 6574 6164 6174 6127 5d5b 2263 6f6c 756d  etadata']["colum
+0000dbf0: 6e73 225d 2c0a 2020 2020 2020 2020 2020  ns"],.          
+0000dc00: 2020 2264 6174 6574 696d 655f 6b65 7922    "datetime_key"
+0000dc10: 3a20 636f 6e6e 5f69 6e66 6f2e 6765 7428  : conn_info.get(
+0000dc20: 2264 6174 6574 696d 655f 6b65 7922 292c  "datetime_key"),
+0000dc30: 0a20 2020 2020 2020 2020 2020 2022 7374  .            "st
+0000dc40: 6172 745f 6461 7465 7469 6d65 223a 2073  art_datetime": s
+0000dc50: 7461 7274 5f64 6174 6574 696d 652c 0a20  tart_datetime,. 
+0000dc60: 2020 2020 2020 2020 2020 2022 656e 645f             "end_
+0000dc70: 6461 7465 7469 6d65 223a 2065 6e64 5f64  datetime": end_d
+0000dc80: 6174 6574 696d 650a 2020 2020 2020 2020  atetime.        
+0000dc90: 2020 2020 7d0a 0a20 2020 2071 7565 7279      }..    query
+0000dca0: 203d 205f 6275 696c 645f 7175 6572 7928   = _build_query(
+0000dcb0: 6b65 7973 2c20 7374 7265 616d 5b27 6d65  keys, stream['me
+0000dcc0: 7461 6461 7461 275d 5b30 5d5b 276d 6574  tadata'][0]['met
+0000dcd0: 6164 6174 6127 5d2e 6765 7428 2266 696c  adata'].get("fil
+0000dce0: 7465 7273 222c 205b 5d29 2c0a 2020 2020  ters", []),.    
+0000dcf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000dd00: 2020 2020 206c 696d 6974 3d31 3029 0a20       limit=10). 
+0000dd10: 2020 2071 7565 7279 5f6a 6f62 203d 2063     query_job = c
+0000dd20: 6c69 656e 742e 7175 6572 7928 7175 6572  lient.query(quer
+0000dd30: 7929 0a20 2020 2070 726f 7065 7274 6965  y).    propertie
+0000dd40: 7320 3d20 7374 7265 616d 5b27 7363 6865  s = stream['sche
+0000dd50: 6d61 275d 5b27 7072 6f70 6572 7469 6573  ma']['properties
+0000dd60: 275d 0a20 2020 2065 7874 7261 6374 5f74  '].    extract_t
+0000dd70: 7374 616d 7020 3d20 6461 7465 7469 6d65  stamp = datetime
+0000dd80: 2e64 6174 6574 696d 652e 7574 636e 6f77  .datetime.utcnow
+0000dd90: 2829 0a20 2020 2065 7874 7261 6374 5f74  ().    extract_t
+0000dda0: 7374 616d 7020 3d20 6578 7472 6163 745f  stamp = extract_
+0000ddb0: 7473 7461 6d70 2e72 6570 6c61 6365 2874  tstamp.replace(t
+0000ddc0: 7a69 6e66 6f3d 6461 7465 7469 6d65 2e74  zinfo=datetime.t
+0000ddd0: 696d 657a 6f6e 652e 7574 6329 0a20 2020  imezone.utc).   
+0000dde0: 2066 6f72 2072 6f77 2069 6e20 7175 6572   for row in quer
+0000ddf0: 795f 6a6f 623a 0a20 2020 2020 2020 2072  y_job:.        r
+0000de00: 6563 6f72 6420 3d20 726f 775f 746f 5f72  ecord = row_to_r
+0000de10: 6563 6f72 6428 726f 772c 2070 726f 7065  ecord(row, prope
+0000de20: 7274 6965 732c 2065 7874 7261 6374 5f74  rties, extract_t
+0000de30: 7374 616d 702c 2075 7365 5f64 6963 743d  stamp, use_dict=
+0000de40: 5472 7565 290a 2020 2020 2020 2020 7265  True).        re
+0000de50: 635f 6d73 6720 3d20 7369 6e67 6572 2e52  c_msg = singer.R
+0000de60: 6563 6f72 644d 6573 7361 6765 280a 2020  ecordMessage(.  
+0000de70: 2020 2020 2020 2020 2020 7374 7265 616d            stream
+0000de80: 3d73 7472 6561 6d5b 2773 7472 6561 6d27  =stream['stream'
+0000de90: 5d2c 0a20 2020 2020 2020 2020 2020 2072  ],.            r
+0000dea0: 6563 6f72 643d 7265 636f 7264 2c0a 2020  ecord=record,.  
+0000deb0: 2020 2020 2020 2020 2020 7665 7273 696f            versio
+0000dec0: 6e3d 4e6f 6e65 2c0a 2020 2020 2020 2020  n=None,.        
+0000ded0: 2020 2020 7469 6d65 5f65 7874 7261 6374      time_extract
+0000dee0: 6564 3d75 7469 6c73 2e6e 6f77 2829 290a  ed=utils.now()).
+0000def0: 2020 2020 2020 2020 7361 6d70 6c65 732e          samples.
+0000df00: 6170 7065 6e64 2872 6563 5f6d 7367 2e72  append(rec_msg.r
+0000df10: 6563 6f72 6429 0a20 2020 2072 6574 7572  ecord).    retur
+0000df20: 6e20 7361 6d70 6c65 730a 0a0a 6465 6620  n samples...def 
+0000df30: 6665 7463 685f 7361 6d70 6c65 7328 636f  fetch_samples(co
+0000df40: 6e6e 5f63 6f6e 6669 672c 2073 7472 6561  nn_config, strea
+0000df50: 6d29 3a0a 2020 2020 2222 220a 2020 2020  m):.    """.    
+0000df60: 4665 7463 6820 7361 6d70 6c65 7320 666f  Fetch samples fo
+0000df70: 7220 7468 6520 7374 7265 616d 2e0a 2020  r the stream..  
+0000df80: 2020 2222 220a 2020 2020 6d64 5f6d 6170    """.    md_map
+0000df90: 203d 206d 6574 6164 6174 612e 746f 5f6d   = metadata.to_m
+0000dfa0: 6170 2873 7472 6561 6d5b 276d 6574 6164  ap(stream['metad
+0000dfb0: 6174 6127 5d29 0a20 2020 2064 6573 6972  ata']).    desir
+0000dfc0: 6564 5f63 6f6c 756d 6e73 203d 205b 6320  ed_columns = [c 
+0000dfd0: 666f 7220 6320 696e 2073 7472 6561 6d5b  for c in stream[
+0000dfe0: 2773 6368 656d 6127 5d5b 2770 726f 7065  'schema']['prope
+0000dff0: 7274 6965 7327 5d2e 6b65 7973 2829 2069  rties'].keys() i
+0000e000: 6620 7368 6f75 6c64 5f73 796e 635f 636f  f should_sync_co
+0000e010: 6c75 6d6e 286d 645f 6d61 702c 2063 295d  lumn(md_map, c)]
+0000e020: 0a20 2020 2064 6573 6972 6564 5f63 6f6c  .    desired_col
+0000e030: 756d 6e73 2e73 6f72 7428 290a 2020 2020  umns.sort().    
+0000e040: 6966 206c 656e 2864 6573 6972 6564 5f63  if len(desired_c
+0000e050: 6f6c 756d 6e73 2920 3d3d 2030 3a0a 2020  olumns) == 0:.  
+0000e060: 2020 2020 2020 2320 5468 6572 6520 6172        # There ar
+0000e070: 6520 6e6f 2063 6f6c 756d 6e73 2073 656c  e no columns sel
+0000e080: 6563 7465 6420 666f 7220 7374 7265 616d  ected for stream
+0000e090: 2e20 536f 2c20 736b 6970 7069 6e67 2069  . So, skipping i
+0000e0a0: 742e 0a20 2020 2020 2020 2072 6574 7572  t..        retur
+0000e0b0: 6e20 5b5d 0a20 2020 2073 7461 7465 203d  n [].    state =
+0000e0c0: 2066 6574 6368 5f74 6162 6c65 2863 6f6e   fetch_table(con
+0000e0d0: 6e5f 636f 6e66 6967 2c20 7374 7265 616d  n_config, stream
+0000e0e0: 290a 0a20 2020 2023 2041 7070 656e 6469  )..    # Appendi
+0000e0f0: 6e67 205f 2074 6f20 6b65 7973 2066 6f72  ng _ to keys for
+0000e100: 2070 7265 7365 7276 696e 6720 7661 6c75   preserving valu
+0000e110: 6573 206f 6620 7265 7365 7276 6564 206b  es of reserved k
+0000e120: 6579 7320 696e 2073 6f75 7263 6520 6461  eys in source da
+0000e130: 7461 0a20 2020 2072 6573 6572 7665 645f  ta.    reserved_
+0000e140: 6b65 7973 203d 205b 275f 6b65 7927 2c20  keys = ['_key', 
+0000e150: 275f 6964 272c 2027 5f72 6576 275d 0a20  '_id', '_rev']. 
+0000e160: 2020 2069 6620 6d64 5f6d 6170 2e67 6574     if md_map.get
+0000e170: 2828 292c 207b 7d29 2e67 6574 2827 7461  ((), {}).get('ta
+0000e180: 626c 652d 6b65 792d 7072 6f70 6572 7469  ble-key-properti
+0000e190: 6573 2729 3a0a 2020 2020 2020 2020 6b65  es'):.        ke
+0000e1a0: 795f 7072 6f70 6572 7469 6573 203d 206d  y_properties = m
+0000e1b0: 645f 6d61 702e 6765 7428 2829 2c20 7b7d  d_map.get((), {}
+0000e1c0: 292e 6765 7428 2774 6162 6c65 2d6b 6579  ).get('table-key
+0000e1d0: 2d70 726f 7065 7274 6965 7327 290a 2020  -properties').  
+0000e1e0: 2020 2020 2020 6966 206b 6579 5f70 726f        if key_pro
+0000e1f0: 7065 7274 6965 735b 305d 203d 3d20 275f  perties[0] == '_
+0000e200: 6b65 7927 3a0a 2020 2020 2020 2020 2020  key':.          
+0000e210: 2020 7265 7365 7276 6564 5f6b 6579 732e    reserved_keys.
+0000e220: 7265 6d6f 7665 2827 5f6b 6579 2729 0a20  remove('_key'). 
+0000e230: 2020 2063 6f6c 756d 6e73 203d 2073 6574     columns = set
+0000e240: 2864 6573 6972 6564 5f63 6f6c 756d 6e73  (desired_columns
+0000e250: 290a 2020 2020 6966 2061 6e79 286b 6579  ).    if any(key
+0000e260: 2069 6e20 636f 6c75 6d6e 7320 666f 7220   in columns for 
+0000e270: 6b65 7920 696e 2072 6573 6572 7665 645f  key in reserved_
+0000e280: 6b65 7973 293a 0a20 2020 2020 2020 2066  keys):.        f
+0000e290: 6f72 2072 6563 6f72 6420 696e 2073 7461  or record in sta
+0000e2a0: 7465 3a0a 2020 2020 2020 2020 2020 2020  te:.            
+0000e2b0: 7265 636f 7264 203d 206d 6f64 6966 795f  record = modify_
+0000e2c0: 7265 7365 7276 6564 5f6b 6579 7328 7265  reserved_keys(re
+0000e2d0: 636f 7264 2c20 7265 7365 7276 6564 5f6b  cord, reserved_k
+0000e2e0: 6579 7329 0a0a 2020 2020 7265 7475 726e  eys)..    return
+0000e2f0: 2073 7461 7465 0a0a 0a64 6566 206d 6f64   state...def mod
+0000e300: 6966 795f 7265 7365 7276 6564 5f6b 6579  ify_reserved_key
+0000e310: 7328 7265 636f 7264 2c20 7265 7365 7276  s(record, reserv
+0000e320: 6564 5f6b 6579 7329 3a0a 2020 2020 666f  ed_keys):.    fo
+0000e330: 7220 7265 7365 7276 6564 5f6b 6579 2069  r reserved_key i
+0000e340: 6e20 7265 7365 7276 6564 5f6b 6579 733a  n reserved_keys:
+0000e350: 0a20 2020 2020 2020 2069 6620 7265 636f  .        if reco
+0000e360: 7264 2e67 6574 2872 6573 6572 7665 645f  rd.get(reserved_
+0000e370: 6b65 7929 3a0a 2020 2020 2020 2020 2020  key):.          
+0000e380: 2020 6e65 775f 6b65 7920 3d20 225f 2220    new_key = "_" 
+0000e390: 2b20 7265 7365 7276 6564 5f6b 6579 0a20  + reserved_key. 
+0000e3a0: 2020 2020 2020 2020 2020 2077 6869 6c65             while
+0000e3b0: 2054 7275 653a 0a20 2020 2020 2020 2020   True:.         
+0000e3c0: 2020 2020 2020 2069 6620 7265 636f 7264         if record
+0000e3d0: 2e67 6574 286e 6577 5f6b 6579 293a 0a20  .get(new_key):. 
+0000e3e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e3f0: 2020 206e 6577 5f6b 6579 203d 2022 5f22     new_key = "_"
+0000e400: 202b 206e 6577 5f6b 6579 0a20 2020 2020   + new_key.     
+0000e410: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+0000e420: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000e430: 2020 2020 2062 7265 616b 0a20 2020 2020       break.     
+0000e440: 2020 2020 2020 2072 6563 6f72 645b 6e65         record[ne
+0000e450: 775f 6b65 795d 203d 2072 6563 6f72 642e  w_key] = record.
+0000e460: 706f 7028 7265 7365 7276 6564 5f6b 6579  pop(reserved_key
+0000e470: 290a 2020 2020 7265 7475 726e 2072 6563  ).    return rec
+0000e480: 6f72 640a 0000 0000 0000 0000 0000 0000  ord.............
+0000e490: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e4a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e4b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e4c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e4d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e4e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e4f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e5a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e5b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e5c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e5d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e5e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e5f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e600: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+0000e610: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000e640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000e650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e690: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e660: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+0000e670: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+0000e680: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+0000e690: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
 0000e6a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000e6b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000e6c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000e6d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000e6e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000e6f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e700: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e700: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 0000e710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000e720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000e730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000e740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000e750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000e760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000e770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -3706,31 +3706,31 @@
 0000e790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000e7a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000e7b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000e7c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000e7d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000e7e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000e7f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e800: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-0000e810: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e800: 3232 206d 7469 6d65 3d31 3639 3038 3739  22 mtime=1690879
+0000e810: 3730 362e 300a 0000 0000 0000 0000 0000  706.0...........
 0000e820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000e830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000e840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000e850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e860: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-0000e870: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-0000e880: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-0000e890: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
+0000e860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000e890: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000e8a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000e8b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000e8c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000e8d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000e8e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000e8f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000e900: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+0000e900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000e910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000e920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000e930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000e940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000e950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000e960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000e970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -3738,703 +3738,703 @@
 0000e990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000e9a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000e9b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000e9c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000e9d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000e9e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000e9f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ea00: 3232 206d 7469 6d65 3d31 3638 3132 3134  22 mtime=1681214
-0000ea10: 3536 312e 300a 0000 0000 0000 0000 0000  561.0...........
-0000ea20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ea30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ea40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000ea00: 6d61 6372 6f6d 6574 612d 736f 7572 6365  macrometa-source
+0000ea10: 2d62 6967 7175 6572 792d 312e 302e 302f  -bigquery-1.0.0/
+0000ea20: 6d61 6372 6f6d 6574 615f 736f 7572 6365  macrometa_source
+0000ea30: 5f62 6967 7175 6572 792f 7379 6e63 5f62  _bigquery/sync_b
+0000ea40: 6967 7175 6572 792e 7079 0000 0000 0000  igquery.py......
 0000ea50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ea60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ea70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ea80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ea90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000ea60: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
+0000ea70: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+0000ea80: 3030 3233 3135 3300 3134 3436 3231 3433  0023153.14462143
+0000ea90: 3333 3200 3032 3637 3036 0020 3000 0000  332.026706. 0...
 0000eaa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000eab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000eac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000ead0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000eae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000eaf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000eb00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000eb00: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
 0000eb10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000eb20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000eb20: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
 0000eb30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000eb40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000eb50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000eb60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000eb70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000eb80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000eb90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000eba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000ebb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000ebc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000ebd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000ebe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000ebf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ec00: 6d61 6372 6f6d 6574 612d 736f 7572 6365  macrometa-source
-0000ec10: 2d62 6967 7175 6572 792d 302e 302e 392f  -bigquery-0.0.9/
-0000ec20: 6d61 6372 6f6d 6574 615f 736f 7572 6365  macrometa_source
-0000ec30: 5f62 6967 7175 6572 792f 7379 6e63 5f62  _bigquery/sync_b
-0000ec40: 6967 7175 6572 792e 7079 0000 0000 0000  igquery.py......
-0000ec50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ec60: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
-0000ec70: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
-0000ec80: 3030 3233 3036 3100 3134 3431 3532 3436  0023061.14415246
-0000ec90: 3134 3100 3032 3637 3134 0020 3000 0000  141.026714. 0...
-0000eca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ecb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ecc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ecd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ece0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ecf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ed00: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
-0000ed10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ed20: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
-0000ed30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ed40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ed50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ed60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ed70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ed80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ed90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000eda0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000edb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000edc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000edd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ede0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000edf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ee00: 696d 706f 7274 2064 6174 6574 696d 652c  import datetime,
-0000ee10: 206a 736f 6e2c 2074 696d 650a 696d 706f   json, time.impo
-0000ee20: 7274 2064 6174 6575 7469 6c2e 7061 7273  rt dateutil.pars
-0000ee30: 6572 0a66 726f 6d20 6465 6369 6d61 6c20  er.from decimal 
-0000ee40: 696d 706f 7274 2044 6563 696d 616c 0a0a  import Decimal..
-0000ee50: 696d 706f 7274 2073 696e 6765 720a 696d  import singer.im
-0000ee60: 706f 7274 2073 696e 6765 722e 6d65 7472  port singer.metr
-0000ee70: 6963 7320 6173 206d 6574 7269 6373 0a69  ics as metrics.i
-0000ee80: 6d70 6f72 7420 7575 6964 0a0a 6672 6f6d  mport uuid..from
-0000ee90: 2067 6f6f 676c 652e 6f61 7574 6832 2069   google.oauth2 i
-0000eea0: 6d70 6f72 7420 7365 7276 6963 655f 6163  mport service_ac
-0000eeb0: 636f 756e 740a 6672 6f6d 2067 6f6f 676c  count.from googl
-0000eec0: 652e 636c 6f75 6420 696d 706f 7274 2062  e.cloud import b
-0000eed0: 6967 7175 6572 790a 6672 6f6d 2070 6174  igquery.from pat
-0000eee0: 686c 6962 2069 6d70 6f72 7420 5061 7468  hlib import Path
-0000eef0: 0a66 726f 6d20 7479 7069 6e67 2069 6d70  .from typing imp
-0000ef00: 6f72 7420 4469 6374 0a0a 696d 706f 7274  ort Dict..import
-0000ef10: 2067 6574 7363 6865 6d61 0a0a 0a4c 4f47   getschema...LOG
-0000ef20: 4745 5220 3d20 7369 6e67 6572 2e67 6574  GER = singer.get
-0000ef30: 5f6c 6f67 6765 7228 226d 6163 726f 6d65  _logger("macrome
-0000ef40: 7461 5f73 6f75 7263 655f 6269 6771 7565  ta_source_bigque
-0000ef50: 7279 2229 0a0a 2320 5374 6974 6368 4461  ry")..# StitchDa
-0000ef60: 7461 2063 6f6d 7061 7469 626c 6520 7469  ta compatible ti
-0000ef70: 6d65 7374 616d 7020 6d65 7461 2064 6174  mestamp meta dat
-0000ef80: 610a 2320 2068 7474 7073 3a2f 2f77 7777  a.#  https://www
-0000ef90: 2e73 7469 7463 6864 6174 612e 636f 6d2f  .stitchdata.com/
-0000efa0: 646f 6373 2f64 6174 612d 7374 7275 6374  docs/data-struct
-0000efb0: 7572 652f 7379 7374 656d 2d74 6162 6c65  ure/system-table
-0000efc0: 732d 616e 642d 636f 6c75 6d6e 730a 2320  s-and-columns.# 
-0000efd0: 5468 6520 7469 6d65 7374 616d 7020 6f66  The timestamp of
-0000efe0: 2074 6865 2072 6563 6f72 6420 6578 7472   the record extr
-0000eff0: 6163 7465 6420 6672 6f6d 2074 6865 2073  acted from the s
-0000f000: 6f75 7263 650a 4558 5452 4143 545f 5449  ource.EXTRACT_TI
-0000f010: 4d45 5354 414d 5020 3d20 225f 7364 635f  MESTAMP = "_sdc_
-0000f020: 6578 7472 6163 7465 645f 6174 220a 0a42  extracted_at"..B
-0000f030: 4f4f 4b4d 4152 4b5f 4b45 595f 4e41 4d45  OOKMARK_KEY_NAME
-0000f040: 203d 2022 6c61 7374 5f75 7064 6174 6522   = "last_update"
-0000f050: 0a0a 0a64 6566 205f 6275 696c 645f 7175  ...def _build_qu
-0000f060: 6572 7928 6b65 7973 2c20 6669 6c74 6572  ery(keys, filter
-0000f070: 733d 5b5d 2c20 696e 636c 7573 6976 655f  s=[], inclusive_
-0000f080: 7374 6172 743d 5472 7565 2c20 6c69 6d69  start=True, limi
-0000f090: 743d 4e6f 6e65 293a 0a20 2020 2063 6f6c  t=None):.    col
-0000f0a0: 756d 6e73 203d 2022 2c22 2e6a 6f69 6e28  umns = ",".join(
-0000f0b0: 6b65 7973 5b22 636f 6c75 6d6e 7322 5d29  keys["columns"])
-0000f0c0: 0a20 2020 2069 6620 6b65 7973 2e67 6574  .    if keys.get
-0000f0d0: 2822 6461 7465 7469 6d65 5f6b 6579 2229  ("datetime_key")
-0000f0e0: 3a0a 2020 2020 2020 2020 6966 2022 2a22  :.        if "*"
-0000f0f0: 206e 6f74 2069 6e20 636f 6c75 6d6e 7320   not in columns 
-0000f100: 616e 6420 6b65 7973 5b22 6461 7465 7469  and keys["dateti
-0000f110: 6d65 5f6b 6579 225d 206e 6f74 2069 6e20  me_key"] not in 
-0000f120: 636f 6c75 6d6e 733a 0a20 2020 2020 2020  columns:.       
-0000f130: 2020 2020 2063 6f6c 756d 6e73 203d 2063       columns = c
-0000f140: 6f6c 756d 6e73 202b 2022 2c22 202b 206b  olumns + "," + k
-0000f150: 6579 735b 2264 6174 6574 696d 655f 6b65  eys["datetime_ke
-0000f160: 7922 5d0a 2020 2020 6b65 7973 5b22 636f  y"].    keys["co
-0000f170: 6c75 6d6e 7322 5d20 3d20 636f 6c75 6d6e  lumns"] = column
-0000f180: 730a 0a20 2020 2071 7565 7279 203d 2022  s..    query = "
-0000f190: 5345 4c45 4354 207b 636f 6c75 6d6e 737d  SELECT {columns}
-0000f1a0: 2046 524f 4d20 7b74 6162 6c65 7d20 5748   FROM {table} WH
-0000f1b0: 4552 4520 313d 3122 2e66 6f72 6d61 7428  ERE 1=1".format(
-0000f1c0: 2a2a 6b65 7973 290a 0a20 2020 2069 6620  **keys)..    if 
-0000f1d0: 6669 6c74 6572 733a 0a20 2020 2020 2020  filters:.       
-0000f1e0: 2066 6f72 2066 2069 6e20 6669 6c74 6572   for f in filter
-0000f1f0: 733a 0a20 2020 2020 2020 2020 2020 2071  s:.            q
-0000f200: 7565 7279 203d 2071 7565 7279 202b 2022  uery = query + "
-0000f210: 2041 4e44 2022 202b 2066 0a0a 2020 2020   AND " + f..    
-0000f220: 6966 206b 6579 732e 6765 7428 2264 6174  if keys.get("dat
-0000f230: 6574 696d 655f 6b65 7922 2920 616e 6420  etime_key") and 
-0000f240: 6b65 7973 2e67 6574 2822 7374 6172 745f  keys.get("start_
-0000f250: 6461 7465 7469 6d65 2229 3a0a 2020 2020  datetime"):.    
-0000f260: 2020 2020 6966 2069 6e63 6c75 7369 7665      if inclusive
-0000f270: 5f73 7461 7274 3a0a 2020 2020 2020 2020  _start:.        
-0000f280: 2020 2020 7175 6572 7920 3d20 2871 7565      query = (que
-0000f290: 7279 202b 0a20 2020 2020 2020 2020 2020  ry +.           
-0000f2a0: 2020 2020 2020 2020 2020 2822 2041 4e44            (" AND
-0000f2b0: 2064 6174 6574 696d 6520 277b 7374 6172   datetime '{star
-0000f2c0: 745f 6461 7465 7469 6d65 7d27 203c 3d20  t_datetime}' <= 
-0000f2d0: 2220 2b0a 2020 2020 2020 2020 2020 2020  " +.            
-0000f2e0: 2020 2020 2020 2020 2020 2243 4153 5428            "CAST(
-0000f2f0: 7b64 6174 6574 696d 655f 6b65 797d 2061  {datetime_key} a
-0000f300: 7320 6461 7465 7469 6d65 2922 292e 666f  s datetime)").fo
-0000f310: 726d 6174 282a 2a6b 6579 7329 290a 2020  rmat(**keys)).  
-0000f320: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-0000f330: 2020 2020 2020 2020 7175 6572 7920 3d20          query = 
-0000f340: 2871 7565 7279 202b 0a20 2020 2020 2020  (query +.       
-0000f350: 2020 2020 2020 2020 2020 2020 2020 2822                ("
-0000f360: 2041 4e44 2064 6174 6574 696d 6520 277b   AND datetime '{
-0000f370: 7374 6172 745f 6461 7465 7469 6d65 7d27  start_datetime}'
-0000f380: 203c 2022 202b 0a20 2020 2020 2020 2020   < " +.         
-0000f390: 2020 2020 2020 2020 2020 2020 2022 4341               "CA
-0000f3a0: 5354 287b 6461 7465 7469 6d65 5f6b 6579  ST({datetime_key
-0000f3b0: 7d20 6173 2064 6174 6574 696d 6529 2229  } as datetime)")
-0000f3c0: 2e66 6f72 6d61 7428 2a2a 6b65 7973 2929  .format(**keys))
-0000f3d0: 0a0a 2020 2020 6966 206b 6579 732e 6765  ..    if keys.ge
-0000f3e0: 7428 2264 6174 6574 696d 655f 6b65 7922  t("datetime_key"
-0000f3f0: 2920 616e 6420 6b65 7973 2e67 6574 2822  ) and keys.get("
-0000f400: 656e 645f 6461 7465 7469 6d65 2229 3a0a  end_datetime"):.
-0000f410: 2020 2020 2020 2020 7175 6572 7920 3d20          query = 
-0000f420: 2871 7565 7279 202b 0a20 2020 2020 2020  (query +.       
-0000f430: 2020 2020 2020 2020 2020 2822 2041 4e44            (" AND
-0000f440: 2043 4153 5428 7b64 6174 6574 696d 655f   CAST({datetime_
-0000f450: 6b65 797d 2061 7320 6461 7465 7469 6d65  key} as datetime
-0000f460: 2920 3c20 2220 2b0a 2020 2020 2020 2020  ) < " +.        
-0000f470: 2020 2020 2020 2020 2020 2264 6174 6574            "datet
-0000f480: 696d 6520 277b 656e 645f 6461 7465 7469  ime '{end_dateti
-0000f490: 6d65 7d27 2229 2e66 6f72 6d61 7428 2a2a  me}'").format(**
-0000f4a0: 6b65 7973 2929 0a20 2020 2069 6620 6b65  keys)).    if ke
-0000f4b0: 7973 2e67 6574 2822 6461 7465 7469 6d65  ys.get("datetime
-0000f4c0: 5f6b 6579 2229 3a0a 2020 2020 2020 2020  _key"):.        
-0000f4d0: 7175 6572 7920 3d20 2871 7565 7279 202b  query = (query +
-0000f4e0: 2022 204f 5244 4552 2042 5920 7b64 6174   " ORDER BY {dat
-0000f4f0: 6574 696d 655f 6b65 797d 222e 666f 726d  etime_key}".form
-0000f500: 6174 282a 2a6b 6579 7329 290a 0a20 2020  at(**keys))..   
-0000f510: 2069 6620 6c69 6d69 7420 6973 206e 6f74   if limit is not
-0000f520: 204e 6f6e 653a 0a20 2020 2020 2020 2071   None:.        q
-0000f530: 7565 7279 203d 2071 7565 7279 202b 2022  uery = query + "
-0000f540: 204c 494d 4954 2025 6422 2025 2069 6e74   LIMIT %d" % int
-0000f550: 286c 696d 6974 290a 0a20 2020 2072 6574  (limit)..    ret
-0000f560: 7572 6e20 7175 6572 790a 0a0a 6465 6620  urn query...def 
-0000f570: 646f 5f64 6973 636f 7665 7228 636f 6e66  do_discover(conf
-0000f580: 6967 2c20 7374 7265 616d 2c20 6f75 7470  ig, stream, outp
-0000f590: 7574 5f73 6368 656d 615f 6669 6c65 3d4e  ut_schema_file=N
-0000f5a0: 6f6e 652c 0a20 2020 2020 2020 2020 2020  one,.           
-0000f5b0: 2020 2020 2061 6464 5f74 696d 6573 7461       add_timesta
-0000f5c0: 6d70 3d46 616c 7365 293a 0a20 2020 2063  mp=False):.    c
-0000f5d0: 7265 6465 6e74 6961 6c73 203d 2073 6572  redentials = ser
-0000f5e0: 7669 6365 5f61 6363 6f75 6e74 2e43 7265  vice_account.Cre
-0000f5f0: 6465 6e74 6961 6c73 2e66 726f 6d5f 7365  dentials.from_se
-0000f600: 7276 6963 655f 6163 636f 756e 745f 6669  rvice_account_fi
-0000f610: 6c65 2863 6f6e 6669 675b 2763 7265 6465  le(config['crede
-0000f620: 6e74 6961 6c73 5f66 696c 6527 5d29 0a20  ntials_file']). 
-0000f630: 2020 2063 6c69 656e 7420 3d20 6269 6771     client = bigq
-0000f640: 7565 7279 2e43 6c69 656e 7428 7072 6f6a  uery.Client(proj
-0000f650: 6563 743d 636f 6e66 6967 5b27 7072 6f6a  ect=config['proj
-0000f660: 6563 7427 5d2c 2063 7265 6465 6e74 6961  ect'], credentia
-0000f670: 6c73 3d63 7265 6465 6e74 6961 6c73 290a  ls=credentials).
-0000f680: 0a20 2020 2073 7461 7274 5f64 6174 6574  .    start_datet
-0000f690: 696d 6520 3d20 4e6f 6e65 0a20 2020 2069  ime = None.    i
-0000f6a0: 6620 636f 6e66 6967 2e67 6574 2822 7374  f config.get("st
-0000f6b0: 6172 745f 6461 7465 7469 6d65 2229 3a0a  art_datetime"):.
-0000f6c0: 2020 2020 2020 2020 7374 6172 745f 6461          start_da
-0000f6d0: 7465 7469 6d65 203d 2064 6174 6575 7469  tetime = dateuti
-0000f6e0: 6c2e 7061 7273 6572 2e70 6172 7365 280a  l.parser.parse(.
-0000f6f0: 2020 2020 2020 2020 2020 2020 636f 6e66              conf
-0000f700: 6967 2e67 6574 2822 7374 6172 745f 6461  ig.get("start_da
-0000f710: 7465 7469 6d65 2229 292e 7374 7266 7469  tetime")).strfti
-0000f720: 6d65 2822 2559 2d25 6d2d 2564 2025 483a  me("%Y-%m-%d %H:
-0000f730: 254d 3a25 532e 2566 2229 0a0a 2020 2020  %M:%S.%f")..    
-0000f740: 656e 645f 6461 7465 7469 6d65 203d 204e  end_datetime = N
-0000f750: 6f6e 650a 2020 2020 6966 2063 6f6e 6669  one.    if confi
-0000f760: 672e 6765 7428 2265 6e64 5f64 6174 6574  g.get("end_datet
-0000f770: 696d 6522 293a 0a20 2020 2020 2020 2065  ime"):.        e
-0000f780: 6e64 5f64 6174 6574 696d 6520 3d20 6461  nd_datetime = da
-0000f790: 7465 7574 696c 2e70 6172 7365 722e 7061  teutil.parser.pa
-0000f7a0: 7273 6528 0a20 2020 2020 2020 2020 2020  rse(.           
-0000f7b0: 2063 6f6e 6669 672e 6765 7428 2265 6e64   config.get("end
-0000f7c0: 5f64 6174 6574 696d 6522 2929 2e73 7472  _datetime")).str
-0000f7d0: 6674 696d 6528 2225 592d 256d 2d25 6420  ftime("%Y-%m-%d 
-0000f7e0: 2548 3a25 4d3a 2553 2e25 6622 290a 0a20  %H:%M:%S.%f").. 
-0000f7f0: 2020 206b 6579 7320 3d20 7b22 7461 626c     keys = {"tabl
-0000f800: 6522 3a20 7374 7265 616d 5b22 7461 626c  e": stream["tabl
-0000f810: 6522 5d2c 0a20 2020 2020 2020 2020 2020  e"],.           
-0000f820: 2022 636f 6c75 6d6e 7322 3a20 7374 7265   "columns": stre
-0000f830: 616d 5b22 636f 6c75 6d6e 7322 5d2c 0a20  am["columns"],. 
-0000f840: 2020 2020 2020 2020 2020 2022 6461 7465             "date
-0000f850: 7469 6d65 5f6b 6579 223a 2073 7472 6561  time_key": strea
-0000f860: 6d2e 6765 7428 2264 6174 6574 696d 655f  m.get("datetime_
-0000f870: 6b65 7922 292c 0a20 2020 2020 2020 2020  key"),.         
-0000f880: 2020 2022 7374 6172 745f 6461 7465 7469     "start_dateti
-0000f890: 6d65 223a 2073 7461 7274 5f64 6174 6574  me": start_datet
-0000f8a0: 696d 652c 0a20 2020 2020 2020 2020 2020  ime,.           
-0000f8b0: 2022 656e 645f 6461 7465 7469 6d65 223a   "end_datetime":
-0000f8c0: 2065 6e64 5f64 6174 6574 696d 650a 2020   end_datetime.  
-0000f8d0: 2020 2020 2020 2020 2020 7d0a 2020 2020            }.    
-0000f8e0: 6c69 6d69 7420 3d20 636f 6e66 6967 2e67  limit = config.g
-0000f8f0: 6574 2822 6c69 6d69 7422 2c20 3130 3029  et("limit", 100)
-0000f900: 0a20 2020 2071 7565 7279 203d 205f 6275  .    query = _bu
-0000f910: 696c 645f 7175 6572 7928 6b65 7973 2c20  ild_query(keys, 
-0000f920: 7374 7265 616d 2e67 6574 2822 6669 6c74  stream.get("filt
-0000f930: 6572 7322 292c 206c 696d 6974 3d6c 696d  ers"), limit=lim
-0000f940: 6974 290a 0a20 2020 204c 4f47 4745 522e  it)..    LOGGER.
-0000f950: 696e 666f 2822 5275 6e6e 696e 6720 7175  info("Running qu
-0000f960: 6572 793a 5c6e 2020 2020 2220 2b20 7175  ery:\n    " + qu
-0000f970: 6572 7929 0a0a 2020 2020 7175 6572 795f  ery)..    query_
-0000f980: 6a6f 6220 3d20 636c 6965 6e74 2e71 7565  job = client.que
-0000f990: 7279 2871 7565 7279 290a 2020 2020 7265  ry(query).    re
-0000f9a0: 7375 6c74 7320 3d20 7175 6572 795f 6a6f  sults = query_jo
-0000f9b0: 622e 7265 7375 6c74 2829 2020 2320 5761  b.result()  # Wa
-0000f9c0: 6974 7320 666f 7220 6a6f 6220 746f 2063  its for job to c
-0000f9d0: 6f6d 706c 6574 652e 0a0a 2020 2020 6461  omplete...    da
-0000f9e0: 7461 203d 205b 5d0a 2020 2020 2320 5265  ta = [].    # Re
-0000f9f0: 6164 2065 7665 7279 7468 696e 6720 7570  ad everything up
-0000fa00: 6672 6f6e 740a 2020 2020 666f 7220 726f  front.    for ro
-0000fa10: 7720 696e 2072 6573 756c 7473 3a0a 2020  w in results:.  
-0000fa20: 2020 2020 2020 7265 636f 7264 203d 207b        record = {
-0000fa30: 7d0a 2020 2020 2020 2020 666f 7220 6b65  }.        for ke
-0000fa40: 7920 696e 2072 6f77 2e6b 6579 7328 293a  y in row.keys():
-0000fa50: 0a20 2020 2020 2020 2020 2020 2072 6563  .            rec
-0000fa60: 6f72 645b 6b65 795d 203d 2072 6f77 5b6b  ord[key] = row[k
-0000fa70: 6579 5d0a 2020 2020 2020 2020 6461 7461  ey].        data
-0000fa80: 2e61 7070 656e 6428 7265 636f 7264 290a  .append(record).
-0000fa90: 0a20 2020 2069 6620 6e6f 7420 6461 7461  .    if not data
-0000faa0: 3a0a 2020 2020 2020 2020 7261 6973 6520  :.        raise 
-0000fab0: 4578 6365 7074 696f 6e28 2243 616e 6e6f  Exception("Canno
-0000fac0: 7420 696e 6665 7220 7363 6865 6d61 3a20  t infer schema: 
-0000fad0: 4e6f 2072 6563 6f72 6420 7265 7475 726e  No record return
-0000fae0: 6564 2e22 290a 0a20 2020 2073 6368 656d  ed.")..    schem
-0000faf0: 6120 3d20 6765 7473 6368 656d 612e 696e  a = getschema.in
-0000fb00: 6665 725f 7363 6865 6d61 2864 6174 6129  fer_schema(data)
-0000fb10: 0a20 2020 2069 6620 6164 645f 7469 6d65  .    if add_time
-0000fb20: 7374 616d 703a 0a20 2020 2020 2020 2074  stamp:.        t
-0000fb30: 696d 6573 7461 6d70 5f66 6f72 6d61 7420  imestamp_format 
-0000fb40: 3d20 7b22 7479 7065 223a 205b 226e 756c  = {"type": ["nul
-0000fb50: 6c22 2c20 2273 7472 696e 6722 5d2c 0a20  l", "string"],. 
-0000fb60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fb70: 2020 2020 2020 2020 2020 2022 666f 726d             "form
-0000fb80: 6174 223a 2022 6461 7465 2d74 696d 6522  at": "date-time"
-0000fb90: 7d0a 2020 2020 2020 2020 7363 6865 6d61  }.        schema
-0000fba0: 5b22 7072 6f70 6572 7469 6573 225d 5b45  ["properties"][E
-0000fbb0: 5854 5241 4354 5f54 494d 4553 5441 4d50  XTRACT_TIMESTAMP
-0000fbc0: 5d20 3d20 7469 6d65 7374 616d 705f 666f  ] = timestamp_fo
-0000fbd0: 726d 6174 0a0a 2020 2020 6966 206f 7574  rmat..    if out
-0000fbe0: 7075 745f 7363 6865 6d61 5f66 696c 653a  put_schema_file:
-0000fbf0: 0a20 2020 2020 2020 2077 6974 6820 6f70  .        with op
-0000fc00: 656e 286f 7574 7075 745f 7363 6865 6d61  en(output_schema
-0000fc10: 5f66 696c 652c 2022 7722 2920 6173 2066  _file, "w") as f
-0000fc20: 3a0a 2020 2020 2020 2020 2020 2020 6a73  :.            js
-0000fc30: 6f6e 2e64 756d 7028 7363 6865 6d61 2c20  on.dump(schema, 
-0000fc40: 662c 2069 6e64 656e 743d 3229 0a0a 2020  f, indent=2)..  
-0000fc50: 2020 7374 7265 616d 5f6d 6574 6164 6174    stream_metadat
-0000fc60: 6120 3d20 5b7b 0a20 2020 2020 2020 2022  a = [{.        "
-0000fc70: 6d65 7461 6461 7461 223a 207b 0a20 2020  metadata": {.   
-0000fc80: 2020 2020 2020 2020 2022 7365 6c65 6374           "select
-0000fc90: 6564 223a 2054 7275 652c 0a20 2020 2020  ed": True,.     
-0000fca0: 2020 2020 2020 2022 7461 626c 6522 3a20         "table": 
-0000fcb0: 7374 7265 616d 5b22 7461 626c 6522 5d2c  stream["table"],
-0000fcc0: 0a20 2020 2020 2020 2020 2020 2022 636f  .            "co
-0000fcd0: 6c75 6d6e 7322 3a20 7374 7265 616d 5b22  lumns": stream["
-0000fce0: 636f 6c75 6d6e 7322 5d2c 0a20 2020 2020  columns"],.     
-0000fcf0: 2020 2020 2020 2022 6669 6c74 6572 7322         "filters"
-0000fd00: 3a20 7374 7265 616d 2e67 6574 2822 6669  : stream.get("fi
-0000fd10: 6c74 6572 7322 2c20 5b5d 292c 0a20 2020  lters", []),.   
-0000fd20: 2020 2020 2020 2020 2022 6461 7465 7469           "dateti
-0000fd30: 6d65 5f6b 6579 223a 2073 7472 6561 6d2e  me_key": stream.
-0000fd40: 6765 7428 2264 6174 6574 696d 655f 6b65  get("datetime_ke
-0000fd50: 7922 292c 0a20 2020 2020 2020 2020 2020  y"),.           
-0000fd60: 2022 7461 626c 652d 6b65 792d 7072 6f70   "table-key-prop
-0000fd70: 6572 7469 6573 223a 205b 636f 6e66 6967  erties": [config
-0000fd80: 2e67 6574 2822 7072 696d 6172 795f 6b65  .get("primary_ke
-0000fd90: 7922 295d 0a20 2020 2020 2020 2020 2020  y")].           
-0000fda0: 2023 2022 696e 636c 7573 696f 6e22 3a20   # "inclusion": 
-0000fdb0: 2261 7661 696c 6162 6c65 222c 0a20 2020  "available",.   
-0000fdc0: 2020 2020 2020 2020 2023 2022 7661 6c69           # "vali
-0000fdd0: 642d 7265 706c 6963 6174 696f 6e2d 6b65  d-replication-ke
-0000fde0: 7973 223a 205b 2264 6174 655f 6d6f 6469  ys": ["date_modi
-0000fdf0: 6669 6564 225d 2c0a 2020 2020 2020 2020  fied"],.        
-0000fe00: 2020 2020 2320 2273 6368 656d 612d 6e61      # "schema-na
-0000fe10: 6d65 223a 2022 7573 6572 7322 0a20 2020  me": "users".   
-0000fe20: 2020 2020 2020 2020 207d 2c0a 2020 2020           },.    
-0000fe30: 2020 2020 2262 7265 6164 6372 756d 6222      "breadcrumb"
-0000fe40: 3a20 5b5d 0a20 2020 2020 2020 207d 5d0a  : [].        }].
-0000fe50: 0a20 2020 2023 2055 6e69 7175 6520 7072  .    # Unique pr
-0000fe60: 696d 6172 7920 6b65 7920 7072 6f76 6964  imary key provid
-0000fe70: 6564 2062 7920 7573 6572 0a20 2020 206b  ed by user.    k
-0000fe80: 6579 5f70 726f 7065 7274 6965 7320 3d20  ey_properties = 
-0000fe90: 5b5d 0a20 2020 2069 6620 636f 6e66 6967  [].    if config
-0000fea0: 2e67 6574 2822 7072 696d 6172 795f 6b65  .get("primary_ke
-0000feb0: 7922 293a 0a20 2020 2020 2020 206b 6579  y"):.        key
-0000fec0: 5f70 726f 7065 7274 6965 7320 3d20 5b63  _properties = [c
-0000fed0: 6f6e 6669 672e 6765 7428 2270 7269 6d61  onfig.get("prima
-0000fee0: 7279 5f6b 6579 2229 5d0a 0a20 2020 2063  ry_key")]..    c
-0000fef0: 6174 616c 6f67 203d 207b 2273 656c 6563  atalog = {"selec
-0000ff00: 7465 6422 3a20 5472 7565 2c0a 2020 2020  ted": True,.    
-0000ff10: 2020 2020 2020 2020 2020 2022 7479 7065             "type
-0000ff20: 223a 2022 6f62 6a65 6374 222c 0a20 2020  ": "object",.   
-0000ff30: 2020 2020 2020 2020 2020 2020 2273 7472              "str
-0000ff40: 6561 6d22 3a20 7374 7265 616d 5b22 6e61  eam": stream["na
-0000ff50: 6d65 225d 2c0a 2020 2020 2020 2020 2020  me"],.          
-0000ff60: 2020 2020 2022 6b65 795f 7072 6f70 6572       "key_proper
-0000ff70: 7469 6573 223a 206b 6579 5f70 726f 7065  ties": key_prope
-0000ff80: 7274 6965 732c 0a20 2020 2020 2020 2020  rties,.         
-0000ff90: 2020 2020 2020 2270 726f 7065 7274 6965        "propertie
-0000ffa0: 7322 3a20 7363 6865 6d61 5b22 7072 6f70  s": schema["prop
-0000ffb0: 6572 7469 6573 225d 0a20 2020 2020 2020  erties"].       
-0000ffc0: 2020 2020 2020 2020 7d0a 0a20 2020 2072          }..    r
-0000ffd0: 6574 7572 6e20 7374 7265 616d 5f6d 6574  eturn stream_met
-0000ffe0: 6164 6174 612c 206b 6579 5f70 726f 7065  adata, key_prope
-0000fff0: 7274 6965 732c 2063 6174 616c 6f67 0a0a  rties, catalog..
-00010000: 0a64 6566 2064 6f5f 7379 6e63 2863 6f6e  .def do_sync(con
-00010010: 6669 672c 2073 7461 7465 2c20 7374 7265  fig, state, stre
-00010020: 616d 293a 0a20 2020 2073 696e 6765 722e  am):.    singer.
-00010030: 7365 745f 6375 7272 656e 746c 795f 7379  set_currently_sy
-00010040: 6e63 696e 6728 7374 6174 652c 2073 7472  ncing(state, str
-00010050: 6561 6d2e 7461 705f 7374 7265 616d 5f69  eam.tap_stream_i
-00010060: 6429 0a20 2020 2073 696e 6765 722e 7772  d).    singer.wr
-00010070: 6974 655f 7374 6174 6528 7374 6174 6529  ite_state(state)
-00010080: 0a0a 2020 2020 6372 6564 656e 7469 616c  ..    credential
-00010090: 7320 3d20 7365 7276 6963 655f 6163 636f  s = service_acco
-000100a0: 756e 742e 4372 6564 656e 7469 616c 732e  unt.Credentials.
-000100b0: 6672 6f6d 5f73 6572 7669 6365 5f61 6363  from_service_acc
-000100c0: 6f75 6e74 5f66 696c 6528 636f 6e66 6967  ount_file(config
-000100d0: 5b27 6372 6564 656e 7469 616c 735f 6669  ['credentials_fi
-000100e0: 6c65 275d 290a 2020 2020 636c 6965 6e74  le']).    client
-000100f0: 203d 2062 6967 7175 6572 792e 436c 6965   = bigquery.Clie
-00010100: 6e74 2870 726f 6a65 6374 3d63 6f6e 6669  nt(project=confi
-00010110: 675b 2770 726f 6a65 6374 275d 2c20 6372  g['project'], cr
-00010120: 6564 656e 7469 616c 733d 6372 6564 656e  edentials=creden
-00010130: 7469 616c 7329 0a20 2020 206d 6574 6164  tials).    metad
-00010140: 6174 6120 3d20 7374 7265 616d 2e6d 6574  ata = stream.met
-00010150: 6164 6174 615b 305d 5b22 6d65 7461 6461  adata[0]["metada
-00010160: 7461 225d 0a20 2020 2074 6170 5f73 7472  ta"].    tap_str
-00010170: 6561 6d5f 6964 203d 2073 7472 6561 6d2e  eam_id = stream.
-00010180: 7461 705f 7374 7265 616d 5f69 640a 0a20  tap_stream_id.. 
-00010190: 2020 2069 6e63 6c75 7369 7665 5f73 7461     inclusive_sta
-000101a0: 7274 203d 2054 7275 650a 2020 2020 7374  rt = True.    st
-000101b0: 6172 745f 6461 7465 7469 6d65 203d 2073  art_datetime = s
-000101c0: 696e 6765 722e 6765 745f 626f 6f6b 6d61  inger.get_bookma
-000101d0: 726b 2873 7461 7465 2c20 7461 705f 7374  rk(state, tap_st
-000101e0: 7265 616d 5f69 642c 0a20 2020 2020 2020  ream_id,.       
-000101f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010210: 2020 424f 4f4b 4d41 524b 5f4b 4559 5f4e    BOOKMARK_KEY_N
-00010220: 414d 4529 0a20 2020 2069 6620 7374 6172  AME).    if star
-00010230: 745f 6461 7465 7469 6d65 3a0a 2020 2020  t_datetime:.    
-00010240: 2020 2020 6966 206e 6f74 2063 6f6e 6669      if not confi
-00010250: 672e 6765 7428 2273 7461 7274 5f61 6c77  g.get("start_alw
-00010260: 6179 735f 696e 636c 7573 6976 6522 293a  ays_inclusive"):
-00010270: 0a20 2020 2020 2020 2020 2020 2069 6e63  .            inc
-00010280: 6c75 7369 7665 5f73 7461 7274 203d 2046  lusive_start = F
-00010290: 616c 7365 0a20 2020 2065 6c73 653a 0a20  alse.    else:. 
-000102a0: 2020 2020 2020 2073 7461 7274 5f64 6174         start_dat
-000102b0: 6574 696d 6520 3d20 636f 6e66 6967 2e67  etime = config.g
-000102c0: 6574 2822 7374 6172 745f 6461 7465 7469  et("start_dateti
-000102d0: 6d65 2229 0a20 2020 2069 6620 7374 6172  me").    if star
-000102e0: 745f 6461 7465 7469 6d65 3a0a 2020 2020  t_datetime:.    
-000102f0: 2020 2020 7374 6172 745f 6461 7465 7469      start_dateti
-00010300: 6d65 203d 2064 6174 6575 7469 6c2e 7061  me = dateutil.pa
-00010310: 7273 6572 2e70 6172 7365 2873 7461 7274  rser.parse(start
-00010320: 5f64 6174 6574 696d 6529 2e73 7472 6674  _datetime).strft
-00010330: 696d 6528 0a20 2020 2020 2020 2020 2020  ime(.           
-00010340: 2022 2559 2d25 6d2d 2564 2025 483a 254d   "%Y-%m-%d %H:%M
-00010350: 3a25 532e 2566 2229 0a0a 2020 2020 6966  :%S.%f")..    if
-00010360: 2063 6f6e 6669 672e 6765 7428 2265 6e64   config.get("end
-00010370: 5f64 6174 6574 696d 6522 293a 0a20 2020  _datetime"):.   
-00010380: 2020 2020 2065 6e64 5f64 6174 6574 696d       end_datetim
-00010390: 6520 3d20 6461 7465 7574 696c 2e70 6172  e = dateutil.par
-000103a0: 7365 722e 7061 7273 6528 0a20 2020 2020  ser.parse(.     
-000103b0: 2020 2020 2020 2063 6f6e 6669 672e 6765         config.ge
-000103c0: 7428 2265 6e64 5f64 6174 6574 696d 6522  t("end_datetime"
-000103d0: 2929 2e73 7472 6674 696d 6528 2225 592d  )).strftime("%Y-
-000103e0: 256d 2d25 6420 2548 3a25 4d3a 2553 2e25  %m-%d %H:%M:%S.%
-000103f0: 6622 290a 0a20 2020 2073 696e 6765 722e  f")..    singer.
-00010400: 7772 6974 655f 7363 6865 6d61 2874 6170  write_schema(tap
-00010410: 5f73 7472 6561 6d5f 6964 2c20 7374 7265  _stream_id, stre
-00010420: 616d 2e73 6368 656d 612e 746f 5f64 6963  am.schema.to_dic
-00010430: 7428 292c 0a20 2020 2020 2020 2020 2020  t(),.           
-00010440: 2020 2020 2020 2020 2020 2020 2073 7472               str
-00010450: 6561 6d2e 6b65 795f 7072 6f70 6572 7469  eam.key_properti
-00010460: 6573 290a 0a20 2020 206b 6579 7320 3d20  es)..    keys = 
-00010470: 7b22 7461 626c 6522 3a20 6d65 7461 6461  {"table": metada
-00010480: 7461 5b22 7461 626c 6522 5d2c 0a20 2020  ta["table"],.   
-00010490: 2020 2020 2020 2020 2022 636f 6c75 6d6e           "column
-000104a0: 7322 3a20 6d65 7461 6461 7461 5b22 636f  s": metadata["co
-000104b0: 6c75 6d6e 7322 5d2c 0a20 2020 2020 2020  lumns"],.       
-000104c0: 2020 2020 2022 6461 7465 7469 6d65 5f6b       "datetime_k
-000104d0: 6579 223a 206d 6574 6164 6174 612e 6765  ey": metadata.ge
-000104e0: 7428 2264 6174 6574 696d 655f 6b65 7922  t("datetime_key"
-000104f0: 292c 0a20 2020 2020 2020 2020 2020 2022  ),.            "
-00010500: 7374 6172 745f 6461 7465 7469 6d65 223a  start_datetime":
-00010510: 2073 7461 7274 5f64 6174 6574 696d 652c   start_datetime,
-00010520: 0a20 2020 2020 2020 2020 2020 2022 656e  .            "en
-00010530: 645f 6461 7465 7469 6d65 223a 2065 6e64  d_datetime": end
-00010540: 5f64 6174 6574 696d 650a 2020 2020 2020  _datetime.      
-00010550: 2020 2020 2020 7d0a 0a20 2020 206c 696d        }..    lim
-00010560: 6974 203d 2063 6f6e 6669 672e 6765 7428  it = config.get(
-00010570: 226c 696d 6974 222c 204e 6f6e 6529 0a20  "limit", None). 
-00010580: 2020 2071 7565 7279 203d 205f 6275 696c     query = _buil
-00010590: 645f 7175 6572 7928 6b65 7973 2c20 6d65  d_query(keys, me
-000105a0: 7461 6461 7461 2e67 6574 2822 6669 6c74  tadata.get("filt
-000105b0: 6572 7322 2c20 5b5d 292c 2069 6e63 6c75  ers", []), inclu
-000105c0: 7369 7665 5f73 7461 7274 2c0a 2020 2020  sive_start,.    
-000105d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000105e0: 2020 2020 206c 696d 6974 3d6c 696d 6974       limit=limit
-000105f0: 290a 2020 2020 7175 6572 795f 6a6f 6220  ).    query_job 
-00010600: 3d20 636c 6965 6e74 2e71 7565 7279 2871  = client.query(q
-00010610: 7565 7279 290a 0a20 2020 2070 726f 7065  uery)..    prope
-00010620: 7274 6965 7320 3d20 7374 7265 616d 2e73  rties = stream.s
-00010630: 6368 656d 612e 7072 6f70 6572 7469 6573  chema.properties
-00010640: 0a20 2020 206c 6173 745f 7570 6461 7465  .    last_update
-00010650: 203d 2073 7461 7274 5f64 6174 6574 696d   = start_datetim
-00010660: 650a 0a20 2020 204c 4f47 4745 522e 696e  e..    LOGGER.in
-00010670: 666f 2822 5275 6e6e 696e 6720 7175 6572  fo("Running quer
-00010680: 793a 5c6e 2020 2020 2573 2220 2520 7175  y:\n    %s" % qu
-00010690: 6572 7929 0a0a 2020 2020 6578 7472 6163  ery)..    extrac
-000106a0: 745f 7473 7461 6d70 203d 2064 6174 6574  t_tstamp = datet
-000106b0: 696d 652e 6461 7465 7469 6d65 2e75 7463  ime.datetime.utc
-000106c0: 6e6f 7728 290a 2020 2020 6578 7472 6163  now().    extrac
-000106d0: 745f 7473 7461 6d70 203d 2065 7874 7261  t_tstamp = extra
-000106e0: 6374 5f74 7374 616d 702e 7265 706c 6163  ct_tstamp.replac
-000106f0: 6528 747a 696e 666f 3d64 6174 6574 696d  e(tzinfo=datetim
-00010700: 652e 7469 6d65 7a6f 6e65 2e75 7463 290a  e.timezone.utc).
-00010710: 0a20 2020 2077 6974 6820 6d65 7472 6963  .    with metric
-00010720: 732e 7265 636f 7264 5f63 6f75 6e74 6572  s.record_counter
-00010730: 2874 6170 5f73 7472 6561 6d5f 6964 2920  (tap_stream_id) 
-00010740: 6173 2063 6f75 6e74 6572 3a0a 2020 2020  as counter:.    
-00010750: 2020 2020 666f 7220 726f 7720 696e 2071      for row in q
-00010760: 7565 7279 5f6a 6f62 3a0a 2020 2020 2020  uery_job:.      
-00010770: 2020 2020 2020 7265 636f 7264 203d 2072        record = r
-00010780: 6f77 5f74 6f5f 7265 636f 7264 2872 6f77  ow_to_record(row
-00010790: 2c20 7072 6f70 6572 7469 6573 2c20 6578  , properties, ex
-000107a0: 7472 6163 745f 7473 7461 6d70 290a 0a20  tract_tstamp).. 
-000107b0: 2020 2020 2020 2020 2020 2073 696e 6765             singe
-000107c0: 722e 7772 6974 655f 7265 636f 7264 2873  r.write_record(s
-000107d0: 7472 6561 6d2e 7374 7265 616d 2c20 7265  tream.stream, re
-000107e0: 636f 7264 290a 0a20 2020 2020 2020 2020  cord)..         
-000107f0: 2020 206c 6173 745f 7570 6461 7465 203d     last_update =
-00010800: 2072 6563 6f72 645b 6b65 7973 5b22 6461   record[keys["da
-00010810: 7465 7469 6d65 5f6b 6579 225d 5d20 6966  tetime_key"]] if
-00010820: 2022 6461 7465 7469 6d65 5f6b 6579 2220   "datetime_key" 
-00010830: 696e 206b 6579 7320 616e 6420 6b65 7973  in keys and keys
-00010840: 5b22 6461 7465 7469 6d65 5f6b 6579 225d  ["datetime_key"]
-00010850: 2065 6c73 6520 2222 0a20 2020 2020 2020   else "".       
-00010860: 2020 2020 2063 6f75 6e74 6572 2e69 6e63       counter.inc
-00010870: 7265 6d65 6e74 2829 0a0a 2020 2020 7374  rement()..    st
-00010880: 6174 6520 3d20 7369 6e67 6572 2e77 7269  ate = singer.wri
-00010890: 7465 5f62 6f6f 6b6d 6172 6b28 7374 6174  te_bookmark(stat
-000108a0: 652c 2074 6170 5f73 7472 6561 6d5f 6964  e, tap_stream_id
-000108b0: 2c20 424f 4f4b 4d41 524b 5f4b 4559 5f4e  , BOOKMARK_KEY_N
-000108c0: 414d 452c 0a20 2020 2020 2020 2020 2020  AME,.           
-000108d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000108e0: 2020 2020 2020 206c 6173 745f 7570 6461         last_upda
-000108f0: 7465 290a 0a20 2020 2073 696e 6765 722e  te)..    singer.
-00010900: 7772 6974 655f 7374 6174 6528 7374 6174  write_state(stat
-00010910: 6529 0a0a 0a64 6566 2072 6f77 5f74 6f5f  e)...def row_to_
-00010920: 7265 636f 7264 2872 6f77 2c20 7072 6f70  record(row, prop
-00010930: 6572 7469 6573 2c20 6578 7472 6163 745f  erties, extract_
-00010940: 7473 7461 6d70 2c20 7573 655f 6469 6374  tstamp, use_dict
-00010950: 3d46 616c 7365 293a 0a20 2020 2072 6563  =False):.    rec
-00010960: 6f72 6420 3d20 7b7d 0a20 2020 2066 6f72  ord = {}.    for
-00010970: 206b 6579 2069 6e20 7072 6f70 6572 7469   key in properti
-00010980: 6573 2e6b 6579 7328 293a 0a20 2020 2020  es.keys():.     
-00010990: 2020 2070 726f 7020 3d20 7072 6f70 6572     prop = proper
-000109a0: 7469 6573 5b6b 6579 5d0a 0a20 2020 2020  ties[key]..     
-000109b0: 2020 2069 6620 6b65 7920 3d3d 2045 5854     if key == EXT
-000109c0: 5241 4354 5f54 494d 4553 5441 4d50 3a0a  RACT_TIMESTAMP:.
-000109d0: 2020 2020 2020 2020 2020 2020 636f 6e74              cont
-000109e0: 696e 7565 0a0a 2020 2020 2020 2020 6966  inue..        if
-000109f0: 2072 6f77 5b6b 6579 5d20 6973 204e 6f6e   row[key] is Non
-00010a00: 653a 0a20 2020 2020 2020 2020 2020 2069  e:.            i
-00010a10: 6620 2870 726f 705b 2774 7970 6527 5d5b  f (prop['type'][
-00010a20: 305d 2069 6620 7573 655f 6469 6374 2065  0] if use_dict e
-00010a30: 6c73 6520 7072 6f70 2e74 7970 655b 305d  lse prop.type[0]
-00010a40: 2920 213d 2022 6e75 6c6c 223a 0a20 2020  ) != "null":.   
-00010a50: 2020 2020 2020 2020 2020 2020 2072 6169               rai
-00010a60: 7365 2056 616c 7565 4572 726f 7228 224e  se ValueError("N
-00010a70: 554c 4c20 7661 6c75 6520 6e6f 7420 616c  ULL value not al
-00010a80: 6c6f 7765 6420 6279 2074 6865 2073 6368  lowed by the sch
-00010a90: 656d 6122 290a 2020 2020 2020 2020 2020  ema").          
-00010aa0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00010ab0: 2020 2020 2020 2020 7265 636f 7264 5b6b          record[k
-00010ac0: 6579 5d20 3d20 4e6f 6e65 0a20 2020 2020  ey] = None.     
-00010ad0: 2020 2065 6c69 6620 2870 726f 702e 6765     elif (prop.ge
-00010ae0: 7428 2766 6f72 6d61 7427 2920 6966 2075  t('format') if u
-00010af0: 7365 5f64 6963 7420 656c 7365 2070 726f  se_dict else pro
-00010b00: 702e 666f 726d 6174 2920 3d3d 2022 6461  p.format) == "da
-00010b10: 7465 2d74 696d 6522 3a0a 2020 2020 2020  te-time":.      
-00010b20: 2020 2020 2020 6966 2074 7970 6528 726f        if type(ro
-00010b30: 775b 6b65 795d 2920 3d3d 2073 7472 3a0a  w[key]) == str:.
-00010b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010b50: 7220 3d20 6461 7465 7574 696c 2e70 6172  r = dateutil.par
-00010b60: 7365 722e 7061 7273 6528 726f 775b 6b65  ser.parse(row[ke
-00010b70: 795d 290a 2020 2020 2020 2020 2020 2020  y]).            
-00010b80: 656c 6966 2074 7970 6528 726f 775b 6b65  elif type(row[ke
-00010b90: 795d 2920 3d3d 2064 6174 6574 696d 652e  y]) == datetime.
-00010ba0: 6461 7465 3a0a 2020 2020 2020 2020 2020  date:.          
-00010bb0: 2020 2020 2020 7220 3d20 6461 7465 7469        r = dateti
-00010bc0: 6d65 2e64 6174 6574 696d 6528 7965 6172  me.datetime(year
-00010bd0: 3d72 6f77 5b6b 6579 5d2e 7965 6172 2c20  =row[key].year, 
-00010be0: 6d6f 6e74 683d 726f 775b 6b65 795d 2e6d  month=row[key].m
-00010bf0: 6f6e 7468 2c20 6461 793d 726f 775b 6b65  onth, day=row[ke
-00010c00: 795d 2e64 6179 290a 2020 2020 2020 2020  y].day).        
-00010c10: 2020 2020 656c 6966 2074 7970 6528 726f      elif type(ro
-00010c20: 775b 6b65 795d 2920 3d3d 2064 6174 6574  w[key]) == datet
-00010c30: 696d 652e 6461 7465 7469 6d65 3a0a 2020  ime.datetime:.  
-00010c40: 2020 2020 2020 2020 2020 2020 2020 7220                r 
-00010c50: 3d20 726f 775b 6b65 795d 0a20 2020 2020  = row[key].     
-00010c60: 2020 2020 2020 2072 6563 6f72 645b 6b65         record[ke
-00010c70: 795d 203d 2072 2e69 736f 666f 726d 6174  y] = r.isoformat
-00010c80: 2829 0a20 2020 2020 2020 2065 6c69 6620  ().        elif 
-00010c90: 2870 726f 705b 2774 7970 6527 5d5b 315d  (prop['type'][1]
-00010ca0: 2069 6620 7573 655f 6469 6374 2065 6c73   if use_dict els
-00010cb0: 6520 7072 6f70 2e74 7970 655b 315d 2920  e prop.type[1]) 
-00010cc0: 3d3d 2022 7374 7269 6e67 223a 0a20 2020  == "string":.   
-00010cd0: 2020 2020 2020 2020 2072 6563 6f72 645b           record[
-00010ce0: 6b65 795d 203d 2073 7472 2872 6f77 5b6b  key] = str(row[k
-00010cf0: 6579 5d29 0a20 2020 2020 2020 2065 6c69  ey]).        eli
-00010d00: 6620 2870 726f 705b 2774 7970 6527 5d5b  f (prop['type'][
-00010d10: 315d 2069 6620 7573 655f 6469 6374 2065  1] if use_dict e
-00010d20: 6c73 6520 7072 6f70 2e74 7970 655b 315d  lse prop.type[1]
-00010d30: 2920 3d3d 2022 6e75 6d62 6572 223a 0a20  ) == "number":. 
-00010d40: 2020 2020 2020 2020 2020 2072 6563 6f72             recor
-00010d50: 645b 6b65 795d 203d 2044 6563 696d 616c  d[key] = Decimal
-00010d60: 2872 6f77 5b6b 6579 5d29 0a20 2020 2020  (row[key]).     
-00010d70: 2020 2065 6c69 6620 2870 726f 705b 2774     elif (prop['t
-00010d80: 7970 6527 5d5b 315d 2069 6620 7573 655f  ype'][1] if use_
-00010d90: 6469 6374 2065 6c73 6520 7072 6f70 2e74  dict else prop.t
-00010da0: 7970 655b 315d 2920 3d3d 2022 696e 7465  ype[1]) == "inte
-00010db0: 6765 7222 3a0a 2020 2020 2020 2020 2020  ger":.          
-00010dc0: 2020 7265 636f 7264 5b6b 6579 5d20 3d20    record[key] = 
-00010dd0: 696e 7428 726f 775b 6b65 795d 290a 2020  int(row[key]).  
-00010de0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-00010df0: 2020 2020 2020 2020 7265 636f 7264 5b6b          record[k
-00010e00: 6579 5d20 3d20 726f 775b 6b65 795d 0a0a  ey] = row[key]..
-00010e10: 2020 2020 6966 2045 5854 5241 4354 5f54      if EXTRACT_T
-00010e20: 494d 4553 5441 4d50 2069 6e20 7072 6f70  IMESTAMP in prop
-00010e30: 6572 7469 6573 2e6b 6579 7328 293a 0a20  erties.keys():. 
-00010e40: 2020 2020 2020 2072 6563 6f72 645b 4558         record[EX
-00010e50: 5452 4143 545f 5449 4d45 5354 414d 505d  TRACT_TIMESTAMP]
-00010e60: 203d 2065 7874 7261 6374 5f74 7374 616d   = extract_tstam
-00010e70: 702e 6973 6f66 6f72 6d61 7428 290a 0a20  p.isoformat().. 
-00010e80: 2020 2072 6574 7572 6e20 7265 636f 7264     return record
-00010e90: 0a0a 0a64 6566 2073 686f 756c 645f 7379  ...def should_sy
-00010ea0: 6e63 5f63 6f6c 756d 6e28 6d64 5f6d 6170  nc_column(md_map
-00010eb0: 2c20 6669 656c 645f 6e61 6d65 293a 0a20  , field_name):. 
-00010ec0: 2020 2066 6965 6c64 5f6d 6574 6164 6174     field_metadat
-00010ed0: 6120 3d20 6d64 5f6d 6170 2e67 6574 2828  a = md_map.get((
-00010ee0: 2770 726f 7065 7274 6965 7327 2c20 6669  'properties', fi
-00010ef0: 656c 645f 6e61 6d65 292c 207b 7d29 0a20  eld_name), {}). 
-00010f00: 2020 2072 6574 7572 6e20 7369 6e67 6572     return singer
-00010f10: 2e73 686f 756c 645f 7379 6e63 5f66 6965  .should_sync_fie
-00010f20: 6c64 2866 6965 6c64 5f6d 6574 6164 6174  ld(field_metadat
-00010f30: 612e 6765 7428 2769 6e63 6c75 7369 6f6e  a.get('inclusion
-00010f40: 2729 2c0a 2020 2020 2020 2020 2020 2020  '),.            
-00010f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010f60: 2020 2020 2020 2020 6669 656c 645f 6d65          field_me
-00010f70: 7461 6461 7461 2e67 6574 2827 7365 6c65  tadata.get('sele
-00010f80: 6374 6564 2729 2c0a 2020 2020 2020 2020  cted'),.        
-00010f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010fa0: 2020 2020 2020 2020 2020 2020 5472 7565              True
-00010fb0: 290a 0a0a 6465 6620 6372 6561 7465 5f63  )...def create_c
-00010fc0: 7265 6465 6e74 6961 6c73 5f66 696c 6528  redentials_file(
-00010fd0: 636f 6e66 6967 3a20 4469 6374 2920 2d3e  config: Dict) ->
-00010fe0: 2044 6963 743a 0a20 2020 2070 6174 685f   Dict:.    path_
-00010ff0: 7575 6964 203d 2075 7569 642e 7575 6964  uuid = uuid.uuid
-00011000: 3428 292e 6865 780a 2020 2020 7472 793a  4().hex.    try:
-00011010: 0a20 2020 2020 2020 2069 6620 636f 6e66  .        if conf
-00011020: 6967 2e67 6574 2827 6372 6564 656e 7469  ig.get('credenti
-00011030: 616c 735f 6669 6c65 2729 3a0a 2020 2020  als_file'):.    
-00011040: 2020 2020 2020 2020 7061 7468 203d 2066          path = f
-00011050: 222f 6f70 742f 6269 6771 7565 7279 2f7b  "/opt/bigquery/{
-00011060: 7061 7468 5f75 7569 647d 2f63 6c69 656e  path_uuid}/clien
-00011070: 745f 7365 6372 6574 732e 6a73 6f6e 220a  t_secrets.json".
-00011080: 2020 2020 2020 2020 2020 2020 636c 6965              clie
-00011090: 6e74 5f73 6563 7265 7473 203d 2050 6174  nt_secrets = Pat
-000110a0: 6828 7061 7468 290a 2020 2020 2020 2020  h(path).        
-000110b0: 2020 2020 636c 6965 6e74 5f73 6563 7265      client_secre
-000110c0: 7473 2e70 6172 656e 742e 6d6b 6469 7228  ts.parent.mkdir(
-000110d0: 6578 6973 745f 6f6b 3d54 7275 652c 2070  exist_ok=True, p
-000110e0: 6172 656e 7473 3d54 7275 6529 0a20 2020  arents=True).   
-000110f0: 2020 2020 2020 2020 2063 6c69 656e 745f           client_
-00011100: 7365 6372 6574 732e 7772 6974 655f 7465  secrets.write_te
-00011110: 7874 2863 6f6e 6669 675b 2763 7265 6465  xt(config['crede
-00011120: 6e74 6961 6c73 5f66 696c 6527 5d29 0a20  ntials_file']). 
+0000ec00: 696d 706f 7274 2064 6174 6574 696d 652c  import datetime,
+0000ec10: 206a 736f 6e2c 2074 696d 650a 696d 706f   json, time.impo
+0000ec20: 7274 2064 6174 6575 7469 6c2e 7061 7273  rt dateutil.pars
+0000ec30: 6572 0a66 726f 6d20 6465 6369 6d61 6c20  er.from decimal 
+0000ec40: 696d 706f 7274 2044 6563 696d 616c 0a0a  import Decimal..
+0000ec50: 696d 706f 7274 2073 696e 6765 720a 696d  import singer.im
+0000ec60: 706f 7274 2073 696e 6765 722e 6d65 7472  port singer.metr
+0000ec70: 6963 7320 6173 206d 6574 7269 6373 0a69  ics as metrics.i
+0000ec80: 6d70 6f72 7420 7575 6964 0a0a 6672 6f6d  mport uuid..from
+0000ec90: 2067 6f6f 676c 652e 6f61 7574 6832 2069   google.oauth2 i
+0000eca0: 6d70 6f72 7420 7365 7276 6963 655f 6163  mport service_ac
+0000ecb0: 636f 756e 740a 6672 6f6d 2067 6f6f 676c  count.from googl
+0000ecc0: 652e 636c 6f75 6420 696d 706f 7274 2062  e.cloud import b
+0000ecd0: 6967 7175 6572 790a 6672 6f6d 2070 6174  igquery.from pat
+0000ece0: 686c 6962 2069 6d70 6f72 7420 5061 7468  hlib import Path
+0000ecf0: 0a66 726f 6d20 7369 6e67 6572 2069 6d70  .from singer imp
+0000ed00: 6f72 7420 7574 696c 730a 6672 6f6d 2074  ort utils.from t
+0000ed10: 7970 696e 6720 696d 706f 7274 2044 6963  yping import Dic
+0000ed20: 740a 0a69 6d70 6f72 7420 6765 7473 6368  t..import getsch
+0000ed30: 656d 610a 0a0a 4c4f 4747 4552 203d 2073  ema...LOGGER = s
+0000ed40: 696e 6765 722e 6765 745f 6c6f 6767 6572  inger.get_logger
+0000ed50: 2822 6d61 6372 6f6d 6574 615f 736f 7572  ("macrometa_sour
+0000ed60: 6365 5f62 6967 7175 6572 7922 290a 0a23  ce_bigquery")..#
+0000ed70: 2053 7469 7463 6844 6174 6120 636f 6d70   StitchData comp
+0000ed80: 6174 6962 6c65 2074 696d 6573 7461 6d70  atible timestamp
+0000ed90: 206d 6574 6120 6461 7461 0a23 2020 6874   meta data.#  ht
+0000eda0: 7470 733a 2f2f 7777 772e 7374 6974 6368  tps://www.stitch
+0000edb0: 6461 7461 2e63 6f6d 2f64 6f63 732f 6461  data.com/docs/da
+0000edc0: 7461 2d73 7472 7563 7475 7265 2f73 7973  ta-structure/sys
+0000edd0: 7465 6d2d 7461 626c 6573 2d61 6e64 2d63  tem-tables-and-c
+0000ede0: 6f6c 756d 6e73 0a23 2054 6865 2074 696d  olumns.# The tim
+0000edf0: 6573 7461 6d70 206f 6620 7468 6520 7265  estamp of the re
+0000ee00: 636f 7264 2065 7874 7261 6374 6564 2066  cord extracted f
+0000ee10: 726f 6d20 7468 6520 736f 7572 6365 0a45  rom the source.E
+0000ee20: 5854 5241 4354 5f54 494d 4553 5441 4d50  XTRACT_TIMESTAMP
+0000ee30: 203d 2022 5f73 6463 5f65 7874 7261 6374   = "_sdc_extract
+0000ee40: 6564 5f61 7422 0a0a 424f 4f4b 4d41 524b  ed_at"..BOOKMARK
+0000ee50: 5f4b 4559 5f4e 414d 4520 3d20 226c 6173  _KEY_NAME = "las
+0000ee60: 745f 7570 6461 7465 220a 0a0a 6465 6620  t_update"...def 
+0000ee70: 5f62 7569 6c64 5f71 7565 7279 286b 6579  _build_query(key
+0000ee80: 732c 2066 696c 7465 7273 3d5b 5d2c 2069  s, filters=[], i
+0000ee90: 6e63 6c75 7369 7665 5f73 7461 7274 3d54  nclusive_start=T
+0000eea0: 7275 652c 206c 696d 6974 3d4e 6f6e 6529  rue, limit=None)
+0000eeb0: 3a0a 2020 2020 636f 6c75 6d6e 7320 3d20  :.    columns = 
+0000eec0: 222c 222e 6a6f 696e 286b 6579 735b 2263  ",".join(keys["c
+0000eed0: 6f6c 756d 6e73 225d 290a 2020 2020 6966  olumns"]).    if
+0000eee0: 206b 6579 732e 6765 7428 2264 6174 6574   keys.get("datet
+0000eef0: 696d 655f 6b65 7922 293a 0a20 2020 2020  ime_key"):.     
+0000ef00: 2020 2069 6620 222a 2220 6e6f 7420 696e     if "*" not in
+0000ef10: 2063 6f6c 756d 6e73 2061 6e64 206b 6579   columns and key
+0000ef20: 735b 2264 6174 6574 696d 655f 6b65 7922  s["datetime_key"
+0000ef30: 5d20 6e6f 7420 696e 2063 6f6c 756d 6e73  ] not in columns
+0000ef40: 3a0a 2020 2020 2020 2020 2020 2020 636f  :.            co
+0000ef50: 6c75 6d6e 7320 3d20 636f 6c75 6d6e 7320  lumns = columns 
+0000ef60: 2b20 222c 2220 2b20 6b65 7973 5b22 6461  + "," + keys["da
+0000ef70: 7465 7469 6d65 5f6b 6579 225d 0a20 2020  tetime_key"].   
+0000ef80: 206b 6579 735b 2263 6f6c 756d 6e73 225d   keys["columns"]
+0000ef90: 203d 2063 6f6c 756d 6e73 0a0a 2020 2020   = columns..    
+0000efa0: 7175 6572 7920 3d20 2253 454c 4543 5420  query = "SELECT 
+0000efb0: 7b63 6f6c 756d 6e73 7d20 4652 4f4d 207b  {columns} FROM {
+0000efc0: 7461 626c 657d 2057 4845 5245 2031 3d31  table} WHERE 1=1
+0000efd0: 222e 666f 726d 6174 282a 2a6b 6579 7329  ".format(**keys)
+0000efe0: 0a0a 2020 2020 6966 2066 696c 7465 7273  ..    if filters
+0000eff0: 3a0a 2020 2020 2020 2020 666f 7220 6620  :.        for f 
+0000f000: 696e 2066 696c 7465 7273 3a0a 2020 2020  in filters:.    
+0000f010: 2020 2020 2020 2020 7175 6572 7920 3d20          query = 
+0000f020: 7175 6572 7920 2b20 2220 414e 4420 2220  query + " AND " 
+0000f030: 2b20 660a 0a20 2020 2069 6620 6b65 7973  + f..    if keys
+0000f040: 2e67 6574 2822 6461 7465 7469 6d65 5f6b  .get("datetime_k
+0000f050: 6579 2229 2061 6e64 206b 6579 732e 6765  ey") and keys.ge
+0000f060: 7428 2273 7461 7274 5f64 6174 6574 696d  t("start_datetim
+0000f070: 6522 293a 0a20 2020 2020 2020 2069 6620  e"):.        if 
+0000f080: 696e 636c 7573 6976 655f 7374 6172 743a  inclusive_start:
+0000f090: 0a20 2020 2020 2020 2020 2020 2071 7565  .            que
+0000f0a0: 7279 203d 2028 7175 6572 7920 2b0a 2020  ry = (query +.  
+0000f0b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f0c0: 2020 2028 2220 414e 4420 6461 7465 7469     (" AND dateti
+0000f0d0: 6d65 2027 7b73 7461 7274 5f64 6174 6574  me '{start_datet
+0000f0e0: 696d 657d 2720 3c3d 2022 202b 0a20 2020  ime}' <= " +.   
+0000f0f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f100: 2020 2022 4341 5354 287b 6461 7465 7469     "CAST({dateti
+0000f110: 6d65 5f6b 6579 7d20 6173 2064 6174 6574  me_key} as datet
+0000f120: 696d 6529 2229 2e66 6f72 6d61 7428 2a2a  ime)").format(**
+0000f130: 6b65 7973 2929 0a20 2020 2020 2020 2065  keys)).        e
+0000f140: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+0000f150: 2071 7565 7279 203d 2028 7175 6572 7920   query = (query 
+0000f160: 2b0a 2020 2020 2020 2020 2020 2020 2020  +.              
+0000f170: 2020 2020 2020 2028 2220 414e 4420 6461         (" AND da
+0000f180: 7465 7469 6d65 2027 7b73 7461 7274 5f64  tetime '{start_d
+0000f190: 6174 6574 696d 657d 2720 3c20 2220 2b0a  atetime}' < " +.
+0000f1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f1b0: 2020 2020 2020 2243 4153 5428 7b64 6174        "CAST({dat
+0000f1c0: 6574 696d 655f 6b65 797d 2061 7320 6461  etime_key} as da
+0000f1d0: 7465 7469 6d65 2922 292e 666f 726d 6174  tetime)").format
+0000f1e0: 282a 2a6b 6579 7329 290a 0a20 2020 2069  (**keys))..    i
+0000f1f0: 6620 6b65 7973 2e67 6574 2822 6461 7465  f keys.get("date
+0000f200: 7469 6d65 5f6b 6579 2229 2061 6e64 206b  time_key") and k
+0000f210: 6579 732e 6765 7428 2265 6e64 5f64 6174  eys.get("end_dat
+0000f220: 6574 696d 6522 293a 0a20 2020 2020 2020  etime"):.       
+0000f230: 2071 7565 7279 203d 2028 7175 6572 7920   query = (query 
+0000f240: 2b0a 2020 2020 2020 2020 2020 2020 2020  +.              
+0000f250: 2020 2028 2220 414e 4420 4341 5354 287b     (" AND CAST({
+0000f260: 6461 7465 7469 6d65 5f6b 6579 7d20 6173  datetime_key} as
+0000f270: 2064 6174 6574 696d 6529 203c 2022 202b   datetime) < " +
+0000f280: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000f290: 2020 2022 6461 7465 7469 6d65 2027 7b65     "datetime '{e
+0000f2a0: 6e64 5f64 6174 6574 696d 657d 2722 292e  nd_datetime}'").
+0000f2b0: 666f 726d 6174 282a 2a6b 6579 7329 290a  format(**keys)).
+0000f2c0: 2020 2020 6966 206b 6579 732e 6765 7428      if keys.get(
+0000f2d0: 2264 6174 6574 696d 655f 6b65 7922 293a  "datetime_key"):
+0000f2e0: 0a20 2020 2020 2020 2071 7565 7279 203d  .        query =
+0000f2f0: 2028 7175 6572 7920 2b20 2220 4f52 4445   (query + " ORDE
+0000f300: 5220 4259 207b 6461 7465 7469 6d65 5f6b  R BY {datetime_k
+0000f310: 6579 7d22 2e66 6f72 6d61 7428 2a2a 6b65  ey}".format(**ke
+0000f320: 7973 2929 0a0a 2020 2020 6966 206c 696d  ys))..    if lim
+0000f330: 6974 2069 7320 6e6f 7420 4e6f 6e65 3a0a  it is not None:.
+0000f340: 2020 2020 2020 2020 7175 6572 7920 3d20          query = 
+0000f350: 7175 6572 7920 2b20 2220 4c49 4d49 5420  query + " LIMIT 
+0000f360: 2564 2220 2520 696e 7428 6c69 6d69 7429  %d" % int(limit)
+0000f370: 0a0a 2020 2020 7265 7475 726e 2071 7565  ..    return que
+0000f380: 7279 0a0a 0a64 6566 2064 6f5f 6469 7363  ry...def do_disc
+0000f390: 6f76 6572 2863 6f6e 6669 672c 2073 7472  over(config, str
+0000f3a0: 6561 6d2c 206f 7574 7075 745f 7363 6865  eam, output_sche
+0000f3b0: 6d61 5f66 696c 653d 4e6f 6e65 2c0a 2020  ma_file=None,.  
+0000f3c0: 2020 2020 2020 2020 2020 2020 2020 6164                ad
+0000f3d0: 645f 7469 6d65 7374 616d 703d 4661 6c73  d_timestamp=Fals
+0000f3e0: 6529 3a0a 2020 2020 6372 6564 656e 7469  e):.    credenti
+0000f3f0: 616c 7320 3d20 7365 7276 6963 655f 6163  als = service_ac
+0000f400: 636f 756e 742e 4372 6564 656e 7469 616c  count.Credential
+0000f410: 732e 6672 6f6d 5f73 6572 7669 6365 5f61  s.from_service_a
+0000f420: 6363 6f75 6e74 5f66 696c 6528 636f 6e66  ccount_file(conf
+0000f430: 6967 5b27 6372 6564 656e 7469 616c 735f  ig['credentials_
+0000f440: 6669 6c65 275d 290a 2020 2020 636c 6965  file']).    clie
+0000f450: 6e74 203d 2062 6967 7175 6572 792e 436c  nt = bigquery.Cl
+0000f460: 6965 6e74 2870 726f 6a65 6374 3d63 6f6e  ient(project=con
+0000f470: 6669 675b 2770 726f 6a65 6374 275d 2c20  fig['project'], 
+0000f480: 6372 6564 656e 7469 616c 733d 6372 6564  credentials=cred
+0000f490: 656e 7469 616c 7329 0a0a 2020 2020 7374  entials)..    st
+0000f4a0: 6172 745f 6461 7465 7469 6d65 203d 204e  art_datetime = N
+0000f4b0: 6f6e 650a 2020 2020 6966 2063 6f6e 6669  one.    if confi
+0000f4c0: 672e 6765 7428 2273 7461 7274 5f64 6174  g.get("start_dat
+0000f4d0: 6574 696d 6522 293a 0a20 2020 2020 2020  etime"):.       
+0000f4e0: 2073 7461 7274 5f64 6174 6574 696d 6520   start_datetime 
+0000f4f0: 3d20 6461 7465 7574 696c 2e70 6172 7365  = dateutil.parse
+0000f500: 722e 7061 7273 6528 0a20 2020 2020 2020  r.parse(.       
+0000f510: 2020 2020 2063 6f6e 6669 672e 6765 7428       config.get(
+0000f520: 2273 7461 7274 5f64 6174 6574 696d 6522  "start_datetime"
+0000f530: 2929 2e73 7472 6674 696d 6528 2225 592d  )).strftime("%Y-
+0000f540: 256d 2d25 6420 2548 3a25 4d3a 2553 2e25  %m-%d %H:%M:%S.%
+0000f550: 6622 290a 0a20 2020 2065 6e64 5f64 6174  f")..    end_dat
+0000f560: 6574 696d 6520 3d20 4e6f 6e65 0a20 2020  etime = None.   
+0000f570: 2069 6620 636f 6e66 6967 2e67 6574 2822   if config.get("
+0000f580: 656e 645f 6461 7465 7469 6d65 2229 3a0a  end_datetime"):.
+0000f590: 2020 2020 2020 2020 656e 645f 6461 7465          end_date
+0000f5a0: 7469 6d65 203d 2064 6174 6575 7469 6c2e  time = dateutil.
+0000f5b0: 7061 7273 6572 2e70 6172 7365 280a 2020  parser.parse(.  
+0000f5c0: 2020 2020 2020 2020 2020 636f 6e66 6967            config
+0000f5d0: 2e67 6574 2822 656e 645f 6461 7465 7469  .get("end_dateti
+0000f5e0: 6d65 2229 292e 7374 7266 7469 6d65 2822  me")).strftime("
+0000f5f0: 2559 2d25 6d2d 2564 2025 483a 254d 3a25  %Y-%m-%d %H:%M:%
+0000f600: 532e 2566 2229 0a0a 2020 2020 6b65 7973  S.%f")..    keys
+0000f610: 203d 207b 2274 6162 6c65 223a 2073 7472   = {"table": str
+0000f620: 6561 6d5b 2274 6162 6c65 225d 2c0a 2020  eam["table"],.  
+0000f630: 2020 2020 2020 2020 2020 2263 6f6c 756d            "colum
+0000f640: 6e73 223a 2073 7472 6561 6d5b 2263 6f6c  ns": stream["col
+0000f650: 756d 6e73 225d 2c0a 2020 2020 2020 2020  umns"],.        
+0000f660: 2020 2020 2264 6174 6574 696d 655f 6b65      "datetime_ke
+0000f670: 7922 3a20 7374 7265 616d 2e67 6574 2822  y": stream.get("
+0000f680: 6461 7465 7469 6d65 5f6b 6579 2229 2c0a  datetime_key"),.
+0000f690: 2020 2020 2020 2020 2020 2020 2273 7461              "sta
+0000f6a0: 7274 5f64 6174 6574 696d 6522 3a20 7374  rt_datetime": st
+0000f6b0: 6172 745f 6461 7465 7469 6d65 2c0a 2020  art_datetime,.  
+0000f6c0: 2020 2020 2020 2020 2020 2265 6e64 5f64            "end_d
+0000f6d0: 6174 6574 696d 6522 3a20 656e 645f 6461  atetime": end_da
+0000f6e0: 7465 7469 6d65 0a20 2020 2020 2020 2020  tetime.         
+0000f6f0: 2020 207d 0a0a 2020 2020 7175 6572 7920     }..    query 
+0000f700: 3d20 5f62 7569 6c64 5f71 7565 7279 286b  = _build_query(k
+0000f710: 6579 732c 2073 7472 6561 6d2e 6765 7428  eys, stream.get(
+0000f720: 2266 696c 7465 7273 2229 2c20 6c69 6d69  "filters"), limi
+0000f730: 743d 3530 290a 0a20 2020 204c 4f47 4745  t=50)..    LOGGE
+0000f740: 522e 696e 666f 2822 5275 6e6e 696e 6720  R.info("Running 
+0000f750: 7175 6572 793a 5c6e 2020 2020 2220 2b20  query:\n    " + 
+0000f760: 7175 6572 7929 0a0a 2020 2020 7175 6572  query)..    quer
+0000f770: 795f 6a6f 6220 3d20 636c 6965 6e74 2e71  y_job = client.q
+0000f780: 7565 7279 2871 7565 7279 290a 2020 2020  uery(query).    
+0000f790: 7265 7375 6c74 7320 3d20 7175 6572 795f  results = query_
+0000f7a0: 6a6f 622e 7265 7375 6c74 2829 2020 2320  job.result()  # 
+0000f7b0: 5761 6974 7320 666f 7220 6a6f 6220 746f  Waits for job to
+0000f7c0: 2063 6f6d 706c 6574 652e 0a0a 2020 2020   complete...    
+0000f7d0: 6461 7461 203d 205b 5d0a 2020 2020 2320  data = [].    # 
+0000f7e0: 5265 6164 2065 7665 7279 7468 696e 6720  Read everything 
+0000f7f0: 7570 6672 6f6e 740a 2020 2020 666f 7220  upfront.    for 
+0000f800: 726f 7720 696e 2072 6573 756c 7473 3a0a  row in results:.
+0000f810: 2020 2020 2020 2020 7265 636f 7264 203d          record =
+0000f820: 207b 7d0a 2020 2020 2020 2020 666f 7220   {}.        for 
+0000f830: 6b65 7920 696e 2072 6f77 2e6b 6579 7328  key in row.keys(
+0000f840: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
+0000f850: 6563 6f72 645b 6b65 795d 203d 2072 6f77  ecord[key] = row
+0000f860: 5b6b 6579 5d0a 2020 2020 2020 2020 6461  [key].        da
+0000f870: 7461 2e61 7070 656e 6428 7265 636f 7264  ta.append(record
+0000f880: 290a 0a20 2020 2069 6620 6e6f 7420 6461  )..    if not da
+0000f890: 7461 3a0a 2020 2020 2020 2020 7261 6973  ta:.        rais
+0000f8a0: 6520 4578 6365 7074 696f 6e28 2243 616e  e Exception("Can
+0000f8b0: 6e6f 7420 696e 6665 7220 7363 6865 6d61  not infer schema
+0000f8c0: 3a20 4e6f 2072 6563 6f72 6420 7265 7475  : No record retu
+0000f8d0: 726e 6564 2e22 290a 0a20 2020 2073 6368  rned.")..    sch
+0000f8e0: 656d 6120 3d20 6765 7473 6368 656d 612e  ema = getschema.
+0000f8f0: 696e 6665 725f 7363 6865 6d61 2864 6174  infer_schema(dat
+0000f900: 6129 0a20 2020 2069 6620 6164 645f 7469  a).    if add_ti
+0000f910: 6d65 7374 616d 703a 0a20 2020 2020 2020  mestamp:.       
+0000f920: 2074 696d 6573 7461 6d70 5f66 6f72 6d61   timestamp_forma
+0000f930: 7420 3d20 7b22 7479 7065 223a 205b 226e  t = {"type": ["n
+0000f940: 756c 6c22 2c20 2273 7472 696e 6722 5d2c  ull", "string"],
+0000f950: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000f960: 2020 2020 2020 2020 2020 2020 2022 666f               "fo
+0000f970: 726d 6174 223a 2022 6461 7465 2d74 696d  rmat": "date-tim
+0000f980: 6522 7d0a 2020 2020 2020 2020 7363 6865  e"}.        sche
+0000f990: 6d61 5b22 7072 6f70 6572 7469 6573 225d  ma["properties"]
+0000f9a0: 5b45 5854 5241 4354 5f54 494d 4553 5441  [EXTRACT_TIMESTA
+0000f9b0: 4d50 5d20 3d20 7469 6d65 7374 616d 705f  MP] = timestamp_
+0000f9c0: 666f 726d 6174 0a0a 2020 2020 6966 206f  format..    if o
+0000f9d0: 7574 7075 745f 7363 6865 6d61 5f66 696c  utput_schema_fil
+0000f9e0: 653a 0a20 2020 2020 2020 2077 6974 6820  e:.        with 
+0000f9f0: 6f70 656e 286f 7574 7075 745f 7363 6865  open(output_sche
+0000fa00: 6d61 5f66 696c 652c 2022 7722 2920 6173  ma_file, "w") as
+0000fa10: 2066 3a0a 2020 2020 2020 2020 2020 2020   f:.            
+0000fa20: 6a73 6f6e 2e64 756d 7028 7363 6865 6d61  json.dump(schema
+0000fa30: 2c20 662c 2069 6e64 656e 743d 3229 0a0a  , f, indent=2)..
+0000fa40: 2020 2020 7374 7265 616d 5f6d 6574 6164      stream_metad
+0000fa50: 6174 6120 3d20 5b7b 0a20 2020 2020 2020  ata = [{.       
+0000fa60: 2022 6d65 7461 6461 7461 223a 207b 0a20   "metadata": {. 
+0000fa70: 2020 2020 2020 2020 2020 2022 7365 6c65             "sele
+0000fa80: 6374 6564 223a 2054 7275 652c 0a20 2020  cted": True,.   
+0000fa90: 2020 2020 2020 2020 2022 7461 626c 6522           "table"
+0000faa0: 3a20 7374 7265 616d 5b22 7461 626c 6522  : stream["table"
+0000fab0: 5d2c 0a20 2020 2020 2020 2020 2020 2022  ],.            "
+0000fac0: 636f 6c75 6d6e 7322 3a20 7374 7265 616d  columns": stream
+0000fad0: 5b22 636f 6c75 6d6e 7322 5d2c 0a20 2020  ["columns"],.   
+0000fae0: 2020 2020 2020 2020 2022 6669 6c74 6572           "filter
+0000faf0: 7322 3a20 7374 7265 616d 2e67 6574 2822  s": stream.get("
+0000fb00: 6669 6c74 6572 7322 2c20 5b5d 292c 0a20  filters", []),. 
+0000fb10: 2020 2020 2020 2020 2020 2022 6461 7465             "date
+0000fb20: 7469 6d65 5f6b 6579 223a 2073 7472 6561  time_key": strea
+0000fb30: 6d2e 6765 7428 2264 6174 6574 696d 655f  m.get("datetime_
+0000fb40: 6b65 7922 292c 0a20 2020 2020 2020 2020  key"),.         
+0000fb50: 2020 2022 7461 626c 652d 6b65 792d 7072     "table-key-pr
+0000fb60: 6f70 6572 7469 6573 223a 205b 636f 6e66  operties": [conf
+0000fb70: 6967 2e67 6574 2822 7072 696d 6172 795f  ig.get("primary_
+0000fb80: 6b65 7922 295d 0a20 2020 2020 2020 2020  key")].         
+0000fb90: 2020 2023 2022 696e 636c 7573 696f 6e22     # "inclusion"
+0000fba0: 3a20 2261 7661 696c 6162 6c65 222c 0a20  : "available",. 
+0000fbb0: 2020 2020 2020 2020 2020 2023 2022 7661             # "va
+0000fbc0: 6c69 642d 7265 706c 6963 6174 696f 6e2d  lid-replication-
+0000fbd0: 6b65 7973 223a 205b 2264 6174 655f 6d6f  keys": ["date_mo
+0000fbe0: 6469 6669 6564 225d 2c0a 2020 2020 2020  dified"],.      
+0000fbf0: 2020 2020 2020 2320 2273 6368 656d 612d        # "schema-
+0000fc00: 6e61 6d65 223a 2022 7573 6572 7322 0a20  name": "users". 
+0000fc10: 2020 2020 2020 2020 2020 207d 2c0a 2020             },.  
+0000fc20: 2020 2020 2020 2262 7265 6164 6372 756d        "breadcrum
+0000fc30: 6222 3a20 5b5d 0a20 2020 2020 2020 207d  b": [].        }
+0000fc40: 5d0a 0a20 2020 2023 2055 6e69 7175 6520  ]..    # Unique 
+0000fc50: 7072 696d 6172 7920 6b65 7920 7072 6f76  primary key prov
+0000fc60: 6964 6564 2062 7920 7573 6572 0a20 2020  ided by user.   
+0000fc70: 206b 6579 5f70 726f 7065 7274 6965 7320   key_properties 
+0000fc80: 3d20 5b5d 0a20 2020 2069 6620 636f 6e66  = [].    if conf
+0000fc90: 6967 2e67 6574 2822 7072 696d 6172 795f  ig.get("primary_
+0000fca0: 6b65 7922 293a 0a20 2020 2020 2020 206b  key"):.        k
+0000fcb0: 6579 5f70 726f 7065 7274 6965 7320 3d20  ey_properties = 
+0000fcc0: 5b63 6f6e 6669 672e 6765 7428 2270 7269  [config.get("pri
+0000fcd0: 6d61 7279 5f6b 6579 2229 5d0a 0a20 2020  mary_key")]..   
+0000fce0: 2063 6174 616c 6f67 203d 207b 2273 656c   catalog = {"sel
+0000fcf0: 6563 7465 6422 3a20 5472 7565 2c0a 2020  ected": True,.  
+0000fd00: 2020 2020 2020 2020 2020 2020 2022 7479               "ty
+0000fd10: 7065 223a 2022 6f62 6a65 6374 222c 0a20  pe": "object",. 
+0000fd20: 2020 2020 2020 2020 2020 2020 2020 2273                "s
+0000fd30: 7472 6561 6d22 3a20 7374 7265 616d 5b22  tream": stream["
+0000fd40: 6e61 6d65 225d 2c0a 2020 2020 2020 2020  name"],.        
+0000fd50: 2020 2020 2020 2022 6b65 795f 7072 6f70         "key_prop
+0000fd60: 6572 7469 6573 223a 206b 6579 5f70 726f  erties": key_pro
+0000fd70: 7065 7274 6965 732c 0a20 2020 2020 2020  perties,.       
+0000fd80: 2020 2020 2020 2020 2270 726f 7065 7274          "propert
+0000fd90: 6965 7322 3a20 7363 6865 6d61 5b22 7072  ies": schema["pr
+0000fda0: 6f70 6572 7469 6573 225d 0a20 2020 2020  operties"].     
+0000fdb0: 2020 2020 2020 2020 2020 7d0a 0a20 2020            }..   
+0000fdc0: 2072 6574 7572 6e20 7374 7265 616d 5f6d   return stream_m
+0000fdd0: 6574 6164 6174 612c 206b 6579 5f70 726f  etadata, key_pro
+0000fde0: 7065 7274 6965 732c 2063 6174 616c 6f67  perties, catalog
+0000fdf0: 0a0a 0a64 6566 2064 6f5f 7379 6e63 2863  ...def do_sync(c
+0000fe00: 6f6e 6669 672c 2073 7461 7465 2c20 7374  onfig, state, st
+0000fe10: 7265 616d 293a 0a20 2020 2073 696e 6765  ream):.    singe
+0000fe20: 722e 7365 745f 6375 7272 656e 746c 795f  r.set_currently_
+0000fe30: 7379 6e63 696e 6728 7374 6174 652c 2073  syncing(state, s
+0000fe40: 7472 6561 6d2e 7461 705f 7374 7265 616d  tream.tap_stream
+0000fe50: 5f69 6429 0a20 2020 2073 696e 6765 722e  _id).    singer.
+0000fe60: 7772 6974 655f 7374 6174 6528 7374 6174  write_state(stat
+0000fe70: 6529 0a0a 2020 2020 6372 6564 656e 7469  e)..    credenti
+0000fe80: 616c 7320 3d20 7365 7276 6963 655f 6163  als = service_ac
+0000fe90: 636f 756e 742e 4372 6564 656e 7469 616c  count.Credential
+0000fea0: 732e 6672 6f6d 5f73 6572 7669 6365 5f61  s.from_service_a
+0000feb0: 6363 6f75 6e74 5f66 696c 6528 636f 6e66  ccount_file(conf
+0000fec0: 6967 5b27 6372 6564 656e 7469 616c 735f  ig['credentials_
+0000fed0: 6669 6c65 275d 290a 2020 2020 636c 6965  file']).    clie
+0000fee0: 6e74 203d 2062 6967 7175 6572 792e 436c  nt = bigquery.Cl
+0000fef0: 6965 6e74 2870 726f 6a65 6374 3d63 6f6e  ient(project=con
+0000ff00: 6669 675b 2770 726f 6a65 6374 275d 2c20  fig['project'], 
+0000ff10: 6372 6564 656e 7469 616c 733d 6372 6564  credentials=cred
+0000ff20: 656e 7469 616c 7329 0a20 2020 206d 6574  entials).    met
+0000ff30: 6164 6174 6120 3d20 7374 7265 616d 2e6d  adata = stream.m
+0000ff40: 6574 6164 6174 615b 305d 5b22 6d65 7461  etadata[0]["meta
+0000ff50: 6461 7461 225d 0a20 2020 2074 6170 5f73  data"].    tap_s
+0000ff60: 7472 6561 6d5f 6964 203d 2073 7472 6561  tream_id = strea
+0000ff70: 6d2e 7461 705f 7374 7265 616d 5f69 640a  m.tap_stream_id.
+0000ff80: 0a20 2020 2069 6e63 6c75 7369 7665 5f73  .    inclusive_s
+0000ff90: 7461 7274 203d 2054 7275 650a 2020 2020  tart = True.    
+0000ffa0: 7374 6172 745f 6461 7465 7469 6d65 203d  start_datetime =
+0000ffb0: 2073 696e 6765 722e 6765 745f 626f 6f6b   singer.get_book
+0000ffc0: 6d61 726b 2873 7461 7465 2c20 7461 705f  mark(state, tap_
+0000ffd0: 7374 7265 616d 5f69 642c 0a20 2020 2020  stream_id,.     
+0000ffe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010000: 2020 2020 424f 4f4b 4d41 524b 5f4b 4559      BOOKMARK_KEY
+00010010: 5f4e 414d 4529 0a20 2020 2069 6620 7374  _NAME).    if st
+00010020: 6172 745f 6461 7465 7469 6d65 3a0a 2020  art_datetime:.  
+00010030: 2020 2020 2020 6966 206e 6f74 2063 6f6e        if not con
+00010040: 6669 672e 6765 7428 2273 7461 7274 5f61  fig.get("start_a
+00010050: 6c77 6179 735f 696e 636c 7573 6976 6522  lways_inclusive"
+00010060: 293a 0a20 2020 2020 2020 2020 2020 2069  ):.            i
+00010070: 6e63 6c75 7369 7665 5f73 7461 7274 203d  nclusive_start =
+00010080: 2046 616c 7365 0a20 2020 2065 6c73 653a   False.    else:
+00010090: 0a20 2020 2020 2020 2073 7461 7274 5f64  .        start_d
+000100a0: 6174 6574 696d 6520 3d20 636f 6e66 6967  atetime = config
+000100b0: 2e67 6574 2822 7374 6172 745f 6461 7465  .get("start_date
+000100c0: 7469 6d65 2229 0a20 2020 2069 6620 7374  time").    if st
+000100d0: 6172 745f 6461 7465 7469 6d65 3a0a 2020  art_datetime:.  
+000100e0: 2020 2020 2020 7374 6172 745f 6461 7465        start_date
+000100f0: 7469 6d65 203d 2064 6174 6575 7469 6c2e  time = dateutil.
+00010100: 7061 7273 6572 2e70 6172 7365 2873 7461  parser.parse(sta
+00010110: 7274 5f64 6174 6574 696d 6529 2e73 7472  rt_datetime).str
+00010120: 6674 696d 6528 0a20 2020 2020 2020 2020  ftime(.         
+00010130: 2020 2022 2559 2d25 6d2d 2564 2025 483a     "%Y-%m-%d %H:
+00010140: 254d 3a25 532e 2566 2229 0a0a 2020 2020  %M:%S.%f")..    
+00010150: 6966 2063 6f6e 6669 672e 6765 7428 2265  if config.get("e
+00010160: 6e64 5f64 6174 6574 696d 6522 293a 0a20  nd_datetime"):. 
+00010170: 2020 2020 2020 2065 6e64 5f64 6174 6574         end_datet
+00010180: 696d 6520 3d20 6461 7465 7574 696c 2e70  ime = dateutil.p
+00010190: 6172 7365 722e 7061 7273 6528 0a20 2020  arser.parse(.   
+000101a0: 2020 2020 2020 2020 2063 6f6e 6669 672e           config.
+000101b0: 6765 7428 2265 6e64 5f64 6174 6574 696d  get("end_datetim
+000101c0: 6522 2929 2e73 7472 6674 696d 6528 2225  e")).strftime("%
+000101d0: 592d 256d 2d25 6420 2548 3a25 4d3a 2553  Y-%m-%d %H:%M:%S
+000101e0: 2e25 6622 290a 0a20 2020 2073 696e 6765  .%f")..    singe
+000101f0: 722e 7772 6974 655f 7363 6865 6d61 2874  r.write_schema(t
+00010200: 6170 5f73 7472 6561 6d5f 6964 2c20 7374  ap_stream_id, st
+00010210: 7265 616d 2e73 6368 656d 612e 746f 5f64  ream.schema.to_d
+00010220: 6963 7428 292c 0a20 2020 2020 2020 2020  ict(),.         
+00010230: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00010240: 7472 6561 6d2e 6b65 795f 7072 6f70 6572  tream.key_proper
+00010250: 7469 6573 290a 0a20 2020 206b 6579 7320  ties)..    keys 
+00010260: 3d20 7b22 7461 626c 6522 3a20 6d65 7461  = {"table": meta
+00010270: 6461 7461 5b22 7461 626c 6522 5d2c 0a20  data["table"],. 
+00010280: 2020 2020 2020 2020 2020 2022 636f 6c75             "colu
+00010290: 6d6e 7322 3a20 6d65 7461 6461 7461 5b22  mns": metadata["
+000102a0: 636f 6c75 6d6e 7322 5d2c 0a20 2020 2020  columns"],.     
+000102b0: 2020 2020 2020 2022 6461 7465 7469 6d65         "datetime
+000102c0: 5f6b 6579 223a 206d 6574 6164 6174 612e  _key": metadata.
+000102d0: 6765 7428 2264 6174 6574 696d 655f 6b65  get("datetime_ke
+000102e0: 7922 292c 0a20 2020 2020 2020 2020 2020  y"),.           
+000102f0: 2022 7374 6172 745f 6461 7465 7469 6d65   "start_datetime
+00010300: 223a 2073 7461 7274 5f64 6174 6574 696d  ": start_datetim
+00010310: 652c 0a20 2020 2020 2020 2020 2020 2022  e,.            "
+00010320: 656e 645f 6461 7465 7469 6d65 223a 2065  end_datetime": e
+00010330: 6e64 5f64 6174 6574 696d 650a 2020 2020  nd_datetime.    
+00010340: 2020 2020 2020 2020 7d0a 0a20 2020 206c          }..    l
+00010350: 696d 6974 203d 2063 6f6e 6669 672e 6765  imit = config.ge
+00010360: 7428 226c 696d 6974 222c 204e 6f6e 6529  t("limit", None)
+00010370: 0a20 2020 2071 7565 7279 203d 205f 6275  .    query = _bu
+00010380: 696c 645f 7175 6572 7928 6b65 7973 2c20  ild_query(keys, 
+00010390: 6d65 7461 6461 7461 2e67 6574 2822 6669  metadata.get("fi
+000103a0: 6c74 6572 7322 2c20 5b5d 292c 2069 6e63  lters", []), inc
+000103b0: 6c75 7369 7665 5f73 7461 7274 2c0a 2020  lusive_start,.  
+000103c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000103d0: 2020 2020 2020 206c 696d 6974 3d6c 696d         limit=lim
+000103e0: 6974 290a 2020 2020 7175 6572 795f 6a6f  it).    query_jo
+000103f0: 6220 3d20 636c 6965 6e74 2e71 7565 7279  b = client.query
+00010400: 2871 7565 7279 290a 0a20 2020 2070 726f  (query)..    pro
+00010410: 7065 7274 6965 7320 3d20 7374 7265 616d  perties = stream
+00010420: 2e73 6368 656d 612e 7072 6f70 6572 7469  .schema.properti
+00010430: 6573 0a20 2020 206c 6173 745f 7570 6461  es.    last_upda
+00010440: 7465 203d 2073 7461 7274 5f64 6174 6574  te = start_datet
+00010450: 696d 650a 0a20 2020 204c 4f47 4745 522e  ime..    LOGGER.
+00010460: 696e 666f 2822 5275 6e6e 696e 6720 7175  info("Running qu
+00010470: 6572 793a 5c6e 2020 2020 2573 2220 2520  ery:\n    %s" % 
+00010480: 7175 6572 7929 0a0a 2020 2020 6578 7472  query)..    extr
+00010490: 6163 745f 7473 7461 6d70 203d 2064 6174  act_tstamp = dat
+000104a0: 6574 696d 652e 6461 7465 7469 6d65 2e75  etime.datetime.u
+000104b0: 7463 6e6f 7728 290a 2020 2020 6578 7472  tcnow().    extr
+000104c0: 6163 745f 7473 7461 6d70 203d 2065 7874  act_tstamp = ext
+000104d0: 7261 6374 5f74 7374 616d 702e 7265 706c  ract_tstamp.repl
+000104e0: 6163 6528 747a 696e 666f 3d64 6174 6574  ace(tzinfo=datet
+000104f0: 696d 652e 7469 6d65 7a6f 6e65 2e75 7463  ime.timezone.utc
+00010500: 290a 0a20 2020 2077 6974 6820 6d65 7472  )..    with metr
+00010510: 6963 732e 7265 636f 7264 5f63 6f75 6e74  ics.record_count
+00010520: 6572 2874 6170 5f73 7472 6561 6d5f 6964  er(tap_stream_id
+00010530: 2920 6173 2063 6f75 6e74 6572 3a0a 2020  ) as counter:.  
+00010540: 2020 2020 2020 666f 7220 726f 7720 696e        for row in
+00010550: 2071 7565 7279 5f6a 6f62 3a0a 2020 2020   query_job:.    
+00010560: 2020 2020 2020 2020 7469 6d65 5f65 7874          time_ext
+00010570: 7261 6374 6564 203d 2075 7469 6c73 2e6e  racted = utils.n
+00010580: 6f77 2829 0a20 2020 2020 2020 2020 2020  ow().           
+00010590: 2072 6563 6f72 6420 3d20 726f 775f 746f   record = row_to
+000105a0: 5f72 6563 6f72 6428 726f 772c 2070 726f  _record(row, pro
+000105b0: 7065 7274 6965 732c 2065 7874 7261 6374  perties, extract
+000105c0: 5f74 7374 616d 7029 0a0a 2020 2020 2020  _tstamp)..      
+000105d0: 2020 2020 2020 7369 6e67 6572 2e77 7269        singer.wri
+000105e0: 7465 5f72 6563 6f72 6428 7374 7265 616d  te_record(stream
+000105f0: 2e73 7472 6561 6d2c 2072 6563 6f72 642c  .stream, record,
+00010600: 2074 696d 655f 6578 7472 6163 7465 643d   time_extracted=
+00010610: 7469 6d65 5f65 7874 7261 6374 6564 290a  time_extracted).
+00010620: 0a20 2020 2020 2020 2020 2020 206c 6173  .            las
+00010630: 745f 7570 6461 7465 203d 2072 6563 6f72  t_update = recor
+00010640: 645b 6b65 7973 5b22 6461 7465 7469 6d65  d[keys["datetime
+00010650: 5f6b 6579 225d 5d20 6966 2022 6461 7465  _key"]] if "date
+00010660: 7469 6d65 5f6b 6579 2220 696e 206b 6579  time_key" in key
+00010670: 7320 616e 6420 6b65 7973 5b22 6461 7465  s and keys["date
+00010680: 7469 6d65 5f6b 6579 225d 2065 6c73 6520  time_key"] else 
+00010690: 2222 0a20 2020 2020 2020 2020 2020 2063  "".            c
+000106a0: 6f75 6e74 6572 2e69 6e63 7265 6d65 6e74  ounter.increment
+000106b0: 2829 0a0a 2020 2020 7374 6174 6520 3d20  ()..    state = 
+000106c0: 7369 6e67 6572 2e77 7269 7465 5f62 6f6f  singer.write_boo
+000106d0: 6b6d 6172 6b28 7374 6174 652c 2074 6170  kmark(state, tap
+000106e0: 5f73 7472 6561 6d5f 6964 2c20 424f 4f4b  _stream_id, BOOK
+000106f0: 4d41 524b 5f4b 4559 5f4e 414d 452c 0a20  MARK_KEY_NAME,. 
+00010700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010720: 206c 6173 745f 7570 6461 7465 290a 0a20   last_update).. 
+00010730: 2020 2073 696e 6765 722e 7772 6974 655f     singer.write_
+00010740: 7374 6174 6528 7374 6174 6529 0a0a 0a64  state(state)...d
+00010750: 6566 2072 6f77 5f74 6f5f 7265 636f 7264  ef row_to_record
+00010760: 2872 6f77 2c20 7072 6f70 6572 7469 6573  (row, properties
+00010770: 2c20 6578 7472 6163 745f 7473 7461 6d70  , extract_tstamp
+00010780: 2c20 7573 655f 6469 6374 3d46 616c 7365  , use_dict=False
+00010790: 293a 0a20 2020 2072 6563 6f72 6420 3d20  ):.    record = 
+000107a0: 7b7d 0a20 2020 2066 6f72 206b 6579 2069  {}.    for key i
+000107b0: 6e20 7072 6f70 6572 7469 6573 2e6b 6579  n properties.key
+000107c0: 7328 293a 0a20 2020 2020 2020 2070 726f  s():.        pro
+000107d0: 7020 3d20 7072 6f70 6572 7469 6573 5b6b  p = properties[k
+000107e0: 6579 5d0a 0a20 2020 2020 2020 2069 6620  ey]..        if 
+000107f0: 6b65 7920 3d3d 2045 5854 5241 4354 5f54  key == EXTRACT_T
+00010800: 494d 4553 5441 4d50 3a0a 2020 2020 2020  IMESTAMP:.      
+00010810: 2020 2020 2020 636f 6e74 696e 7565 0a0a        continue..
+00010820: 2020 2020 2020 2020 6966 2072 6f77 5b6b          if row[k
+00010830: 6579 5d20 6973 204e 6f6e 653a 0a20 2020  ey] is None:.   
+00010840: 2020 2020 2020 2020 2069 6620 2870 726f           if (pro
+00010850: 705b 2774 7970 6527 5d5b 305d 2069 6620  p['type'][0] if 
+00010860: 7573 655f 6469 6374 2065 6c73 6520 7072  use_dict else pr
+00010870: 6f70 2e74 7970 655b 305d 2920 213d 2022  op.type[0]) != "
+00010880: 6e75 6c6c 223a 0a20 2020 2020 2020 2020  null":.         
+00010890: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+000108a0: 7565 4572 726f 7228 224e 554c 4c20 7661  ueError("NULL va
+000108b0: 6c75 6520 6e6f 7420 616c 6c6f 7765 6420  lue not allowed 
+000108c0: 6279 2074 6865 2073 6368 656d 6122 290a  by the schema").
+000108d0: 2020 2020 2020 2020 2020 2020 656c 7365              else
+000108e0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000108f0: 2020 7265 636f 7264 5b6b 6579 5d20 3d20    record[key] = 
+00010900: 4e6f 6e65 0a20 2020 2020 2020 2065 6c69  None.        eli
+00010910: 6620 2870 726f 702e 6765 7428 2766 6f72  f (prop.get('for
+00010920: 6d61 7427 2920 6966 2075 7365 5f64 6963  mat') if use_dic
+00010930: 7420 656c 7365 2070 726f 702e 666f 726d  t else prop.form
+00010940: 6174 2920 3d3d 2022 6461 7465 2d74 696d  at) == "date-tim
+00010950: 6522 3a0a 2020 2020 2020 2020 2020 2020  e":.            
+00010960: 6966 2074 7970 6528 726f 775b 6b65 795d  if type(row[key]
+00010970: 2920 3d3d 2073 7472 3a0a 2020 2020 2020  ) == str:.      
+00010980: 2020 2020 2020 2020 2020 7220 3d20 6461            r = da
+00010990: 7465 7574 696c 2e70 6172 7365 722e 7061  teutil.parser.pa
+000109a0: 7273 6528 726f 775b 6b65 795d 290a 2020  rse(row[key]).  
+000109b0: 2020 2020 2020 2020 2020 656c 6966 2074            elif t
+000109c0: 7970 6528 726f 775b 6b65 795d 2920 3d3d  ype(row[key]) ==
+000109d0: 2064 6174 6574 696d 652e 6461 7465 3a0a   datetime.date:.
+000109e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000109f0: 7220 3d20 6461 7465 7469 6d65 2e64 6174  r = datetime.dat
+00010a00: 6574 696d 6528 7965 6172 3d72 6f77 5b6b  etime(year=row[k
+00010a10: 6579 5d2e 7965 6172 2c20 6d6f 6e74 683d  ey].year, month=
+00010a20: 726f 775b 6b65 795d 2e6d 6f6e 7468 2c20  row[key].month, 
+00010a30: 6461 793d 726f 775b 6b65 795d 2e64 6179  day=row[key].day
+00010a40: 290a 2020 2020 2020 2020 2020 2020 656c  ).            el
+00010a50: 6966 2074 7970 6528 726f 775b 6b65 795d  if type(row[key]
+00010a60: 2920 3d3d 2064 6174 6574 696d 652e 6461  ) == datetime.da
+00010a70: 7465 7469 6d65 3a0a 2020 2020 2020 2020  tetime:.        
+00010a80: 2020 2020 2020 2020 7220 3d20 726f 775b          r = row[
+00010a90: 6b65 795d 0a20 2020 2020 2020 2020 2020  key].           
+00010aa0: 2072 6563 6f72 645b 6b65 795d 203d 2072   record[key] = r
+00010ab0: 2e69 736f 666f 726d 6174 2829 0a20 2020  .isoformat().   
+00010ac0: 2020 2020 2065 6c69 6620 2870 726f 705b       elif (prop[
+00010ad0: 2774 7970 6527 5d5b 315d 2069 6620 7573  'type'][1] if us
+00010ae0: 655f 6469 6374 2065 6c73 6520 7072 6f70  e_dict else prop
+00010af0: 2e74 7970 655b 315d 2920 3d3d 2022 7374  .type[1]) == "st
+00010b00: 7269 6e67 223a 0a20 2020 2020 2020 2020  ring":.         
+00010b10: 2020 2072 6563 6f72 645b 6b65 795d 203d     record[key] =
+00010b20: 2073 7472 2872 6f77 5b6b 6579 5d29 0a20   str(row[key]). 
+00010b30: 2020 2020 2020 2065 6c69 6620 2870 726f         elif (pro
+00010b40: 705b 2774 7970 6527 5d5b 315d 2069 6620  p['type'][1] if 
+00010b50: 7573 655f 6469 6374 2065 6c73 6520 7072  use_dict else pr
+00010b60: 6f70 2e74 7970 655b 315d 2920 3d3d 2022  op.type[1]) == "
+00010b70: 6e75 6d62 6572 223a 0a20 2020 2020 2020  number":.       
+00010b80: 2020 2020 2072 6563 6f72 645b 6b65 795d       record[key]
+00010b90: 203d 2044 6563 696d 616c 2872 6f77 5b6b   = Decimal(row[k
+00010ba0: 6579 5d29 0a20 2020 2020 2020 2065 6c69  ey]).        eli
+00010bb0: 6620 2870 726f 705b 2774 7970 6527 5d5b  f (prop['type'][
+00010bc0: 315d 2069 6620 7573 655f 6469 6374 2065  1] if use_dict e
+00010bd0: 6c73 6520 7072 6f70 2e74 7970 655b 315d  lse prop.type[1]
+00010be0: 2920 3d3d 2022 696e 7465 6765 7222 3a0a  ) == "integer":.
+00010bf0: 2020 2020 2020 2020 2020 2020 7265 636f              reco
+00010c00: 7264 5b6b 6579 5d20 3d20 696e 7428 726f  rd[key] = int(ro
+00010c10: 775b 6b65 795d 290a 2020 2020 2020 2020  w[key]).        
+00010c20: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00010c30: 2020 7265 636f 7264 5b6b 6579 5d20 3d20    record[key] = 
+00010c40: 726f 775b 6b65 795d 0a0a 2020 2020 6966  row[key]..    if
+00010c50: 2045 5854 5241 4354 5f54 494d 4553 5441   EXTRACT_TIMESTA
+00010c60: 4d50 2069 6e20 7072 6f70 6572 7469 6573  MP in properties
+00010c70: 2e6b 6579 7328 293a 0a20 2020 2020 2020  .keys():.       
+00010c80: 2072 6563 6f72 645b 4558 5452 4143 545f   record[EXTRACT_
+00010c90: 5449 4d45 5354 414d 505d 203d 2065 7874  TIMESTAMP] = ext
+00010ca0: 7261 6374 5f74 7374 616d 702e 6973 6f66  ract_tstamp.isof
+00010cb0: 6f72 6d61 7428 290a 0a20 2020 2072 6574  ormat()..    ret
+00010cc0: 7572 6e20 7265 636f 7264 0a0a 0a64 6566  urn record...def
+00010cd0: 2073 686f 756c 645f 7379 6e63 5f63 6f6c   should_sync_col
+00010ce0: 756d 6e28 6d64 5f6d 6170 2c20 6669 656c  umn(md_map, fiel
+00010cf0: 645f 6e61 6d65 293a 0a20 2020 2066 6965  d_name):.    fie
+00010d00: 6c64 5f6d 6574 6164 6174 6120 3d20 6d64  ld_metadata = md
+00010d10: 5f6d 6170 2e67 6574 2828 2770 726f 7065  _map.get(('prope
+00010d20: 7274 6965 7327 2c20 6669 656c 645f 6e61  rties', field_na
+00010d30: 6d65 292c 207b 7d29 0a20 2020 2072 6574  me), {}).    ret
+00010d40: 7572 6e20 7369 6e67 6572 2e73 686f 756c  urn singer.shoul
+00010d50: 645f 7379 6e63 5f66 6965 6c64 2866 6965  d_sync_field(fie
+00010d60: 6c64 5f6d 6574 6164 6174 612e 6765 7428  ld_metadata.get(
+00010d70: 2769 6e63 6c75 7369 6f6e 2729 2c0a 2020  'inclusion'),.  
+00010d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010da0: 2020 6669 656c 645f 6d65 7461 6461 7461    field_metadata
+00010db0: 2e67 6574 2827 7365 6c65 6374 6564 2729  .get('selected')
+00010dc0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00010dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010de0: 2020 2020 2020 5472 7565 290a 0a0a 6465        True)...de
+00010df0: 6620 6372 6561 7465 5f63 7265 6465 6e74  f create_credent
+00010e00: 6961 6c73 5f66 696c 6528 636f 6e66 6967  ials_file(config
+00010e10: 3a20 4469 6374 2920 2d3e 2044 6963 743a  : Dict) -> Dict:
+00010e20: 0a20 2020 2070 6174 685f 7575 6964 203d  .    path_uuid =
+00010e30: 2075 7569 642e 7575 6964 3428 292e 6865   uuid.uuid4().he
+00010e40: 780a 2020 2020 7472 793a 0a20 2020 2020  x.    try:.     
+00010e50: 2020 2069 6620 636f 6e66 6967 2e67 6574     if config.get
+00010e60: 2827 6372 6564 656e 7469 616c 735f 6669  ('credentials_fi
+00010e70: 6c65 2729 3a0a 2020 2020 2020 2020 2020  le'):.          
+00010e80: 2020 7061 7468 203d 2066 222f 6f70 742f    path = f"/opt/
+00010e90: 6269 6771 7565 7279 2f7b 7061 7468 5f75  bigquery/{path_u
+00010ea0: 7569 647d 2f63 6c69 656e 745f 7365 6372  uid}/client_secr
+00010eb0: 6574 732e 6a73 6f6e 220a 2020 2020 2020  ets.json".      
+00010ec0: 2020 2020 2020 636c 6965 6e74 5f73 6563        client_sec
+00010ed0: 7265 7473 203d 2050 6174 6828 7061 7468  rets = Path(path
+00010ee0: 290a 2020 2020 2020 2020 2020 2020 636c  ).            cl
+00010ef0: 6965 6e74 5f73 6563 7265 7473 2e70 6172  ient_secrets.par
+00010f00: 656e 742e 6d6b 6469 7228 6578 6973 745f  ent.mkdir(exist_
+00010f10: 6f6b 3d54 7275 652c 2070 6172 656e 7473  ok=True, parents
+00010f20: 3d54 7275 6529 0a20 2020 2020 2020 2020  =True).         
+00010f30: 2020 2063 6c69 656e 745f 7365 6372 6574     client_secret
+00010f40: 732e 7772 6974 655f 7465 7874 2863 6f6e  s.write_text(con
+00010f50: 6669 675b 2763 7265 6465 6e74 6961 6c73  fig['credentials
+00010f60: 5f66 696c 6527 5d29 0a20 2020 2020 2020  _file']).       
+00010f70: 2020 2020 2063 6f6e 6669 675b 2763 7265       config['cre
+00010f80: 6465 6e74 6961 6c73 5f66 696c 6527 5d20  dentials_file'] 
+00010f90: 3d20 636c 6965 6e74 5f73 6563 7265 7473  = client_secrets
+00010fa0: 0a20 2020 2020 2020 2020 2020 204c 4f47  .            LOG
+00010fb0: 4745 522e 696e 666f 2866 2243 6c69 656e  GER.info(f"Clien
+00010fc0: 7420 6372 6564 656e 7469 616c 7320 6669  t credentials fi
+00010fd0: 6c65 2063 7265 6174 6564 2061 743a 207b  le created at: {
+00010fe0: 7061 7468 7d22 290a 2020 2020 6578 6365  path}").    exce
+00010ff0: 7074 2045 7863 6570 7469 6f6e 2061 7320  pt Exception as 
+00011000: 653a 0a20 2020 2020 2020 204c 4f47 4745  e:.        LOGGE
+00011010: 522e 7761 726e 2866 2246 6169 6c65 6420  R.warn(f"Failed 
+00011020: 746f 2063 6c69 656e 7420 6372 6564 656e  to client creden
+00011030: 7469 616c 7320 6669 6c65 3a20 2f6f 7074  tials file: /opt
+00011040: 2f62 6967 7175 6572 792f 7b70 6174 685f  /bigquery/{path_
+00011050: 7575 6964 7d2f 2e20 7b65 7d22 290a 2020  uuid}/. {e}").  
+00011060: 2020 7265 7475 726e 2063 6f6e 6669 670a    return config.
+00011070: 0a0a 6465 6620 6465 6c65 7465 5f63 7265  ..def delete_cre
+00011080: 6465 6e74 6961 6c73 5f66 696c 6528 636f  dentials_file(co
+00011090: 6e66 6967 3a20 4469 6374 2920 2d3e 204e  nfig: Dict) -> N
+000110a0: 6f6e 653a 0a20 2020 2074 7279 3a0a 2020  one:.    try:.  
+000110b0: 2020 2020 2020 6966 2063 6f6e 6669 672e        if config.
+000110c0: 6765 7428 2763 7265 6465 6e74 6961 6c73  get('credentials
+000110d0: 5f66 696c 6527 293a 0a20 2020 2020 2020  _file'):.       
+000110e0: 2020 2020 2070 6174 6820 3d20 636f 6e66       path = conf
+000110f0: 6967 5b27 6372 6564 656e 7469 616c 735f  ig['credentials_
+00011100: 6669 6c65 275d 0a20 2020 2020 2020 2020  file'].         
+00011110: 2020 2063 6c69 656e 745f 7365 6372 6574     client_secret
+00011120: 7320 3d20 5061 7468 2870 6174 6829 0a20  s = Path(path). 
 00011130: 2020 2020 2020 2020 2020 2063 6f6e 6669             confi
 00011140: 675b 2763 7265 6465 6e74 6961 6c73 5f66  g['credentials_f
 00011150: 696c 6527 5d20 3d20 636c 6965 6e74 5f73  ile'] = client_s
-00011160: 6563 7265 7473 0a20 2020 2020 2020 2020  ecrets.         
-00011170: 2020 204c 4f47 4745 522e 696e 666f 2866     LOGGER.info(f
-00011180: 2243 6c69 656e 7420 6372 6564 656e 7469  "Client credenti
-00011190: 616c 7320 6669 6c65 2063 7265 6174 6564  als file created
-000111a0: 2061 743a 207b 7061 7468 7d22 290a 2020   at: {path}").  
-000111b0: 2020 6578 6365 7074 2045 7863 6570 7469    except Excepti
-000111c0: 6f6e 2061 7320 653a 0a20 2020 2020 2020  on as e:.       
-000111d0: 204c 4f47 4745 522e 7761 726e 2866 2246   LOGGER.warn(f"F
-000111e0: 6169 6c65 6420 746f 2063 6c69 656e 7420  ailed to client 
-000111f0: 6372 6564 656e 7469 616c 7320 6669 6c65  credentials file
-00011200: 3a20 2f6f 7074 2f62 6967 7175 6572 792f  : /opt/bigquery/
-00011210: 7b70 6174 685f 7575 6964 7d2f 2e20 7b65  {path_uuid}/. {e
-00011220: 7d22 290a 2020 2020 7265 7475 726e 2063  }").    return c
-00011230: 6f6e 6669 670a 0a0a 6465 6620 6465 6c65  onfig...def dele
-00011240: 7465 5f63 7265 6465 6e74 6961 6c73 5f66  te_credentials_f
-00011250: 696c 6528 636f 6e66 6967 3a20 4469 6374  ile(config: Dict
-00011260: 2920 2d3e 204e 6f6e 653a 0a20 2020 2074  ) -> None:.    t
-00011270: 7279 3a0a 2020 2020 2020 2020 6966 2063  ry:.        if c
-00011280: 6f6e 6669 672e 6765 7428 2763 7265 6465  onfig.get('crede
-00011290: 6e74 6961 6c73 5f66 696c 6527 293a 0a20  ntials_file'):. 
-000112a0: 2020 2020 2020 2020 2020 2070 6174 6820             path 
-000112b0: 3d20 636f 6e66 6967 5b27 6372 6564 656e  = config['creden
-000112c0: 7469 616c 735f 6669 6c65 275d 0a20 2020  tials_file'].   
-000112d0: 2020 2020 2020 2020 2063 6c69 656e 745f           client_
-000112e0: 7365 6372 6574 7320 3d20 5061 7468 2870  secrets = Path(p
-000112f0: 6174 6829 0a20 2020 2020 2020 2020 2020  ath).           
-00011300: 2063 6f6e 6669 675b 2763 7265 6465 6e74   config['credent
-00011310: 6961 6c73 5f66 696c 6527 5d20 3d20 636c  ials_file'] = cl
-00011320: 6965 6e74 5f73 6563 7265 7473 2e72 6561  ient_secrets.rea
-00011330: 645f 7465 7874 2829 0a20 2020 2020 2020  d_text().       
-00011340: 2020 2020 2063 6c69 656e 745f 7365 6372       client_secr
-00011350: 6574 732e 756e 6c69 6e6b 2829 0a20 2020  ets.unlink().   
-00011360: 2020 2020 2020 2020 204c 4f47 4745 522e           LOGGER.
-00011370: 696e 666f 2866 2243 6c69 656e 7420 6372  info(f"Client cr
-00011380: 6564 656e 7469 616c 7320 6669 6c65 2064  edentials file d
-00011390: 656c 6574 6564 2066 726f 6d3a 207b 7061  eleted from: {pa
-000113a0: 7468 7d22 290a 2020 2020 2020 2020 2020  th}").          
-000113b0: 2020 636c 6965 6e74 5f73 6563 7265 7473    client_secrets
-000113c0: 2e70 6172 656e 742e 726d 6469 7228 290a  .parent.rmdir().
-000113d0: 2020 2020 6578 6365 7074 2045 7863 6570      except Excep
-000113e0: 7469 6f6e 2061 7320 653a 0a20 2020 2020  tion as e:.     
-000113f0: 2020 204c 4f47 4745 522e 7761 726e 2866     LOGGER.warn(f
-00011400: 2246 6169 6c65 6420 746f 2064 656c 6574  "Failed to delet
-00011410: 6520 636c 6965 6e74 2063 7265 6465 6e74  e client credent
-00011420: 6961 6c73 2066 696c 653a 207b 657d 2229  ials file: {e}")
-00011430: 0a00 0000 0000 0000 0000 0000 0000 0000  ................
+00011160: 6563 7265 7473 2e72 6561 645f 7465 7874  ecrets.read_text
+00011170: 2829 0a20 2020 2020 2020 2020 2020 2063  ().            c
+00011180: 6c69 656e 745f 7365 6372 6574 732e 756e  lient_secrets.un
+00011190: 6c69 6e6b 2829 0a20 2020 2020 2020 2020  link().         
+000111a0: 2020 204c 4f47 4745 522e 696e 666f 2866     LOGGER.info(f
+000111b0: 2243 6c69 656e 7420 6372 6564 656e 7469  "Client credenti
+000111c0: 616c 7320 6669 6c65 2064 656c 6574 6564  als file deleted
+000111d0: 2066 726f 6d3a 207b 7061 7468 7d22 290a   from: {path}").
+000111e0: 2020 2020 2020 2020 2020 2020 636c 6965              clie
+000111f0: 6e74 5f73 6563 7265 7473 2e70 6172 656e  nt_secrets.paren
+00011200: 742e 726d 6469 7228 290a 2020 2020 6578  t.rmdir().    ex
+00011210: 6365 7074 2045 7863 6570 7469 6f6e 2061  cept Exception a
+00011220: 7320 653a 0a20 2020 2020 2020 204c 4f47  s e:.        LOG
+00011230: 4745 522e 7761 726e 2866 2246 6169 6c65  GER.warn(f"Faile
+00011240: 6420 746f 2064 656c 6574 6520 636c 6965  d to delete clie
+00011250: 6e74 2063 7265 6465 6e74 6961 6c73 2066  nt credentials f
+00011260: 696c 653a 207b 657d 2229 0a00 0000 0000  ile: {e}")......
+00011270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011290: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000112a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000112b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000112c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000112d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000112e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000112f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000113a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000113b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000113c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000113d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000113e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000113f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011400: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00011410: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011490: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011460: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00011470: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00011480: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
+00011490: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
 000114a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000114b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000114c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000114d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000114e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000114f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011500: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 00011510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -4442,31 +4442,31 @@
 00011590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000115a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000115b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000115c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000115d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000115e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000115f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011600: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00011610: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011600: 3238 206d 7469 6d65 3d31 3639 3038 3739  28 mtime=1690879
+00011610: 3732 332e 3233 3437 3930 330a 0000 0000  723.2347903.....
 00011620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011660: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00011670: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00011680: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
-00011690: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
+00011660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011690: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000116a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000116b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000116c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000116d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000116e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000116f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011700: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00011700: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -4474,95 +4474,95 @@
 00011790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000117a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000117b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000117c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000117d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000117e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000117f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011800: 3238 206d 7469 6d65 3d31 3638 3132 3134  28 mtime=1681214
-00011810: 3537 372e 3030 3936 3130 320a 0000 0000  577.0096102.....
-00011820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011800: 6d61 6372 6f6d 6574 612d 736f 7572 6365  macrometa-source
+00011810: 2d62 6967 7175 6572 792d 312e 302e 302f  -bigquery-1.0.0/
+00011820: 6d61 6372 6f6d 6574 615f 736f 7572 6365  macrometa_source
+00011830: 5f62 6967 7175 6572 792e 6567 672d 696e  _bigquery.egg-in
+00011840: 666f 2f00 0000 0000 0000 0000 0000 0000  fo/.............
 00011850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011890: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011860: 0000 0000 3030 3030 3735 3500 3030 3031  ....0000755.0001
+00011870: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+00011880: 3030 3030 3030 3000 3134 3436 3231 3433  0000000.14462143
+00011890: 3335 3300 3032 3531 3432 0020 3500 0000  353.025142. 5...
 000118a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000118b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000118c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000118d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000118e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000118f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011900: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
 00011910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011920: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
 00011930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000119a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000119b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000119c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000119d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000119e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000119f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011a00: 6d61 6372 6f6d 6574 612d 736f 7572 6365  macrometa-source
-00011a10: 2d62 6967 7175 6572 792d 302e 302e 392f  -bigquery-0.0.9/
-00011a20: 6d61 6372 6f6d 6574 615f 736f 7572 6365  macrometa_source
-00011a30: 5f62 6967 7175 6572 792e 6567 672d 696e  _bigquery.egg-in
-00011a40: 666f 2f00 0000 0000 0000 0000 0000 0000  fo/.............
+00011a00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00011a10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011a60: 0000 0000 3030 3030 3735 3500 3030 3031  ....0000755.0001
-00011a70: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
-00011a80: 3030 3030 3030 3000 3134 3431 3532 3436  0000000.14415246
-00011a90: 3136 3100 3032 3531 3531 0020 3500 0000  161.025151. 5...
+00011a60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00011a70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00011a80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+00011a90: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
 00011aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011b00: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
+00011b00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 00011b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011b20: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
+00011b20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011b40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011b50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011c00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00011c10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011c00: 3232 206d 7469 6d65 3d31 3639 3038 3739  22 mtime=1690879
+00011c10: 3732 332e 300a 0000 0000 0000 0000 0000  723.0...........
 00011c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011c60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00011c70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00011c80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00011c90: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
+00011c60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011c80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011c90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011d00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00011d00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011d20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011d40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011d50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -4570,575 +4570,575 @@
 00011d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011e00: 3232 206d 7469 6d65 3d31 3638 3132 3134  22 mtime=1681214
-00011e10: 3537 362e 300a 0000 0000 0000 0000 0000  576.0...........
-00011e20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011e00: 6d61 6372 6f6d 6574 612d 736f 7572 6365  macrometa-source
+00011e10: 2d62 6967 7175 6572 792d 312e 302e 302f  -bigquery-1.0.0/
+00011e20: 6d61 6372 6f6d 6574 615f 736f 7572 6365  macrometa_source
+00011e30: 5f62 6967 7175 6572 792e 6567 672d 696e  _bigquery.egg-in
+00011e40: 666f 2f50 4b47 2d49 4e46 4f00 0000 0000  fo/PKG-INFO.....
 00011e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011e60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011e70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011e80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011e90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011e60: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
+00011e70: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+00011e80: 3030 3136 3536 3400 3134 3436 3231 3433  0016564.14462143
+00011e90: 3335 3300 3032 3632 3533 0020 3000 0000  353.026253. 0...
 00011ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011f00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011f00: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
 00011f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00011f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011f20: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
 00011f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011f40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011f50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00011ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012000: 6d61 6372 6f6d 6574 612d 736f 7572 6365  macrometa-source
-00012010: 2d62 6967 7175 6572 792d 302e 302e 392f  -bigquery-0.0.9/
-00012020: 6d61 6372 6f6d 6574 615f 736f 7572 6365  macrometa_source
-00012030: 5f62 6967 7175 6572 792e 6567 672d 696e  _bigquery.egg-in
-00012040: 666f 2f50 4b47 2d49 4e46 4f00 0000 0000  fo/PKG-INFO.....
-00012050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012060: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
-00012070: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
-00012080: 3030 3136 3536 3400 3134 3431 3532 3436  0016564.14415246
-00012090: 3136 3000 3032 3632 3631 0020 3000 0000  160.026261. 0...
-000120a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000120b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000120c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000120d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000120e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000120f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012100: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
-00012110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012120: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
-00012130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000121a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000121b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000121c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000121d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000121e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000121f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012200: 4d65 7461 6461 7461 2d56 6572 7369 6f6e  Metadata-Version
-00012210: 3a20 322e 310a 4e61 6d65 3a20 6d61 6372  : 2.1.Name: macr
-00012220: 6f6d 6574 612d 736f 7572 6365 2d62 6967  ometa-source-big
-00012230: 7175 6572 790a 5665 7273 696f 6e3a 2030  query.Version: 0
-00012240: 2e30 2e39 0a53 756d 6d61 7279 3a20 4d61  .0.9.Summary: Ma
-00012250: 6372 6f6d 6574 6120 736f 7572 6365 2062  crometa source b
-00012260: 6967 7175 6572 7920 636f 6e6e 6563 746f  igquery connecto
-00012270: 7220 666f 7220 6578 7472 6163 7469 6e67  r for extracting
-00012280: 2064 6174 6120 6672 6f6d 2042 6967 5175   data from BigQu
-00012290: 6572 790a 486f 6d65 2d70 6167 653a 2068  ery.Home-page: h
-000122a0: 7474 7073 3a2f 2f67 6974 6875 622e 636f  ttps://github.co
-000122b0: 6d2f 4d61 6372 6f6d 6574 6163 6f72 702f  m/Macrometacorp/
-000122c0: 6d61 6372 6f6d 6574 612d 736f 7572 6365  macrometa-source
-000122d0: 2d62 6967 7175 6572 790a 4175 7468 6f72  -bigquery.Author
-000122e0: 3a20 4d61 6372 6f6d 6574 610a 436c 6173  : Macrometa.Clas
-000122f0: 7369 6669 6572 3a20 4c69 6365 6e73 6520  sifier: License 
-00012300: 3a3a 204f 5349 2041 7070 726f 7665 6420  :: OSI Approved 
-00012310: 3a3a 2041 7061 6368 6520 536f 6674 7761  :: Apache Softwa
-00012320: 7265 204c 6963 656e 7365 0a43 6c61 7373  re License.Class
-00012330: 6966 6965 723a 2050 726f 6772 616d 6d69  ifier: Programmi
-00012340: 6e67 204c 616e 6775 6167 6520 3a3a 2050  ng Language :: P
-00012350: 7974 686f 6e20 3a3a 2033 203a 3a20 4f6e  ython :: 3 :: On
-00012360: 6c79 0a44 6573 6372 6970 7469 6f6e 2d43  ly.Description-C
-00012370: 6f6e 7465 6e74 2d54 7970 653a 2074 6578  ontent-Type: tex
-00012380: 742f 6d61 726b 646f 776e 0a4c 6963 656e  t/markdown.Licen
-00012390: 7365 2d46 696c 653a 204c 4943 454e 5345  se-File: LICENSE
-000123a0: 0a0a 0a0a 2320 6d61 6372 6f6d 6574 612d  ....# macrometa-
-000123b0: 736f 7572 6365 2d62 6967 7175 6572 790a  source-bigquery.
-000123c0: 0a45 7874 7261 6374 2064 6174 6120 6672  .Extract data fr
-000123d0: 6f6d 2042 6967 5175 6572 7920 7461 626c  om BigQuery tabl
-000123e0: 6573 2e0a 0a54 6869 7320 6973 2061 206d  es...This is a m
-000123f0: 6163 726f 6d65 7461 2073 6f75 7263 6520  acrometa source 
-00012400: 6269 6771 7565 7279 2063 6f6e 6e65 6374  bigquery connect
-00012410: 6f72 2074 6861 7420 7072 6f64 7563 6573  or that produces
-00012420: 204a 534f 4e2d 666f 726d 6174 7465 6420   JSON-formatted 
-00012430: 6461 7461 0a66 6f6c 6c6f 7769 6e67 2074  data.following t
-00012440: 6865 205b 5369 6e67 6572 2073 7065 635d  he [Singer spec]
-00012450: 2868 7474 7073 3a2f 2f67 6974 6875 622e  (https://github.
-00012460: 636f 6d2f 7369 6e67 6572 2d69 6f2f 6765  com/singer-io/ge
-00012470: 7474 696e 672d 7374 6172 7465 642f 626c  tting-started/bl
-00012480: 6f62 2f6d 6173 7465 722f 5350 4543 2e6d  ob/master/SPEC.m
-00012490: 6429 2e0a 0a54 6869 7320 7461 703a 0a0a  d)...This tap:..
-000124a0: 2d20 5075 6c6c 7320 6461 7461 2066 726f  - Pulls data fro
-000124b0: 6d20 476f 6f67 6c65 2042 6967 5175 6572  m Google BigQuer
-000124c0: 7920 7461 626c 6573 2f76 6965 7773 2e0a  y tables/views..
-000124d0: 2d20 496e 6665 7273 2074 6865 2073 6368  - Infers the sch
-000124e0: 656d 6120 666f 7220 6561 6368 2072 6573  ema for each res
-000124f0: 6f75 7263 6520 616e 6420 7072 6f64 7563  ource and produc
-00012500: 6520 6361 7461 6c6f 6720 6669 6c65 2e0a  e catalog file..
-00012510: 0a23 2320 496e 7374 616c 6c61 7469 6f6e  .## Installation
-00012520: 0a0a 2323 2320 5374 6570 2031 3a20 4163  ..### Step 1: Ac
-00012530: 7469 7661 7465 2074 6865 2047 6f6f 676c  tivate the Googl
-00012540: 6520 4269 6751 7565 7279 2041 5049 0a0a  e BigQuery API..
-00012550: 2028 6f72 6967 696e 616c 6c79 2066 6f75   (originally fou
-00012560: 6e64 2069 6e20 7468 6520 5b47 6f6f 676c  nd in the [Googl
-00012570: 6520 4150 4920 646f 6373 5d28 6874 7470  e API docs](http
-00012580: 733a 2f2f 676f 6f67 6c65 636c 6f75 6470  s://googlecloudp
-00012590: 6c61 7466 6f72 6d2e 6769 7468 7562 2e69  latform.github.i
-000125a0: 6f2f 676f 6f67 6c65 2d63 6c6f 7564 2d70  o/google-cloud-p
-000125b0: 7974 686f 6e2f 6c61 7465 7374 2f62 6967  ython/latest/big
-000125c0: 7175 6572 792f 7573 6167 652e 6874 6d6c  query/usage.html
-000125d0: 2929 0a0a 2031 2e20 5573 6520 5b74 6869  )).. 1. Use [thi
-000125e0: 7320 7769 7a61 7264 5d28 6874 7470 733a  s wizard](https:
-000125f0: 2f2f 636f 6e73 6f6c 652e 6465 7665 6c6f  //console.develo
-00012600: 7065 7273 2e67 6f6f 676c 652e 636f 6d2f  pers.google.com/
-00012610: 7374 6172 742f 6170 693f 6964 3d62 6967  start/api?id=big
-00012620: 7175 6572 792d 6a73 6f6e 2e67 6f6f 676c  query-json.googl
-00012630: 6561 7069 732e 636f 6d29 2074 6f20 6372  eapis.com) to cr
-00012640: 6561 7465 206f 7220 7365 6c65 6374 2061  eate or select a
-00012650: 2070 726f 6a65 6374 2069 6e20 7468 6520   project in the 
-00012660: 476f 6f67 6c65 2044 6576 656c 6f70 6572  Google Developer
-00012670: 7320 436f 6e73 6f6c 6520 616e 6420 6163  s Console and ac
-00012680: 7469 7661 7465 2074 6865 2042 6967 5175  tivate the BigQu
-00012690: 6572 7920 4150 492e 2043 6c69 636b 2043  ery API. Click C
-000126a0: 6f6e 7469 6e75 652c 2074 6865 6e20 476f  ontinue, then Go
-000126b0: 2074 6f20 6372 6564 656e 7469 616c 732e   to credentials.
-000126c0: 0a20 322e 204f 6e20 7468 6520 2a2a 4164  . 2. On the **Ad
-000126d0: 6420 6372 6564 656e 7469 616c 7320 746f  d credentials to
-000126e0: 2079 6f75 7220 7072 6f6a 6563 742a 2a20   your project** 
-000126f0: 7061 6765 2c20 636c 6963 6b20 7468 6520  page, click the 
-00012700: 2a2a 4361 6e63 656c 2a2a 2062 7574 746f  **Cancel** butto
-00012710: 6e2e 0a20 332e 2041 7420 7468 6520 746f  n.. 3. At the to
-00012720: 7020 6f66 2074 6865 2070 6167 652c 2073  p of the page, s
-00012730: 656c 6563 7420 7468 6520 2a2a 4f41 7574  elect the **OAut
-00012740: 6820 636f 6e73 656e 7420 7363 7265 656e  h consent screen
-00012750: 2a2a 2074 6162 2e20 5365 6c65 6374 2061  ** tab. Select a
-00012760: 6e20 2a2a 456d 6169 6c20 6164 6472 6573  n **Email addres
-00012770: 732a 2a2c 2065 6e74 6572 2061 202a 2a50  s**, enter a **P
-00012780: 726f 6475 6374 206e 616d 652a 2a20 6966  roduct name** if
-00012790: 206e 6f74 2061 6c72 6561 6479 2073 6574   not already set
-000127a0: 2c20 616e 6420 636c 6963 6b20 7468 6520  , and click the 
-000127b0: 2a2a 5361 7665 2a2a 2062 7574 746f 6e2e  **Save** button.
-000127c0: 0a20 342e 2053 656c 6563 7420 7468 6520  . 4. Select the 
-000127d0: 2a2a 4372 6564 656e 7469 616c 732a 2a20  **Credentials** 
-000127e0: 7461 622c 2063 6c69 636b 2074 6865 202a  tab, click the *
-000127f0: 2a43 7265 6174 6520 6372 6564 656e 7469  *Create credenti
-00012800: 616c 732a 2a20 6275 7474 6f6e 2061 6e64  als** button and
-00012810: 2073 656c 6563 7420 2a2a 4f41 7574 6820   select **OAuth 
-00012820: 636c 6965 6e74 2049 442a 2a2e 0a20 352e  client ID**.. 5.
-00012830: 2053 656c 6563 7420 7468 6520 6170 706c   Select the appl
-00012840: 6963 6174 696f 6e20 7479 7065 202a 2a4f  ication type **O
-00012850: 7468 6572 2a2a 2c20 656e 7465 7220 7468  ther**, enter th
-00012860: 6520 6e61 6d65 2022 4d61 6372 6f6d 6574  e name "Macromet
-00012870: 6120 536f 7572 6365 2042 6967 5175 6572  a Source BigQuer
-00012880: 7922 2c20 616e 6420 636c 6963 6b20 7468  y", and click th
-00012890: 6520 2a2a 4372 6561 7465 2a2a 2062 7574  e **Create** but
-000128a0: 746f 6e2e 0a20 362e 2043 6c69 636b 202a  ton.. 6. Click *
-000128b0: 2a4f 4b2a 2a20 746f 2064 6973 6d69 7373  *OK** to dismiss
-000128c0: 2074 6865 2072 6573 756c 7469 6e67 2064   the resulting d
-000128d0: 6961 6c6f 672e 0a20 372e 2043 6c69 636b  ialog.. 7. Click
-000128e0: 2074 6865 2044 6f77 6e6c 6f61 6420 6275   the Download bu
-000128f0: 7474 6f6e 2074 6f20 7468 6520 7269 6768  tton to the righ
-00012900: 7420 6f66 2074 6865 2063 6c69 656e 7420  t of the client 
-00012910: 4944 2e0a 2038 2e20 4d6f 7665 2074 6869  ID.. 8. Move thi
-00012920: 7320 6669 6c65 2074 6f20 796f 7572 2077  s file to your w
-00012930: 6f72 6b69 6e67 2064 6972 6563 746f 7279  orking directory
-00012940: 2061 6e64 2072 656e 616d 6520 6974 202a   and rename it *
-00012950: 636c 6965 6e74 5f73 6563 7265 7473 2e6a  client_secrets.j
-00012960: 736f 6e2a 2e0a 0a0a 4578 706f 7274 2074  son*....Export t
-00012970: 6865 206c 6f63 6174 696f 6e20 6f66 2074  he location of t
-00012980: 6865 2073 6563 7265 7420 6669 6c65 3a0a  he secret file:.
-00012990: 0a60 6060 0a65 7870 6f72 7420 474f 4f47  .```.export GOOG
-000129a0: 4c45 5f41 5050 4c49 4341 5449 4f4e 5f43  LE_APPLICATION_C
-000129b0: 5245 4445 4e54 4941 4c53 3d22 2e2f 636c  REDENTIALS="./cl
-000129c0: 6965 6e74 5f73 6563 7265 742e 6a73 6f6e  ient_secret.json
-000129d0: 220a 6060 600a 0a46 6f72 206f 7468 6572  ".```..For other
-000129e0: 2061 7574 6865 6e74 6963 6174 696f 6e20   authentication 
-000129f0: 6d65 7468 6f64 2c20 706c 6561 7365 2073  method, please s
-00012a00: 6565 2041 7574 6865 6e74 6963 6174 696f  ee Authenticatio
-00012a10: 6e20 7365 6374 696f 6e2e 0a0a 2323 2320  n section...### 
-00012a20: 5374 6570 2032 3a20 496e 7374 616c 6c0a  Step 2: Install.
-00012a30: 0a46 6972 7374 2c20 6d61 6b65 2073 7572  .First, make sur
-00012a40: 6520 5079 7468 6f6e 2033 2069 7320 696e  e Python 3 is in
-00012a50: 7374 616c 6c65 6420 6f6e 2079 6f75 7220  stalled on your 
-00012a60: 7379 7374 656d 206f 7220 666f 6c6c 6f77  system or follow
-00012a70: 2074 6865 7365 200a 696e 7374 616c 6c61   these .installa
-00012a80: 7469 6f6e 2069 6e73 7472 7563 7469 6f6e  tion instruction
-00012a90: 7320 666f 7220 4d61 6320 6f72 2055 6275  s for Mac or Ubu
-00012aa0: 6e74 752e 0a0a 6060 600a 7069 7020 696e  ntu...```.pip in
-00012ab0: 7374 616c 6c20 2d55 206d 6163 726f 6d65  stall -U macrome
-00012ac0: 7461 2d73 6f75 7263 652d 6269 6771 7565  ta-source-bigque
-00012ad0: 7279 0a60 6060 0a0a 2323 2052 756e 0a0a  ry.```..## Run..
-00012ae0: 2323 2320 5374 6570 2031 3a20 436f 6e66  ### Step 1: Conf
-00012af0: 6967 7572 650a 0a43 7265 6174 6520 6120  igure..Create a 
-00012b00: 6669 6c65 2063 616c 6c65 6420 7461 705f  file called tap_
-00012b10: 636f 6e66 6967 2e6a 736f 6e20 696e 2079  config.json in y
-00012b20: 6f75 7220 776f 726b 696e 6720 6469 7265  our working dire
-00012b30: 6374 6f72 792c 2066 6f6c 6c6f 7769 6e67  ctory, following
-00012b40: 200a 636f 6e66 6967 2e73 616d 706c 652e   .config.sample.
-00012b50: 6a73 6f6e 3a0a 0a60 6060 0a7b 0a20 2022  json:..```.{.  "
-00012b60: 7374 7265 616d 7322 3a20 5b0a 2020 2020  streams": [.    
-00012b70: 2020 7b22 6e61 6d65 223a 2022 3c73 6f6d    {"name": "<som
-00012b80: 655f 7363 6865 6d61 5f6e 616d 653e 222c  e_schema_name>",
-00012b90: 0a20 2020 2020 2020 2274 6162 6c65 223a  .       "table":
-00012ba0: 2022 603c 7072 6f6a 6563 743e 2e3c 6461   "`<project>.<da
-00012bb0: 7461 7365 743e 2e3c 7461 626c 653e 6022  taset>.<table>`"
-00012bc0: 2c0a 2020 2020 2020 2022 636f 6c75 6d6e  ,.       "column
-00012bd0: 7322 3a20 5b22 3c63 6f6c 5f6e 616d 655f  s": ["<col_name_
-00012be0: 303e 222c 2022 3c63 6f6c 5f6e 616d 655f  0>", "<col_name_
-00012bf0: 313e 222c 2022 3c63 6f6c 5f6e 616d 655f  1>", "<col_name_
-00012c00: 323e 225d 2c0a 2020 2020 2020 2022 6461  2>"],.       "da
-00012c10: 7465 7469 6d65 5f6b 6579 223a 2022 3c79  tetime_key": "<y
-00012c20: 6f75 725f 6b65 793e 222c 0a20 2020 2020  our_key>",.     
-00012c30: 2020 2266 696c 7465 7273 223a 205b 2263    "filters": ["c
-00012c40: 6f75 6e74 7279 3d27 7573 2722 2c20 2273  ountry='us'", "s
-00012c50: 7461 7465 3d27 4341 2722 2c0a 2020 2020  tate='CA'",.    
-00012c60: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00012c70: 7265 6769 7374 6572 6564 5f6f 6e3e 3d44  registered_on>=D
-00012c80: 4154 455f 4144 4428 6375 7272 656e 745f  ATE_ADD(current_
-00012c90: 6461 7465 2c20 494e 5445 5256 414c 202d  date, INTERVAL -
-00012ca0: 3720 6461 7929 220a 2020 2020 2020 2020  7 day)".        
-00012cb0: 2020 2020 2020 2020 2020 5d20 2f2f 2061            ] // a
-00012cc0: 6c73 6f20 6f70 7469 6f6e 616c 3a20 7468  lso optional: th
-00012cd0: 6573 6520 6172 6520 7061 7273 6564 2069  ese are parsed i
-00012ce0: 6e20 2757 4845 5245 2720 636c 6175 7365  n 'WHERE' clause
-00012cf0: 0a20 2020 2020 207d 0a20 2020 205d 2c0a  .      }.    ],.
-00012d00: 2020 2273 7461 7274 5f64 6174 6574 696d    "start_datetim
-00012d10: 6522 3a20 2232 3031 372d 3031 2d30 3154  e": "2017-01-01T
-00012d20: 3030 3a30 303a 3030 5a22 2c20 2f2f 2054  00:00:00Z", // T
-00012d30: 6869 7320 6361 6e20 6265 2073 6574 2061  his can be set a
-00012d40: 7420 7468 6520 636f 6d6d 616e 6420 6c69  t the command li
-00012d50: 6e65 2061 7267 756d 656e 740a 2020 2265  ne argument.  "e
-00012d60: 6e64 5f64 6174 6574 696d 6522 3a20 2232  nd_datetime": "2
-00012d70: 3031 372d 3032 2d30 3154 3030 3a30 303a  017-02-01T00:00:
-00012d80: 3030 5a22 2c20 2f2f 2065 6e64 5f64 6174  00Z", // end_dat
-00012d90: 6574 696d 6520 6973 206f 7074 696f 6e61  etime is optiona
-00012da0: 6c0a 2020 226c 696d 6974 223a 2031 3030  l.  "limit": 100
-00012db0: 2c0a 2020 2273 7461 7274 5f61 6c77 6179  ,.  "start_alway
-00012dc0: 735f 696e 636c 7573 6976 6522 3a20 6661  s_inclusive": fa
-00012dd0: 6c73 6520 2f2f 2064 6566 6175 6c74 2069  lse // default i
-00012de0: 7320 6661 6c73 652c 206f 7074 696f 6e61  s false, optiona
-00012df0: 6c0a 7d0a 6060 600a 0a2d 2054 6865 2072  l.}.```..- The r
-00012e00: 6571 7569 7265 6420 7061 7261 6d65 7465  equired paramete
-00012e10: 7273 2069 7320 6174 206c 6561 7374 206f  rs is at least o
-00012e20: 6e65 2073 7472 6561 6d20 286f 6e65 2062  ne stream (one b
-00012e30: 6967 7175 6572 7920 7461 626c 652f 7669  igquery table/vi
-00012e40: 6577 2920 746f 2063 6f70 792e 0a20 202d  ew) to copy..  -
-00012e50: 2049 7420 6973 206e 6f74 2061 2072 6563   It is not a rec
-00012e60: 6f6d 6d65 6e64 6564 2042 6967 5175 6572  ommended BigQuer
-00012e70: 7920 7072 6163 7469 6365 2074 6f20 7573  y practice to us
-00012e80: 6520 602a 6020 746f 2073 7065 6369 6679  e `*` to specify
-00012e90: 2074 6865 2063 6f6c 756d 6e73 0a20 2020   the columns.   
-00012ea0: 2061 7320 6974 206d 6179 2062 6c6f 7720   as it may blow 
-00012eb0: 7570 2074 6865 2063 6f73 7420 666f 7220  up the cost for 
-00012ec0: 6120 7461 626c 6520 7769 7468 2061 206c  a table with a l
-00012ed0: 6172 6765 206e 756d 6265 7220 6f66 2063  arge number of c
-00012ee0: 6f6c 756d 6e73 2e0a 2020 2d20 6066 696c  olumns..  - `fil
-00012ef0: 7465 7273 6020 6172 6520 6f70 7469 6f6e  ters` are option
-00012f00: 616c 2062 7574 2077 6520 7374 726f 6e67  al but we strong
-00012f10: 6c79 2072 6563 6f6d 6d65 6e64 2075 7369  ly recommend usi
-00012f20: 6e67 2074 6869 7320 6f76 6572 2061 206c  ng this over a l
-00012f30: 6172 6765 0a20 2020 2070 6172 7469 7469  arge.    partiti
-00012f40: 6f6e 6564 2074 6162 6c65 2074 6f20 636f  oned table to co
-00012f50: 6e74 726f 6c20 7468 6520 636f 7374 2e20  ntrol the cost. 
-00012f60: 4c49 4d49 5420 2028 5468 6520 6175 7468  LIMIT  (The auth
-00012f70: 6f72 7320 6f66 2074 6170 2d62 6967 7175  ors of tap-bigqu
-00012f80: 6572 7920 6973 206e 6f74 0a20 2020 2072  ery is not.    r
-00012f90: 6573 706f 6e73 6962 6c65 2066 6f72 2074  esponsible for t
-00012fa0: 6865 2063 6f73 7420 696e 6375 7272 6564  he cost incurred
-00012fb0: 2062 7920 7275 6e6e 696e 6720 7468 6973   by running this
-00012fc0: 2070 726f 6772 616d 2e20 416c 7761 7973   program. Always
-00012fd0: 2074 6573 740a 2020 2020 7468 6f72 6f75   test.    thorou
-00012fe0: 6768 6c79 2077 6974 6820 736d 616c 6c20  ghly with small 
-00012ff0: 6461 7461 2073 6574 2066 6972 7374 2e29  data set first.)
-00013000: 0a2d 2060 7374 6172 745f 6461 7465 7469  .- `start_dateti
-00013010: 6d65 6020 6d75 7374 2061 6c73 6f20 6265  me` must also be
-00013020: 2073 6574 2069 6e20 7468 6520 636f 6e66   set in the conf
-00013030: 6967 2066 696c 6520 6f72 2061 7320 7468  ig file or as th
-00013040: 6520 636f 6d6d 616e 6420 6c69 6e65 0a20  e command line. 
-00013050: 2061 7267 756d 656e 7420 2853 6565 2074   argument (See t
-00013060: 6865 206e 6578 7420 7374 6570 292e 0a2d  he next step)..-
-00013070: 2060 6c69 6d69 7460 2077 696c 6c20 6c69   `limit` will li
-00013080: 6d69 7420 7468 6520 6e75 6d62 6572 206f  mit the number o
-00013090: 6620 7265 7375 6c74 732c 2062 7574 2069  f results, but i
-000130a0: 7420 646f 6573 206e 6f74 2072 6573 756c  t does not resul
-000130b0: 7420 696e 2072 6564 7563 650a 2020 7468  t in reduce.  th
-000130c0: 6520 7175 6572 7920 636f 7374 2e0a 0a54  e query cost...T
-000130d0: 6865 2074 6162 6c65 2f76 6965 7720 6973  he table/view is
-000130e0: 2065 7870 6563 7465 6420 746f 2068 6176   expected to hav
-000130f0: 6520 6120 636f 6c75 6d6e 2074 6f20 696e  e a column to in
-00013100: 6469 6361 7465 2074 6865 2063 7265 6174  dicate the creat
-00013110: 696f 6e20 6f72 0a75 7064 6174 6520 6461  ion or.update da
-00013120: 7465 2061 6e64 2074 696d 6520 736f 2074  te and time so t
-00013130: 6865 2074 6170 2073 656e 6473 2074 6865  he tap sends the
-00013140: 2071 7565 7279 2077 6974 6820 604f 5244   query with `ORD
-00013150: 4552 2042 5960 2061 6e64 2075 7365 0a74  ER BY` and use.t
-00013160: 6865 2063 6f6c 756d 6e20 746f 2072 6563  he column to rec
-00013170: 6f72 6420 7468 6520 626f 6f6b 6d61 726b  ord the bookmark
-00013180: 2028 5365 6520 5374 6174 6520 7365 6374   (See State sect
-00013190: 696f 6e29 2e0a 0a23 2323 2053 7465 7020  ion)...### Step 
-000131a0: 323a 2043 7265 6174 6520 6361 7461 6c6f  2: Create catalo
-000131b0: 670a 0a52 756e 2074 6170 2d62 6967 7175  g..Run tap-bigqu
-000131c0: 6572 7920 696e 2064 6973 636f 7665 7279  ery in discovery
-000131d0: 206d 6f64 6520 746f 206c 6574 2069 7420   mode to let it 
-000131e0: 6372 6561 7465 206a 736f 6e20 7363 6865  create json sche
-000131f0: 6d61 2066 696c 6520 616e 6420 7468 656e  ma file and then
-00013200: 0a72 756e 2074 6865 6d20 746f 6765 7468  .run them togeth
-00013210: 6572 2c20 7069 7069 6e67 2074 6865 206f  er, piping the o
-00013220: 7574 7075 7420 6f66 206d 6163 726f 6d65  utput of macrome
-00013230: 7461 2d73 6f75 7263 652d 6269 6771 7565  ta-source-bigque
-00013240: 7279 2074 6f20 7461 7267 6574 2d63 7376  ry to target-csv
-00013250: 3a0a 0a60 6060 0a6d 6163 726f 6d65 7461  :..```.macrometa
-00013260: 2d73 6f75 7263 652d 6269 6771 7565 7279  -source-bigquery
-00013270: 202d 6320 7461 705f 636f 6e66 6967 2e6a   -c tap_config.j
-00013280: 736f 6e20 2d64 203e 2063 6174 616c 6f67  son -d > catalog
-00013290: 2e6a 736f 6e0a 6060 600a 0a23 2323 2053  .json.```..### S
-000132a0: 7465 7020 333a 2052 756e 0a0a 6d61 6372  tep 3: Run..macr
-000132b0: 6f6d 6574 612d 736f 7572 6365 2d62 6967  ometa-source-big
-000132c0: 7175 6572 7920 6361 6e20 6265 2072 756e  query can be run
-000132d0: 2077 6974 6820 616e 7920 5461 7267 6574   with any Target
-000132e0: 2e20 4173 2065 7861 6d70 6c65 2c20 6c65  . As example, le
-000132f0: 7420 7573 650a 5b74 6172 6765 742d 6373  t use.[target-cs
-00013300: 765d 2868 7474 7073 3a2f 2f67 6974 6875  v](https://githu
-00013310: 622e 636f 6d2f 7369 6e67 6572 2d69 6f2f  b.com/singer-io/
-00013320: 7461 7267 6574 2d63 7376 292e 0a0a 6060  target-csv)...``
-00013330: 600a 7069 7020 696e 7374 616c 6c20 7461  `.pip install ta
-00013340: 7267 6574 2d63 7376 0a60 6060 0a0a 5275  rget-csv.```..Ru
-00013350: 6e3a 0a0a 6060 600a 6d61 6372 6f6d 6574  n:..```.macromet
-00013360: 612d 736f 7572 6365 2d62 6967 7175 6572  a-source-bigquer
-00013370: 7920 2d63 2074 6170 5f63 6f6e 6669 672e  y -c tap_config.
-00013380: 6a73 6f6e 205c 0a20 2020 202d 2d63 6174  json \.    --cat
-00013390: 616c 6f67 2063 6174 616c 6f67 2e6a 736f  alog catalog.jso
-000133a0: 6e20 2d2d 7374 6172 745f 6461 7465 7469  n --start_dateti
-000133b0: 6d65 2027 3230 3230 2d30 382d 3031 5430  me '2020-08-01T0
-000133c0: 303a 3030 3a30 305a 2720 5c0a 2020 2020  0:00:00Z' \.    
-000133d0: 2d2d 656e 645f 6461 7465 7469 6d65 2027  --end_datetime '
-000133e0: 3230 3230 2d30 382d 3032 5430 313a 3030  2020-08-02T01:00
-000133f0: 3a30 305a 2720 7c20 7461 7267 6574 2d63  :00Z' | target-c
-00013400: 7376 202d 2d63 6f6e 6669 6720 7461 7267  sv --config targ
-00013410: 6574 5f63 6f6e 6669 672e 6a73 6f6e 205c  et_config.json \
-00013420: 0a20 2020 203e 2073 7461 7465 2e6a 736f  .    > state.jso
-00013430: 6e0a 6060 600a 0a54 6869 7320 6578 616d  n.```..This exam
-00013440: 706c 6520 7368 6f75 6c64 2063 7265 6174  ple should creat
-00013450: 6520 6120 6373 7620 6669 6c65 2069 6e20  e a csv file in 
-00013460: 7468 6520 7361 6d65 2064 6972 6563 746f  the same directo
-00013470: 7279 2e0a 6073 7461 7465 2e6a 736f 6e60  ry..`state.json`
-00013480: 2073 686f 756c 6420 636f 6e74 6169 6e20   should contain 
-00013490: 6120 7374 6174 6520 2862 6f6f 6b6d 6172  a state (bookmar
-000134a0: 6b29 2061 6674 6572 2074 6865 2072 756e  k) after the run
-000134b0: 2e20 2853 6565 2053 7461 7465 2073 6563  . (See State sec
-000134c0: 7469 6f6e 292e 0a0a 4e6f 7465 733a 0a0a  tion)...Notes:..
-000134d0: 2d20 7374 6172 7420 616e 6420 656e 6420  - start and end 
-000134e0: 6461 7465 7469 6d65 7320 6163 6365 7074  datetimes accept
-000134f0: 2049 534f 2038 3630 3120 666f 726d 6174   ISO 8601 format
-00013500: 2c20 6361 6e20 6265 2064 6174 6520 6f6e  , can be date on
-00013510: 6c79 2e20 7374 6172 7420 6461 7465 7469  ly. start dateti
-00013520: 6d65 0a20 2069 7320 696e 636c 7573 6976  me.  is inclusiv
-00013530: 652c 2065 6e64 2064 6174 6574 696d 6520  e, end datetime 
-00013540: 6973 206e 6f74 2e0a 2d20 4974 2069 7320  is not..- It is 
-00013550: 7265 636f 6d6d 656e 6465 6420 746f 2069  recommended to i
-00013560: 6e73 7065 6374 2074 6865 2063 6174 616c  nspect the catal
-00013570: 6f67 2066 696c 6520 616e 6420 6669 7820  og file and fix 
-00013580: 7468 6520 6175 746f 2d74 7970 6520 6173  the auto-type as
-00013590: 7369 676e 6d65 6e74 0a20 2069 6620 6e65  signment.  if ne
-000135a0: 6365 7373 6172 792e 0a2d 2074 6172 6765  cessary..- targe
-000135b0: 742d 6373 7627 7320 7461 7267 6574 5f63  t-csv's target_c
-000135c0: 6f6e 6669 672e 6a73 6f6e 2069 7320 6f70  onfig.json is op
-000135d0: 7469 6e61 6c2e 0a2d 206d 6163 726f 6d65  tinal..- macrome
-000135e0: 7461 2d73 6f75 7263 652d 6269 6771 7565  ta-source-bigque
-000135f0: 7279 2063 616e 2070 726f 6475 6365 206e  ry can produce n
-00013600: 6573 7465 6420 7265 636f 7264 7320 6275  ested records bu
-00013610: 7420 6974 2773 2075 7020 746f 2074 6172  t it's up to tar
-00013620: 6765 7420 6966 2074 6865 2064 6174 610a  get if the data.
-00013630: 2020 7772 6974 696e 6720 7769 6c6c 2062    writing will b
-00013640: 6520 7375 6363 6573 7366 756c 2e20 496e  e successful. In
-00013650: 2074 6869 7320 6578 616d 706c 6520 7769   this example wi
-00013660: 7468 2074 6172 6765 742d 6373 762c 2074  th target-csv, t
-00013670: 6865 2074 6162 6c65 2069 730a 2020 6578  he table is.  ex
-00013680: 7065 6374 6564 2074 6f20 6265 2066 6c61  pected to be fla
-00013690: 742e 0a0a 2323 2041 7574 6865 6e74 6963  t...## Authentic
-000136a0: 6174 696f 6e0a 0a49 7420 6973 2072 6563  ation..It is rec
-000136b0: 6f6d 6d65 6e64 6564 2074 6f20 7573 6520  ommended to use 
-000136c0: 606d 6163 726f 6d65 7461 2d73 6f75 7263  `macrometa-sourc
-000136d0: 652d 6269 6771 7565 7279 6020 7769 7468  e-bigquery` with
-000136e0: 2061 2073 6572 7669 6365 2061 6363 6f75   a service accou
-000136f0: 6e74 2e0a 0a2d 2044 6f77 6e6c 6f61 6420  nt...- Download 
-00013700: 7468 6520 636c 6965 6e74 5f73 6563 7265  the client_secre
-00013710: 7473 2e6a 736f 6e20 6669 6c65 2066 6f72  ts.json file for
-00013720: 2079 6f75 7220 7365 7276 6963 6520 6163   your service ac
-00013730: 636f 756e 742c 2061 6e64 2070 6c61 6365  count, and place
-00013740: 2069 740a 2020 6f6e 2074 6865 206d 6163   it.  on the mac
-00013750: 6869 6e65 2077 6865 7265 2060 6d61 6372  hine where `macr
-00013760: 6f6d 6574 612d 736f 7572 6365 2d62 6967  ometa-source-big
-00013770: 7175 6572 7960 2077 696c 6c20 6265 2065  query` will be e
-00013780: 7865 6375 7465 642e 0a2d 2053 6574 2061  xecuted..- Set a
-00013790: 2060 474f 4f47 4c45 5f41 5050 4c49 4341   `GOOGLE_APPLICA
-000137a0: 5449 4f4e 5f43 5245 4445 4e54 4941 4c53  TION_CREDENTIALS
-000137b0: 6020 656e 7669 726f 6e6d 656e 7420 7661  ` environment va
-000137c0: 7269 6162 6c65 206f 6e20 7468 6520 6d61  riable on the ma
-000137d0: 6368 696e 652c 0a20 2077 6865 7265 2074  chine,.  where t
-000137e0: 6865 2076 616c 7565 2069 7320 7468 6520  he value is the 
-000137f0: 6675 6c6c 7920 7175 616c 6966 6965 6420  fully qualified 
-00013800: 7061 7468 2074 6f20 636c 6965 6e74 5f73  path to client_s
-00013810: 6563 7265 7473 2e6a 736f 6e0a 0a49 6e20  ecrets.json..In 
-00013820: 7468 6520 7465 7374 696e 6720 656e 7669  the testing envi
-00013830: 726f 6e6d 656e 742c 2079 6f75 2063 616e  ronment, you can
-00013840: 2061 6c73 6f20 6d61 6e75 616c 6c79 2061   also manually a
-00013850: 7574 6865 6e74 6963 6174 6520 6265 666f  uthenticate befo
-00013860: 7265 2072 756e 6e69 670a 7468 6520 7461  re runnig.the ta
-00013870: 702e 2049 6e20 7468 6973 2063 6173 6520  p. In this case 
-00013880: 796f 7520 646f 206e 6f74 206e 6565 6420  you do not need 
-00013890: 6047 4f4f 474c 455f 4150 504c 4943 4154  `GOOGLE_APPLICAT
-000138a0: 494f 4e5f 4352 4544 454e 5449 414c 5360  ION_CREDENTIALS`
-000138b0: 2064 6566 696e 6564 3a0a 0a60 6060 0a67   defined:..```.g
-000138c0: 636c 6f75 6420 6175 7468 2061 7070 6c69  cloud auth appli
-000138d0: 6361 7469 6f6e 2d64 6566 6175 6c74 206c  cation-default l
-000138e0: 6f67 696e 0a60 6060 0a0a 596f 7520 6d61  ogin.```..You ma
-000138f0: 7920 616c 736f 2068 6176 6520 746f 2073  y also have to s
-00013900: 6574 2074 6865 2070 726f 6a65 6374 3a0a  et the project:.
-00013910: 0a60 6060 0a67 636c 6f75 6420 636f 6e66  .```.gcloud conf
-00013920: 6967 2073 6574 2070 726f 6a65 6374 203c  ig set project <
-00013930: 7072 6f6a 6563 742d 6964 3e0a 6060 600a  project-id>.```.
-00013940: 0a54 686f 7567 6820 6e6f 7420 7465 7374  .Though not test
-00013950: 6564 2c20 6974 2073 686f 756c 6420 616c  ed, it should al
-00013960: 736f 2062 6520 706f 7373 6962 6c65 2074  so be possible t
-00013970: 6f20 7573 6520 7468 6520 4f41 7574 6820  o use the OAuth 
-00013980: 666c 6f77 2074 6f0a 6175 7468 656e 7469  flow to.authenti
-00013990: 6361 7465 2074 6f20 4743 5020 6173 2077  cate to GCP as w
-000139a0: 656c 6c3a 0a2d 2060 6d61 6372 6f6d 6574  ell:.- `macromet
-000139b0: 612d 736f 7572 6365 2d62 6967 7175 6572  a-source-bigquer
-000139c0: 7960 2077 696c 6c20 6174 7465 6d70 7420  y` will attempt 
-000139d0: 746f 206f 7065 6e20 6120 6e65 7720 7769  to open a new wi
-000139e0: 6e64 6f77 206f 7220 7461 6220 696e 2079  ndow or tab in y
-000139f0: 6f75 7220 6465 6661 756c 740a 2020 6272  our default.  br
-00013a00: 6f77 7365 722e 2049 6620 7468 6973 2066  owser. If this f
-00013a10: 6169 6c73 2c20 636f 7079 2074 6865 2055  ails, copy the U
-00013a20: 524c 2066 726f 6d20 7468 6520 636f 6e73  RL from the cons
-00013a30: 6f6c 6520 616e 6420 6d61 6e75 616c 6c79  ole and manually
-00013a40: 206f 7065 6e20 6974 0a20 2069 6e20 796f   open it.  in yo
-00013a50: 7572 2062 726f 7773 6572 2e0a 2d20 4966  ur browser..- If
-00013a60: 2079 6f75 2061 7265 206e 6f74 2061 6c72   you are not alr
-00013a70: 6561 6479 206c 6f67 6765 6420 696e 746f  eady logged into
-00013a80: 2079 6f75 7220 476f 6f67 6c65 2061 6363   your Google acc
-00013a90: 6f75 6e74 2c20 796f 7520 7769 6c6c 2062  ount, you will b
-00013aa0: 6520 7072 6f6d 7074 6564 0a20 2074 6f20  e prompted.  to 
-00013ab0: 6c6f 6720 696e 2e0a 2d20 4966 2079 6f75  log in..- If you
-00013ac0: 2061 7265 206c 6f67 6765 6420 696e 746f   are logged into
-00013ad0: 206d 756c 7469 706c 6520 476f 6f67 6c65   multiple Google
-00013ae0: 2061 6363 6f75 6e74 732c 2079 6f75 2077   accounts, you w
-00013af0: 696c 6c20 6265 2061 736b 6564 2074 6f20  ill be asked to 
-00013b00: 7365 6c65 6374 0a20 206f 6e65 2061 6363  select.  one acc
-00013b10: 6f75 6e74 2074 6f20 7573 6520 666f 7220  ount to use for 
-00013b20: 7468 6520 6175 7468 6f72 697a 6174 696f  the authorizatio
-00013b30: 6e2e 0a2d 2043 6c69 636b 2074 6865 202a  n..- Click the *
-00013b40: 2a41 6363 6570 742a 2a20 6275 7474 6f6e  *Accept** button
-00013b50: 2074 6f20 616c 6c6f 7720 606d 6163 726f   to allow `macro
-00013b60: 6d65 7461 2d73 6f75 7263 652d 6269 6771  meta-source-bigq
-00013b70: 7565 7279 6020 746f 2061 6363 6573 7320  uery` to access 
-00013b80: 796f 7572 2047 6f6f 676c 6520 4269 6751  your Google BigQ
-00013b90: 7565 7279 0a20 2074 6162 6c65 2e0a 2d20  uery.  table..- 
-00013ba0: 596f 7520 6361 6e20 636c 6f73 6520 7468  You can close th
-00013bb0: 6520 7461 6220 6166 7465 7220 7468 6520  e tab after the 
-00013bc0: 7369 676e 7570 2066 6c6f 7720 6973 2063  signup flow is c
-00013bd0: 6f6d 706c 6574 652e 0a0a 2323 2053 7461  omplete...## Sta
-00013be0: 7465 0a0a 5468 6973 2073 6f75 7263 6520  te..This source 
-00013bf0: 636f 6e6e 6563 746f 7220 656d 6974 7320  connector emits 
-00013c00: 5b73 7461 7465 5d28 6874 7470 733a 2f2f  [state](https://
-00013c10: 6769 7468 7562 2e63 6f6d 2f73 696e 6765  github.com/singe
-00013c20: 722d 696f 2f67 6574 7469 6e67 2d73 7461  r-io/getting-sta
-00013c30: 7274 6564 2f62 6c6f 622f 6d61 7374 6572  rted/blob/master
-00013c40: 2f64 6f63 732f 434f 4e46 4947 5f41 4e44  /docs/CONFIG_AND
-00013c50: 5f53 5441 5445 2e6d 6423 7374 6174 652d  _STATE.md#state-
-00013c60: 6669 6c65 292e 0a54 6865 2063 6f6d 6d61  file)..The comma
-00013c70: 6e64 2061 6c73 6f20 7461 6b65 7320 6120  nd also takes a 
-00013c80: 7374 6174 6520 6669 6c65 2069 6e70 7574  state file input
-00013c90: 2077 6974 6820 602d 2d73 7461 7465 203c   with `--state <
-00013ca0: 6669 6c65 2d6e 616d 653e 6020 6f70 7469  file-name>` opti
-00013cb0: 6f6e 2e0a 4966 2074 6865 2073 7461 7465  on..If the state
-00013cc0: 2069 7320 7365 742c 2073 7461 7274 5f64   is set, start_d
-00013cd0: 6174 6574 696d 6520 636f 6e66 6967 2061  atetime config a
-00013ce0: 6e64 2063 6f6d 6d61 6e64 206c 696e 6520  nd command line 
-00013cf0: 6172 6775 6d65 6e74 2061 7265 0a69 676e  argument are.ign
-00013d00: 6f72 6564 2061 6e64 2074 6865 2064 6174  ored and the dat
-00013d10: 6574 696d 6520 7661 6c75 6520 6672 6f6d  etime value from
-00013d20: 206c 6173 745f 7570 6461 7465 206b 6579   last_update key
-00013d30: 2069 7320 7573 6564 2061 7320 7468 6520   is used as the 
-00013d40: 7265 7375 6d69 6e67 0a70 6f69 6e74 2e0a  resuming.point..
-00013d50: 0a54 6f20 6176 6f69 6420 7468 6520 6461  .To avoid the da
-00013d60: 7461 2064 7570 6c69 6361 7469 6f6e 2c20  ta duplication, 
-00013d70: 7374 6172 7420 6461 7465 7469 6d65 2069  start datetime i
-00013d80: 7320 6578 636c 7573 6976 650a 6073 7461  s exclusive.`sta
-00013d90: 7274 5f64 6174 6574 696d 6520 3c20 6461  rt_datetime < da
-00013da0: 7465 7469 6d65 5f63 6f6c 756d 6e60 2077  tetime_column` w
-00013db0: 6865 6e20 7468 6520 736f 7572 6365 2063  hen the source c
-00013dc0: 6f6e 6e65 6374 6f72 2072 756e 7320 7769  onnector runs wi
-00013dd0: 7468 2073 7461 7465 206f 7074 696f 6e2e  th state option.
-00013de0: 2049 660a 796f 7520 6665 6172 2061 2064   If.you fear a d
-00013df0: 6174 6120 6c6f 7373 2062 6563 6175 7365  ata loss because
-00013e00: 206f 6620 7468 6973 2c20 6a75 7374 2075   of this, just u
-00013e10: 7365 2074 6865 2060 2d2d 7374 6172 745f  se the `--start_
-00013e20: 6461 7465 7469 6d65 6020 6f70 7469 6f6e  datetime` option
-00013e30: 0a69 6e73 7465 6164 206f 6620 7374 6174  .instead of stat
-00013e40: 652e 204f 7220 7365 7420 6073 7461 7274  e. Or set `start
-00013e50: 5f61 6c77 6179 735f 696e 636c 7573 6976  _always_inclusiv
-00013e60: 653a 2074 7275 6560 2069 6e20 636f 6e66  e: true` in conf
-00013e70: 6967 7572 6174 696f 6e2e 0a0a 5468 6520  iguration...The 
-00013e80: 736f 7572 6365 2063 6f6e 6e65 6374 6f72  source connector
-00013e90: 2069 7473 656c 6620 646f 6573 206e 6f74   itself does not
-00013ea0: 206f 7574 7075 7420 6120 7374 6174 6520   output a state 
-00013eb0: 6669 6c65 2e20 4974 2061 6e74 6963 6970  file. It anticip
-00013ec0: 6174 6520 7468 6520 7461 7267 6574 2070  ate the target p
-00013ed0: 726f 6772 616d 0a6f 7220 6120 646f 776e  rogram.or a down
-00013ee0: 7374 7265 616d 2070 726f 6365 7373 2074  stream process t
-00013ef0: 6f20 6669 616e 6c69 7a65 2074 6865 2073  o fianlize the s
-00013f00: 7461 7465 2073 6166 6574 6c79 2061 6e64  tate safetly and
-00013f10: 2070 726f 6475 6365 2061 2073 7461 7465   produce a state
-00013f20: 2066 696c 652e 0a0a 2323 204f 7269 6769   file...## Origi
-00013f30: 6e61 6c20 7265 706f 0a68 7474 7073 3a2f  nal repo.https:/
-00013f40: 2f67 6974 6875 622e 636f 6d2f 4d61 6372  /github.com/Macr
-00013f50: 6f6d 6574 6163 6f72 702f 6d61 6372 6f6d  ometacorp/macrom
-00013f60: 6574 612d 736f 7572 6365 2d62 6967 7175  eta-source-bigqu
-00013f70: 6572 790a 0000 0000 0000 0000 0000 0000  ery.............
+00012000: 4d65 7461 6461 7461 2d56 6572 7369 6f6e  Metadata-Version
+00012010: 3a20 322e 310a 4e61 6d65 3a20 6d61 6372  : 2.1.Name: macr
+00012020: 6f6d 6574 612d 736f 7572 6365 2d62 6967  ometa-source-big
+00012030: 7175 6572 790a 5665 7273 696f 6e3a 2031  query.Version: 1
+00012040: 2e30 2e30 0a53 756d 6d61 7279 3a20 4d61  .0.0.Summary: Ma
+00012050: 6372 6f6d 6574 6120 736f 7572 6365 2062  crometa source b
+00012060: 6967 7175 6572 7920 636f 6e6e 6563 746f  igquery connecto
+00012070: 7220 666f 7220 6578 7472 6163 7469 6e67  r for extracting
+00012080: 2064 6174 6120 6672 6f6d 2042 6967 5175   data from BigQu
+00012090: 6572 790a 486f 6d65 2d70 6167 653a 2068  ery.Home-page: h
+000120a0: 7474 7073 3a2f 2f67 6974 6875 622e 636f  ttps://github.co
+000120b0: 6d2f 4d61 6372 6f6d 6574 6163 6f72 702f  m/Macrometacorp/
+000120c0: 6d61 6372 6f6d 6574 612d 736f 7572 6365  macrometa-source
+000120d0: 2d62 6967 7175 6572 790a 4175 7468 6f72  -bigquery.Author
+000120e0: 3a20 4d61 6372 6f6d 6574 610a 436c 6173  : Macrometa.Clas
+000120f0: 7369 6669 6572 3a20 4c69 6365 6e73 6520  sifier: License 
+00012100: 3a3a 204f 5349 2041 7070 726f 7665 6420  :: OSI Approved 
+00012110: 3a3a 2041 7061 6368 6520 536f 6674 7761  :: Apache Softwa
+00012120: 7265 204c 6963 656e 7365 0a43 6c61 7373  re License.Class
+00012130: 6966 6965 723a 2050 726f 6772 616d 6d69  ifier: Programmi
+00012140: 6e67 204c 616e 6775 6167 6520 3a3a 2050  ng Language :: P
+00012150: 7974 686f 6e20 3a3a 2033 203a 3a20 4f6e  ython :: 3 :: On
+00012160: 6c79 0a44 6573 6372 6970 7469 6f6e 2d43  ly.Description-C
+00012170: 6f6e 7465 6e74 2d54 7970 653a 2074 6578  ontent-Type: tex
+00012180: 742f 6d61 726b 646f 776e 0a4c 6963 656e  t/markdown.Licen
+00012190: 7365 2d46 696c 653a 204c 4943 454e 5345  se-File: LICENSE
+000121a0: 0a0a 0a0a 2320 6d61 6372 6f6d 6574 612d  ....# macrometa-
+000121b0: 736f 7572 6365 2d62 6967 7175 6572 790a  source-bigquery.
+000121c0: 0a45 7874 7261 6374 2064 6174 6120 6672  .Extract data fr
+000121d0: 6f6d 2042 6967 5175 6572 7920 7461 626c  om BigQuery tabl
+000121e0: 6573 2e0a 0a54 6869 7320 6973 2061 206d  es...This is a m
+000121f0: 6163 726f 6d65 7461 2073 6f75 7263 6520  acrometa source 
+00012200: 6269 6771 7565 7279 2063 6f6e 6e65 6374  bigquery connect
+00012210: 6f72 2074 6861 7420 7072 6f64 7563 6573  or that produces
+00012220: 204a 534f 4e2d 666f 726d 6174 7465 6420   JSON-formatted 
+00012230: 6461 7461 0a66 6f6c 6c6f 7769 6e67 2074  data.following t
+00012240: 6865 205b 5369 6e67 6572 2073 7065 635d  he [Singer spec]
+00012250: 2868 7474 7073 3a2f 2f67 6974 6875 622e  (https://github.
+00012260: 636f 6d2f 7369 6e67 6572 2d69 6f2f 6765  com/singer-io/ge
+00012270: 7474 696e 672d 7374 6172 7465 642f 626c  tting-started/bl
+00012280: 6f62 2f6d 6173 7465 722f 5350 4543 2e6d  ob/master/SPEC.m
+00012290: 6429 2e0a 0a54 6869 7320 7461 703a 0a0a  d)...This tap:..
+000122a0: 2d20 5075 6c6c 7320 6461 7461 2066 726f  - Pulls data fro
+000122b0: 6d20 476f 6f67 6c65 2042 6967 5175 6572  m Google BigQuer
+000122c0: 7920 7461 626c 6573 2f76 6965 7773 2e0a  y tables/views..
+000122d0: 2d20 496e 6665 7273 2074 6865 2073 6368  - Infers the sch
+000122e0: 656d 6120 666f 7220 6561 6368 2072 6573  ema for each res
+000122f0: 6f75 7263 6520 616e 6420 7072 6f64 7563  ource and produc
+00012300: 6520 6361 7461 6c6f 6720 6669 6c65 2e0a  e catalog file..
+00012310: 0a23 2320 496e 7374 616c 6c61 7469 6f6e  .## Installation
+00012320: 0a0a 2323 2320 5374 6570 2031 3a20 4163  ..### Step 1: Ac
+00012330: 7469 7661 7465 2074 6865 2047 6f6f 676c  tivate the Googl
+00012340: 6520 4269 6751 7565 7279 2041 5049 0a0a  e BigQuery API..
+00012350: 2028 6f72 6967 696e 616c 6c79 2066 6f75   (originally fou
+00012360: 6e64 2069 6e20 7468 6520 5b47 6f6f 676c  nd in the [Googl
+00012370: 6520 4150 4920 646f 6373 5d28 6874 7470  e API docs](http
+00012380: 733a 2f2f 676f 6f67 6c65 636c 6f75 6470  s://googlecloudp
+00012390: 6c61 7466 6f72 6d2e 6769 7468 7562 2e69  latform.github.i
+000123a0: 6f2f 676f 6f67 6c65 2d63 6c6f 7564 2d70  o/google-cloud-p
+000123b0: 7974 686f 6e2f 6c61 7465 7374 2f62 6967  ython/latest/big
+000123c0: 7175 6572 792f 7573 6167 652e 6874 6d6c  query/usage.html
+000123d0: 2929 0a0a 2031 2e20 5573 6520 5b74 6869  )).. 1. Use [thi
+000123e0: 7320 7769 7a61 7264 5d28 6874 7470 733a  s wizard](https:
+000123f0: 2f2f 636f 6e73 6f6c 652e 6465 7665 6c6f  //console.develo
+00012400: 7065 7273 2e67 6f6f 676c 652e 636f 6d2f  pers.google.com/
+00012410: 7374 6172 742f 6170 693f 6964 3d62 6967  start/api?id=big
+00012420: 7175 6572 792d 6a73 6f6e 2e67 6f6f 676c  query-json.googl
+00012430: 6561 7069 732e 636f 6d29 2074 6f20 6372  eapis.com) to cr
+00012440: 6561 7465 206f 7220 7365 6c65 6374 2061  eate or select a
+00012450: 2070 726f 6a65 6374 2069 6e20 7468 6520   project in the 
+00012460: 476f 6f67 6c65 2044 6576 656c 6f70 6572  Google Developer
+00012470: 7320 436f 6e73 6f6c 6520 616e 6420 6163  s Console and ac
+00012480: 7469 7661 7465 2074 6865 2042 6967 5175  tivate the BigQu
+00012490: 6572 7920 4150 492e 2043 6c69 636b 2043  ery API. Click C
+000124a0: 6f6e 7469 6e75 652c 2074 6865 6e20 476f  ontinue, then Go
+000124b0: 2074 6f20 6372 6564 656e 7469 616c 732e   to credentials.
+000124c0: 0a20 322e 204f 6e20 7468 6520 2a2a 4164  . 2. On the **Ad
+000124d0: 6420 6372 6564 656e 7469 616c 7320 746f  d credentials to
+000124e0: 2079 6f75 7220 7072 6f6a 6563 742a 2a20   your project** 
+000124f0: 7061 6765 2c20 636c 6963 6b20 7468 6520  page, click the 
+00012500: 2a2a 4361 6e63 656c 2a2a 2062 7574 746f  **Cancel** butto
+00012510: 6e2e 0a20 332e 2041 7420 7468 6520 746f  n.. 3. At the to
+00012520: 7020 6f66 2074 6865 2070 6167 652c 2073  p of the page, s
+00012530: 656c 6563 7420 7468 6520 2a2a 4f41 7574  elect the **OAut
+00012540: 6820 636f 6e73 656e 7420 7363 7265 656e  h consent screen
+00012550: 2a2a 2074 6162 2e20 5365 6c65 6374 2061  ** tab. Select a
+00012560: 6e20 2a2a 456d 6169 6c20 6164 6472 6573  n **Email addres
+00012570: 732a 2a2c 2065 6e74 6572 2061 202a 2a50  s**, enter a **P
+00012580: 726f 6475 6374 206e 616d 652a 2a20 6966  roduct name** if
+00012590: 206e 6f74 2061 6c72 6561 6479 2073 6574   not already set
+000125a0: 2c20 616e 6420 636c 6963 6b20 7468 6520  , and click the 
+000125b0: 2a2a 5361 7665 2a2a 2062 7574 746f 6e2e  **Save** button.
+000125c0: 0a20 342e 2053 656c 6563 7420 7468 6520  . 4. Select the 
+000125d0: 2a2a 4372 6564 656e 7469 616c 732a 2a20  **Credentials** 
+000125e0: 7461 622c 2063 6c69 636b 2074 6865 202a  tab, click the *
+000125f0: 2a43 7265 6174 6520 6372 6564 656e 7469  *Create credenti
+00012600: 616c 732a 2a20 6275 7474 6f6e 2061 6e64  als** button and
+00012610: 2073 656c 6563 7420 2a2a 4f41 7574 6820   select **OAuth 
+00012620: 636c 6965 6e74 2049 442a 2a2e 0a20 352e  client ID**.. 5.
+00012630: 2053 656c 6563 7420 7468 6520 6170 706c   Select the appl
+00012640: 6963 6174 696f 6e20 7479 7065 202a 2a4f  ication type **O
+00012650: 7468 6572 2a2a 2c20 656e 7465 7220 7468  ther**, enter th
+00012660: 6520 6e61 6d65 2022 4d61 6372 6f6d 6574  e name "Macromet
+00012670: 6120 536f 7572 6365 2042 6967 5175 6572  a Source BigQuer
+00012680: 7922 2c20 616e 6420 636c 6963 6b20 7468  y", and click th
+00012690: 6520 2a2a 4372 6561 7465 2a2a 2062 7574  e **Create** but
+000126a0: 746f 6e2e 0a20 362e 2043 6c69 636b 202a  ton.. 6. Click *
+000126b0: 2a4f 4b2a 2a20 746f 2064 6973 6d69 7373  *OK** to dismiss
+000126c0: 2074 6865 2072 6573 756c 7469 6e67 2064   the resulting d
+000126d0: 6961 6c6f 672e 0a20 372e 2043 6c69 636b  ialog.. 7. Click
+000126e0: 2074 6865 2044 6f77 6e6c 6f61 6420 6275   the Download bu
+000126f0: 7474 6f6e 2074 6f20 7468 6520 7269 6768  tton to the righ
+00012700: 7420 6f66 2074 6865 2063 6c69 656e 7420  t of the client 
+00012710: 4944 2e0a 2038 2e20 4d6f 7665 2074 6869  ID.. 8. Move thi
+00012720: 7320 6669 6c65 2074 6f20 796f 7572 2077  s file to your w
+00012730: 6f72 6b69 6e67 2064 6972 6563 746f 7279  orking directory
+00012740: 2061 6e64 2072 656e 616d 6520 6974 202a   and rename it *
+00012750: 636c 6965 6e74 5f73 6563 7265 7473 2e6a  client_secrets.j
+00012760: 736f 6e2a 2e0a 0a0a 4578 706f 7274 2074  son*....Export t
+00012770: 6865 206c 6f63 6174 696f 6e20 6f66 2074  he location of t
+00012780: 6865 2073 6563 7265 7420 6669 6c65 3a0a  he secret file:.
+00012790: 0a60 6060 0a65 7870 6f72 7420 474f 4f47  .```.export GOOG
+000127a0: 4c45 5f41 5050 4c49 4341 5449 4f4e 5f43  LE_APPLICATION_C
+000127b0: 5245 4445 4e54 4941 4c53 3d22 2e2f 636c  REDENTIALS="./cl
+000127c0: 6965 6e74 5f73 6563 7265 742e 6a73 6f6e  ient_secret.json
+000127d0: 220a 6060 600a 0a46 6f72 206f 7468 6572  ".```..For other
+000127e0: 2061 7574 6865 6e74 6963 6174 696f 6e20   authentication 
+000127f0: 6d65 7468 6f64 2c20 706c 6561 7365 2073  method, please s
+00012800: 6565 2041 7574 6865 6e74 6963 6174 696f  ee Authenticatio
+00012810: 6e20 7365 6374 696f 6e2e 0a0a 2323 2320  n section...### 
+00012820: 5374 6570 2032 3a20 496e 7374 616c 6c0a  Step 2: Install.
+00012830: 0a46 6972 7374 2c20 6d61 6b65 2073 7572  .First, make sur
+00012840: 6520 5079 7468 6f6e 2033 2069 7320 696e  e Python 3 is in
+00012850: 7374 616c 6c65 6420 6f6e 2079 6f75 7220  stalled on your 
+00012860: 7379 7374 656d 206f 7220 666f 6c6c 6f77  system or follow
+00012870: 2074 6865 7365 200a 696e 7374 616c 6c61   these .installa
+00012880: 7469 6f6e 2069 6e73 7472 7563 7469 6f6e  tion instruction
+00012890: 7320 666f 7220 4d61 6320 6f72 2055 6275  s for Mac or Ubu
+000128a0: 6e74 752e 0a0a 6060 600a 7069 7020 696e  ntu...```.pip in
+000128b0: 7374 616c 6c20 2d55 206d 6163 726f 6d65  stall -U macrome
+000128c0: 7461 2d73 6f75 7263 652d 6269 6771 7565  ta-source-bigque
+000128d0: 7279 0a60 6060 0a0a 2323 2052 756e 0a0a  ry.```..## Run..
+000128e0: 2323 2320 5374 6570 2031 3a20 436f 6e66  ### Step 1: Conf
+000128f0: 6967 7572 650a 0a43 7265 6174 6520 6120  igure..Create a 
+00012900: 6669 6c65 2063 616c 6c65 6420 7461 705f  file called tap_
+00012910: 636f 6e66 6967 2e6a 736f 6e20 696e 2079  config.json in y
+00012920: 6f75 7220 776f 726b 696e 6720 6469 7265  our working dire
+00012930: 6374 6f72 792c 2066 6f6c 6c6f 7769 6e67  ctory, following
+00012940: 200a 636f 6e66 6967 2e73 616d 706c 652e   .config.sample.
+00012950: 6a73 6f6e 3a0a 0a60 6060 0a7b 0a20 2022  json:..```.{.  "
+00012960: 7374 7265 616d 7322 3a20 5b0a 2020 2020  streams": [.    
+00012970: 2020 7b22 6e61 6d65 223a 2022 3c73 6f6d    {"name": "<som
+00012980: 655f 7363 6865 6d61 5f6e 616d 653e 222c  e_schema_name>",
+00012990: 0a20 2020 2020 2020 2274 6162 6c65 223a  .       "table":
+000129a0: 2022 603c 7072 6f6a 6563 743e 2e3c 6461   "`<project>.<da
+000129b0: 7461 7365 743e 2e3c 7461 626c 653e 6022  taset>.<table>`"
+000129c0: 2c0a 2020 2020 2020 2022 636f 6c75 6d6e  ,.       "column
+000129d0: 7322 3a20 5b22 3c63 6f6c 5f6e 616d 655f  s": ["<col_name_
+000129e0: 303e 222c 2022 3c63 6f6c 5f6e 616d 655f  0>", "<col_name_
+000129f0: 313e 222c 2022 3c63 6f6c 5f6e 616d 655f  1>", "<col_name_
+00012a00: 323e 225d 2c0a 2020 2020 2020 2022 6461  2>"],.       "da
+00012a10: 7465 7469 6d65 5f6b 6579 223a 2022 3c79  tetime_key": "<y
+00012a20: 6f75 725f 6b65 793e 222c 0a20 2020 2020  our_key>",.     
+00012a30: 2020 2266 696c 7465 7273 223a 205b 2263    "filters": ["c
+00012a40: 6f75 6e74 7279 3d27 7573 2722 2c20 2273  ountry='us'", "s
+00012a50: 7461 7465 3d27 4341 2722 2c0a 2020 2020  tate='CA'",.    
+00012a60: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00012a70: 7265 6769 7374 6572 6564 5f6f 6e3e 3d44  registered_on>=D
+00012a80: 4154 455f 4144 4428 6375 7272 656e 745f  ATE_ADD(current_
+00012a90: 6461 7465 2c20 494e 5445 5256 414c 202d  date, INTERVAL -
+00012aa0: 3720 6461 7929 220a 2020 2020 2020 2020  7 day)".        
+00012ab0: 2020 2020 2020 2020 2020 5d20 2f2f 2061            ] // a
+00012ac0: 6c73 6f20 6f70 7469 6f6e 616c 3a20 7468  lso optional: th
+00012ad0: 6573 6520 6172 6520 7061 7273 6564 2069  ese are parsed i
+00012ae0: 6e20 2757 4845 5245 2720 636c 6175 7365  n 'WHERE' clause
+00012af0: 0a20 2020 2020 207d 0a20 2020 205d 2c0a  .      }.    ],.
+00012b00: 2020 2273 7461 7274 5f64 6174 6574 696d    "start_datetim
+00012b10: 6522 3a20 2232 3031 372d 3031 2d30 3154  e": "2017-01-01T
+00012b20: 3030 3a30 303a 3030 5a22 2c20 2f2f 2054  00:00:00Z", // T
+00012b30: 6869 7320 6361 6e20 6265 2073 6574 2061  his can be set a
+00012b40: 7420 7468 6520 636f 6d6d 616e 6420 6c69  t the command li
+00012b50: 6e65 2061 7267 756d 656e 740a 2020 2265  ne argument.  "e
+00012b60: 6e64 5f64 6174 6574 696d 6522 3a20 2232  nd_datetime": "2
+00012b70: 3031 372d 3032 2d30 3154 3030 3a30 303a  017-02-01T00:00:
+00012b80: 3030 5a22 2c20 2f2f 2065 6e64 5f64 6174  00Z", // end_dat
+00012b90: 6574 696d 6520 6973 206f 7074 696f 6e61  etime is optiona
+00012ba0: 6c0a 2020 226c 696d 6974 223a 2031 3030  l.  "limit": 100
+00012bb0: 2c0a 2020 2273 7461 7274 5f61 6c77 6179  ,.  "start_alway
+00012bc0: 735f 696e 636c 7573 6976 6522 3a20 6661  s_inclusive": fa
+00012bd0: 6c73 6520 2f2f 2064 6566 6175 6c74 2069  lse // default i
+00012be0: 7320 6661 6c73 652c 206f 7074 696f 6e61  s false, optiona
+00012bf0: 6c0a 7d0a 6060 600a 0a2d 2054 6865 2072  l.}.```..- The r
+00012c00: 6571 7569 7265 6420 7061 7261 6d65 7465  equired paramete
+00012c10: 7273 2069 7320 6174 206c 6561 7374 206f  rs is at least o
+00012c20: 6e65 2073 7472 6561 6d20 286f 6e65 2062  ne stream (one b
+00012c30: 6967 7175 6572 7920 7461 626c 652f 7669  igquery table/vi
+00012c40: 6577 2920 746f 2063 6f70 792e 0a20 202d  ew) to copy..  -
+00012c50: 2049 7420 6973 206e 6f74 2061 2072 6563   It is not a rec
+00012c60: 6f6d 6d65 6e64 6564 2042 6967 5175 6572  ommended BigQuer
+00012c70: 7920 7072 6163 7469 6365 2074 6f20 7573  y practice to us
+00012c80: 6520 602a 6020 746f 2073 7065 6369 6679  e `*` to specify
+00012c90: 2074 6865 2063 6f6c 756d 6e73 0a20 2020   the columns.   
+00012ca0: 2061 7320 6974 206d 6179 2062 6c6f 7720   as it may blow 
+00012cb0: 7570 2074 6865 2063 6f73 7420 666f 7220  up the cost for 
+00012cc0: 6120 7461 626c 6520 7769 7468 2061 206c  a table with a l
+00012cd0: 6172 6765 206e 756d 6265 7220 6f66 2063  arge number of c
+00012ce0: 6f6c 756d 6e73 2e0a 2020 2d20 6066 696c  olumns..  - `fil
+00012cf0: 7465 7273 6020 6172 6520 6f70 7469 6f6e  ters` are option
+00012d00: 616c 2062 7574 2077 6520 7374 726f 6e67  al but we strong
+00012d10: 6c79 2072 6563 6f6d 6d65 6e64 2075 7369  ly recommend usi
+00012d20: 6e67 2074 6869 7320 6f76 6572 2061 206c  ng this over a l
+00012d30: 6172 6765 0a20 2020 2070 6172 7469 7469  arge.    partiti
+00012d40: 6f6e 6564 2074 6162 6c65 2074 6f20 636f  oned table to co
+00012d50: 6e74 726f 6c20 7468 6520 636f 7374 2e20  ntrol the cost. 
+00012d60: 4c49 4d49 5420 2028 5468 6520 6175 7468  LIMIT  (The auth
+00012d70: 6f72 7320 6f66 2074 6170 2d62 6967 7175  ors of tap-bigqu
+00012d80: 6572 7920 6973 206e 6f74 0a20 2020 2072  ery is not.    r
+00012d90: 6573 706f 6e73 6962 6c65 2066 6f72 2074  esponsible for t
+00012da0: 6865 2063 6f73 7420 696e 6375 7272 6564  he cost incurred
+00012db0: 2062 7920 7275 6e6e 696e 6720 7468 6973   by running this
+00012dc0: 2070 726f 6772 616d 2e20 416c 7761 7973   program. Always
+00012dd0: 2074 6573 740a 2020 2020 7468 6f72 6f75   test.    thorou
+00012de0: 6768 6c79 2077 6974 6820 736d 616c 6c20  ghly with small 
+00012df0: 6461 7461 2073 6574 2066 6972 7374 2e29  data set first.)
+00012e00: 0a2d 2060 7374 6172 745f 6461 7465 7469  .- `start_dateti
+00012e10: 6d65 6020 6d75 7374 2061 6c73 6f20 6265  me` must also be
+00012e20: 2073 6574 2069 6e20 7468 6520 636f 6e66   set in the conf
+00012e30: 6967 2066 696c 6520 6f72 2061 7320 7468  ig file or as th
+00012e40: 6520 636f 6d6d 616e 6420 6c69 6e65 0a20  e command line. 
+00012e50: 2061 7267 756d 656e 7420 2853 6565 2074   argument (See t
+00012e60: 6865 206e 6578 7420 7374 6570 292e 0a2d  he next step)..-
+00012e70: 2060 6c69 6d69 7460 2077 696c 6c20 6c69   `limit` will li
+00012e80: 6d69 7420 7468 6520 6e75 6d62 6572 206f  mit the number o
+00012e90: 6620 7265 7375 6c74 732c 2062 7574 2069  f results, but i
+00012ea0: 7420 646f 6573 206e 6f74 2072 6573 756c  t does not resul
+00012eb0: 7420 696e 2072 6564 7563 650a 2020 7468  t in reduce.  th
+00012ec0: 6520 7175 6572 7920 636f 7374 2e0a 0a54  e query cost...T
+00012ed0: 6865 2074 6162 6c65 2f76 6965 7720 6973  he table/view is
+00012ee0: 2065 7870 6563 7465 6420 746f 2068 6176   expected to hav
+00012ef0: 6520 6120 636f 6c75 6d6e 2074 6f20 696e  e a column to in
+00012f00: 6469 6361 7465 2074 6865 2063 7265 6174  dicate the creat
+00012f10: 696f 6e20 6f72 0a75 7064 6174 6520 6461  ion or.update da
+00012f20: 7465 2061 6e64 2074 696d 6520 736f 2074  te and time so t
+00012f30: 6865 2074 6170 2073 656e 6473 2074 6865  he tap sends the
+00012f40: 2071 7565 7279 2077 6974 6820 604f 5244   query with `ORD
+00012f50: 4552 2042 5960 2061 6e64 2075 7365 0a74  ER BY` and use.t
+00012f60: 6865 2063 6f6c 756d 6e20 746f 2072 6563  he column to rec
+00012f70: 6f72 6420 7468 6520 626f 6f6b 6d61 726b  ord the bookmark
+00012f80: 2028 5365 6520 5374 6174 6520 7365 6374   (See State sect
+00012f90: 696f 6e29 2e0a 0a23 2323 2053 7465 7020  ion)...### Step 
+00012fa0: 323a 2043 7265 6174 6520 6361 7461 6c6f  2: Create catalo
+00012fb0: 670a 0a52 756e 2074 6170 2d62 6967 7175  g..Run tap-bigqu
+00012fc0: 6572 7920 696e 2064 6973 636f 7665 7279  ery in discovery
+00012fd0: 206d 6f64 6520 746f 206c 6574 2069 7420   mode to let it 
+00012fe0: 6372 6561 7465 206a 736f 6e20 7363 6865  create json sche
+00012ff0: 6d61 2066 696c 6520 616e 6420 7468 656e  ma file and then
+00013000: 0a72 756e 2074 6865 6d20 746f 6765 7468  .run them togeth
+00013010: 6572 2c20 7069 7069 6e67 2074 6865 206f  er, piping the o
+00013020: 7574 7075 7420 6f66 206d 6163 726f 6d65  utput of macrome
+00013030: 7461 2d73 6f75 7263 652d 6269 6771 7565  ta-source-bigque
+00013040: 7279 2074 6f20 7461 7267 6574 2d63 7376  ry to target-csv
+00013050: 3a0a 0a60 6060 0a6d 6163 726f 6d65 7461  :..```.macrometa
+00013060: 2d73 6f75 7263 652d 6269 6771 7565 7279  -source-bigquery
+00013070: 202d 6320 7461 705f 636f 6e66 6967 2e6a   -c tap_config.j
+00013080: 736f 6e20 2d64 203e 2063 6174 616c 6f67  son -d > catalog
+00013090: 2e6a 736f 6e0a 6060 600a 0a23 2323 2053  .json.```..### S
+000130a0: 7465 7020 333a 2052 756e 0a0a 6d61 6372  tep 3: Run..macr
+000130b0: 6f6d 6574 612d 736f 7572 6365 2d62 6967  ometa-source-big
+000130c0: 7175 6572 7920 6361 6e20 6265 2072 756e  query can be run
+000130d0: 2077 6974 6820 616e 7920 5461 7267 6574   with any Target
+000130e0: 2e20 4173 2065 7861 6d70 6c65 2c20 6c65  . As example, le
+000130f0: 7420 7573 650a 5b74 6172 6765 742d 6373  t use.[target-cs
+00013100: 765d 2868 7474 7073 3a2f 2f67 6974 6875  v](https://githu
+00013110: 622e 636f 6d2f 7369 6e67 6572 2d69 6f2f  b.com/singer-io/
+00013120: 7461 7267 6574 2d63 7376 292e 0a0a 6060  target-csv)...``
+00013130: 600a 7069 7020 696e 7374 616c 6c20 7461  `.pip install ta
+00013140: 7267 6574 2d63 7376 0a60 6060 0a0a 5275  rget-csv.```..Ru
+00013150: 6e3a 0a0a 6060 600a 6d61 6372 6f6d 6574  n:..```.macromet
+00013160: 612d 736f 7572 6365 2d62 6967 7175 6572  a-source-bigquer
+00013170: 7920 2d63 2074 6170 5f63 6f6e 6669 672e  y -c tap_config.
+00013180: 6a73 6f6e 205c 0a20 2020 202d 2d63 6174  json \.    --cat
+00013190: 616c 6f67 2063 6174 616c 6f67 2e6a 736f  alog catalog.jso
+000131a0: 6e20 2d2d 7374 6172 745f 6461 7465 7469  n --start_dateti
+000131b0: 6d65 2027 3230 3230 2d30 382d 3031 5430  me '2020-08-01T0
+000131c0: 303a 3030 3a30 305a 2720 5c0a 2020 2020  0:00:00Z' \.    
+000131d0: 2d2d 656e 645f 6461 7465 7469 6d65 2027  --end_datetime '
+000131e0: 3230 3230 2d30 382d 3032 5430 313a 3030  2020-08-02T01:00
+000131f0: 3a30 305a 2720 7c20 7461 7267 6574 2d63  :00Z' | target-c
+00013200: 7376 202d 2d63 6f6e 6669 6720 7461 7267  sv --config targ
+00013210: 6574 5f63 6f6e 6669 672e 6a73 6f6e 205c  et_config.json \
+00013220: 0a20 2020 203e 2073 7461 7465 2e6a 736f  .    > state.jso
+00013230: 6e0a 6060 600a 0a54 6869 7320 6578 616d  n.```..This exam
+00013240: 706c 6520 7368 6f75 6c64 2063 7265 6174  ple should creat
+00013250: 6520 6120 6373 7620 6669 6c65 2069 6e20  e a csv file in 
+00013260: 7468 6520 7361 6d65 2064 6972 6563 746f  the same directo
+00013270: 7279 2e0a 6073 7461 7465 2e6a 736f 6e60  ry..`state.json`
+00013280: 2073 686f 756c 6420 636f 6e74 6169 6e20   should contain 
+00013290: 6120 7374 6174 6520 2862 6f6f 6b6d 6172  a state (bookmar
+000132a0: 6b29 2061 6674 6572 2074 6865 2072 756e  k) after the run
+000132b0: 2e20 2853 6565 2053 7461 7465 2073 6563  . (See State sec
+000132c0: 7469 6f6e 292e 0a0a 4e6f 7465 733a 0a0a  tion)...Notes:..
+000132d0: 2d20 7374 6172 7420 616e 6420 656e 6420  - start and end 
+000132e0: 6461 7465 7469 6d65 7320 6163 6365 7074  datetimes accept
+000132f0: 2049 534f 2038 3630 3120 666f 726d 6174   ISO 8601 format
+00013300: 2c20 6361 6e20 6265 2064 6174 6520 6f6e  , can be date on
+00013310: 6c79 2e20 7374 6172 7420 6461 7465 7469  ly. start dateti
+00013320: 6d65 0a20 2069 7320 696e 636c 7573 6976  me.  is inclusiv
+00013330: 652c 2065 6e64 2064 6174 6574 696d 6520  e, end datetime 
+00013340: 6973 206e 6f74 2e0a 2d20 4974 2069 7320  is not..- It is 
+00013350: 7265 636f 6d6d 656e 6465 6420 746f 2069  recommended to i
+00013360: 6e73 7065 6374 2074 6865 2063 6174 616c  nspect the catal
+00013370: 6f67 2066 696c 6520 616e 6420 6669 7820  og file and fix 
+00013380: 7468 6520 6175 746f 2d74 7970 6520 6173  the auto-type as
+00013390: 7369 676e 6d65 6e74 0a20 2069 6620 6e65  signment.  if ne
+000133a0: 6365 7373 6172 792e 0a2d 2074 6172 6765  cessary..- targe
+000133b0: 742d 6373 7627 7320 7461 7267 6574 5f63  t-csv's target_c
+000133c0: 6f6e 6669 672e 6a73 6f6e 2069 7320 6f70  onfig.json is op
+000133d0: 7469 6e61 6c2e 0a2d 206d 6163 726f 6d65  tinal..- macrome
+000133e0: 7461 2d73 6f75 7263 652d 6269 6771 7565  ta-source-bigque
+000133f0: 7279 2063 616e 2070 726f 6475 6365 206e  ry can produce n
+00013400: 6573 7465 6420 7265 636f 7264 7320 6275  ested records bu
+00013410: 7420 6974 2773 2075 7020 746f 2074 6172  t it's up to tar
+00013420: 6765 7420 6966 2074 6865 2064 6174 610a  get if the data.
+00013430: 2020 7772 6974 696e 6720 7769 6c6c 2062    writing will b
+00013440: 6520 7375 6363 6573 7366 756c 2e20 496e  e successful. In
+00013450: 2074 6869 7320 6578 616d 706c 6520 7769   this example wi
+00013460: 7468 2074 6172 6765 742d 6373 762c 2074  th target-csv, t
+00013470: 6865 2074 6162 6c65 2069 730a 2020 6578  he table is.  ex
+00013480: 7065 6374 6564 2074 6f20 6265 2066 6c61  pected to be fla
+00013490: 742e 0a0a 2323 2041 7574 6865 6e74 6963  t...## Authentic
+000134a0: 6174 696f 6e0a 0a49 7420 6973 2072 6563  ation..It is rec
+000134b0: 6f6d 6d65 6e64 6564 2074 6f20 7573 6520  ommended to use 
+000134c0: 606d 6163 726f 6d65 7461 2d73 6f75 7263  `macrometa-sourc
+000134d0: 652d 6269 6771 7565 7279 6020 7769 7468  e-bigquery` with
+000134e0: 2061 2073 6572 7669 6365 2061 6363 6f75   a service accou
+000134f0: 6e74 2e0a 0a2d 2044 6f77 6e6c 6f61 6420  nt...- Download 
+00013500: 7468 6520 636c 6965 6e74 5f73 6563 7265  the client_secre
+00013510: 7473 2e6a 736f 6e20 6669 6c65 2066 6f72  ts.json file for
+00013520: 2079 6f75 7220 7365 7276 6963 6520 6163   your service ac
+00013530: 636f 756e 742c 2061 6e64 2070 6c61 6365  count, and place
+00013540: 2069 740a 2020 6f6e 2074 6865 206d 6163   it.  on the mac
+00013550: 6869 6e65 2077 6865 7265 2060 6d61 6372  hine where `macr
+00013560: 6f6d 6574 612d 736f 7572 6365 2d62 6967  ometa-source-big
+00013570: 7175 6572 7960 2077 696c 6c20 6265 2065  query` will be e
+00013580: 7865 6375 7465 642e 0a2d 2053 6574 2061  xecuted..- Set a
+00013590: 2060 474f 4f47 4c45 5f41 5050 4c49 4341   `GOOGLE_APPLICA
+000135a0: 5449 4f4e 5f43 5245 4445 4e54 4941 4c53  TION_CREDENTIALS
+000135b0: 6020 656e 7669 726f 6e6d 656e 7420 7661  ` environment va
+000135c0: 7269 6162 6c65 206f 6e20 7468 6520 6d61  riable on the ma
+000135d0: 6368 696e 652c 0a20 2077 6865 7265 2074  chine,.  where t
+000135e0: 6865 2076 616c 7565 2069 7320 7468 6520  he value is the 
+000135f0: 6675 6c6c 7920 7175 616c 6966 6965 6420  fully qualified 
+00013600: 7061 7468 2074 6f20 636c 6965 6e74 5f73  path to client_s
+00013610: 6563 7265 7473 2e6a 736f 6e0a 0a49 6e20  ecrets.json..In 
+00013620: 7468 6520 7465 7374 696e 6720 656e 7669  the testing envi
+00013630: 726f 6e6d 656e 742c 2079 6f75 2063 616e  ronment, you can
+00013640: 2061 6c73 6f20 6d61 6e75 616c 6c79 2061   also manually a
+00013650: 7574 6865 6e74 6963 6174 6520 6265 666f  uthenticate befo
+00013660: 7265 2072 756e 6e69 670a 7468 6520 7461  re runnig.the ta
+00013670: 702e 2049 6e20 7468 6973 2063 6173 6520  p. In this case 
+00013680: 796f 7520 646f 206e 6f74 206e 6565 6420  you do not need 
+00013690: 6047 4f4f 474c 455f 4150 504c 4943 4154  `GOOGLE_APPLICAT
+000136a0: 494f 4e5f 4352 4544 454e 5449 414c 5360  ION_CREDENTIALS`
+000136b0: 2064 6566 696e 6564 3a0a 0a60 6060 0a67   defined:..```.g
+000136c0: 636c 6f75 6420 6175 7468 2061 7070 6c69  cloud auth appli
+000136d0: 6361 7469 6f6e 2d64 6566 6175 6c74 206c  cation-default l
+000136e0: 6f67 696e 0a60 6060 0a0a 596f 7520 6d61  ogin.```..You ma
+000136f0: 7920 616c 736f 2068 6176 6520 746f 2073  y also have to s
+00013700: 6574 2074 6865 2070 726f 6a65 6374 3a0a  et the project:.
+00013710: 0a60 6060 0a67 636c 6f75 6420 636f 6e66  .```.gcloud conf
+00013720: 6967 2073 6574 2070 726f 6a65 6374 203c  ig set project <
+00013730: 7072 6f6a 6563 742d 6964 3e0a 6060 600a  project-id>.```.
+00013740: 0a54 686f 7567 6820 6e6f 7420 7465 7374  .Though not test
+00013750: 6564 2c20 6974 2073 686f 756c 6420 616c  ed, it should al
+00013760: 736f 2062 6520 706f 7373 6962 6c65 2074  so be possible t
+00013770: 6f20 7573 6520 7468 6520 4f41 7574 6820  o use the OAuth 
+00013780: 666c 6f77 2074 6f0a 6175 7468 656e 7469  flow to.authenti
+00013790: 6361 7465 2074 6f20 4743 5020 6173 2077  cate to GCP as w
+000137a0: 656c 6c3a 0a2d 2060 6d61 6372 6f6d 6574  ell:.- `macromet
+000137b0: 612d 736f 7572 6365 2d62 6967 7175 6572  a-source-bigquer
+000137c0: 7960 2077 696c 6c20 6174 7465 6d70 7420  y` will attempt 
+000137d0: 746f 206f 7065 6e20 6120 6e65 7720 7769  to open a new wi
+000137e0: 6e64 6f77 206f 7220 7461 6220 696e 2079  ndow or tab in y
+000137f0: 6f75 7220 6465 6661 756c 740a 2020 6272  our default.  br
+00013800: 6f77 7365 722e 2049 6620 7468 6973 2066  owser. If this f
+00013810: 6169 6c73 2c20 636f 7079 2074 6865 2055  ails, copy the U
+00013820: 524c 2066 726f 6d20 7468 6520 636f 6e73  RL from the cons
+00013830: 6f6c 6520 616e 6420 6d61 6e75 616c 6c79  ole and manually
+00013840: 206f 7065 6e20 6974 0a20 2069 6e20 796f   open it.  in yo
+00013850: 7572 2062 726f 7773 6572 2e0a 2d20 4966  ur browser..- If
+00013860: 2079 6f75 2061 7265 206e 6f74 2061 6c72   you are not alr
+00013870: 6561 6479 206c 6f67 6765 6420 696e 746f  eady logged into
+00013880: 2079 6f75 7220 476f 6f67 6c65 2061 6363   your Google acc
+00013890: 6f75 6e74 2c20 796f 7520 7769 6c6c 2062  ount, you will b
+000138a0: 6520 7072 6f6d 7074 6564 0a20 2074 6f20  e prompted.  to 
+000138b0: 6c6f 6720 696e 2e0a 2d20 4966 2079 6f75  log in..- If you
+000138c0: 2061 7265 206c 6f67 6765 6420 696e 746f   are logged into
+000138d0: 206d 756c 7469 706c 6520 476f 6f67 6c65   multiple Google
+000138e0: 2061 6363 6f75 6e74 732c 2079 6f75 2077   accounts, you w
+000138f0: 696c 6c20 6265 2061 736b 6564 2074 6f20  ill be asked to 
+00013900: 7365 6c65 6374 0a20 206f 6e65 2061 6363  select.  one acc
+00013910: 6f75 6e74 2074 6f20 7573 6520 666f 7220  ount to use for 
+00013920: 7468 6520 6175 7468 6f72 697a 6174 696f  the authorizatio
+00013930: 6e2e 0a2d 2043 6c69 636b 2074 6865 202a  n..- Click the *
+00013940: 2a41 6363 6570 742a 2a20 6275 7474 6f6e  *Accept** button
+00013950: 2074 6f20 616c 6c6f 7720 606d 6163 726f   to allow `macro
+00013960: 6d65 7461 2d73 6f75 7263 652d 6269 6771  meta-source-bigq
+00013970: 7565 7279 6020 746f 2061 6363 6573 7320  uery` to access 
+00013980: 796f 7572 2047 6f6f 676c 6520 4269 6751  your Google BigQ
+00013990: 7565 7279 0a20 2074 6162 6c65 2e0a 2d20  uery.  table..- 
+000139a0: 596f 7520 6361 6e20 636c 6f73 6520 7468  You can close th
+000139b0: 6520 7461 6220 6166 7465 7220 7468 6520  e tab after the 
+000139c0: 7369 676e 7570 2066 6c6f 7720 6973 2063  signup flow is c
+000139d0: 6f6d 706c 6574 652e 0a0a 2323 2053 7461  omplete...## Sta
+000139e0: 7465 0a0a 5468 6973 2073 6f75 7263 6520  te..This source 
+000139f0: 636f 6e6e 6563 746f 7220 656d 6974 7320  connector emits 
+00013a00: 5b73 7461 7465 5d28 6874 7470 733a 2f2f  [state](https://
+00013a10: 6769 7468 7562 2e63 6f6d 2f73 696e 6765  github.com/singe
+00013a20: 722d 696f 2f67 6574 7469 6e67 2d73 7461  r-io/getting-sta
+00013a30: 7274 6564 2f62 6c6f 622f 6d61 7374 6572  rted/blob/master
+00013a40: 2f64 6f63 732f 434f 4e46 4947 5f41 4e44  /docs/CONFIG_AND
+00013a50: 5f53 5441 5445 2e6d 6423 7374 6174 652d  _STATE.md#state-
+00013a60: 6669 6c65 292e 0a54 6865 2063 6f6d 6d61  file)..The comma
+00013a70: 6e64 2061 6c73 6f20 7461 6b65 7320 6120  nd also takes a 
+00013a80: 7374 6174 6520 6669 6c65 2069 6e70 7574  state file input
+00013a90: 2077 6974 6820 602d 2d73 7461 7465 203c   with `--state <
+00013aa0: 6669 6c65 2d6e 616d 653e 6020 6f70 7469  file-name>` opti
+00013ab0: 6f6e 2e0a 4966 2074 6865 2073 7461 7465  on..If the state
+00013ac0: 2069 7320 7365 742c 2073 7461 7274 5f64   is set, start_d
+00013ad0: 6174 6574 696d 6520 636f 6e66 6967 2061  atetime config a
+00013ae0: 6e64 2063 6f6d 6d61 6e64 206c 696e 6520  nd command line 
+00013af0: 6172 6775 6d65 6e74 2061 7265 0a69 676e  argument are.ign
+00013b00: 6f72 6564 2061 6e64 2074 6865 2064 6174  ored and the dat
+00013b10: 6574 696d 6520 7661 6c75 6520 6672 6f6d  etime value from
+00013b20: 206c 6173 745f 7570 6461 7465 206b 6579   last_update key
+00013b30: 2069 7320 7573 6564 2061 7320 7468 6520   is used as the 
+00013b40: 7265 7375 6d69 6e67 0a70 6f69 6e74 2e0a  resuming.point..
+00013b50: 0a54 6f20 6176 6f69 6420 7468 6520 6461  .To avoid the da
+00013b60: 7461 2064 7570 6c69 6361 7469 6f6e 2c20  ta duplication, 
+00013b70: 7374 6172 7420 6461 7465 7469 6d65 2069  start datetime i
+00013b80: 7320 6578 636c 7573 6976 650a 6073 7461  s exclusive.`sta
+00013b90: 7274 5f64 6174 6574 696d 6520 3c20 6461  rt_datetime < da
+00013ba0: 7465 7469 6d65 5f63 6f6c 756d 6e60 2077  tetime_column` w
+00013bb0: 6865 6e20 7468 6520 736f 7572 6365 2063  hen the source c
+00013bc0: 6f6e 6e65 6374 6f72 2072 756e 7320 7769  onnector runs wi
+00013bd0: 7468 2073 7461 7465 206f 7074 696f 6e2e  th state option.
+00013be0: 2049 660a 796f 7520 6665 6172 2061 2064   If.you fear a d
+00013bf0: 6174 6120 6c6f 7373 2062 6563 6175 7365  ata loss because
+00013c00: 206f 6620 7468 6973 2c20 6a75 7374 2075   of this, just u
+00013c10: 7365 2074 6865 2060 2d2d 7374 6172 745f  se the `--start_
+00013c20: 6461 7465 7469 6d65 6020 6f70 7469 6f6e  datetime` option
+00013c30: 0a69 6e73 7465 6164 206f 6620 7374 6174  .instead of stat
+00013c40: 652e 204f 7220 7365 7420 6073 7461 7274  e. Or set `start
+00013c50: 5f61 6c77 6179 735f 696e 636c 7573 6976  _always_inclusiv
+00013c60: 653a 2074 7275 6560 2069 6e20 636f 6e66  e: true` in conf
+00013c70: 6967 7572 6174 696f 6e2e 0a0a 5468 6520  iguration...The 
+00013c80: 736f 7572 6365 2063 6f6e 6e65 6374 6f72  source connector
+00013c90: 2069 7473 656c 6620 646f 6573 206e 6f74   itself does not
+00013ca0: 206f 7574 7075 7420 6120 7374 6174 6520   output a state 
+00013cb0: 6669 6c65 2e20 4974 2061 6e74 6963 6970  file. It anticip
+00013cc0: 6174 6520 7468 6520 7461 7267 6574 2070  ate the target p
+00013cd0: 726f 6772 616d 0a6f 7220 6120 646f 776e  rogram.or a down
+00013ce0: 7374 7265 616d 2070 726f 6365 7373 2074  stream process t
+00013cf0: 6f20 6669 616e 6c69 7a65 2074 6865 2073  o fianlize the s
+00013d00: 7461 7465 2073 6166 6574 6c79 2061 6e64  tate safetly and
+00013d10: 2070 726f 6475 6365 2061 2073 7461 7465   produce a state
+00013d20: 2066 696c 652e 0a0a 2323 204f 7269 6769   file...## Origi
+00013d30: 6e61 6c20 7265 706f 0a68 7474 7073 3a2f  nal repo.https:/
+00013d40: 2f67 6974 6875 622e 636f 6d2f 4d61 6372  /github.com/Macr
+00013d50: 6f6d 6574 6163 6f72 702f 6d61 6372 6f6d  ometacorp/macrom
+00013d60: 6574 612d 736f 7572 6365 2d62 6967 7175  eta-source-bigqu
+00013d70: 6572 790a 0000 0000 0000 0000 0000 0000  ery.............
+00013d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013e00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00013e10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013e20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013e60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00013e70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00013e80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+00013e90: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
+00013ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013f00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00013f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013f40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013f50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00013f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00013f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00013fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00013fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00013fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00013fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00013fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00013ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014000: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00014010: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014000: 3232 206d 7469 6d65 3d31 3639 3038 3739  22 mtime=1690879
+00014010: 3732 332e 300a 0000 0000 0000 0000 0000  723.0...........
 00014020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014060: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00014070: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00014080: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00014090: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
+00014060: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014070: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014080: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014090: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000140a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000140b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000140c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000140d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000140e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000140f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014100: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00014100: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -5146,127 +5146,127 @@
 00014190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000141a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000141b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000141c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000141d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000141e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000141f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014200: 3232 206d 7469 6d65 3d31 3638 3132 3134  22 mtime=1681214
-00014210: 3537 362e 300a 0000 0000 0000 0000 0000  576.0...........
-00014220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014200: 6d61 6372 6f6d 6574 612d 736f 7572 6365  macrometa-source
+00014210: 2d62 6967 7175 6572 792d 312e 302e 302f  -bigquery-1.0.0/
+00014220: 6d61 6372 6f6d 6574 615f 736f 7572 6365  macrometa_source
+00014230: 5f62 6967 7175 6572 792e 6567 672d 696e  _bigquery.egg-in
+00014240: 666f 2f53 4f55 5243 4553 2e74 7874 0000  fo/SOURCES.txt..
 00014250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014290: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014260: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
+00014270: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+00014280: 3030 3030 3732 3000 3134 3436 3231 3433  0000720.14462143
+00014290: 3335 3300 3032 3730 3235 0020 3000 0000  353.027025. 0...
 000142a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000142b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000142c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000142d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000142e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000142f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014300: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
 00014310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014320: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
 00014330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000143a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000143b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000143c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000143d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000143e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000143f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014400: 6d61 6372 6f6d 6574 612d 736f 7572 6365  macrometa-source
-00014410: 2d62 6967 7175 6572 792d 302e 302e 392f  -bigquery-0.0.9/
-00014420: 6d61 6372 6f6d 6574 615f 736f 7572 6365  macrometa_source
-00014430: 5f62 6967 7175 6572 792e 6567 672d 696e  _bigquery.egg-in
-00014440: 666f 2f53 4f55 5243 4553 2e74 7874 0000  fo/SOURCES.txt..
-00014450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014460: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
-00014470: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
-00014480: 3030 3030 3732 3000 3134 3431 3532 3436  0000720.14415246
-00014490: 3136 3000 3032 3730 3333 0020 3000 0000  160.027033. 0...
-000144a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000144b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000144c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000144d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000144e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000144f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014500: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
-00014510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014520: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
-00014530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000145a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000145b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000145c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014400: 4c49 4345 4e53 450a 5245 4144 4d45 2e6d  LICENSE.README.m
+00014410: 640a 7365 7475 702e 7079 0a6d 6163 726f  d.setup.py.macro
+00014420: 6d65 7461 5f73 6f75 7263 655f 6269 6771  meta_source_bigq
+00014430: 7565 7279 2f5f 5f69 6e69 745f 5f2e 7079  uery/__init__.py
+00014440: 0a6d 6163 726f 6d65 7461 5f73 6f75 7263  .macrometa_sourc
+00014450: 655f 6269 6771 7565 7279 2f73 616d 706c  e_bigquery/sampl
+00014460: 655f 6461 7461 2e70 790a 6d61 6372 6f6d  e_data.py.macrom
+00014470: 6574 615f 736f 7572 6365 5f62 6967 7175  eta_source_bigqu
+00014480: 6572 792f 7379 6e63 5f62 6967 7175 6572  ery/sync_bigquer
+00014490: 792e 7079 0a6d 6163 726f 6d65 7461 5f73  y.py.macrometa_s
+000144a0: 6f75 7263 655f 6269 6771 7565 7279 2e65  ource_bigquery.e
+000144b0: 6767 2d69 6e66 6f2f 504b 472d 494e 464f  gg-info/PKG-INFO
+000144c0: 0a6d 6163 726f 6d65 7461 5f73 6f75 7263  .macrometa_sourc
+000144d0: 655f 6269 6771 7565 7279 2e65 6767 2d69  e_bigquery.egg-i
+000144e0: 6e66 6f2f 534f 5552 4345 532e 7478 740a  nfo/SOURCES.txt.
+000144f0: 6d61 6372 6f6d 6574 615f 736f 7572 6365  macrometa_source
+00014500: 5f62 6967 7175 6572 792e 6567 672d 696e  _bigquery.egg-in
+00014510: 666f 2f64 6570 656e 6465 6e63 795f 6c69  fo/dependency_li
+00014520: 6e6b 732e 7478 740a 6d61 6372 6f6d 6574  nks.txt.macromet
+00014530: 615f 736f 7572 6365 5f62 6967 7175 6572  a_source_bigquer
+00014540: 792e 6567 672d 696e 666f 2f65 6e74 7279  y.egg-info/entry
+00014550: 5f70 6f69 6e74 732e 7478 740a 6d61 6372  _points.txt.macr
+00014560: 6f6d 6574 615f 736f 7572 6365 5f62 6967  ometa_source_big
+00014570: 7175 6572 792e 6567 672d 696e 666f 2f72  query.egg-info/r
+00014580: 6571 7569 7265 732e 7478 740a 6d61 6372  equires.txt.macr
+00014590: 6f6d 6574 615f 736f 7572 6365 5f62 6967  ometa_source_big
+000145a0: 7175 6572 792e 6567 672d 696e 666f 2f74  query.egg-info/t
+000145b0: 6f70 5f6c 6576 656c 2e74 7874 0a74 6573  op_level.txt.tes
+000145c0: 7473 2f74 6573 745f 7175 6572 792e 7079  ts/test_query.py
 000145d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000145e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000145f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014600: 4c49 4345 4e53 450a 5245 4144 4d45 2e6d  LICENSE.README.m
-00014610: 640a 7365 7475 702e 7079 0a6d 6163 726f  d.setup.py.macro
-00014620: 6d65 7461 5f73 6f75 7263 655f 6269 6771  meta_source_bigq
-00014630: 7565 7279 2f5f 5f69 6e69 745f 5f2e 7079  uery/__init__.py
-00014640: 0a6d 6163 726f 6d65 7461 5f73 6f75 7263  .macrometa_sourc
-00014650: 655f 6269 6771 7565 7279 2f73 616d 706c  e_bigquery/sampl
-00014660: 655f 6461 7461 2e70 790a 6d61 6372 6f6d  e_data.py.macrom
-00014670: 6574 615f 736f 7572 6365 5f62 6967 7175  eta_source_bigqu
-00014680: 6572 792f 7379 6e63 5f62 6967 7175 6572  ery/sync_bigquer
-00014690: 792e 7079 0a6d 6163 726f 6d65 7461 5f73  y.py.macrometa_s
-000146a0: 6f75 7263 655f 6269 6771 7565 7279 2e65  ource_bigquery.e
-000146b0: 6767 2d69 6e66 6f2f 504b 472d 494e 464f  gg-info/PKG-INFO
-000146c0: 0a6d 6163 726f 6d65 7461 5f73 6f75 7263  .macrometa_sourc
-000146d0: 655f 6269 6771 7565 7279 2e65 6767 2d69  e_bigquery.egg-i
-000146e0: 6e66 6f2f 534f 5552 4345 532e 7478 740a  nfo/SOURCES.txt.
-000146f0: 6d61 6372 6f6d 6574 615f 736f 7572 6365  macrometa_source
-00014700: 5f62 6967 7175 6572 792e 6567 672d 696e  _bigquery.egg-in
-00014710: 666f 2f64 6570 656e 6465 6e63 795f 6c69  fo/dependency_li
-00014720: 6e6b 732e 7478 740a 6d61 6372 6f6d 6574  nks.txt.macromet
-00014730: 615f 736f 7572 6365 5f62 6967 7175 6572  a_source_bigquer
-00014740: 792e 6567 672d 696e 666f 2f65 6e74 7279  y.egg-info/entry
-00014750: 5f70 6f69 6e74 732e 7478 740a 6d61 6372  _points.txt.macr
-00014760: 6f6d 6574 615f 736f 7572 6365 5f62 6967  ometa_source_big
-00014770: 7175 6572 792e 6567 672d 696e 666f 2f72  query.egg-info/r
-00014780: 6571 7569 7265 732e 7478 740a 6d61 6372  equires.txt.macr
-00014790: 6f6d 6574 615f 736f 7572 6365 5f62 6967  ometa_source_big
-000147a0: 7175 6572 792e 6567 672d 696e 666f 2f74  query.egg-info/t
-000147b0: 6f70 5f6c 6576 656c 2e74 7874 0a74 6573  op_level.txt.tes
-000147c0: 7473 2f74 6573 745f 7175 6572 792e 7079  ts/test_query.py
+00014600: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00014610: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014660: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00014670: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00014680: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+00014690: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
+000146a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000146b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000146c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000146d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000146e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000146f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014700: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00014710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000147a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000147b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000147c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000147d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000147e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000147f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014800: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00014810: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014800: 3232 206d 7469 6d65 3d31 3639 3038 3739  22 mtime=1690879
+00014810: 3732 332e 300a 0000 0000 0000 0000 0000  723.0...........
 00014820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014860: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00014870: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00014880: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00014890: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
+00014860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014890: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000148a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000148b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000148c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000148d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000148e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000148f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014900: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00014900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -5274,95 +5274,95 @@
 00014990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000149a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000149b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000149c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000149d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000149e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000149f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014a00: 3232 206d 7469 6d65 3d31 3638 3132 3134  22 mtime=1681214
-00014a10: 3537 362e 300a 0000 0000 0000 0000 0000  576.0...........
-00014a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014a60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014a70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014a80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014a90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014a00: 6d61 6372 6f6d 6574 612d 736f 7572 6365  macrometa-source
+00014a10: 2d62 6967 7175 6572 792d 312e 302e 302f  -bigquery-1.0.0/
+00014a20: 6d61 6372 6f6d 6574 615f 736f 7572 6365  macrometa_source
+00014a30: 5f62 6967 7175 6572 792e 6567 672d 696e  _bigquery.egg-in
+00014a40: 666f 2f64 6570 656e 6465 6e63 795f 6c69  fo/dependency_li
+00014a50: 6e6b 732e 7478 7400 0000 0000 0000 0000  nks.txt.........
+00014a60: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
+00014a70: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+00014a80: 3030 3030 3030 3100 3134 3436 3231 3433  0000001.14462143
+00014a90: 3335 3300 3033 3132 3130 0020 3000 0000  353.031210. 0...
 00014aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014b00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014b00: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
 00014b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014b20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014b20: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
 00014b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014b40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014b50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014c00: 6d61 6372 6f6d 6574 612d 736f 7572 6365  macrometa-source
-00014c10: 2d62 6967 7175 6572 792d 302e 302e 392f  -bigquery-0.0.9/
-00014c20: 6d61 6372 6f6d 6574 615f 736f 7572 6365  macrometa_source
-00014c30: 5f62 6967 7175 6572 792e 6567 672d 696e  _bigquery.egg-in
-00014c40: 666f 2f64 6570 656e 6465 6e63 795f 6c69  fo/dependency_li
-00014c50: 6e6b 732e 7478 7400 0000 0000 0000 0000  nks.txt.........
-00014c60: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
-00014c70: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
-00014c80: 3030 3030 3030 3100 3134 3431 3532 3436  0000001.14415246
-00014c90: 3136 3000 3033 3132 3136 0020 3000 0000  160.031216. 0...
+00014c00: 0a00 0000 0000 0000 0000 0000 0000 0000  ................
+00014c10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014c60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014c80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014c90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014d00: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
+00014d00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014d20: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
+00014d20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014d40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014d50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014e00: 0a00 0000 0000 0000 0000 0000 0000 0000  ................
+00014e00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
 00014e10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014e20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014e60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014e70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014e80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014e90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014e60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00014e70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00014e80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+00014e90: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
 00014ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014f00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014f00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 00014f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014f40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014f50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -5370,31 +5370,31 @@
 00014f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00014ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015000: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00015010: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015000: 3232 206d 7469 6d65 3d31 3639 3038 3739  22 mtime=1690879
+00015010: 3732 332e 300a 0000 0000 0000 0000 0000  723.0...........
 00015020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015060: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00015070: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00015080: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00015090: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
+00015060: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015070: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015080: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015090: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000150a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000150b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000150c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000150d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000150e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000150f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015100: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00015100: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -5402,95 +5402,95 @@
 00015190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000151a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000151b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000151c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000151d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000151e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000151f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015200: 3232 206d 7469 6d65 3d31 3638 3132 3134  22 mtime=1681214
-00015210: 3537 362e 300a 0000 0000 0000 0000 0000  576.0...........
-00015220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015290: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015200: 6d61 6372 6f6d 6574 612d 736f 7572 6365  macrometa-source
+00015210: 2d62 6967 7175 6572 792d 312e 302e 302f  -bigquery-1.0.0/
+00015220: 6d61 6372 6f6d 6574 615f 736f 7572 6365  macrometa_source
+00015230: 5f62 6967 7175 6572 792e 6567 672d 696e  _bigquery.egg-in
+00015240: 666f 2f65 6e74 7279 5f70 6f69 6e74 732e  fo/entry_points.
+00015250: 7478 7400 0000 0000 0000 0000 0000 0000  txt.............
+00015260: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
+00015270: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+00015280: 3030 3030 3131 3500 3134 3436 3231 3433  0000115.14462143
+00015290: 3335 3300 3033 3034 3335 0020 3000 0000  353.030435. 0...
 000152a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000152b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000152c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000152d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000152e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000152f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015300: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
 00015310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015320: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
 00015330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000153a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000153b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000153c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000153d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000153e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000153f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015400: 6d61 6372 6f6d 6574 612d 736f 7572 6365  macrometa-source
-00015410: 2d62 6967 7175 6572 792d 302e 302e 392f  -bigquery-0.0.9/
-00015420: 6d61 6372 6f6d 6574 615f 736f 7572 6365  macrometa_source
-00015430: 5f62 6967 7175 6572 792e 6567 672d 696e  _bigquery.egg-in
-00015440: 666f 2f65 6e74 7279 5f70 6f69 6e74 732e  fo/entry_points.
-00015450: 7478 7400 0000 0000 0000 0000 0000 0000  txt.............
-00015460: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
-00015470: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
-00015480: 3030 3030 3131 3500 3134 3431 3532 3436  0000115.14415246
-00015490: 3136 3000 3033 3034 3433 0020 3000 0000  160.030443. 0...
+00015400: 5b63 6f6e 736f 6c65 5f73 6372 6970 7473  [console_scripts
+00015410: 5d0a 6d61 6372 6f6d 6574 612d 736f 7572  ].macrometa-sour
+00015420: 6365 2d62 6967 7175 6572 7920 3d20 6d61  ce-bigquery = ma
+00015430: 6372 6f6d 6574 615f 736f 7572 6365 5f62  crometa_source_b
+00015440: 6967 7175 6572 793a 6d61 696e 0a00 0000  igquery:main....
+00015450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015490: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000154a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000154b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000154c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000154d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000154e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000154f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015500: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
+00015500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015520: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
+00015520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000155a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000155b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000155c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000155d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000155e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000155f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015600: 5b63 6f6e 736f 6c65 5f73 6372 6970 7473  [console_scripts
-00015610: 5d0a 6d61 6372 6f6d 6574 612d 736f 7572  ].macrometa-sour
-00015620: 6365 2d62 6967 7175 6572 7920 3d20 6d61  ce-bigquery = ma
-00015630: 6372 6f6d 6574 615f 736f 7572 6365 5f62  crometa_source_b
-00015640: 6967 7175 6572 793a 6d61 696e 0a00 0000  igquery:main....
+00015600: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00015610: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015690: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015660: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00015670: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00015680: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+00015690: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
 000156a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000156b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000156c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000156d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000156e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000156f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015700: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015700: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 00015710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -5498,31 +5498,31 @@
 00015790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000157a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000157b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000157c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000157d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000157e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000157f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015800: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00015810: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015800: 3232 206d 7469 6d65 3d31 3639 3038 3739  22 mtime=1690879
+00015810: 3732 332e 300a 0000 0000 0000 0000 0000  723.0...........
 00015820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015860: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00015870: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00015880: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00015890: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
+00015860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015890: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000158a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000158b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000158c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000158d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000158e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000158f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015900: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00015900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -5530,95 +5530,95 @@
 00015990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000159a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000159b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000159c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000159d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000159e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000159f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015a00: 3232 206d 7469 6d65 3d31 3638 3132 3134  22 mtime=1681214
-00015a10: 3537 362e 300a 0000 0000 0000 0000 0000  576.0...........
-00015a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015a00: 6d61 6372 6f6d 6574 612d 736f 7572 6365  macrometa-source
+00015a10: 2d62 6967 7175 6572 792d 312e 302e 302f  -bigquery-1.0.0/
+00015a20: 6d61 6372 6f6d 6574 615f 736f 7572 6365  macrometa_source
+00015a30: 5f62 6967 7175 6572 792e 6567 672d 696e  _bigquery.egg-in
+00015a40: 666f 2f72 6571 7569 7265 732e 7478 7400  fo/requires.txt.
 00015a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015a60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015a70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015a80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015a90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015a60: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
+00015a70: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+00015a80: 3030 3030 3234 3400 3134 3436 3231 3433  0000244.14462143
+00015a90: 3335 3300 3032 3735 3432 0020 3000 0000  353.027542. 0...
 00015aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015b00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015b00: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
 00015b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015b20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015b20: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
 00015b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015b40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015b50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015c00: 6d61 6372 6f6d 6574 612d 736f 7572 6365  macrometa-source
-00015c10: 2d62 6967 7175 6572 792d 302e 302e 392f  -bigquery-0.0.9/
-00015c20: 6d61 6372 6f6d 6574 615f 736f 7572 6365  macrometa_source
-00015c30: 5f62 6967 7175 6572 792e 6567 672d 696e  _bigquery.egg-in
-00015c40: 666f 2f72 6571 7569 7265 732e 7478 7400  fo/requires.txt.
-00015c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015c60: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
-00015c70: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
-00015c80: 3030 3030 3231 3200 3134 3431 3532 3436  0000212.14415246
-00015c90: 3136 3000 3032 3735 3433 0020 3000 0000  160.027543. 0...
-00015ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015c00: 6765 7473 6368 656d 613e 3d30 2e31 2e32  getschema>=0.1.2
+00015c10: 0a67 6f6f 676c 652d 636c 6f75 642d 6269  .google-cloud-bi
+00015c20: 6771 7565 7279 3d3d 332e 322e 300a 7369  gquery==3.2.0.si
+00015c30: 6d70 6c65 6a73 6f6e 3d3d 332e 3131 2e31  mplejson==3.11.1
+00015c40: 0a73 6574 7570 746f 6f6c 733e 3d34 302e  .setuptools>=40.
+00015c50: 332e 300a 7069 7065 6c69 6e65 7769 7365  3.0.pipelinewise
+00015c60: 2d73 696e 6765 722d 7079 7468 6f6e 3d3d  -singer-python==
+00015c70: 312e 322e 300a 6338 636f 6e6e 6563 746f  1.2.0.c8connecto
+00015c80: 723e 3d30 2e30 2e32 340a 7072 6f6d 6574  r>=0.0.24.promet
+00015c90: 6865 7573 2d63 6c69 656e 743d 3d30 2e31  heus-client==0.1
+00015ca0: 362e 300a 0000 0000 0000 0000 0000 0000  6.0.............
 00015cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015d00: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
+00015d00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015d20: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
+00015d20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015d40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015d50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015e00: 6765 7473 6368 656d 613e 3d30 2e31 2e32  getschema>=0.1.2
-00015e10: 0a67 6f6f 676c 652d 636c 6f75 642d 6269  .google-cloud-bi
-00015e20: 6771 7565 7279 3d3d 332e 322e 300a 7369  gquery==3.2.0.si
-00015e30: 6d70 6c65 6a73 6f6e 3d3d 332e 3131 2e31  mplejson==3.11.1
-00015e40: 0a73 6574 7570 746f 6f6c 733e 3d34 302e  .setuptools>=40.
-00015e50: 332e 300a 7069 7065 6c69 6e65 7769 7365  3.0.pipelinewise
-00015e60: 2d73 696e 6765 722d 7079 7468 6f6e 3d3d  -singer-python==
-00015e70: 312e 322e 300a 6338 636f 6e6e 6563 746f  1.2.0.c8connecto
-00015e80: 723d 3d30 2e30 2e31 350a 0000 0000 0000  r==0.0.15.......
-00015e90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015e00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00015e10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015e20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015e60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00015e70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00015e80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+00015e90: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
 00015ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015f00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015f00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 00015f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015f40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015f50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -5626,31 +5626,31 @@
 00015f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016000: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00016010: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016000: 3232 206d 7469 6d65 3d31 3639 3038 3739  22 mtime=1690879
+00016010: 3732 332e 300a 0000 0000 0000 0000 0000  723.0...........
 00016020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016060: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00016070: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00016080: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00016090: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
+00016060: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016070: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016080: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016090: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000160a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000160b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000160c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000160d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000160e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000160f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016100: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00016100: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -5658,95 +5658,95 @@
 00016190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000161a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000161b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000161c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000161d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000161e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000161f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016200: 3232 206d 7469 6d65 3d31 3638 3132 3134  22 mtime=1681214
-00016210: 3537 362e 300a 0000 0000 0000 0000 0000  576.0...........
-00016220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016200: 6d61 6372 6f6d 6574 612d 736f 7572 6365  macrometa-source
+00016210: 2d62 6967 7175 6572 792d 312e 302e 302f  -bigquery-1.0.0/
+00016220: 6d61 6372 6f6d 6574 615f 736f 7572 6365  macrometa_source
+00016230: 5f62 6967 7175 6572 792e 6567 672d 696e  _bigquery.egg-in
+00016240: 666f 2f74 6f70 5f6c 6576 656c 2e74 7874  fo/top_level.txt
 00016250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016290: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016260: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
+00016270: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+00016280: 3030 3030 3033 3200 3134 3436 3231 3433  0000032.14462143
+00016290: 3335 3300 3032 3736 3637 0020 3000 0000  353.027667. 0...
 000162a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000162b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000162c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000162d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000162e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000162f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016300: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
 00016310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016320: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
 00016330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000163a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000163b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000163c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000163d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000163e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000163f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016400: 6d61 6372 6f6d 6574 612d 736f 7572 6365  macrometa-source
-00016410: 2d62 6967 7175 6572 792d 302e 302e 392f  -bigquery-0.0.9/
-00016420: 6d61 6372 6f6d 6574 615f 736f 7572 6365  macrometa_source
-00016430: 5f62 6967 7175 6572 792e 6567 672d 696e  _bigquery.egg-in
-00016440: 666f 2f74 6f70 5f6c 6576 656c 2e74 7874  fo/top_level.txt
+00016400: 6d61 6372 6f6d 6574 615f 736f 7572 6365  macrometa_source
+00016410: 5f62 6967 7175 6572 790a 0000 0000 0000  _bigquery.......
+00016420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016460: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
-00016470: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
-00016480: 3030 3030 3033 3200 3134 3431 3532 3436  0000032.14415246
-00016490: 3136 3000 3032 3736 3735 0020 3000 0000  160.027675. 0...
+00016460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016490: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000164a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000164b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000164c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000164d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000164e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000164f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016500: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
+00016500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016520: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
+00016520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000165a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000165b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000165c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000165d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000165e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000165f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016600: 6d61 6372 6f6d 6574 615f 736f 7572 6365  macrometa_source
-00016610: 5f62 6967 7175 6572 790a 0000 0000 0000  _bigquery.......
+00016600: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00016610: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016690: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016660: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00016670: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00016680: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
+00016690: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
 000166a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000166b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000166c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000166d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000166e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000166f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016700: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016700: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 00016710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -5754,31 +5754,31 @@
 00016790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000167a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000167b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000167c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000167d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000167e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000167f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016800: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00016810: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016800: 3238 206d 7469 6d65 3d31 3639 3038 3739  28 mtime=1690879
+00016810: 3732 332e 3233 3437 3930 330a 0000 0000  723.2347903.....
 00016820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016860: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00016870: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00016880: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
-00016890: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
+00016860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016890: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000168a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000168b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000168c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000168d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000168e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000168f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016900: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00016900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -5786,95 +5786,95 @@
 00016990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000169a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000169b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000169c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000169d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000169e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000169f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016a00: 3238 206d 7469 6d65 3d31 3638 3132 3134  28 mtime=1681214
-00016a10: 3537 372e 3030 3936 3130 320a 0000 0000  577.0096102.....
-00016a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016a00: 6d61 6372 6f6d 6574 612d 736f 7572 6365  macrometa-source
+00016a10: 2d62 6967 7175 6572 792d 312e 302e 302f  -bigquery-1.0.0/
+00016a20: 7365 7475 702e 6366 6700 0000 0000 0000  setup.cfg.......
 00016a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016a60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016a70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016a80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016a90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016a60: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
+00016a70: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+00016a80: 3030 3030 3034 3600 3134 3436 3231 3433  0000046.14462143
+00016a90: 3335 3300 3032 3030 3332 0020 3000 0000  353.020032. 0...
 00016aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016b00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016b00: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
 00016b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016b20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016b20: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
 00016b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016b40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016b50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016c00: 6d61 6372 6f6d 6574 612d 736f 7572 6365  macrometa-source
-00016c10: 2d62 6967 7175 6572 792d 302e 302e 392f  -bigquery-0.0.9/
-00016c20: 7365 7475 702e 6366 6700 0000 0000 0000  setup.cfg.......
+00016c00: 5b65 6767 5f69 6e66 6f5d 0a74 6167 5f62  [egg_info].tag_b
+00016c10: 7569 6c64 203d 200a 7461 675f 6461 7465  uild = .tag_date
+00016c20: 203d 2030 0a0a 0000 0000 0000 0000 0000   = 0............
 00016c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016c60: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
-00016c70: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
-00016c80: 3030 3030 3034 3600 3134 3431 3532 3436  0000046.14415246
-00016c90: 3136 3100 3032 3030 3431 0020 3000 0000  161.020041. 0...
+00016c60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016c80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016c90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016d00: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
+00016d00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016d20: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
+00016d20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016d40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016d50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016e00: 5b65 6767 5f69 6e66 6f5d 0a74 6167 5f62  [egg_info].tag_b
-00016e10: 7569 6c64 203d 200a 7461 675f 6461 7465  uild = .tag_date
-00016e20: 203d 2030 0a0a 0000 0000 0000 0000 0000   = 0............
+00016e00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00016e10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016e20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016e60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016e70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016e80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016e90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016e60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00016e70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00016e80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+00016e90: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
 00016ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016f00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016f00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 00016f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016f40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016f50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -5882,31 +5882,31 @@
 00016f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00017000: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00017010: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017000: 3232 206d 7469 6d65 3d31 3639 3038 3739  22 mtime=1690879
+00017010: 3730 362e 300a 0000 0000 0000 0000 0000  706.0...........
 00017020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00017060: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00017070: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00017080: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00017090: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
+00017060: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017070: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017080: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017090: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000170a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000170b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000170c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000170d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000170e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000170f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00017100: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00017100: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -5914,159 +5914,159 @@
 00017190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000171a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000171b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000171c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000171d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000171e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000171f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00017200: 3232 206d 7469 6d65 3d31 3638 3132 3134  22 mtime=1681214
-00017210: 3536 312e 300a 0000 0000 0000 0000 0000  561.0...........
-00017220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017200: 6d61 6372 6f6d 6574 612d 736f 7572 6365  macrometa-source
+00017210: 2d62 6967 7175 6572 792d 312e 302e 302f  -bigquery-1.0.0/
+00017220: 7365 7475 702e 7079 0000 0000 0000 0000  setup.py........
 00017230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00017260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00017270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00017280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00017290: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017260: 0000 0000 3030 3030 3735 3500 3030 3031  ....0000755.0001
+00017270: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+00017280: 3030 3032 3037 3100 3134 3436 3231 3433  0002071.14462143
+00017290: 3333 3200 3031 3737 3233 0020 3000 0000  332.017723. 0...
 000172a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000172b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000172c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000172d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000172e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000172f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00017300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017300: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
 00017310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00017320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017320: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
 00017330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000173a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000173b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000173c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000173d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000173e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000173f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00017400: 6d61 6372 6f6d 6574 612d 736f 7572 6365  macrometa-source
-00017410: 2d62 6967 7175 6572 792d 302e 302e 392f  -bigquery-0.0.9/
-00017420: 7365 7475 702e 7079 0000 0000 0000 0000  setup.py........
-00017430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00017440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00017450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00017460: 0000 0000 3030 3030 3735 3500 3030 3031  ....0000755.0001
-00017470: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
-00017480: 3030 3032 3032 3400 3134 3431 3532 3436  0002024.14415246
-00017490: 3134 3100 3031 3737 3331 0020 3000 0000  141.017731. 0...
-000174a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000174b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000174c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000174d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000174e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000174f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00017500: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
-00017510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00017520: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
-00017530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00017540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00017550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00017560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00017570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00017580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00017590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000175a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000175b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000175c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000175d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000175e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000175f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00017600: 2321 2f75 7372 2f62 696e 2f65 6e76 2070  #!/usr/bin/env p
-00017610: 7974 686f 6e0a 6672 6f6d 2073 6574 7570  ython.from setup
-00017620: 746f 6f6c 7320 696d 706f 7274 2073 6574  tools import set
-00017630: 7570 0a0a 0a77 6974 6820 6f70 656e 2822  up...with open("
-00017640: 5245 4144 4d45 2e6d 6422 2c20 2272 2229  README.md", "r")
-00017650: 2061 7320 6668 3a0a 2020 2020 6c6f 6e67   as fh:.    long
-00017660: 5f64 6573 6372 6970 7469 6f6e 203d 2066  _description = f
-00017670: 682e 7265 6164 2829 0a0a 7365 7475 7028  h.read()..setup(
-00017680: 0a20 2020 206e 616d 653d 226d 6163 726f  .    name="macro
-00017690: 6d65 7461 2d73 6f75 7263 652d 6269 6771  meta-source-bigq
-000176a0: 7565 7279 222c 0a20 2020 2076 6572 7369  uery",.    versi
-000176b0: 6f6e 3d27 302e 302e 3927 2c0a 2020 2020  on='0.0.9',.    
-000176c0: 6465 7363 7269 7074 696f 6e3d 224d 6163  description="Mac
-000176d0: 726f 6d65 7461 2073 6f75 7263 6520 6269  rometa source bi
-000176e0: 6771 7565 7279 2063 6f6e 6e65 6374 6f72  gquery connector
-000176f0: 2066 6f72 2065 7874 7261 6374 696e 6720   for extracting 
-00017700: 6461 7461 2066 726f 6d20 4269 6751 7565  data from BigQue
-00017710: 7279 222c 0a20 2020 206c 6f6e 675f 6465  ry",.    long_de
-00017720: 7363 7269 7074 696f 6e3d 6c6f 6e67 5f64  scription=long_d
-00017730: 6573 6372 6970 7469 6f6e 2c0a 2020 2020  escription,.    
-00017740: 6c6f 6e67 5f64 6573 6372 6970 7469 6f6e  long_description
-00017750: 5f63 6f6e 7465 6e74 5f74 7970 653d 2274  _content_type="t
-00017760: 6578 742f 6d61 726b 646f 776e 222c 0a20  ext/markdown",. 
-00017770: 2020 2061 7574 686f 723d 224d 6163 726f     author="Macro
-00017780: 6d65 7461 222c 0a20 2020 2075 726c 3d22  meta",.    url="
-00017790: 6874 7470 733a 2f2f 6769 7468 7562 2e63  https://github.c
-000177a0: 6f6d 2f4d 6163 726f 6d65 7461 636f 7270  om/Macrometacorp
-000177b0: 2f6d 6163 726f 6d65 7461 2d73 6f75 7263  /macrometa-sourc
-000177c0: 652d 6269 6771 7565 7279 222c 0a0a 2020  e-bigquery",..  
-000177d0: 2020 636c 6173 7369 6669 6572 733d 5b0a    classifiers=[.
-000177e0: 2020 2020 2020 2020 224c 6963 656e 7365          "License
-000177f0: 203a 3a20 4f53 4920 4170 7072 6f76 6564   :: OSI Approved
-00017800: 203a 3a20 4170 6163 6865 2053 6f66 7477   :: Apache Softw
-00017810: 6172 6520 4c69 6365 6e73 6522 2c0a 2020  are License",.  
-00017820: 2020 2020 2020 2250 726f 6772 616d 6d69        "Programmi
-00017830: 6e67 204c 616e 6775 6167 6520 3a3a 2050  ng Language :: P
-00017840: 7974 686f 6e20 3a3a 2033 203a 3a20 4f6e  ython :: 3 :: On
-00017850: 6c79 222c 0a20 2020 205d 2c0a 2020 2020  ly",.    ],.    
-00017860: 7079 5f6d 6f64 756c 6573 3d5b 226d 6163  py_modules=["mac
-00017870: 726f 6d65 7461 5f73 6f75 7263 655f 6269  rometa_source_bi
-00017880: 6771 7565 7279 225d 2c0a 2020 2020 696e  gquery"],.    in
-00017890: 7374 616c 6c5f 7265 7175 6972 6573 3d5b  stall_requires=[
-000178a0: 0a20 2020 2020 2020 2022 6765 7473 6368  .        "getsch
-000178b0: 656d 613e 3d30 2e31 2e32 222c 0a20 2020  ema>=0.1.2",.   
-000178c0: 2020 2020 2022 676f 6f67 6c65 2d63 6c6f       "google-clo
-000178d0: 7564 2d62 6967 7175 6572 793d 3d33 2e32  ud-bigquery==3.2
-000178e0: 2e30 222c 0a20 2020 2020 2020 2022 7369  .0",.        "si
-000178f0: 6d70 6c65 6a73 6f6e 3d3d 332e 3131 2e31  mplejson==3.11.1
-00017900: 222c 0a20 2020 2020 2020 2022 7365 7475  ",.        "setu
-00017910: 7074 6f6f 6c73 3e3d 3430 2e33 2e30 222c  ptools>=40.3.0",
-00017920: 0a20 2020 2020 2020 2022 7069 7065 6c69  .        "pipeli
-00017930: 6e65 7769 7365 2d73 696e 6765 722d 7079  newise-singer-py
-00017940: 7468 6f6e 3d3d 312e 322e 3022 2c0a 2020  thon==1.2.0",.  
-00017950: 2020 2020 2020 2263 3863 6f6e 6e65 6374        "c8connect
-00017960: 6f72 3d3d 302e 302e 3135 220a 2020 2020  or==0.0.15".    
-00017970: 5d2c 0a0a 2020 2020 656e 7472 795f 706f  ],..    entry_po
-00017980: 696e 7473 3d22 2222 0a20 2020 205b 636f  ints=""".    [co
-00017990: 6e73 6f6c 655f 7363 7269 7074 735d 0a20  nsole_scripts]. 
-000179a0: 2020 206d 6163 726f 6d65 7461 2d73 6f75     macrometa-sou
-000179b0: 7263 652d 6269 6771 7565 7279 3d6d 6163  rce-bigquery=mac
-000179c0: 726f 6d65 7461 5f73 6f75 7263 655f 6269  rometa_source_bi
-000179d0: 6771 7565 7279 3a6d 6169 6e0a 2020 2020  gquery:main.    
-000179e0: 2222 222c 0a0a 2020 2020 7061 636b 6167  """,..    packag
-000179f0: 6573 3d5b 226d 6163 726f 6d65 7461 5f73  es=["macrometa_s
-00017a00: 6f75 7263 655f 6269 6771 7565 7279 225d  ource_bigquery"]
-00017a10: 2c0a 290a 0000 0000 0000 0000 0000 0000  ,.).............
+00017400: 2321 2f75 7372 2f62 696e 2f65 6e76 2070  #!/usr/bin/env p
+00017410: 7974 686f 6e0a 6672 6f6d 2073 6574 7570  ython.from setup
+00017420: 746f 6f6c 7320 696d 706f 7274 2073 6574  tools import set
+00017430: 7570 0a0a 0a77 6974 6820 6f70 656e 2822  up...with open("
+00017440: 5245 4144 4d45 2e6d 6422 2c20 2272 2229  README.md", "r")
+00017450: 2061 7320 6668 3a0a 2020 2020 6c6f 6e67   as fh:.    long
+00017460: 5f64 6573 6372 6970 7469 6f6e 203d 2066  _description = f
+00017470: 682e 7265 6164 2829 0a0a 7365 7475 7028  h.read()..setup(
+00017480: 0a20 2020 206e 616d 653d 226d 6163 726f  .    name="macro
+00017490: 6d65 7461 2d73 6f75 7263 652d 6269 6771  meta-source-bigq
+000174a0: 7565 7279 222c 0a20 2020 2076 6572 7369  uery",.    versi
+000174b0: 6f6e 3d27 312e 302e 3027 2c0a 2020 2020  on='1.0.0',.    
+000174c0: 6465 7363 7269 7074 696f 6e3d 224d 6163  description="Mac
+000174d0: 726f 6d65 7461 2073 6f75 7263 6520 6269  rometa source bi
+000174e0: 6771 7565 7279 2063 6f6e 6e65 6374 6f72  gquery connector
+000174f0: 2066 6f72 2065 7874 7261 6374 696e 6720   for extracting 
+00017500: 6461 7461 2066 726f 6d20 4269 6751 7565  data from BigQue
+00017510: 7279 222c 0a20 2020 206c 6f6e 675f 6465  ry",.    long_de
+00017520: 7363 7269 7074 696f 6e3d 6c6f 6e67 5f64  scription=long_d
+00017530: 6573 6372 6970 7469 6f6e 2c0a 2020 2020  escription,.    
+00017540: 6c6f 6e67 5f64 6573 6372 6970 7469 6f6e  long_description
+00017550: 5f63 6f6e 7465 6e74 5f74 7970 653d 2274  _content_type="t
+00017560: 6578 742f 6d61 726b 646f 776e 222c 0a20  ext/markdown",. 
+00017570: 2020 2061 7574 686f 723d 224d 6163 726f     author="Macro
+00017580: 6d65 7461 222c 0a20 2020 2075 726c 3d22  meta",.    url="
+00017590: 6874 7470 733a 2f2f 6769 7468 7562 2e63  https://github.c
+000175a0: 6f6d 2f4d 6163 726f 6d65 7461 636f 7270  om/Macrometacorp
+000175b0: 2f6d 6163 726f 6d65 7461 2d73 6f75 7263  /macrometa-sourc
+000175c0: 652d 6269 6771 7565 7279 222c 0a0a 2020  e-bigquery",..  
+000175d0: 2020 636c 6173 7369 6669 6572 733d 5b0a    classifiers=[.
+000175e0: 2020 2020 2020 2020 224c 6963 656e 7365          "License
+000175f0: 203a 3a20 4f53 4920 4170 7072 6f76 6564   :: OSI Approved
+00017600: 203a 3a20 4170 6163 6865 2053 6f66 7477   :: Apache Softw
+00017610: 6172 6520 4c69 6365 6e73 6522 2c0a 2020  are License",.  
+00017620: 2020 2020 2020 2250 726f 6772 616d 6d69        "Programmi
+00017630: 6e67 204c 616e 6775 6167 6520 3a3a 2050  ng Language :: P
+00017640: 7974 686f 6e20 3a3a 2033 203a 3a20 4f6e  ython :: 3 :: On
+00017650: 6c79 222c 0a20 2020 205d 2c0a 2020 2020  ly",.    ],.    
+00017660: 7079 5f6d 6f64 756c 6573 3d5b 226d 6163  py_modules=["mac
+00017670: 726f 6d65 7461 5f73 6f75 7263 655f 6269  rometa_source_bi
+00017680: 6771 7565 7279 225d 2c0a 2020 2020 696e  gquery"],.    in
+00017690: 7374 616c 6c5f 7265 7175 6972 6573 3d5b  stall_requires=[
+000176a0: 0a20 2020 2020 2020 2022 6765 7473 6368  .        "getsch
+000176b0: 656d 613e 3d30 2e31 2e32 222c 0a20 2020  ema>=0.1.2",.   
+000176c0: 2020 2020 2022 676f 6f67 6c65 2d63 6c6f       "google-clo
+000176d0: 7564 2d62 6967 7175 6572 793d 3d33 2e32  ud-bigquery==3.2
+000176e0: 2e30 222c 0a20 2020 2020 2020 2022 7369  .0",.        "si
+000176f0: 6d70 6c65 6a73 6f6e 3d3d 332e 3131 2e31  mplejson==3.11.1
+00017700: 222c 0a20 2020 2020 2020 2022 7365 7475  ",.        "setu
+00017710: 7074 6f6f 6c73 3e3d 3430 2e33 2e30 222c  ptools>=40.3.0",
+00017720: 0a20 2020 2020 2020 2022 7069 7065 6c69  .        "pipeli
+00017730: 6e65 7769 7365 2d73 696e 6765 722d 7079  newise-singer-py
+00017740: 7468 6f6e 3d3d 312e 322e 3022 2c0a 2020  thon==1.2.0",.  
+00017750: 2020 2020 2020 2263 3863 6f6e 6e65 6374        "c8connect
+00017760: 6f72 3e3d 302e 302e 3234 222c 0a20 2020  or>=0.0.24",.   
+00017770: 2020 2020 2022 7072 6f6d 6574 6865 7573       "prometheus
+00017780: 2d63 6c69 656e 743d 3d30 2e31 362e 3022  -client==0.16.0"
+00017790: 0a20 2020 205d 2c0a 0a20 2020 2065 6e74  .    ],..    ent
+000177a0: 7279 5f70 6f69 6e74 733d 2222 220a 2020  ry_points=""".  
+000177b0: 2020 5b63 6f6e 736f 6c65 5f73 6372 6970    [console_scrip
+000177c0: 7473 5d0a 2020 2020 6d61 6372 6f6d 6574  ts].    macromet
+000177d0: 612d 736f 7572 6365 2d62 6967 7175 6572  a-source-bigquer
+000177e0: 793d 6d61 6372 6f6d 6574 615f 736f 7572  y=macrometa_sour
+000177f0: 6365 5f62 6967 7175 6572 793a 6d61 696e  ce_bigquery:main
+00017800: 0a20 2020 2022 2222 2c0a 0a20 2020 2070  .    """,..    p
+00017810: 6163 6b61 6765 733d 5b22 6d61 6372 6f6d  ackages=["macrom
+00017820: 6574 615f 736f 7572 6365 5f62 6967 7175  eta_source_bigqu
+00017830: 6572 7922 5d2c 0a29 0a00 0000 0000 0000  ery"],.)........
+00017840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017890: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000178a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000178b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000178c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000178d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000178e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000178f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000179a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000179b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000179c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000179d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000179e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000179f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017a00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00017a10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00017a60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00017a70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00017a80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00017a90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017a60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00017a70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00017a80: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
+00017a90: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
 00017aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00017b00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017b00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 00017b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017b20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017b40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017b50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -6074,31 +6074,31 @@
 00017b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00017c00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00017c10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017c00: 3238 206d 7469 6d65 3d31 3639 3038 3739  28 mtime=1690879
+00017c10: 3732 332e 3233 3437 3930 330a 0000 0000  723.2347903.....
 00017c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00017c60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00017c70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00017c80: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
-00017c90: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
+00017c60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017c80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017c90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00017d00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00017d00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017d20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017d40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017d50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -6106,95 +6106,95 @@
 00017d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00017e00: 3238 206d 7469 6d65 3d31 3638 3132 3134  28 mtime=1681214
-00017e10: 3537 372e 3030 3936 3130 320a 0000 0000  577.0096102.....
-00017e20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017e00: 6d61 6372 6f6d 6574 612d 736f 7572 6365  macrometa-source
+00017e10: 2d62 6967 7175 6572 792d 312e 302e 302f  -bigquery-1.0.0/
+00017e20: 7465 7374 732f 0000 0000 0000 0000 0000  tests/..........
 00017e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00017e60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00017e70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00017e80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00017e90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017e60: 0000 0000 3030 3030 3735 3500 3030 3031  ....0000755.0001
+00017e70: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+00017e80: 3030 3030 3030 3000 3134 3436 3231 3433  0000000.14462143
+00017e90: 3335 3300 3031 3733 3533 0020 3500 0000  353.017353. 5...
 00017ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00017f00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017f00: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
 00017f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00017f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00017f20: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
 00017f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017f40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017f50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00017ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018000: 6d61 6372 6f6d 6574 612d 736f 7572 6365  macrometa-source
-00018010: 2d62 6967 7175 6572 792d 302e 302e 392f  -bigquery-0.0.9/
-00018020: 7465 7374 732f 0000 0000 0000 0000 0000  tests/..........
+00018000: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00018010: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00018030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00018040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00018050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018060: 0000 0000 3030 3030 3735 3500 3030 3031  ....0000755.0001
-00018070: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
-00018080: 3030 3030 3030 3000 3134 3431 3532 3436  0000000.14415246
-00018090: 3136 3100 3031 3733 3632 0020 3500 0000  161.017362. 5...
+00018060: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00018070: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00018080: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+00018090: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
 000180a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000180b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000180c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000180d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000180e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000180f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018100: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
+00018100: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 00018110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018120: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
+00018120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00018130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00018140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00018150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00018160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00018170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00018180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00018190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000181a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000181b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000181c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000181d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000181e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000181f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018200: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00018210: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018200: 3232 206d 7469 6d65 3d31 3639 3038 3739  22 mtime=1690879
+00018210: 3730 362e 300a 0000 0000 0000 0000 0000  706.0...........
 00018220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00018230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00018240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00018250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018260: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00018270: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00018280: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00018290: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
+00018260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018290: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000182a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000182b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000182c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000182d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000182e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000182f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018300: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00018300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00018310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00018320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00018330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00018340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00018350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00018360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00018370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -6202,177 +6202,177 @@
 00018390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000183a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000183b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000183c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000183d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000183e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000183f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018400: 3232 206d 7469 6d65 3d31 3638 3132 3134  22 mtime=1681214
-00018410: 3536 312e 300a 0000 0000 0000 0000 0000  561.0...........
-00018420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018400: 6d61 6372 6f6d 6574 612d 736f 7572 6365  macrometa-source
+00018410: 2d62 6967 7175 6572 792d 312e 302e 302f  -bigquery-1.0.0/
+00018420: 7465 7374 732f 7465 7374 5f71 7565 7279  tests/test_query
+00018430: 2e70 7900 0000 0000 0000 0000 0000 0000  .py.............
 00018440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00018450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018490: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018460: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
+00018470: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+00018480: 3030 3033 3034 3300 3134 3436 3231 3433  0003043.14462143
+00018490: 3333 3200 3032 3231 3236 0020 3000 0000  332.022126. 0...
 000184a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000184b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000184c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000184d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000184e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000184f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018500: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
 00018510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018520: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
 00018530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00018540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00018550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00018560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00018570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00018580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00018590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000185a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000185b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000185c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000185d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000185e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000185f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018600: 6d61 6372 6f6d 6574 612d 736f 7572 6365  macrometa-source
-00018610: 2d62 6967 7175 6572 792d 302e 302e 392f  -bigquery-0.0.9/
-00018620: 7465 7374 732f 7465 7374 5f71 7565 7279  tests/test_query
-00018630: 2e70 7900 0000 0000 0000 0000 0000 0000  .py.............
-00018640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018660: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
-00018670: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
-00018680: 3030 3033 3034 3300 3134 3431 3532 3436  0003043.14415246
-00018690: 3134 3100 3032 3231 3336 0020 3000 0000  141.022136. 0...
-000186a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000186b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000186c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000186d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000186e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000186f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018700: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
-00018710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018720: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
-00018730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000187a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000187b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000187c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000187d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000187e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000187f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018800: 6672 6f6d 2074 6170 5f62 6967 7175 6572  from tap_bigquer
-00018810: 792e 7379 6e63 5f62 6967 7175 6572 7920  y.sync_bigquery 
-00018820: 696d 706f 7274 205f 6275 696c 645f 7175  import _build_qu
-00018830: 6572 7920 6173 2062 7569 6c64 5f71 7565  ery as build_que
-00018840: 7279 0a0a 0a64 6566 2074 6573 745f 636f  ry...def test_co
-00018850: 6c75 6d6e 5f63 6f6e 7374 7275 6374 696f  lumn_constructio
-00018860: 6e28 293a 0a20 2020 206b 6579 7320 3d20  n():.    keys = 
-00018870: 7b0a 2020 2020 2020 2020 2274 6162 6c65  {.        "table
-00018880: 223a 2022 7465 7374 2e74 6573 742e 7461  ": "test.test.ta
-00018890: 626c 6522 2c0a 2020 2020 2020 2020 2263  ble",.        "c
-000188a0: 6f6c 756d 6e73 223a 205b 2263 6f6c 3022  olumns": ["col0"
-000188b0: 2c20 2263 6f6c 3122 2c20 2263 6f6c 3222  , "col1", "col2"
-000188c0: 5d2c 0a20 2020 2020 2020 2022 6461 7465  ],.        "date
-000188d0: 7469 6d65 5f6b 6579 223a 2022 636f 6c30  time_key": "col0
-000188e0: 220a 2020 2020 7d0a 2020 2020 7175 6572  ".    }.    quer
-000188f0: 7920 3d20 6275 696c 645f 7175 6572 7928  y = build_query(
-00018900: 6b65 7973 290a 2020 2020 6578 7065 6374  keys).    expect
-00018910: 6564 203d 2028 0a20 2020 2020 2020 2022  ed = (.        "
-00018920: 5345 4c45 4354 2063 6f6c 302c 636f 6c31  SELECT col0,col1
-00018930: 2c63 6f6c 3220 4652 4f4d 2074 6573 742e  ,col2 FROM test.
-00018940: 7465 7374 2e74 6162 6c65 2057 4845 5245  test.table WHERE
-00018950: 2031 3d31 204f 5244 4552 2042 5920 636f   1=1 ORDER BY co
-00018960: 6c30 2229 0a20 2020 2061 7373 6572 7420  l0").    assert 
-00018970: 7175 6572 7920 3d3d 2065 7870 6563 7465  query == expecte
-00018980: 640a 0a0a 6465 6620 7465 7374 5f64 6174  d...def test_dat
-00018990: 6574 696d 655f 6b65 795f 696e 7365 7274  etime_key_insert
-000189a0: 696f 6e28 293a 0a20 2020 206b 6579 7320  ion():.    keys 
-000189b0: 3d20 7b0a 2020 2020 2020 2020 2274 6162  = {.        "tab
-000189c0: 6c65 223a 2022 7465 7374 2e74 6573 742e  le": "test.test.
-000189d0: 7461 626c 6522 2c0a 2020 2020 2020 2020  table",.        
-000189e0: 2263 6f6c 756d 6e73 223a 205b 2263 6f6c  "columns": ["col
-000189f0: 3122 2c20 2263 6f6c 3222 5d2c 0a20 2020  1", "col2"],.   
-00018a00: 2020 2020 2022 6461 7465 7469 6d65 5f6b       "datetime_k
-00018a10: 6579 223a 2022 636f 6c30 220a 2020 2020  ey": "col0".    
-00018a20: 7d0a 2020 2020 7175 6572 7920 3d20 6275  }.    query = bu
-00018a30: 696c 645f 7175 6572 7928 6b65 7973 290a  ild_query(keys).
-00018a40: 2020 2020 6578 7065 6374 6564 203d 2028      expected = (
-00018a50: 0a20 2020 2020 2020 2022 5345 4c45 4354  .        "SELECT
-00018a60: 2063 6f6c 312c 636f 6c32 2c63 6f6c 3020   col1,col2,col0 
-00018a70: 4652 4f4d 2074 6573 742e 7465 7374 2e74  FROM test.test.t
-00018a80: 6162 6c65 2057 4845 5245 2031 3d31 204f  able WHERE 1=1 O
-00018a90: 5244 4552 2042 5920 636f 6c30 2229 0a20  RDER BY col0"). 
-00018aa0: 2020 2061 7373 6572 7420 7175 6572 7920     assert query 
-00018ab0: 3d3d 2065 7870 6563 7465 640a 0a0a 6465  == expected...de
-00018ac0: 6620 7465 7374 5f6c 696d 6974 2829 3a0a  f test_limit():.
-00018ad0: 2020 2020 6b65 7973 203d 207b 0a20 2020      keys = {.   
-00018ae0: 2020 2020 2022 7461 626c 6522 3a20 2274       "table": "t
-00018af0: 6573 742e 7465 7374 2e74 6162 6c65 222c  est.test.table",
-00018b00: 0a20 2020 2020 2020 2022 636f 6c75 6d6e  .        "column
-00018b10: 7322 3a20 5b22 636f 6c30 222c 2022 636f  s": ["col0", "co
-00018b20: 6c31 222c 2022 636f 6c32 225d 2c0a 2020  l1", "col2"],.  
-00018b30: 2020 2020 2020 2264 6174 6574 696d 655f        "datetime_
-00018b40: 6b65 7922 3a20 2263 6f6c 3022 0a20 2020  key": "col0".   
-00018b50: 207d 0a20 2020 2071 7565 7279 203d 2062   }.    query = b
-00018b60: 7569 6c64 5f71 7565 7279 286b 6579 732c  uild_query(keys,
-00018b70: 206c 696d 6974 3d31 3029 0a20 2020 2065   limit=10).    e
-00018b80: 7870 6563 7465 6420 3d20 280a 2020 2020  xpected = (.    
-00018b90: 2020 2020 2253 454c 4543 5420 636f 6c30      "SELECT col0
-00018ba0: 2c63 6f6c 312c 636f 6c32 2046 524f 4d20  ,col1,col2 FROM 
-00018bb0: 7465 7374 2e74 6573 742e 7461 626c 6520  test.test.table 
-00018bc0: 5748 4552 4520 313d 3122 202b 0a20 2020  WHERE 1=1" +.   
-00018bd0: 2020 2020 2022 204f 5244 4552 2042 5920       " ORDER BY 
-00018be0: 636f 6c30 204c 494d 4954 2031 3022 290a  col0 LIMIT 10").
-00018bf0: 2020 2020 6173 7365 7274 2071 7565 7279      assert query
-00018c00: 203d 3d20 6578 7065 6374 6564 0a0a 0a64   == expected...d
-00018c10: 6566 2074 6573 745f 6669 6c74 6572 7328  ef test_filters(
-00018c20: 293a 0a20 2020 206b 6579 7320 3d20 7b0a  ):.    keys = {.
-00018c30: 2020 2020 2020 2020 2274 6162 6c65 223a          "table":
-00018c40: 2022 7465 7374 2e74 6573 742e 7461 626c   "test.test.tabl
-00018c50: 6522 2c0a 2020 2020 2020 2020 2263 6f6c  e",.        "col
-00018c60: 756d 6e73 223a 205b 2263 6f6c 3022 2c20  umns": ["col0", 
-00018c70: 2263 6f6c 3122 2c20 2263 6f6c 3222 5d2c  "col1", "col2"],
-00018c80: 0a20 2020 2020 2020 2022 6461 7465 7469  .        "dateti
-00018c90: 6d65 5f6b 6579 223a 2022 6372 6561 7465  me_key": "create
-00018ca0: 645f 6174 220a 2020 2020 7d0a 2020 2020  d_at".    }.    
-00018cb0: 6669 6c74 6572 7320 3d20 5b22 4441 5445  filters = ["DATE
-00018cc0: 5f41 4444 2863 7265 6174 6564 5f61 742c  _ADD(created_at,
-00018cd0: 2049 4e54 4552 5641 4c20 2d37 2044 4159   INTERVAL -7 DAY
-00018ce0: 2922 2c0a 2020 2020 2020 2020 2020 2020  )",.            
-00018cf0: 2020 2022 7374 6174 653d 2743 4127 225d     "state='CA'"]
-00018d00: 0a20 2020 2071 7565 7279 203d 2062 7569  .    query = bui
-00018d10: 6c64 5f71 7565 7279 286b 6579 732c 2066  ld_query(keys, f
-00018d20: 696c 7465 7273 3d66 696c 7465 7273 2c20  ilters=filters, 
-00018d30: 6c69 6d69 743d 3130 290a 2020 2020 6578  limit=10).    ex
-00018d40: 7065 6374 6564 203d 2028 0a20 2020 2020  pected = (.     
-00018d50: 2020 2022 5345 4c45 4354 2063 6f6c 302c     "SELECT col0,
-00018d60: 636f 6c31 2c63 6f6c 322c 6372 6561 7465  col1,col2,create
-00018d70: 645f 6174 2046 524f 4d20 7465 7374 2e74  d_at FROM test.t
-00018d80: 6573 742e 7461 626c 6522 202b 0a20 2020  est.table" +.   
-00018d90: 2020 2020 2022 2057 4845 5245 2031 3d31       " WHERE 1=1
-00018da0: 2041 4e44 2044 4154 455f 4144 4428 6372   AND DATE_ADD(cr
-00018db0: 6561 7465 645f 6174 2c20 494e 5445 5256  eated_at, INTERV
-00018dc0: 414c 202d 3720 4441 5929 2220 2b0a 2020  AL -7 DAY)" +.  
-00018dd0: 2020 2020 2020 2220 414e 4420 7374 6174        " AND stat
-00018de0: 653d 2743 4127 204f 5244 4552 2042 5920  e='CA' ORDER BY 
-00018df0: 6372 6561 7465 645f 6174 204c 494d 4954  created_at LIMIT
-00018e00: 2031 3022 290a 2020 2020 6173 7365 7274   10").    assert
-00018e10: 2071 7565 7279 203d 3d20 6578 7065 6374   query == expect
-00018e20: 6564 0a00 0000 0000 0000 0000 0000 0000  ed..............
+00018600: 6672 6f6d 2074 6170 5f62 6967 7175 6572  from tap_bigquer
+00018610: 792e 7379 6e63 5f62 6967 7175 6572 7920  y.sync_bigquery 
+00018620: 696d 706f 7274 205f 6275 696c 645f 7175  import _build_qu
+00018630: 6572 7920 6173 2062 7569 6c64 5f71 7565  ery as build_que
+00018640: 7279 0a0a 0a64 6566 2074 6573 745f 636f  ry...def test_co
+00018650: 6c75 6d6e 5f63 6f6e 7374 7275 6374 696f  lumn_constructio
+00018660: 6e28 293a 0a20 2020 206b 6579 7320 3d20  n():.    keys = 
+00018670: 7b0a 2020 2020 2020 2020 2274 6162 6c65  {.        "table
+00018680: 223a 2022 7465 7374 2e74 6573 742e 7461  ": "test.test.ta
+00018690: 626c 6522 2c0a 2020 2020 2020 2020 2263  ble",.        "c
+000186a0: 6f6c 756d 6e73 223a 205b 2263 6f6c 3022  olumns": ["col0"
+000186b0: 2c20 2263 6f6c 3122 2c20 2263 6f6c 3222  , "col1", "col2"
+000186c0: 5d2c 0a20 2020 2020 2020 2022 6461 7465  ],.        "date
+000186d0: 7469 6d65 5f6b 6579 223a 2022 636f 6c30  time_key": "col0
+000186e0: 220a 2020 2020 7d0a 2020 2020 7175 6572  ".    }.    quer
+000186f0: 7920 3d20 6275 696c 645f 7175 6572 7928  y = build_query(
+00018700: 6b65 7973 290a 2020 2020 6578 7065 6374  keys).    expect
+00018710: 6564 203d 2028 0a20 2020 2020 2020 2022  ed = (.        "
+00018720: 5345 4c45 4354 2063 6f6c 302c 636f 6c31  SELECT col0,col1
+00018730: 2c63 6f6c 3220 4652 4f4d 2074 6573 742e  ,col2 FROM test.
+00018740: 7465 7374 2e74 6162 6c65 2057 4845 5245  test.table WHERE
+00018750: 2031 3d31 204f 5244 4552 2042 5920 636f   1=1 ORDER BY co
+00018760: 6c30 2229 0a20 2020 2061 7373 6572 7420  l0").    assert 
+00018770: 7175 6572 7920 3d3d 2065 7870 6563 7465  query == expecte
+00018780: 640a 0a0a 6465 6620 7465 7374 5f64 6174  d...def test_dat
+00018790: 6574 696d 655f 6b65 795f 696e 7365 7274  etime_key_insert
+000187a0: 696f 6e28 293a 0a20 2020 206b 6579 7320  ion():.    keys 
+000187b0: 3d20 7b0a 2020 2020 2020 2020 2274 6162  = {.        "tab
+000187c0: 6c65 223a 2022 7465 7374 2e74 6573 742e  le": "test.test.
+000187d0: 7461 626c 6522 2c0a 2020 2020 2020 2020  table",.        
+000187e0: 2263 6f6c 756d 6e73 223a 205b 2263 6f6c  "columns": ["col
+000187f0: 3122 2c20 2263 6f6c 3222 5d2c 0a20 2020  1", "col2"],.   
+00018800: 2020 2020 2022 6461 7465 7469 6d65 5f6b       "datetime_k
+00018810: 6579 223a 2022 636f 6c30 220a 2020 2020  ey": "col0".    
+00018820: 7d0a 2020 2020 7175 6572 7920 3d20 6275  }.    query = bu
+00018830: 696c 645f 7175 6572 7928 6b65 7973 290a  ild_query(keys).
+00018840: 2020 2020 6578 7065 6374 6564 203d 2028      expected = (
+00018850: 0a20 2020 2020 2020 2022 5345 4c45 4354  .        "SELECT
+00018860: 2063 6f6c 312c 636f 6c32 2c63 6f6c 3020   col1,col2,col0 
+00018870: 4652 4f4d 2074 6573 742e 7465 7374 2e74  FROM test.test.t
+00018880: 6162 6c65 2057 4845 5245 2031 3d31 204f  able WHERE 1=1 O
+00018890: 5244 4552 2042 5920 636f 6c30 2229 0a20  RDER BY col0"). 
+000188a0: 2020 2061 7373 6572 7420 7175 6572 7920     assert query 
+000188b0: 3d3d 2065 7870 6563 7465 640a 0a0a 6465  == expected...de
+000188c0: 6620 7465 7374 5f6c 696d 6974 2829 3a0a  f test_limit():.
+000188d0: 2020 2020 6b65 7973 203d 207b 0a20 2020      keys = {.   
+000188e0: 2020 2020 2022 7461 626c 6522 3a20 2274       "table": "t
+000188f0: 6573 742e 7465 7374 2e74 6162 6c65 222c  est.test.table",
+00018900: 0a20 2020 2020 2020 2022 636f 6c75 6d6e  .        "column
+00018910: 7322 3a20 5b22 636f 6c30 222c 2022 636f  s": ["col0", "co
+00018920: 6c31 222c 2022 636f 6c32 225d 2c0a 2020  l1", "col2"],.  
+00018930: 2020 2020 2020 2264 6174 6574 696d 655f        "datetime_
+00018940: 6b65 7922 3a20 2263 6f6c 3022 0a20 2020  key": "col0".   
+00018950: 207d 0a20 2020 2071 7565 7279 203d 2062   }.    query = b
+00018960: 7569 6c64 5f71 7565 7279 286b 6579 732c  uild_query(keys,
+00018970: 206c 696d 6974 3d31 3029 0a20 2020 2065   limit=10).    e
+00018980: 7870 6563 7465 6420 3d20 280a 2020 2020  xpected = (.    
+00018990: 2020 2020 2253 454c 4543 5420 636f 6c30      "SELECT col0
+000189a0: 2c63 6f6c 312c 636f 6c32 2046 524f 4d20  ,col1,col2 FROM 
+000189b0: 7465 7374 2e74 6573 742e 7461 626c 6520  test.test.table 
+000189c0: 5748 4552 4520 313d 3122 202b 0a20 2020  WHERE 1=1" +.   
+000189d0: 2020 2020 2022 204f 5244 4552 2042 5920       " ORDER BY 
+000189e0: 636f 6c30 204c 494d 4954 2031 3022 290a  col0 LIMIT 10").
+000189f0: 2020 2020 6173 7365 7274 2071 7565 7279      assert query
+00018a00: 203d 3d20 6578 7065 6374 6564 0a0a 0a64   == expected...d
+00018a10: 6566 2074 6573 745f 6669 6c74 6572 7328  ef test_filters(
+00018a20: 293a 0a20 2020 206b 6579 7320 3d20 7b0a  ):.    keys = {.
+00018a30: 2020 2020 2020 2020 2274 6162 6c65 223a          "table":
+00018a40: 2022 7465 7374 2e74 6573 742e 7461 626c   "test.test.tabl
+00018a50: 6522 2c0a 2020 2020 2020 2020 2263 6f6c  e",.        "col
+00018a60: 756d 6e73 223a 205b 2263 6f6c 3022 2c20  umns": ["col0", 
+00018a70: 2263 6f6c 3122 2c20 2263 6f6c 3222 5d2c  "col1", "col2"],
+00018a80: 0a20 2020 2020 2020 2022 6461 7465 7469  .        "dateti
+00018a90: 6d65 5f6b 6579 223a 2022 6372 6561 7465  me_key": "create
+00018aa0: 645f 6174 220a 2020 2020 7d0a 2020 2020  d_at".    }.    
+00018ab0: 6669 6c74 6572 7320 3d20 5b22 4441 5445  filters = ["DATE
+00018ac0: 5f41 4444 2863 7265 6174 6564 5f61 742c  _ADD(created_at,
+00018ad0: 2049 4e54 4552 5641 4c20 2d37 2044 4159   INTERVAL -7 DAY
+00018ae0: 2922 2c0a 2020 2020 2020 2020 2020 2020  )",.            
+00018af0: 2020 2022 7374 6174 653d 2743 4127 225d     "state='CA'"]
+00018b00: 0a20 2020 2071 7565 7279 203d 2062 7569  .    query = bui
+00018b10: 6c64 5f71 7565 7279 286b 6579 732c 2066  ld_query(keys, f
+00018b20: 696c 7465 7273 3d66 696c 7465 7273 2c20  ilters=filters, 
+00018b30: 6c69 6d69 743d 3130 290a 2020 2020 6578  limit=10).    ex
+00018b40: 7065 6374 6564 203d 2028 0a20 2020 2020  pected = (.     
+00018b50: 2020 2022 5345 4c45 4354 2063 6f6c 302c     "SELECT col0,
+00018b60: 636f 6c31 2c63 6f6c 322c 6372 6561 7465  col1,col2,create
+00018b70: 645f 6174 2046 524f 4d20 7465 7374 2e74  d_at FROM test.t
+00018b80: 6573 742e 7461 626c 6522 202b 0a20 2020  est.table" +.   
+00018b90: 2020 2020 2022 2057 4845 5245 2031 3d31       " WHERE 1=1
+00018ba0: 2041 4e44 2044 4154 455f 4144 4428 6372   AND DATE_ADD(cr
+00018bb0: 6561 7465 645f 6174 2c20 494e 5445 5256  eated_at, INTERV
+00018bc0: 414c 202d 3720 4441 5929 2220 2b0a 2020  AL -7 DAY)" +.  
+00018bd0: 2020 2020 2020 2220 414e 4420 7374 6174        " AND stat
+00018be0: 653d 2743 4127 204f 5244 4552 2042 5920  e='CA' ORDER BY 
+00018bf0: 6372 6561 7465 645f 6174 204c 494d 4954  created_at LIMIT
+00018c00: 2031 3022 290a 2020 2020 6173 7365 7274   10").    assert
+00018c10: 2071 7565 7279 203d 3d20 6578 7065 6374   query == expect
+00018c20: 6564 0a00 0000 0000 0000 0000 0000 0000  ed..............
+00018c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018c60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018c80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018c90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018d00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018d20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018d40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018d50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018e00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018e10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018e20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00018e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00018e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00018e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00018e60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00018e70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00018e80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00018e90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
```

