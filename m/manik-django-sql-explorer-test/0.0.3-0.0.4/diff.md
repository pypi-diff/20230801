# Comparing `tmp/manik_django_sql_explorer_test-0.0.3-py3-none-any.whl.zip` & `tmp/manik_django_sql_explorer_test-0.0.4-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,28 +1,28 @@
-Zip file size: 123126 bytes, number of entries: 82
+Zip file size: 123523 bytes, number of entries: 82
 -rw-r--r--  2.0 unx      581 b- defN 23-Jul-21 11:15 explorer/__init__.py
 -rw-r--r--  2.0 unx      785 b- defN 23-Jul-22 07:25 explorer/__init__.pyc
 -rw-r--r--  2.0 unx     1632 b- defN 23-Jul-21 11:15 explorer/actions.py
 -rw-r--r--  2.0 unx     2540 b- defN 23-Jul-22 07:25 explorer/actions.pyc
 -rw-r--r--  2.0 unx      375 b- defN 23-Jul-21 11:15 explorer/admin.py
 -rw-r--r--  2.0 unx      750 b- defN 23-Jul-22 07:25 explorer/admin.pyc
 -rw-r--r--  2.0 unx     2380 b- defN 23-Jul-25 11:36 explorer/app_settings.py
 -rw-r--r--  2.0 unx     2541 b- defN 23-Jul-22 07:25 explorer/app_settings.pyc
--rw-r--r--  2.0 unx      389 b- defN 23-Jul-24 14:51 explorer/constants.py
+-rw-r--r--  2.0 unx      545 b- defN 23-Aug-01 06:16 explorer/constants.py
 -rw-r--r--  2.0 unx      388 b- defN 23-Jul-22 07:25 explorer/constants.pyc
 -rw-r--r--  2.0 unx     2054 b- defN 23-Jul-21 11:15 explorer/counter.py
 -rw-r--r--  2.0 unx     2039 b- defN 23-Jul-21 11:15 explorer/forms.py
 -rw-r--r--  2.0 unx     3028 b- defN 23-Jul-22 07:25 explorer/forms.pyc
--rw-r--r--  2.0 unx    14049 b- defN 23-Jul-25 12:17 explorer/models.py
+-rw-r--r--  2.0 unx    13485 b- defN 23-Aug-01 04:47 explorer/models.py
 -rw-r--r--  2.0 unx    17187 b- defN 23-Jul-22 07:25 explorer/models.pyc
 -rw-r--r--  2.0 unx     2233 b- defN 23-Jul-21 11:15 explorer/tasks.py
 -rw-r--r--  2.0 unx     3469 b- defN 23-Jul-22 07:25 explorer/tasks.pyc
 -rw-r--r--  2.0 unx     1265 b- defN 23-Jul-21 11:15 explorer/urls.py
 -rw-r--r--  2.0 unx     1401 b- defN 23-Jul-22 07:25 explorer/urls.pyc
--rw-r--r--  2.0 unx     9956 b- defN 23-Jul-25 12:17 explorer/utils.py
+-rw-r--r--  2.0 unx    11653 b- defN 23-Aug-01 06:21 explorer/utils.py
 -rw-r--r--  2.0 unx    12909 b- defN 23-Jul-22 07:25 explorer/utils.pyc
 -rw-r--r--  2.0 unx    15149 b- defN 23-Jul-21 11:15 explorer/views.py
 -rw-r--r--  2.0 unx    17344 b- defN 23-Jul-22 07:25 explorer/views.pyc
 -rw-r--r--  2.0 unx      628 b- defN 23-Jul-21 11:22 explorer/__pycache__/__init__.cpython-310.pyc
 -rw-r--r--  2.0 unx    15356 b- defN 23-Jul-21 11:43 explorer/__pycache__/models.cpython-310.pyc
 -rw-r--r--  2.0 unx    11231 b- defN 23-Jul-21 11:43 explorer/__pycache__/utils.cpython-310.pyc
 -rw-r--r--  2.0 unx     1909 b- defN 23-Jul-21 11:15 explorer/migrations/0001_initial.py
@@ -71,14 +71,14 @@
 -rw-r--r--  2.0 unx    19387 b- defN 23-Jul-21 11:15 explorer/tests/test_views.py
 -rw-r--r--  2.0 unx    26789 b- defN 23-Jul-22 15:43 explorer/tests/test_views.pyc
 -rw-r--r--  2.0 unx      222 b- defN 23-Jul-21 11:15 explorer/tests/urls.py
 -rw-r--r--  2.0 unx      461 b- defN 23-Jul-22 07:25 explorer/tests/urls.pyc
 -rw-r--r--  2.0 unx      928 b- defN 23-Jul-21 11:15 explorer/tests/utils.py
 -rw-r--r--  2.0 unx      169 b- defN 23-Jul-21 11:22 explorer/tests/__pycache__/__init__.cpython-310.pyc
 -rw-r--r--  2.0 unx     1473 b- defN 23-Jul-21 11:22 explorer/tests/__pycache__/settings.cpython-310.pyc
--rw-r--r--  2.0 unx      244 b- defN 23-Jul-25 12:18 manik_django_sql_explorer_test-0.0.3.dist-info/AUTHORS
--rw-r--r--  2.0 unx     1090 b- defN 23-Jul-25 12:18 manik_django_sql_explorer_test-0.0.3.dist-info/LICENSE
--rw-r--r--  2.0 unx    15994 b- defN 23-Jul-25 12:18 manik_django_sql_explorer_test-0.0.3.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 23-Jul-25 12:18 manik_django_sql_explorer_test-0.0.3.dist-info/WHEEL
--rw-r--r--  2.0 unx        9 b- defN 23-Jul-25 12:18 manik_django_sql_explorer_test-0.0.3.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx     7289 b- defN 23-Jul-25 12:18 manik_django_sql_explorer_test-0.0.3.dist-info/RECORD
-82 files, 318293 bytes uncompressed, 111484 bytes compressed:  65.0%
+-rw-r--r--  2.0 unx      244 b- defN 23-Aug-01 06:25 manik_django_sql_explorer_test-0.0.4.dist-info/AUTHORS
+-rw-r--r--  2.0 unx     1090 b- defN 23-Aug-01 06:25 manik_django_sql_explorer_test-0.0.4.dist-info/LICENSE
+-rw-r--r--  2.0 unx    15994 b- defN 23-Aug-01 06:25 manik_django_sql_explorer_test-0.0.4.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-Aug-01 06:25 manik_django_sql_explorer_test-0.0.4.dist-info/WHEEL
+-rw-r--r--  2.0 unx        9 b- defN 23-Aug-01 06:25 manik_django_sql_explorer_test-0.0.4.dist-info/top_level.txt
+?rw-rw-r--  2.0 unx     7290 b- defN 23-Aug-01 06:25 manik_django_sql_explorer_test-0.0.4.dist-info/RECORD
+82 files, 319583 bytes uncompressed, 111881 bytes compressed:  65.0%
```

## zipnote {}

```diff
@@ -222,26 +222,26 @@
 
 Filename: explorer/tests/__pycache__/__init__.cpython-310.pyc
 Comment: 
 
 Filename: explorer/tests/__pycache__/settings.cpython-310.pyc
 Comment: 
 
-Filename: manik_django_sql_explorer_test-0.0.3.dist-info/AUTHORS
+Filename: manik_django_sql_explorer_test-0.0.4.dist-info/AUTHORS
 Comment: 
 
-Filename: manik_django_sql_explorer_test-0.0.3.dist-info/LICENSE
+Filename: manik_django_sql_explorer_test-0.0.4.dist-info/LICENSE
 Comment: 
 
-Filename: manik_django_sql_explorer_test-0.0.3.dist-info/METADATA
+Filename: manik_django_sql_explorer_test-0.0.4.dist-info/METADATA
 Comment: 
 
-Filename: manik_django_sql_explorer_test-0.0.3.dist-info/WHEEL
+Filename: manik_django_sql_explorer_test-0.0.4.dist-info/WHEEL
 Comment: 
 
-Filename: manik_django_sql_explorer_test-0.0.3.dist-info/top_level.txt
+Filename: manik_django_sql_explorer_test-0.0.4.dist-info/top_level.txt
 Comment: 
 
-Filename: manik_django_sql_explorer_test-0.0.3.dist-info/RECORD
+Filename: manik_django_sql_explorer_test-0.0.4.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## explorer/constants.py

```diff
@@ -5,8 +5,11 @@
 
 TYPE_CODE_FOR_JSON = 3802
 TYPE_CODE_FOR_TEXT = 25
 TYPE_CODE_FOR_CHAR = 1043
 
 PLAYER_PHONE_NUMBER_MASKING_TYPE_CODES = [TYPE_CODE_FOR_CHAR]
 
-ALLOW_PHONE_NUMBER_MASKING_GROUP_ID = 10439
+ALLOW_PHONE_NUMBER_MASKING_GROUP_ID = 10439
+
+PATTERN_FOR_FINDING_PHONE_NUMBER = r"(?:\+?\d{1,3}|0)?([6-9]\d{9})\b"
+PATTERN_FOR_FINDING_EMAIL = r"\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Z|a-z]{2,7}\b"
```

## explorer/models.py

```diff
@@ -1,10 +1,10 @@
 from explorer.utils import passes_blacklist, swap_params, extract_params, shared_dict_update, get_connection, \
     get_s3_connection, get_connection_pii, get_connection_asyncapi_db, should_route_to_asyncapi_db, mask_string, \
-    is_pii_masked_for_user
+    is_pii_masked_for_user, mask_player_pii
 from future.utils import python_2_unicode_compatible
 from django.db import models, DatabaseError
 from time import time
 from django.core.urlresolvers import reverse
 from django.conf import settings
 from django.contrib import messages
 from django.contrib.messages import constants as messages_constants
@@ -175,44 +175,38 @@
 
         # Collect the indices for JSON and text columns
         for index, column in enumerate(self._description):
             if hasattr(column, "type_code") and column.type_code in type_code_and_column_indices_to_be_masked_dict:
                 type_code_and_column_indices_to_be_masked_dict[column.type_code].append(index)
 
             # Masking for player phone numbers
-            print("self.used_by_user", self.used_by_user)
-            print("is_pii_masked_for_user(self.used_by_user)", is_pii_masked_for_user(self.used_by_user))
-            print("hasattr(column, type_code)", hasattr(column, "type_code"))
-            print("column.type_code", column.type_code)
             if self.used_by_user and is_pii_masked_for_user(self.used_by_user) and hasattr(column, "type_code") and column.type_code in PLAYER_PHONE_NUMBER_MASKING_TYPE_CODES:
                 phone_number_masking_indexes.append(index)
 
         # Masking for PII data in char fields if specific tables are used in SQL
-        print("app_settings.TABLE_NAMES_FOR_PII_MASKING", app_settings.TABLE_NAMES_FOR_PII_MASKING)
-        print("phone_number_masking_indexes", phone_number_masking_indexes)
         if app_settings.TABLE_NAMES_FOR_PII_MASKING and phone_number_masking_indexes:
             for table_name in app_settings.TABLE_NAMES_FOR_PII_MASKING:
                 if table_name in self.sql:
                     type_code_and_column_indices_to_be_masked_dict[TYPE_CODE_FOR_CHAR] = phone_number_masking_indexes
                     break
-        print("type_code_and_column_indices_to_be_masked_dict", type_code_and_column_indices_to_be_masked_dict)
+
         return type_code_and_column_indices_to_be_masked_dict
 
     def get_masked_data(self, data, type_code):
         """
         Mask the data based on the type code.
         """
         if not data:
             return data
         if type_code == TYPE_CODE_FOR_JSON:
             return json.dumps(mask_string(str(data)))
         elif type_code == TYPE_CODE_FOR_TEXT:
             return mask_string(data)
         elif type_code in PLAYER_PHONE_NUMBER_MASKING_TYPE_CODES:
-            return mask_string(data)
+            return mask_player_pii(data)
         return data
 
     def mask_pii_data(self, row, type_code_and_column_indices_to_be_masked_dict):
         """
         Mask the JSON and TEXT data types in the row.
         """
         modified_row = list(row)
```

## explorer/utils.py

```diff
@@ -10,15 +10,16 @@
 from explorer import app_settings
 import string
 import re
 import functools
 import sys
 import logging
 
-from explorer.constants import PII_MASKING_PATTERN_REPLACEMENT_DICT, ALLOW_PHONE_NUMBER_MASKING_GROUP_ID
+from explorer.constants import PII_MASKING_PATTERN_REPLACEMENT_DICT, ALLOW_PHONE_NUMBER_MASKING_GROUP_ID, \
+    PATTERN_FOR_FINDING_EMAIL, PATTERN_FOR_FINDING_PHONE_NUMBER
 
 logger = logging.getLogger(__name__)
 
 
 PY3 = sys.version_info[0] == 3
 
 if PY3:
@@ -321,14 +322,65 @@
     """
 
     for pattern, replacement in PII_MASKING_PATTERN_REPLACEMENT_DICT.items():
         string_to_masked = re.sub(pattern, replacement, string_to_masked)
     return string_to_masked
 
 
+def get_masked_value(value: str):
+    """
+    This function will return the masked value depending upon the length of the value.
+    For eg.
+    1. value = None => masked_value = None
+    1. value = "son" => masked_value = "XXX"
+    2. value = "sunny" => masked_value = "sXXXy"
+    3. value = "my name is kunal" => masked_value = "myXXXXXXXXXXXal"
+    """
+
+    if not value:
+        return None
+
+    if len(value) <= 3:
+        return "".join("X" for _ in range(len(value)))
+    elif 4 <= len(value) <= 5:
+        return value[0] + "".join("X" for _ in range(len(value) - 2)) + value[-1]
+    else:
+        return value[:2] + "".join("X" for _ in range(len(value) - 2)) + value[-2:]
+
+
+def get_masked_email(email: str) -> str:
+    if not email or "@" not in email:
+        return email
+
+    local_part, domain_part = email.split("@")
+    masked_local_part = get_masked_value(local_part)
+    return masked_local_part + "@" + "".join("X" for _ in range(len(domain_part)))
+
+
+def get_masked_phone_number(phone_number: str) -> str:
+    if not phone_number or len(phone_number) < 10:
+        return phone_number
+
+    return "".join("X" for _ in range(len(phone_number) - 4)) + phone_number[-4:]
+
+
+def mask_player_pii(data: str) -> str:
+    if not data:
+        return data
+
+    matched_phone_numbers = re.findall(PATTERN_FOR_FINDING_PHONE_NUMBER, data)
+    for phone_number in matched_phone_numbers:
+        data = data.replace(phone_number, get_masked_phone_number(phone_number))
+
+    matched_emails = re.findall(PATTERN_FOR_FINDING_EMAIL, data)
+    for email in matched_emails:
+        data = data.replace(email, get_masked_email(email))
+
+    return data
+
+
 def is_pii_masked_for_user(user):
     """
     Check if the user has permission to view masked phone numbers
     """
-    if user:
-        user_group_ids = user.groups.all().values_list('id', flat=True)
-        return ALLOW_PHONE_NUMBER_MASKING_GROUP_ID not in user_group_ids
+    user_group_ids = user.groups.all().values_list('id', flat=True)
+    return ALLOW_PHONE_NUMBER_MASKING_GROUP_ID not in user_group_ids
```

## Comparing `manik_django_sql_explorer_test-0.0.3.dist-info/LICENSE` & `manik_django_sql_explorer_test-0.0.4.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `manik_django_sql_explorer_test-0.0.3.dist-info/METADATA` & `manik_django_sql_explorer_test-0.0.4.dist-info/METADATA`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: manik-django-sql-explorer-test
-Version: 0.0.3
+Version: 0.0.4
 Summary: A pluggable app that allows users (admins) to execute SQL, view, and export the results. Inspired by Stack Exchange Data Explorer.
 Home-page: https://github.com/epantry/django-sql-explorer
 Author: Chris Clark
 Author-email: chris@untrod.com
 License: MIT
 Keywords: django sql explorer reports reporting csv database query
 Classifier: Development Status :: 5 - Production/Stable
```

## Comparing `manik_django_sql_explorer_test-0.0.3.dist-info/RECORD` & `manik_django_sql_explorer_test-0.0.4.dist-info/RECORD`

 * *Files 9% similar despite different names*

```diff
@@ -2,26 +2,26 @@
 explorer/__init__.pyc,sha256=sLjuL5IG7OSxhjlotVhCxx24UmRhyFTZ2pBw8rCBZZQ,785
 explorer/actions.py,sha256=9HXZJasw4KInj2sJjFA1V2kr-x6TBQv8-LCgfz6AjbY,1632
 explorer/actions.pyc,sha256=vhSCCjSa4mEnvs0yV0TvdYEl5bEB1Vve7TJpp3lJZLY,2540
 explorer/admin.py,sha256=kxspF9IE1I-klJjonhNU8rIkR1N9qCU8faItUSUvyys,375
 explorer/admin.pyc,sha256=uQIW-5b63qw1Yh2lYJe7zlZS95WF7MtCyBU7zxyt-Sg,750
 explorer/app_settings.py,sha256=2i1CIZEc9V8PGqA39-3dG6bBkuHhWnUpu1JxoMUaND0,2380
 explorer/app_settings.pyc,sha256=teLeQqq4siDdHdY8nBbRUnf837D5j9T9tE5JZPixPco,2541
-explorer/constants.py,sha256=eRcgkLgZjvqf-4eukhB_uRWHZVV2cYazt7u4M95-pFc,389
+explorer/constants.py,sha256=9A5Y2r2vRTGWfyKHSzyGIUmSihEBuDVjGKBpWtZWJl0,545
 explorer/constants.pyc,sha256=vfNY1SSEdgvKnVh-OUbrwpD1GmdVkZOiy7nubrOgPwU,388
 explorer/counter.py,sha256=VHqsayUogidDwQ79PcRLox-vk8JfL8obQBlKeX3Bp-w,2054
 explorer/forms.py,sha256=vfmoyUxfueFTfk-4qP_aRiVUdCTY9sVka0tcY8x48BQ,2039
 explorer/forms.pyc,sha256=u0FrNKkUjiAqSZB_txRTGz93xHZIx8gcTSCVFc_RaxU,3028
-explorer/models.py,sha256=rM0MmRGZGoB67RClzZWR7oDlT_Q6f7qaqrWu_VJutqQ,14049
+explorer/models.py,sha256=NcVrGFcpBM78AZz9MAiH5yvP36Rn55Tx3dACf42JYQU,13485
 explorer/models.pyc,sha256=V--69kNjCT8GWanu2pKrO--fwN94vaDkT2eax0nlFAA,17187
 explorer/tasks.py,sha256=E9oASEaa1ujsCr7YDfCr6xfFWxftjtKO73EiColPeBk,2233
 explorer/tasks.pyc,sha256=b-LEa1DJu8RW93ZwtsHumrSlfAE05AO9xIVxqMtHxCQ,3469
 explorer/urls.py,sha256=uOcxG1clyuW7uGeqV1RFWmmkWG2gNXvb8-o_WjrgnAI,1265
 explorer/urls.pyc,sha256=l0Oa1kH5a7iUEdIOYEKmBoiTBZPnr_-EwJrWchP9q_Q,1401
-explorer/utils.py,sha256=sweDLgwgdkgsXnTMNDo7SLU_mxNsVKCNtSwNgy-WOXY,9956
+explorer/utils.py,sha256=xTeJNhpdGZzsJiYEHCfoNWTvlH4bJIeyJtEd0p6F8yU,11653
 explorer/utils.pyc,sha256=mdMyKEGr8G-EDIkPRteRaQlVoH0jb6rUSXgzm20W1Do,12909
 explorer/views.py,sha256=UZt0-VM770BfoT2usxYTGbFz5Pk6v_gt7JZRWQhtD8U,15149
 explorer/views.pyc,sha256=6IrMDm2uUCbFfB9do3To7h_Z8grsQo5_iWZAIBQmMjE,17344
 explorer/__pycache__/__init__.cpython-310.pyc,sha256=DGKJpIpMHLia0dQtOh8iGo3bbPkH1C2DP2Xj610ELUg,628
 explorer/__pycache__/models.cpython-310.pyc,sha256=21oi42_5jYiZhlMdarkh-zD4jr8WK_ZXcI467_VO-nk,15356
 explorer/__pycache__/utils.cpython-310.pyc,sha256=mGzMbo0qQR61h_sSK5zagw7IF1mlg570LYAMYyk2o2s,11231
 explorer/migrations/0001_initial.py,sha256=8ZTRFFkznebXTNIN4M3IHWHUwpMW0WS6tLHEfhUWfkw,1909
@@ -70,13 +70,13 @@
 explorer/tests/test_views.py,sha256=J_gapZu2A4AEJzjuuQfT_ey0zRe0vE_MNmIkFcYwo14,19387
 explorer/tests/test_views.pyc,sha256=O_-Q2tCZ8SIVaM_3Dz1Q_w-CFJm7y05vytBw_2lygaY,26789
 explorer/tests/urls.py,sha256=0rzxCRImd1IivOGwpOtNPI5Tnt-jiKp8hTTzxx4Qf34,222
 explorer/tests/urls.pyc,sha256=xLPEcO1jsVdozRZ0VKfGfgdiVbOOwkgYLXWcEs8AxNs,461
 explorer/tests/utils.py,sha256=1q4L4sHfxjXEv9LpTQWrJbV6TN_4FtExQDJt80Tdi0g,928
 explorer/tests/__pycache__/__init__.cpython-310.pyc,sha256=ebq1LVQxkJsUJF-zQGgAeWdJRu2DPMEnPZ5see7JMgA,169
 explorer/tests/__pycache__/settings.cpython-310.pyc,sha256=ugDmup2j_0p0AyU1yxhWEuqkq4Inlw_Z0vZ5_vf72sQ,1473
-manik_django_sql_explorer_test-0.0.3.dist-info/AUTHORS,sha256=-yOIuXJ7TC0-m-gAy0Gjc3ez1eK0a-o7u9B7WCgqB6Y,244
-manik_django_sql_explorer_test-0.0.3.dist-info/LICENSE,sha256=hyOjdzZR7ljYNZbISAWLjgNRz6_b3-5EQfz2hOsvg3g,1090
-manik_django_sql_explorer_test-0.0.3.dist-info/METADATA,sha256=gobZS1NBddNpgaZzQtLfj35OXhshUDEFvw5wvDCU9nU,15994
-manik_django_sql_explorer_test-0.0.3.dist-info/WHEEL,sha256=G16H4A3IeoQmnOrYV4ueZGKSjhipXx8zc8nu9FGlvMA,92
-manik_django_sql_explorer_test-0.0.3.dist-info/top_level.txt,sha256=HS5-rAbNJAJEVP0OygxhpNOCiXv092OahmzE5wX-k4s,9
-manik_django_sql_explorer_test-0.0.3.dist-info/RECORD,,
+manik_django_sql_explorer_test-0.0.4.dist-info/AUTHORS,sha256=-yOIuXJ7TC0-m-gAy0Gjc3ez1eK0a-o7u9B7WCgqB6Y,244
+manik_django_sql_explorer_test-0.0.4.dist-info/LICENSE,sha256=hyOjdzZR7ljYNZbISAWLjgNRz6_b3-5EQfz2hOsvg3g,1090
+manik_django_sql_explorer_test-0.0.4.dist-info/METADATA,sha256=Y2ZIuVPp9VKC2SqLJlmY8LhGcoJ-ctTu1k8V7c0Daho,15994
+manik_django_sql_explorer_test-0.0.4.dist-info/WHEEL,sha256=G16H4A3IeoQmnOrYV4ueZGKSjhipXx8zc8nu9FGlvMA,92
+manik_django_sql_explorer_test-0.0.4.dist-info/top_level.txt,sha256=HS5-rAbNJAJEVP0OygxhpNOCiXv092OahmzE5wX-k4s,9
+manik_django_sql_explorer_test-0.0.4.dist-info/RECORD,,
```

