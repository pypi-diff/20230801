# Comparing `tmp/tablite-2023.6.dev8-py3-none-any.whl.zip` & `tmp/tablite-2023.6.dev9-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,34 +1,34 @@
-Zip file size: 82024 bytes, number of entries: 32
--rw-r--r--  2.0 unx      244 b- defN 23-Jun-19 21:18 tablite/__init__.py
--rw-r--r--  2.0 unx    59673 b- defN 23-Jun-19 21:18 tablite/base.py
--rw-r--r--  2.0 unx     2781 b- defN 23-Jun-19 21:18 tablite/config.py
--rw-r--r--  2.0 unx    28614 b- defN 23-Jun-19 21:18 tablite/core.py
--rw-r--r--  2.0 unx     4781 b- defN 23-Jun-19 21:18 tablite/datasets.py
--rw-r--r--  2.0 unx    28840 b- defN 23-Jun-19 21:18 tablite/datatypes.py
--rw-r--r--  2.0 unx     2872 b- defN 23-Jun-19 21:18 tablite/diff.py
--rw-r--r--  2.0 unx     7822 b- defN 23-Jun-19 21:18 tablite/export_utils.py
--rw-r--r--  2.0 unx    10112 b- defN 23-Jun-19 21:18 tablite/file_reader_utils.py
--rw-r--r--  2.0 unx     4889 b- defN 23-Jun-19 21:18 tablite/groupby_utils.py
--rw-r--r--  2.0 unx     5627 b- defN 23-Jun-19 21:18 tablite/groupbys.py
--rw-r--r--  2.0 unx    22262 b- defN 23-Jun-19 21:18 tablite/import_utils.py
--rw-r--r--  2.0 unx     7666 b- defN 23-Jun-19 21:18 tablite/imputation.py
--rw-r--r--  2.0 unx    12059 b- defN 23-Jun-19 21:18 tablite/joins.py
--rw-r--r--  2.0 unx     6276 b- defN 23-Jun-19 21:18 tablite/lookup.py
--rw-r--r--  2.0 unx     3199 b- defN 23-Jun-19 21:18 tablite/mp_utils.py
--rw-r--r--  2.0 unx     8892 b- defN 23-Jun-19 21:18 tablite/pivots.py
--rw-r--r--  2.0 unx    10308 b- defN 23-Jun-19 21:18 tablite/redux.py
--rw-r--r--  2.0 unx     1521 b- defN 23-Jun-19 21:18 tablite/reindex.py
--rw-r--r--  2.0 unx     6884 b- defN 23-Jun-19 21:18 tablite/sort_utils.py
--rw-r--r--  2.0 unx     5411 b- defN 23-Jun-19 21:18 tablite/sortation.py
--rw-r--r--  2.0 unx     1125 b- defN 23-Jun-19 21:18 tablite/tools.py
--rw-r--r--  2.0 unx    11195 b- defN 23-Jun-19 21:18 tablite/utils.py
--rw-r--r--  2.0 unx      139 b- defN 23-Jun-19 21:18 tablite/version.py
--rw-r--r--  2.0 unx     1069 b- defN 23-Jun-19 21:18 tablite-2023.6.dev8.data/data/LICENSE
--rw-r--r--  2.0 unx     6960 b- defN 23-Jun-19 21:18 tablite-2023.6.dev8.data/data/README.md
--rw-r--r--  2.0 unx      246 b- defN 23-Jun-19 21:18 tablite-2023.6.dev8.data/data/requirements.txt
--rw-r--r--  2.0 unx     1069 b- defN 23-Jun-19 21:18 tablite-2023.6.dev8.dist-info/LICENSE
--rw-r--r--  2.0 unx     8677 b- defN 23-Jun-19 21:18 tablite-2023.6.dev8.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 23-Jun-19 21:18 tablite-2023.6.dev8.dist-info/WHEEL
--rw-r--r--  2.0 unx        8 b- defN 23-Jun-19 21:18 tablite-2023.6.dev8.dist-info/top_level.txt
--rw-rw-r--  2.0 unx     2533 b- defN 23-Jun-19 21:18 tablite-2023.6.dev8.dist-info/RECORD
-32 files, 273846 bytes uncompressed, 78044 bytes compressed:  71.5%
+Zip file size: 82191 bytes, number of entries: 32
+-rw-r--r--  2.0 unx      244 b- defN 23-Jun-22 15:36 tablite/__init__.py
+-rw-r--r--  2.0 unx    60579 b- defN 23-Jun-22 15:36 tablite/base.py
+-rw-r--r--  2.0 unx     2781 b- defN 23-Jun-22 15:36 tablite/config.py
+-rw-r--r--  2.0 unx    28631 b- defN 23-Jun-22 15:36 tablite/core.py
+-rw-r--r--  2.0 unx     4781 b- defN 23-Jun-22 15:36 tablite/datasets.py
+-rw-r--r--  2.0 unx    28840 b- defN 23-Jun-22 15:36 tablite/datatypes.py
+-rw-r--r--  2.0 unx     2872 b- defN 23-Jun-22 15:36 tablite/diff.py
+-rw-r--r--  2.0 unx     7822 b- defN 23-Jun-22 15:36 tablite/export_utils.py
+-rw-r--r--  2.0 unx    10112 b- defN 23-Jun-22 15:36 tablite/file_reader_utils.py
+-rw-r--r--  2.0 unx     4889 b- defN 23-Jun-22 15:36 tablite/groupby_utils.py
+-rw-r--r--  2.0 unx     5627 b- defN 23-Jun-22 15:36 tablite/groupbys.py
+-rw-r--r--  2.0 unx    22262 b- defN 23-Jun-22 15:36 tablite/import_utils.py
+-rw-r--r--  2.0 unx     7666 b- defN 23-Jun-22 15:36 tablite/imputation.py
+-rw-r--r--  2.0 unx    12059 b- defN 23-Jun-22 15:36 tablite/joins.py
+-rw-r--r--  2.0 unx     6276 b- defN 23-Jun-22 15:36 tablite/lookup.py
+-rw-r--r--  2.0 unx     3199 b- defN 23-Jun-22 15:36 tablite/mp_utils.py
+-rw-r--r--  2.0 unx     8892 b- defN 23-Jun-22 15:36 tablite/pivots.py
+-rw-r--r--  2.0 unx    10308 b- defN 23-Jun-22 15:36 tablite/redux.py
+-rw-r--r--  2.0 unx     1521 b- defN 23-Jun-22 15:36 tablite/reindex.py
+-rw-r--r--  2.0 unx     6884 b- defN 23-Jun-22 15:36 tablite/sort_utils.py
+-rw-r--r--  2.0 unx     5411 b- defN 23-Jun-22 15:36 tablite/sortation.py
+-rw-r--r--  2.0 unx     1125 b- defN 23-Jun-22 15:36 tablite/tools.py
+-rw-r--r--  2.0 unx    11195 b- defN 23-Jun-22 15:36 tablite/utils.py
+-rw-r--r--  2.0 unx      139 b- defN 23-Jun-22 15:36 tablite/version.py
+-rw-r--r--  2.0 unx     1069 b- defN 23-Jun-22 15:36 tablite-2023.6.dev9.data/data/LICENSE
+-rw-r--r--  2.0 unx     6960 b- defN 23-Jun-22 15:36 tablite-2023.6.dev9.data/data/README.md
+-rw-r--r--  2.0 unx      246 b- defN 23-Jun-22 15:36 tablite-2023.6.dev9.data/data/requirements.txt
+-rw-r--r--  2.0 unx     1069 b- defN 23-Jun-22 15:36 tablite-2023.6.dev9.dist-info/LICENSE
+-rw-r--r--  2.0 unx     8677 b- defN 23-Jun-22 15:36 tablite-2023.6.dev9.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-Jun-22 15:36 tablite-2023.6.dev9.dist-info/WHEEL
+-rw-r--r--  2.0 unx        8 b- defN 23-Jun-22 15:36 tablite-2023.6.dev9.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     2533 b- defN 23-Jun-22 15:36 tablite-2023.6.dev9.dist-info/RECORD
+32 files, 274769 bytes uncompressed, 78211 bytes compressed:  71.5%
```

## zipnote {}

```diff
@@ -66,32 +66,32 @@
 
 Filename: tablite/utils.py
 Comment: 
 
 Filename: tablite/version.py
 Comment: 
 
-Filename: tablite-2023.6.dev8.data/data/LICENSE
+Filename: tablite-2023.6.dev9.data/data/LICENSE
 Comment: 
 
-Filename: tablite-2023.6.dev8.data/data/README.md
+Filename: tablite-2023.6.dev9.data/data/README.md
 Comment: 
 
-Filename: tablite-2023.6.dev8.data/data/requirements.txt
+Filename: tablite-2023.6.dev9.data/data/requirements.txt
 Comment: 
 
-Filename: tablite-2023.6.dev8.dist-info/LICENSE
+Filename: tablite-2023.6.dev9.dist-info/LICENSE
 Comment: 
 
-Filename: tablite-2023.6.dev8.dist-info/METADATA
+Filename: tablite-2023.6.dev9.dist-info/METADATA
 Comment: 
 
-Filename: tablite-2023.6.dev8.dist-info/WHEEL
+Filename: tablite-2023.6.dev9.dist-info/WHEEL
 Comment: 
 
-Filename: tablite-2023.6.dev8.dist-info/top_level.txt
+Filename: tablite-2023.6.dev9.dist-info/top_level.txt
 Comment: 
 
-Filename: tablite-2023.6.dev8.dist-info/RECORD
+Filename: tablite-2023.6.dev9.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## tablite/base.py

```diff
@@ -185,15 +185,15 @@
         """resizes pages to Config.PAGE_SIZE"""
         new_pages = []
         start, end = 0, 0
         for _ in range(0, len(self) + 1, Config.PAGE_SIZE):
             start, end = end, end + Config.PAGE_SIZE
             array = self[slice(start, end, 1)]
 
-            np_dtype, py_dtype = pytype_from_iterable(array)
+            np_dtype, py_dtype = pytype_from_iterable(array.tolist())
             new = MetaArray(array, dtype=np_dtype, py_dtype=py_dtype)
 
             new_pages.append(Page(self.path, new))
         self.pages = new_pages
 
     def extend(self, value):  # USER FUNCTION.
         """extends the column.
@@ -806,15 +806,15 @@
         returns dtypes in the whole column
         """
         dtypes = set()
         for page in set(self.pages):
             dtypes.add(page.dtype if page.dtype is object else page.dtype.__name__)
             if len(dtypes) > 1:
                 return "mixed"
-            
+
         if len(dtypes) == 0:
             return "mixed"
 
         dtype = dtypes.pop()
         return "mixed" if dtype is object else dtype
 
     def index(self):
@@ -846,14 +846,16 @@
             try:  # when it works, numpy is fast...
                 arrays.append(np.unique(page.get()))
             except TypeError:  # ...but np.unique cannot handle Nones.
                 arrays.append(multitype_set(page.get()))
         union = np_type_unify(arrays)
         try:
             return np.unique(union)
+        except MemoryError:
+            return np.array(set(union))
         except TypeError:
             return multitype_set(union)
 
     def histogram(self):
         """
         returns 2 arrays: unique elements and count of each element
 
@@ -1689,29 +1691,53 @@
 
         Examples:
         >>> table6 = Table()
         >>> table6['A'] = ['Alice', 'Bob', 'Bob', 'Ben', 'Charlie', 'Ben','Albert']
         >>> table6['B'] = ['Alison', 'Marley', 'Dylan', 'Affleck', 'Hepburn', 'Barnes', 'Einstein']
 
         >>> table6.index('A')  # single key.
-        {('Alice',): {0},
-         ('Bob',): {1, 2},
-         ('Ben',): {3, 5},
-         ('Charlie',): {4},
-         ('Albert',): {6}})
+        {('Alice',): [0],
+         ('Bob',): [1, 2],
+         ('Ben',): [3, 5],
+         ('Charlie',): [4],
+         ('Albert',): [6]})
 
         >>> table6.index('A', 'B')  # multiple keys.
-        {('Alice', 'Alison'): {0},
-         ('Bob', 'Marley'): {1},
-         ('Bob', 'Dylan'): {2},
-         ('Ben', 'Affleck'): {3},
-         ('Charlie', 'Hepburn'): {4},
-         ('Ben', 'Barnes'): {5},
-         ('Albert', 'Einstein'): {6}})
+        {('Alice', 'Alison'): [0],
+         ('Bob', 'Marley'): [1],
+         ('Bob', 'Dylan'): [2],
+         ('Ben', 'Affleck'): [3],
+         ('Charlie', 'Hepburn'): [4],
+         ('Ben', 'Barnes'): [5],
+         ('Albert', 'Einstein'): [6]})
 
         """
         idx = defaultdict(list)
         iterators = [iter(self.columns[c]) for c in args]
         for ix, key in enumerate(zip(*iterators)):
             key = tuple(numpy_to_python(k) for k in key)
             idx[key].append(ix)
         return idx
+
+    def unique_index(self, *args, tqdm=_tqdm):
+        """generates the index of unique rows given a list of column names
+
+        Args:
+            *args (any): columns names
+            tqdm (tqdm, optional): Defaults to _tqdm.
+
+        Returns:
+            np.array(int64): indices of unique records.
+        """
+        if not args:
+            raise ValueError("*args (column names) is required")
+        seen = set()
+        unique = set()
+        iterators = [iter(self.columns[c]) for c in args]
+        for ix, key in tqdm(enumerate(zip(*iterators)), disable=Config.TQDM_DISABLE):
+            key_hash = hash(tuple(numpy_to_python(k) for k in key))
+            if key_hash in seen:
+                continue
+            else:
+                seen.add(key_hash)
+                unique.add(ix)
+        return np.array(sorted(unique))
```

## tablite/core.py

```diff
@@ -1,31 +1,30 @@
 import sys
 import logging
+import numpy as np
 from pathlib import Path
 
 from tqdm import tqdm as _tqdm
 
 from tablite.base import Table as BaseTable
 from tablite.base import Column  # noqa
 from tablite.utils import type_check
 from tablite import import_utils
 from tablite import export_utils
 from tablite import redux
+from tablite import reindex as _reindex
 from tablite import joins
 from tablite import lookup
 from tablite import sortation
 from tablite import groupbys
 from tablite import pivots
 from tablite import imputation
 from tablite import diff
 
 
-TIMEOUT_MS = 60 * 1000  # maximum msec tolerance waiting for OS to release hdf5 write lock
-
-
 logging.getLogger("lml").propagate = False
 logging.getLogger("pyexcel_io").propagate = False
 logging.getLogger("pyexcel").propagate = False
 
 log = logging.getLogger(__name__)
 
 
@@ -373,26 +372,28 @@
             result: ['b','d','f','h']
 
             Table:  ['a','b','c','d','e','f','g','h']
             index:  [0,2,4,6,1,3,5,7]
             result: ['a','c','e','g','b','d','f','h']
 
         """
-        return sortation.reindex(self, index)
+        if isinstance(index, list):
+            index = np.array(index)
+        return _reindex.reindex(self, index)
 
     def drop_duplicates(self, *args):
         """
         removes duplicate rows based on column names
 
         args: (optional) column_names
         if no args, all columns are used.
         """
         if not args:
             args = self.columns
-        index = [min(v) for v in self.index(*args).values()]
+        index = self.unique_index(*args)
         return self.reindex(index)
 
     def sort(self, mapping, sort_mode="excel", tqdm=_tqdm, pbar: _tqdm = None):
         """Perform multi-pass sorting with precedence given order of column names.
 
         Args:
             mapping (dict): keys as columns,
```

## tablite/version.py

```diff
@@ -1,3 +1,3 @@
-major, minor, patch = 2023, 6, "dev8"
+major, minor, patch = 2023, 6, "dev9"
 __version_info__ = (major, minor, patch)
 __version__ = ".".join(str(i) for i in __version_info__)
```

## Comparing `tablite-2023.6.dev8.data/data/LICENSE` & `tablite-2023.6.dev9.data/data/LICENSE`

 * *Files identical despite different names*

## Comparing `tablite-2023.6.dev8.data/data/README.md` & `tablite-2023.6.dev9.data/data/README.md`

 * *Files identical despite different names*

## Comparing `tablite-2023.6.dev8.dist-info/LICENSE` & `tablite-2023.6.dev9.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `tablite-2023.6.dev8.dist-info/METADATA` & `tablite-2023.6.dev9.dist-info/METADATA`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: tablite
-Version: 2023.6.dev8
+Version: 2023.6.dev9
 Summary: multiprocessing enabled out-of-memory data analysis library for tabular data.
 Home-page: https://github.com/root-11/tablite
 Author: https://github.com/root-11
 License: MIT
 Keywords: all,any,average,column,columns,count,csv,data imputation,date range,dict,excel,filter,first,from,from_pandas,groupby,guess,imputation,in-memory,index,indexing,inner join,is sorted,json,last,left join,list,list on disk,log,max,median,min,mode,numpy,ods,out-of-memory,outer join,pandas,pivot,pivot table,product,read csv,remove duplicates,replace,replace missing values,rows,show,sort,standard deviation,stored list,sum,table,tables,tablite,to,to_pandas,tools,transpose,txt,unique,use disk,xlsx,xround,zip
 Platform: any
 Classifier: Development Status :: 5 - Production/Stable
```

## Comparing `tablite-2023.6.dev8.dist-info/RECORD` & `tablite-2023.6.dev9.dist-info/RECORD`

 * *Files 11% similar despite different names*

```diff
@@ -1,11 +1,11 @@
 tablite/__init__.py,sha256=SH-lADLJJHz9XwBebXZMYNBsBneAGwSCXY5rJhYgrYg,244
-tablite/base.py,sha256=n1Y2xyt3n648TJYoqmKIdoJZfZlnhDdEl8apx3DoOvU,59673
+tablite/base.py,sha256=E5gsK1sdGSrZ7_fTZYaCJ-_YAh6z4rzGYGyWVzbc_ak,60579
 tablite/config.py,sha256=cgd9W89kJyud6nIKCUn-JSeL1z1diM4iVB6c3uTQbgs,2781
-tablite/core.py,sha256=NSX07t4zsTe7kVx8Pq1X72gXdSWBAG3d6pl3Ejhlgoo,28614
+tablite/core.py,sha256=gKGsk84Ih3olW38nONg0lKGUR9vRhxW6FaXXgDBwyzk,28631
 tablite/datasets.py,sha256=pRlucE6XUvRFkuEm9ITtgtCMjdzxcDnHjxXNc1Xc5Vc,4781
 tablite/datatypes.py,sha256=AgsBdcpYh2GT85s6igHQicvsm-RQRdumSi2R6H15m2c,28840
 tablite/diff.py,sha256=NuxQGJLtXEat4utd1gyRDZBucV33nsMZeP9T02Mmofc,2872
 tablite/export_utils.py,sha256=ylIgplaTJzWcSHhcOIQY1xV-C3ZniHZ607NK9ZinBwI,7822
 tablite/file_reader_utils.py,sha256=3a0XGUrmfM84BueFrP-wbTfL8_xpXmHp3RvknsYUf8k,10112
 tablite/groupby_utils.py,sha256=-GhV2q_4gFd7c1QKz0Oz6aiW5YLSMXXlIa_iNsJasBw,4889
 tablite/groupbys.py,sha256=wFnhcdjvzMkCAxFca1oVFk_adWzAnsVysQdu9MwZQHc,5627
@@ -17,16 +17,16 @@
 tablite/pivots.py,sha256=qJLVsXpw0Nw8p83NJvxl7-kVSZp_0HUlqWIa2IamQcU,8892
 tablite/redux.py,sha256=rKNKSXecLT5_buNwEz5G_SNJ3wPjXVQ4Aebf1WJ2d5A,10308
 tablite/reindex.py,sha256=lsSfk84XYQhmMxmUNovPWRmxtiaCC6Ue2CiEiju4qek,1521
 tablite/sort_utils.py,sha256=KevYkZlRq3nsSRDElG_chUm-t7dya2KOOzh0p-he0_4,6884
 tablite/sortation.py,sha256=CafBHU3emzG4m2azu_mny0-IHC6o_JkZoMx2ETmaMs4,5411
 tablite/tools.py,sha256=hEpqij7_2yc8yptUetk9Qjq1b7NxGoMamcCWOX3X010,1125
 tablite/utils.py,sha256=GXSuj7UfJzKa9a0t3FW5TnYacnvPD2_g1P-hDFP0ZWQ,11195
-tablite/version.py,sha256=IM7sbMk8gUSCmCQ4ZE1JlFtZqB_nrn6nMj5y-MJ8Fmc,139
-tablite-2023.6.dev8.data/data/LICENSE,sha256=DzHDlst_HKcG2siTMmSx3QBYn1DfYj8Thz7d189Hd_M,1069
-tablite-2023.6.dev8.data/data/README.md,sha256=TlGniuVuNAT76KFExrlEPDOiUDnrRb6Qa7aahNmxZ3Y,6960
-tablite-2023.6.dev8.data/data/requirements.txt,sha256=AGNyHRtmn33IBZb4LVH8kqvOsoQCbzZTM1F9-VBUxVI,246
-tablite-2023.6.dev8.dist-info/LICENSE,sha256=DzHDlst_HKcG2siTMmSx3QBYn1DfYj8Thz7d189Hd_M,1069
-tablite-2023.6.dev8.dist-info/METADATA,sha256=f8kBtXVNDo7yczLhz9MbzghbSN4qmVLNinPoYJDD9U4,8677
-tablite-2023.6.dev8.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
-tablite-2023.6.dev8.dist-info/top_level.txt,sha256=wLPhlgUC10JlueE5ZhtCVSrs2VnvMQgNlhdCNsxPXPg,8
-tablite-2023.6.dev8.dist-info/RECORD,,
+tablite/version.py,sha256=rM_WbVX7wgUuUoMSl-yMbux2llavzYjWUJDtRM8Snb4,139
+tablite-2023.6.dev9.data/data/LICENSE,sha256=DzHDlst_HKcG2siTMmSx3QBYn1DfYj8Thz7d189Hd_M,1069
+tablite-2023.6.dev9.data/data/README.md,sha256=TlGniuVuNAT76KFExrlEPDOiUDnrRb6Qa7aahNmxZ3Y,6960
+tablite-2023.6.dev9.data/data/requirements.txt,sha256=AGNyHRtmn33IBZb4LVH8kqvOsoQCbzZTM1F9-VBUxVI,246
+tablite-2023.6.dev9.dist-info/LICENSE,sha256=DzHDlst_HKcG2siTMmSx3QBYn1DfYj8Thz7d189Hd_M,1069
+tablite-2023.6.dev9.dist-info/METADATA,sha256=5NO7tLyQ76B1C2nOF0UrS9gj7CeCCHNvxdgegvAsfdY,8677
+tablite-2023.6.dev9.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
+tablite-2023.6.dev9.dist-info/top_level.txt,sha256=wLPhlgUC10JlueE5ZhtCVSrs2VnvMQgNlhdCNsxPXPg,8
+tablite-2023.6.dev9.dist-info/RECORD,,
```

