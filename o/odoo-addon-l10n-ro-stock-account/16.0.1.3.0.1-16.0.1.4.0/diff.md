# Comparing `tmp/odoo_addon_l10n_ro_stock_account-16.0.1.3.0.1-py3-none-any.whl.zip` & `tmp/odoo_addon_l10n_ro_stock_account-16.0.1.4.0-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,58 +1,58 @@
-Zip file size: 68886 bytes, number of entries: 56
--rw-r--r--  2.0 unx     3436 b- defN 23-Jul-30 04:04 odoo/addons/l10n_ro_stock_account/README.rst
--rw-r--r--  2.0 unx       79 b- defN 23-Jul-30 04:04 odoo/addons/l10n_ro_stock_account/__init__.py
--rw-r--r--  2.0 unx     1198 b- defN 23-Jul-30 04:04 odoo/addons/l10n_ro_stock_account/__manifest__.py
--rw-r--r--  2.0 unx    12467 b- defN 23-Jul-30 04:04 odoo/addons/l10n_ro_stock_account/init_hook.py
--rw-r--r--  2.0 unx    16253 b- defN 23-Jul-30 04:04 odoo/addons/l10n_ro_stock_account/i18n/l10n_ro_stock_account.pot
--rw-r--r--  2.0 unx    17334 b- defN 23-Jul-30 04:04 odoo/addons/l10n_ro_stock_account/i18n/ro.po
--rw-r--r--  2.0 unx      434 b- defN 23-Jul-30 04:04 odoo/addons/l10n_ro_stock_account/models/__init__.py
--rw-r--r--  2.0 unx      588 b- defN 23-Jul-30 04:04 odoo/addons/l10n_ro_stock_account/models/account_account.py
--rw-r--r--  2.0 unx     6119 b- defN 23-Jul-30 04:04 odoo/addons/l10n_ro_stock_account/models/account_move.py
--rw-r--r--  2.0 unx      419 b- defN 23-Jul-30 04:04 odoo/addons/l10n_ro_stock_account/models/l10n_ro_stock_valuation_layer_tracking.py
--rw-r--r--  2.0 unx     3176 b- defN 23-Jul-30 04:04 odoo/addons/l10n_ro_stock_account/models/product_category.py
--rw-r--r--  2.0 unx    16577 b- defN 23-Jul-30 04:04 odoo/addons/l10n_ro_stock_account/models/product_product.py
--rw-r--r--  2.0 unx     3103 b- defN 23-Jul-30 04:04 odoo/addons/l10n_ro_stock_account/models/product_template.py
--rw-r--r--  2.0 unx      655 b- defN 23-Jul-30 04:04 odoo/addons/l10n_ro_stock_account/models/res_company.py
--rw-r--r--  2.0 unx    10102 b- defN 23-Jul-30 04:04 odoo/addons/l10n_ro_stock_account/models/stock_landed_cost.py
--rw-r--r--  2.0 unx     1428 b- defN 23-Jul-30 04:04 odoo/addons/l10n_ro_stock_account/models/stock_location.py
--rw-r--r--  2.0 unx    34408 b- defN 23-Jul-30 04:04 odoo/addons/l10n_ro_stock_account/models/stock_move.py
--rw-r--r--  2.0 unx     1668 b- defN 23-Jul-30 04:04 odoo/addons/l10n_ro_stock_account/models/stock_move_line.py
--rw-r--r--  2.0 unx     1334 b- defN 23-Jul-30 04:04 odoo/addons/l10n_ro_stock_account/models/stock_picking.py
--rw-r--r--  2.0 unx     1108 b- defN 23-Jul-30 04:04 odoo/addons/l10n_ro_stock_account/models/stock_quant.py
--rw-r--r--  2.0 unx     8934 b- defN 23-Jul-30 04:04 odoo/addons/l10n_ro_stock_account/models/stock_valuation_layer.py
--rw-r--r--  2.0 unx      303 b- defN 23-Jul-30 04:04 odoo/addons/l10n_ro_stock_account/readme/CONTRIBUTORS.rst
--rw-r--r--  2.0 unx       95 b- defN 23-Jul-30 04:04 odoo/addons/l10n_ro_stock_account/readme/DESCRIPTION.rst
--rw-r--r--  2.0 unx      197 b- defN 23-Jul-30 04:04 odoo/addons/l10n_ro_stock_account/security/ir.model.access.csv
--rw-r--r--  2.0 unx      566 b- defN 23-Jul-30 04:04 odoo/addons/l10n_ro_stock_account/static/description/icon.png
--rw-r--r--  2.0 unx    12854 b- defN 23-Jul-30 04:04 odoo/addons/l10n_ro_stock_account/static/description/index.html
--rw-r--r--  2.0 unx      407 b- defN 23-Jul-30 04:04 odoo/addons/l10n_ro_stock_account/tests/__init__.py
--rw-r--r--  2.0 unx    23813 b- defN 23-Jul-30 04:04 odoo/addons/l10n_ro_stock_account/tests/common.py
--rw-r--r--  2.0 unx     4873 b- defN 23-Jul-30 04:04 odoo/addons/l10n_ro_stock_account/tests/common2.py
--rw-r--r--  2.0 unx     9814 b- defN 23-Jul-30 04:04 odoo/addons/l10n_ro_stock_account/tests/test_consum.py
--rw-r--r--  2.0 unx     2074 b- defN 23-Jul-30 04:04 odoo/addons/l10n_ro_stock_account/tests/test_inventory.py
--rw-r--r--  2.0 unx     3741 b- defN 23-Jul-30 04:04 odoo/addons/l10n_ro_stock_account/tests/test_po_landed_cost_sale.py
--rw-r--r--  2.0 unx     3729 b- defN 23-Jul-30 04:04 odoo/addons/l10n_ro_stock_account/tests/test_po_sale_landed_cost.py
--rw-r--r--  2.0 unx      760 b- defN 23-Jul-30 04:04 odoo/addons/l10n_ro_stock_account/tests/test_product.py
--rw-r--r--  2.0 unx     3745 b- defN 23-Jul-30 04:04 odoo/addons/l10n_ro_stock_account/tests/test_purchase.py
--rw-r--r--  2.0 unx     1932 b- defN 23-Jul-30 04:04 odoo/addons/l10n_ro_stock_account/tests/test_reception_return_not_fifo.py
--rw-r--r--  2.0 unx      515 b- defN 23-Jul-30 04:04 odoo/addons/l10n_ro_stock_account/tests/test_retur.py
--rw-r--r--  2.0 unx     5707 b- defN 23-Jul-30 04:04 odoo/addons/l10n_ro_stock_account/tests/test_sale.py
--rw-r--r--  2.0 unx     6495 b- defN 23-Jul-30 04:04 odoo/addons/l10n_ro_stock_account/tests/test_sale_return_not_fifo.py
--rw-r--r--  2.0 unx     5202 b- defN 23-Jul-30 04:04 odoo/addons/l10n_ro_stock_account/tests/test_svl_vacuum_location.py
--rw-r--r--  2.0 unx      675 b- defN 23-Jul-30 04:04 odoo/addons/l10n_ro_stock_account/views/account_account_view.xml
--rw-r--r--  2.0 unx     1403 b- defN 23-Jul-30 04:04 odoo/addons/l10n_ro_stock_account/views/product_category_view.xml
--rw-r--r--  2.0 unx      892 b- defN 23-Jul-30 04:04 odoo/addons/l10n_ro_stock_account/views/product_template_view.xml
--rw-r--r--  2.0 unx      922 b- defN 23-Jul-30 04:04 odoo/addons/l10n_ro_stock_account/views/stock_landed_cost_view.xml
--rw-r--r--  2.0 unx     1998 b- defN 23-Jul-30 04:04 odoo/addons/l10n_ro_stock_account/views/stock_location_view.xml
--rw-r--r--  2.0 unx     1989 b- defN 23-Jul-30 04:04 odoo/addons/l10n_ro_stock_account/views/stock_picking_view.xml
--rw-r--r--  2.0 unx     3778 b- defN 23-Jul-30 04:04 odoo/addons/l10n_ro_stock_account/views/stock_valuation_layer_views.xml
--rw-r--r--  2.0 unx       83 b- defN 23-Jul-30 04:04 odoo/addons/l10n_ro_stock_account/wizard/__init__.py
--rw-r--r--  2.0 unx     1316 b- defN 23-Jul-30 04:04 odoo/addons/l10n_ro_stock_account/wizard/stock_picking_return.py
--rw-r--r--  2.0 unx     1362 b- defN 23-Jul-30 04:04 odoo/addons/l10n_ro_stock_account/wizard/stock_picking_return_views.xml
--rw-r--r--  2.0 unx     1102 b- defN 23-Jul-30 04:04 odoo/addons/l10n_ro_stock_account/wizard/stock_valuation_layer_revaluation.py
--rw-r--r--  2.0 unx      936 b- defN 23-Jul-30 04:04 odoo/addons/l10n_ro_stock_account/wizard/stock_valuation_layer_revaluation_views.xml
--rw-r--r--  2.0 unx     4194 b- defN 23-Jul-30 04:04 odoo_addon_l10n_ro_stock_account-16.0.1.3.0.1.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 23-Jul-30 04:04 odoo_addon_l10n_ro_stock_account-16.0.1.3.0.1.dist-info/WHEEL
--rw-r--r--  2.0 unx        5 b- defN 23-Jul-30 04:04 odoo_addon_l10n_ro_stock_account-16.0.1.3.0.1.dist-info/top_level.txt
--rw-rw-r--  2.0 unx     6483 b- defN 23-Jul-30 04:04 odoo_addon_l10n_ro_stock_account-16.0.1.3.0.1.dist-info/RECORD
-56 files, 254872 bytes uncompressed, 57884 bytes compressed:  77.3%
+Zip file size: 68988 bytes, number of entries: 56
+-rw-r--r--  2.0 unx     3436 b- defN 23-Aug-01 06:21 odoo/addons/l10n_ro_stock_account/README.rst
+-rw-r--r--  2.0 unx       79 b- defN 23-Aug-01 06:21 odoo/addons/l10n_ro_stock_account/__init__.py
+-rw-r--r--  2.0 unx     1198 b- defN 23-Aug-01 06:22 odoo/addons/l10n_ro_stock_account/__manifest__.py
+-rw-r--r--  2.0 unx    12467 b- defN 23-Aug-01 06:21 odoo/addons/l10n_ro_stock_account/init_hook.py
+-rw-r--r--  2.0 unx    16253 b- defN 23-Aug-01 06:21 odoo/addons/l10n_ro_stock_account/i18n/l10n_ro_stock_account.pot
+-rw-r--r--  2.0 unx    17334 b- defN 23-Aug-01 06:21 odoo/addons/l10n_ro_stock_account/i18n/ro.po
+-rw-r--r--  2.0 unx      434 b- defN 23-Aug-01 06:21 odoo/addons/l10n_ro_stock_account/models/__init__.py
+-rw-r--r--  2.0 unx      588 b- defN 23-Aug-01 06:21 odoo/addons/l10n_ro_stock_account/models/account_account.py
+-rw-r--r--  2.0 unx     6119 b- defN 23-Aug-01 06:21 odoo/addons/l10n_ro_stock_account/models/account_move.py
+-rw-r--r--  2.0 unx      419 b- defN 23-Aug-01 06:21 odoo/addons/l10n_ro_stock_account/models/l10n_ro_stock_valuation_layer_tracking.py
+-rw-r--r--  2.0 unx     3176 b- defN 23-Aug-01 06:21 odoo/addons/l10n_ro_stock_account/models/product_category.py
+-rw-r--r--  2.0 unx    16819 b- defN 23-Aug-01 06:21 odoo/addons/l10n_ro_stock_account/models/product_product.py
+-rw-r--r--  2.0 unx     3103 b- defN 23-Aug-01 06:21 odoo/addons/l10n_ro_stock_account/models/product_template.py
+-rw-r--r--  2.0 unx      655 b- defN 23-Aug-01 06:21 odoo/addons/l10n_ro_stock_account/models/res_company.py
+-rw-r--r--  2.0 unx    10102 b- defN 23-Aug-01 06:21 odoo/addons/l10n_ro_stock_account/models/stock_landed_cost.py
+-rw-r--r--  2.0 unx     1428 b- defN 23-Aug-01 06:21 odoo/addons/l10n_ro_stock_account/models/stock_location.py
+-rw-r--r--  2.0 unx    34408 b- defN 23-Aug-01 06:21 odoo/addons/l10n_ro_stock_account/models/stock_move.py
+-rw-r--r--  2.0 unx     1668 b- defN 23-Aug-01 06:21 odoo/addons/l10n_ro_stock_account/models/stock_move_line.py
+-rw-r--r--  2.0 unx     1334 b- defN 23-Aug-01 06:21 odoo/addons/l10n_ro_stock_account/models/stock_picking.py
+-rw-r--r--  2.0 unx     1108 b- defN 23-Aug-01 06:21 odoo/addons/l10n_ro_stock_account/models/stock_quant.py
+-rw-r--r--  2.0 unx     8934 b- defN 23-Aug-01 06:21 odoo/addons/l10n_ro_stock_account/models/stock_valuation_layer.py
+-rw-r--r--  2.0 unx      303 b- defN 23-Aug-01 06:21 odoo/addons/l10n_ro_stock_account/readme/CONTRIBUTORS.rst
+-rw-r--r--  2.0 unx       95 b- defN 23-Aug-01 06:21 odoo/addons/l10n_ro_stock_account/readme/DESCRIPTION.rst
+-rw-r--r--  2.0 unx      197 b- defN 23-Aug-01 06:21 odoo/addons/l10n_ro_stock_account/security/ir.model.access.csv
+-rw-r--r--  2.0 unx      566 b- defN 23-Aug-01 06:21 odoo/addons/l10n_ro_stock_account/static/description/icon.png
+-rw-r--r--  2.0 unx    12854 b- defN 23-Aug-01 06:21 odoo/addons/l10n_ro_stock_account/static/description/index.html
+-rw-r--r--  2.0 unx      407 b- defN 23-Aug-01 06:21 odoo/addons/l10n_ro_stock_account/tests/__init__.py
+-rw-r--r--  2.0 unx    24382 b- defN 23-Aug-01 06:21 odoo/addons/l10n_ro_stock_account/tests/common.py
+-rw-r--r--  2.0 unx     4873 b- defN 23-Aug-01 06:21 odoo/addons/l10n_ro_stock_account/tests/common2.py
+-rw-r--r--  2.0 unx     9814 b- defN 23-Aug-01 06:21 odoo/addons/l10n_ro_stock_account/tests/test_consum.py
+-rw-r--r--  2.0 unx     2074 b- defN 23-Aug-01 06:21 odoo/addons/l10n_ro_stock_account/tests/test_inventory.py
+-rw-r--r--  2.0 unx     3741 b- defN 23-Aug-01 06:21 odoo/addons/l10n_ro_stock_account/tests/test_po_landed_cost_sale.py
+-rw-r--r--  2.0 unx     3729 b- defN 23-Aug-01 06:21 odoo/addons/l10n_ro_stock_account/tests/test_po_sale_landed_cost.py
+-rw-r--r--  2.0 unx      765 b- defN 23-Aug-01 06:21 odoo/addons/l10n_ro_stock_account/tests/test_product.py
+-rw-r--r--  2.0 unx     3745 b- defN 23-Aug-01 06:21 odoo/addons/l10n_ro_stock_account/tests/test_purchase.py
+-rw-r--r--  2.0 unx     1932 b- defN 23-Aug-01 06:21 odoo/addons/l10n_ro_stock_account/tests/test_reception_return_not_fifo.py
+-rw-r--r--  2.0 unx      515 b- defN 23-Aug-01 06:21 odoo/addons/l10n_ro_stock_account/tests/test_retur.py
+-rw-r--r--  2.0 unx     5707 b- defN 23-Aug-01 06:21 odoo/addons/l10n_ro_stock_account/tests/test_sale.py
+-rw-r--r--  2.0 unx     6604 b- defN 23-Aug-01 06:21 odoo/addons/l10n_ro_stock_account/tests/test_sale_return_not_fifo.py
+-rw-r--r--  2.0 unx     5202 b- defN 23-Aug-01 06:21 odoo/addons/l10n_ro_stock_account/tests/test_svl_vacuum_location.py
+-rw-r--r--  2.0 unx      675 b- defN 23-Aug-01 06:21 odoo/addons/l10n_ro_stock_account/views/account_account_view.xml
+-rw-r--r--  2.0 unx     1403 b- defN 23-Aug-01 06:21 odoo/addons/l10n_ro_stock_account/views/product_category_view.xml
+-rw-r--r--  2.0 unx      892 b- defN 23-Aug-01 06:21 odoo/addons/l10n_ro_stock_account/views/product_template_view.xml
+-rw-r--r--  2.0 unx      922 b- defN 23-Aug-01 06:21 odoo/addons/l10n_ro_stock_account/views/stock_landed_cost_view.xml
+-rw-r--r--  2.0 unx     1998 b- defN 23-Aug-01 06:21 odoo/addons/l10n_ro_stock_account/views/stock_location_view.xml
+-rw-r--r--  2.0 unx     1989 b- defN 23-Aug-01 06:21 odoo/addons/l10n_ro_stock_account/views/stock_picking_view.xml
+-rw-r--r--  2.0 unx     3778 b- defN 23-Aug-01 06:21 odoo/addons/l10n_ro_stock_account/views/stock_valuation_layer_views.xml
+-rw-r--r--  2.0 unx       83 b- defN 23-Aug-01 06:21 odoo/addons/l10n_ro_stock_account/wizard/__init__.py
+-rw-r--r--  2.0 unx     1316 b- defN 23-Aug-01 06:21 odoo/addons/l10n_ro_stock_account/wizard/stock_picking_return.py
+-rw-r--r--  2.0 unx     1362 b- defN 23-Aug-01 06:21 odoo/addons/l10n_ro_stock_account/wizard/stock_picking_return_views.xml
+-rw-r--r--  2.0 unx     1102 b- defN 23-Aug-01 06:21 odoo/addons/l10n_ro_stock_account/wizard/stock_valuation_layer_revaluation.py
+-rw-r--r--  2.0 unx      936 b- defN 23-Aug-01 06:21 odoo/addons/l10n_ro_stock_account/wizard/stock_valuation_layer_revaluation_views.xml
+-rw-r--r--  2.0 unx     4192 b- defN 23-Aug-01 06:22 odoo_addon_l10n_ro_stock_account-16.0.1.4.0.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-Aug-01 06:22 odoo_addon_l10n_ro_stock_account-16.0.1.4.0.dist-info/WHEEL
+-rw-r--r--  2.0 unx        5 b- defN 23-Aug-01 06:22 odoo_addon_l10n_ro_stock_account-16.0.1.4.0.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     6475 b- defN 23-Aug-01 06:22 odoo_addon_l10n_ro_stock_account-16.0.1.4.0.dist-info/RECORD
+56 files, 255787 bytes uncompressed, 58002 bytes compressed:  77.3%
```

## zipnote {}

```diff
@@ -150,20 +150,20 @@
 
 Filename: odoo/addons/l10n_ro_stock_account/wizard/stock_valuation_layer_revaluation.py
 Comment: 
 
 Filename: odoo/addons/l10n_ro_stock_account/wizard/stock_valuation_layer_revaluation_views.xml
 Comment: 
 
-Filename: odoo_addon_l10n_ro_stock_account-16.0.1.3.0.1.dist-info/METADATA
+Filename: odoo_addon_l10n_ro_stock_account-16.0.1.4.0.dist-info/METADATA
 Comment: 
 
-Filename: odoo_addon_l10n_ro_stock_account-16.0.1.3.0.1.dist-info/WHEEL
+Filename: odoo_addon_l10n_ro_stock_account-16.0.1.4.0.dist-info/WHEEL
 Comment: 
 
-Filename: odoo_addon_l10n_ro_stock_account-16.0.1.3.0.1.dist-info/top_level.txt
+Filename: odoo_addon_l10n_ro_stock_account-16.0.1.4.0.dist-info/top_level.txt
 Comment: 
 
-Filename: odoo_addon_l10n_ro_stock_account-16.0.1.3.0.1.dist-info/RECORD
+Filename: odoo_addon_l10n_ro_stock_account-16.0.1.4.0.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## odoo/addons/l10n_ro_stock_account/__manifest__.py

```diff
@@ -1,11 +1,11 @@
 # License AGPL-3.0 or later (http://www.gnu.org/licenses/agpl.html).
 {
     "name": "Romania - Stock Accounting",
-    "version": "16.0.1.3.0",
+    "version": "16.0.1.4.0",
     "category": "Localization",
     "summary": "Romania - Stock Accounting",
     "author": "NextERP Romania,"
     "Dorin Hongu,"
     "Forest and Biomass Romania,"
     "Odoo Community Association (OCA)",
     "website": "https://github.com/OCA/l10n-romania",
```

## odoo/addons/l10n_ro_stock_account/models/product_product.py

```diff
@@ -96,15 +96,17 @@
                 vals = vals_tpl.copy()
                 vals["quantity"] = fifo_vals.get("quantity", 0)
                 vals["value"] = fifo_vals.get("value", 0)
                 vals["remaining_qty"] = fifo_vals.get("remaining_qty", 0)
                 vals["l10n_ro_tracking"] = fifo_vals.get("l10n_ro_tracking")
 
                 # In case of AVCO, fix rounding issue of standard price when needed.
-                if self.cost_method == "average":
+                if self.cost_method == "average" and not self.env.context.get(
+                    "origin_return_candidates"
+                ):
                     vals["value"] = currency.round(
                         vals["quantity"] * self.standard_price
                     )
                     rounding_error = currency.round(
                         self.standard_price * self.quantity_svl - self.value_svl
                     )
                     if rounding_error:
@@ -122,15 +124,19 @@
                                 "+" if rounding_error > 0 else "",
                                 float_repr(
                                     rounding_error,
                                     precision_digits=currency.decimal_places,
                                 ),
                                 currency.symbol,
                             )
-                if self.cost_method == "fifo":
+
+                if self.cost_method == "fifo" or (
+                    self.cost_method == "average"
+                    and self.env.context.get("origin_return_candidates")
+                ):
                     vals.update(fifo_vals)
                 vals_list.append(vals)
         else:
             vals_list = [vals_tpl]
         return vals_list
 
     def _l10n_ro_prepare_domain_fifo(self, company, domain=None):
```

## odoo/addons/l10n_ro_stock_account/tests/common.py

```diff
@@ -105,23 +105,40 @@
             "property_stock_account_input_categ_id": cls.account_valuation.id,
             "property_stock_account_output_categ_id": cls.account_valuation.id,
             "property_stock_valuation_account_id": cls.account_valuation.id,
             "property_stock_journal": stock_journal.id,
             "l10n_ro_stock_account_change": True,
         }
 
-        cls.category = cls.env["product.category"].search(
+        cls.category_fifo = cls.env["product.category"].search(
             [("name", "=", "TEST Marfa")], limit=1
         )
-        if not cls.category:
-            cls.category = cls.env["product.category"].create(category_value)
+        if not cls.category_fifo:
+            cls.category_fifo = cls.env["product.category"].create(category_value)
         else:
-            cls.category.write(category_value)
+            cls.category_fifo.write(category_value)
 
-        cls.category_mp = cls.category.copy(
+        cls.category = cls.category_fifo
+
+        category_value.update(
+            {
+                "name": "TEST Marfa ",
+                "property_cost_method": "average",
+            }
+        )
+
+        cls.category_average = cls.env["product.category"].search(
+            [("name", "=", "TEST Marfa Average")], limit=1
+        )
+        if not cls.category_average:
+            cls.category_average = cls.env["product.category"].create(category_value)
+        else:
+            cls.category_average.write(category_value)
+
+        cls.category_mp = cls.category_fifo.copy(
             {
                 "property_account_expense_categ_id": cls.account_expense_mp.id,
                 "property_stock_account_input_categ_id": cls.account_valuation_mp.id,
                 "property_stock_account_output_categ_id": cls.account_valuation_mp.id,
                 "property_stock_valuation_account_id": cls.account_valuation_mp.id,
             }
         )
@@ -131,27 +148,27 @@
         cls.list_price_p1 = 70.0
         cls.list_price_p2 = 70.0
 
         cls.product_1 = cls.env["product.product"].create(
             {
                 "name": "Product A",
                 "type": "product",
-                "categ_id": cls.category.id,
+                "categ_id": cls.category_fifo.id,
                 "invoice_policy": "delivery",
                 "purchase_method": "receive",
                 "list_price": cls.list_price_p1,
                 "standard_price": cls.price_p1,
             }
         )
         cls.product_2 = cls.env["product.product"].create(
             {
                 "name": "Product B",
                 "type": "product",
                 "purchase_method": "receive",
-                "categ_id": cls.category.id,
+                "categ_id": cls.category_average.id,
                 "invoice_policy": "delivery",
                 "list_price": cls.list_price_p2,
                 "standard_price": cls.price_p2,
             }
         )
 
         cls.product_mp = cls.env["product.product"].create(
```

## odoo/addons/l10n_ro_stock_account/tests/test_product.py

```diff
@@ -10,15 +10,15 @@
 _logger = logging.getLogger(__name__)
 
 
 @tagged("post_install", "-at_install")
 class TestProductCategory(TestStockCommon):
     def test_product_category(self):
 
-        category = Form(self.category.copy())
+        category = Form(self.category_fifo.copy())
         category.property_stock_valuation_account_id = self.account_valuation_mp
 
         category = category.save()
 
         self.assertEqual(
             category.property_stock_account_output_categ_id, self.account_valuation_mp
         )
```

## odoo/addons/l10n_ro_stock_account/tests/test_sale_return_not_fifo.py

```diff
@@ -81,15 +81,15 @@
         retur2
          -retur	        1	    75	    75	    1550
 
 
         """
 
         self.qty_po_p1 = 5.0
-        self.qty_po_p2 = 10.0
+        self.qty_po_p2 = 5.0
 
         self.price_p1 = 50.0
         self.price_p2 = 50.0
         self.make_purchase()
 
         stock_value_final_p1 = round(self.qty_po_p1 * self.price_p1, 2)
         stock_value_final_p2 = round(self.qty_po_p2 * self.price_p2, 2)
@@ -106,34 +106,36 @@
         self.qty_so_p2 = 15.0
 
         # iesire din stoc prin vanzare
         self.create_so()
 
         # valoarea de stoc dupa vanzarea produselor
         stock_value_final_p1 -= round(5 * 50 + 10 * 75, 2)
-        stock_value_final_p2 -= round(10 * 50 + 5 * 75, 2)
+
+        price_p2 = (5 * 50 + 20 * 75) / (5 + 20)
+        stock_value_final_p2 -= round(15 * price_p2, 2)
 
         self.check_stock_valuation(stock_value_final_p1, stock_value_final_p2)
         self.check_account_valuation(stock_value_final_p1, stock_value_final_p2)
 
         pick = self.so.picking_ids
         self.make_return(pick, 7.0)
 
         self.create_sale_invoice()
 
         stock_value_final_p1 += round(5 * 50 + 2 * 75, 2)
-        stock_value_final_p2 += round(7 * 50, 2)
+        stock_value_final_p2 += round(7 * price_p2, 2)
 
         self.check_stock_valuation(stock_value_final_p1, stock_value_final_p2)
         self.check_account_valuation(stock_value_final_p1, stock_value_final_p2)
 
         self.make_return(pick, 1)
 
         stock_value_final_p1 += round(75, 2)
-        stock_value_final_p2 += round(50, 2)
+        stock_value_final_p2 += round(price_p2, 2)
 
         self.check_stock_valuation(stock_value_final_p1, stock_value_final_p2)
         self.check_account_valuation(stock_value_final_p1, stock_value_final_p2)
 
     def test_not_fifo_return3(self):
         """
         Test FIFO valuation method for stock accounting in case of return from sale
@@ -171,14 +173,15 @@
         self.make_purchase()
         stock_value_final_p1 += round(self.qty_po_p1 * self.price_p1, 2)
         stock_value_final_p2 += round(self.qty_po_p2 * self.price_p2, 2)
 
         self.qty_so_p1 = 5.0
         self.qty_so_p2 = 5.0
 
+        price_p2 = (2 * 3 + 3 * 4) / (2 + 3)
         # iesire din stoc prin vanzare
         self.create_so()
 
         # valoarea de stoc dupa vanzarea produselor
         stock_value_final_p1 = 0.0
         stock_value_final_p2 = 0.0
 
@@ -187,19 +190,19 @@
 
         pick = self.so.picking_ids
         self.make_return(pick, 3)
 
         self.create_sale_invoice()
 
         stock_value_final_p1 += round(2 * 3 + 1 * 4, 2)
-        stock_value_final_p2 += round(2 * 3 + 1 * 4, 2)
+        stock_value_final_p2 += round(3 * price_p2, 2)
 
         self.check_stock_valuation(stock_value_final_p1, stock_value_final_p2)
         self.check_account_valuation(stock_value_final_p1, stock_value_final_p2)
 
         self.make_return(pick, 1)
 
         stock_value_final_p1 += round(4, 2)
-        stock_value_final_p2 += round(4, 2)
+        stock_value_final_p2 += round(price_p2, 2)
 
         self.check_stock_valuation(stock_value_final_p1, stock_value_final_p2)
         self.check_account_valuation(stock_value_final_p1, stock_value_final_p2)
```

## Comparing `odoo_addon_l10n_ro_stock_account-16.0.1.3.0.1.dist-info/METADATA` & `odoo_addon_l10n_ro_stock_account-16.0.1.4.0.dist-info/METADATA`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: odoo-addon-l10n-ro-stock-account
-Version: 16.0.1.3.0.1
+Version: 16.0.1.4.0
 Summary: Romania - Stock Accounting
 Home-page: https://github.com/OCA/l10n-romania
 Author: NextERP Romania,Dorin Hongu,Forest and Biomass Romania,Odoo Community Association (OCA)
 Author-email: support@odoo-community.org
 License: AGPL-3
 Platform: UNKNOWN
 Classifier: Programming Language :: Python
```

## Comparing `odoo_addon_l10n_ro_stock_account-16.0.1.3.0.1.dist-info/RECORD` & `odoo_addon_l10n_ro_stock_account-16.0.1.4.0.dist-info/RECORD`

 * *Files 2% similar despite different names*

```diff
@@ -1,19 +1,19 @@
 odoo/addons/l10n_ro_stock_account/README.rst,sha256=VaVE274MyzphetZRCuPHVsMLWyolDgBHyPQwT87Jb8s,3436
 odoo/addons/l10n_ro_stock_account/__init__.py,sha256=PacuDFh1zPYOcR8_TpqCbSm2lburCBebCib46Rga4LY,79
-odoo/addons/l10n_ro_stock_account/__manifest__.py,sha256=xLHSJoBYVAd80rUCHgVc-Tt2y7bYhD0YMeaLdNnJzh4,1198
+odoo/addons/l10n_ro_stock_account/__manifest__.py,sha256=TQzHXxe2yZgkRvLt8nkn--wX21wzBLzbOr5Uos7THsk,1198
 odoo/addons/l10n_ro_stock_account/init_hook.py,sha256=ALTW5wQKBLJr82YYMpSgX51t2N5fb_RTWttPNOEdKt8,12467
 odoo/addons/l10n_ro_stock_account/i18n/l10n_ro_stock_account.pot,sha256=7ArJ9tHp5m5MeEnY3EOGUuFr-m07-JZ-OzrmXh8cv9s,16253
 odoo/addons/l10n_ro_stock_account/i18n/ro.po,sha256=zB6d0oGnyzEP7lv4Y-CgS7MkzmQCR9nWvGVfI1GCA4g,17334
 odoo/addons/l10n_ro_stock_account/models/__init__.py,sha256=GV7G2YF21G_xjW7QmrViek6VP-bpFPv8FXB5EFvzoFQ,434
 odoo/addons/l10n_ro_stock_account/models/account_account.py,sha256=VWfu4nKGYWPIdk-N-Sf-mNJwdGNdLCrkTLMHSp5V_MA,588
 odoo/addons/l10n_ro_stock_account/models/account_move.py,sha256=G6W90kcfGyT9-jGKvjXNCq99UflXwI63iip2COaYftw,6119
 odoo/addons/l10n_ro_stock_account/models/l10n_ro_stock_valuation_layer_tracking.py,sha256=uCieonqwP4C2kEM0I2M7il96Y_vstmXzUn4W0zc9cuo,419
 odoo/addons/l10n_ro_stock_account/models/product_category.py,sha256=96rcY4AMPHB4lax0iXsxgbCo9Yifrp0xX8eT3D40B0I,3176
-odoo/addons/l10n_ro_stock_account/models/product_product.py,sha256=581BP63B8F9Q9TG5MdNw-qDnblRIxn8lnIijTEKitXg,16577
+odoo/addons/l10n_ro_stock_account/models/product_product.py,sha256=r3qDGDfPBKtQEhslPq7sIYsZ2Zb7tCuTtd4o9BnPMtk,16819
 odoo/addons/l10n_ro_stock_account/models/product_template.py,sha256=ou3I7vS4gMpSUeB3irVUgyB11YDGrD5fkw1XM8u4sWw,3103
 odoo/addons/l10n_ro_stock_account/models/res_company.py,sha256=N96-mE6HqZ-nM027UBNbTmxzxxf9rsOsrudv-_lQ7RA,655
 odoo/addons/l10n_ro_stock_account/models/stock_landed_cost.py,sha256=tMnuufgYOBks7RnX0Y9RUoZ6UqXcQJQWh9D5YFEWwIM,10102
 odoo/addons/l10n_ro_stock_account/models/stock_location.py,sha256=ufg27uLVP3UxfKmTyHx5vixp5UQSjwGDevxOhyhY5Z8,1428
 odoo/addons/l10n_ro_stock_account/models/stock_move.py,sha256=3P-34UjnZOLzuQ5Xqy6f0durg9VRgBIPfVZLKNP_J5g,34408
 odoo/addons/l10n_ro_stock_account/models/stock_move_line.py,sha256=ZtBZOrOS5V9qlGJksTTAdPalZ70naOINyU5NOrDj0WQ,1668
 odoo/addons/l10n_ro_stock_account/models/stock_picking.py,sha256=OGNWrnoHDCklDXt5vDzvRCNq-WuKvDQvZIR-oOQSsvI,1334
@@ -21,36 +21,36 @@
 odoo/addons/l10n_ro_stock_account/models/stock_valuation_layer.py,sha256=CgIV75Ovp1_zlafMf-l9cHoKDzFSEl2HI83sg7hUHMQ,8934
 odoo/addons/l10n_ro_stock_account/readme/CONTRIBUTORS.rst,sha256=HYRMiA7qtJA4RIxiyWWIOwbHg8XNaV0ltNZqeCbL1dE,303
 odoo/addons/l10n_ro_stock_account/readme/DESCRIPTION.rst,sha256=IGaYSYZzlaVso6xah4LBOiTvBs5xwi86-abmjCMPV50,95
 odoo/addons/l10n_ro_stock_account/security/ir.model.access.csv,sha256=T0dM-gb3TZsHQjiBa-WgJbrY7Iw597P9eWU6ElDQdNo,197
 odoo/addons/l10n_ro_stock_account/static/description/icon.png,sha256=MND3TYqrnM623pd0tf3WhoHU-3X5Ns6ho-Yz_HcYlTk,566
 odoo/addons/l10n_ro_stock_account/static/description/index.html,sha256=UU8vMOY1T6fEJkNuUCpXXS8vCGbvoQaGBl8_Zm5tgUo,12854
 odoo/addons/l10n_ro_stock_account/tests/__init__.py,sha256=rO3lnrbDTQYsF830mLICgq9HIj2MsTwPi9T6QN6q338,407
-odoo/addons/l10n_ro_stock_account/tests/common.py,sha256=BWJEz7KPcb1hNo8sqFx5EAqz9VcQ4AxUWBJIVVfxxm0,23813
+odoo/addons/l10n_ro_stock_account/tests/common.py,sha256=DkCWebfWs4QTsVHUdylnLkyEyn-XACQWJ-fDDhJhprE,24382
 odoo/addons/l10n_ro_stock_account/tests/common2.py,sha256=RnbZEw26qDbRV3L_nB0OjsxswTiAldxmGzFG7zAZB9E,4873
 odoo/addons/l10n_ro_stock_account/tests/test_consum.py,sha256=C_zWKivusB1oph_FRhyutDtqtoqjPLBFYE-WKh_mjmY,9814
 odoo/addons/l10n_ro_stock_account/tests/test_inventory.py,sha256=y0j_n9VYi5O5zICDo_QxPunhO_xzpyXFLQ87dS_AZ8g,2074
 odoo/addons/l10n_ro_stock_account/tests/test_po_landed_cost_sale.py,sha256=MHaCk2wTmOIyhMrxXc1XmdheQmYAqXCNIaRwEk82CCY,3741
 odoo/addons/l10n_ro_stock_account/tests/test_po_sale_landed_cost.py,sha256=5kOzlEXZFfjoso_Xjr_D7EqyvwWYWNnGkbB5hjcVyRo,3729
-odoo/addons/l10n_ro_stock_account/tests/test_product.py,sha256=zhA9HlCODIuZpHj7psijmzIliLVgytNxw3RsKkQ3E14,760
+odoo/addons/l10n_ro_stock_account/tests/test_product.py,sha256=w1nKstbQ5qX_H8X4AvXT9Py4hdSrG0lsj5xxJA-laeY,765
 odoo/addons/l10n_ro_stock_account/tests/test_purchase.py,sha256=cCdr5pRS8Hiquo5q7qQ-A_X29cVuSRTSqysC4Hg42pE,3745
 odoo/addons/l10n_ro_stock_account/tests/test_reception_return_not_fifo.py,sha256=_x9emMEa14qIYsC3KPIgehLe_Jn8J88mFDfcxhXMl8k,1932
 odoo/addons/l10n_ro_stock_account/tests/test_retur.py,sha256=gvFJaTQc9-eCv6piYrLYn__jzrljGUMA7hXGEPGlMPQ,515
 odoo/addons/l10n_ro_stock_account/tests/test_sale.py,sha256=sq9MJO4ExfM8W4HJMJDVNrwlnex19UcQns7AWuPvN6M,5707
-odoo/addons/l10n_ro_stock_account/tests/test_sale_return_not_fifo.py,sha256=WTdj5FLYb2o2j73OQYbLxiuSZgAdHhTR0PR3CRPA3PY,6495
+odoo/addons/l10n_ro_stock_account/tests/test_sale_return_not_fifo.py,sha256=WC2rFyAYcrIJ2Lc3Kx3sGFgZhtXSZ361k-g9gRxgwRM,6604
 odoo/addons/l10n_ro_stock_account/tests/test_svl_vacuum_location.py,sha256=ILoV7dvIk6ysz3yThXCe4KZTazW_fCrVc82skMzA2bw,5202
 odoo/addons/l10n_ro_stock_account/views/account_account_view.xml,sha256=9ox9pIDx02DKpBYC1kpvkMPV-2qRIemsT_aUQgUJWpw,675
 odoo/addons/l10n_ro_stock_account/views/product_category_view.xml,sha256=dHxapD6dz-0u3-tHaXPDp6ms1ILLgye-jVeRwwKAy_Q,1403
 odoo/addons/l10n_ro_stock_account/views/product_template_view.xml,sha256=o0MJ_XESfIf3tBqQJdbVzoWbqRG5Jsz8vSqDlVfPuq0,892
 odoo/addons/l10n_ro_stock_account/views/stock_landed_cost_view.xml,sha256=I86yEy25teqD61V4ra4FVeLzRno3Zm-wlSJSw9JjAgQ,922
 odoo/addons/l10n_ro_stock_account/views/stock_location_view.xml,sha256=ZpCEvKk7v8liHv4rH29cNLQTRuUMtphS6bqKSHtHZf8,1998
 odoo/addons/l10n_ro_stock_account/views/stock_picking_view.xml,sha256=hGR6lyA7UMbWbH_rWMmkkT6zOYbP1KJxez13i0Ajppw,1989
 odoo/addons/l10n_ro_stock_account/views/stock_valuation_layer_views.xml,sha256=vqQUarM29ms1gFNUevxN7JmWVn9fpiHQvDOol_YldjE,3778
 odoo/addons/l10n_ro_stock_account/wizard/__init__.py,sha256=eIqrPGDGbKIxnJ5ebAsp5fwAQ6LsOh0Z6Dw1z1qERSw,83
 odoo/addons/l10n_ro_stock_account/wizard/stock_picking_return.py,sha256=NLkH1KxO9jv0HC2YbFH02JmRe2IJy8n-ZWESDdTP9pA,1316
 odoo/addons/l10n_ro_stock_account/wizard/stock_picking_return_views.xml,sha256=I9BSaRGK8-xbZZTPUy1XhLzJyAP-ftq-VU-EGOpvbxc,1362
 odoo/addons/l10n_ro_stock_account/wizard/stock_valuation_layer_revaluation.py,sha256=qjrzT91n9pw7LJtfrDrEZ6ddg5T50hMU5Kz24LuET_o,1102
 odoo/addons/l10n_ro_stock_account/wizard/stock_valuation_layer_revaluation_views.xml,sha256=djZXcgpMsRbYgYSUR45SCznU6ycHyyV4tjdwUQDvYOU,936
-odoo_addon_l10n_ro_stock_account-16.0.1.3.0.1.dist-info/METADATA,sha256=JM9sGzC1n3WJWAe4lSbNTgH4X9DsfrG0kr_kY6u2VXY,4194
-odoo_addon_l10n_ro_stock_account-16.0.1.3.0.1.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
-odoo_addon_l10n_ro_stock_account-16.0.1.3.0.1.dist-info/top_level.txt,sha256=qBj40grFkGOfDZ2WDSw3y1RnDlgG0u8rP8pvGNdbz4w,5
-odoo_addon_l10n_ro_stock_account-16.0.1.3.0.1.dist-info/RECORD,,
+odoo_addon_l10n_ro_stock_account-16.0.1.4.0.dist-info/METADATA,sha256=CvqOVpttS0Q0SCPbWSXiR_9eJqwpPaPebda29fKIMSk,4192
+odoo_addon_l10n_ro_stock_account-16.0.1.4.0.dist-info/WHEEL,sha256=AtBG6SXL3KF_v0NxLf0ehyVOh0cold-JbJYXNGorC6Q,92
+odoo_addon_l10n_ro_stock_account-16.0.1.4.0.dist-info/top_level.txt,sha256=qBj40grFkGOfDZ2WDSw3y1RnDlgG0u8rP8pvGNdbz4w,5
+odoo_addon_l10n_ro_stock_account-16.0.1.4.0.dist-info/RECORD,,
```

